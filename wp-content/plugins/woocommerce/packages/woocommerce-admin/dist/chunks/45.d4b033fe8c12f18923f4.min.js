(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{202:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(18);function c(e){var t=Object(o.dispatch)("core/notices").createNotice;e.error_data&&e.errors&&Object.keys(e.errors).length?Object.keys(e.errors).forEach((function(n){t("error",e.errors[n].join(" "))})):e.message&&t(e.code?"error":"success",e.message)}},264:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(17),c=n.n(o),r=n(27),a=n(23);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window.location,o=n.pathname,c=n.search,i=Object(a.g)("connectNonce","");return t=s({"wccom-site":Object(a.g)("siteUrl"),"wccom-back":o+c,"wccom-woo-version":Object(a.g)("wcVersion"),"wccom-connect-nonce":i},t),Object(r.addQueryArgs)(e,t)}},726:function(e,t,n){"use strict";var o=n(12),c=n(14),r=n(0),a=n(8),i=n.n(a),s=n(2),l=n(32);t.a=function(e){var t=e.className,n=e.checked,a=e.id,u=e.onChange,m=void 0===u?s.noop:u,p=Object(c.a)(e,["className","checked","id","onChange"]),d=i()("components-form-toggle",t,{"is-checked":n});return Object(r.createElement)("span",{className:d},Object(r.createElement)("input",Object(o.a)({className:"components-form-toggle__input",id:a,type:"checkbox",checked:n,onChange:m},p)),Object(r.createElement)("span",{className:"components-form-toggle__track"}),Object(r.createElement)("span",{className:"components-form-toggle__thumb"}),n?Object(r.createElement)(l.b,{className:"components-form-toggle__on",width:"2",height:"6",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2 6"},Object(r.createElement)(l.a,{d:"M0 0h2v6H0z"})):Object(r.createElement)(l.b,{className:"components-form-toggle__off",width:"6",height:"6","aria-hidden":"true",role:"img",focusable:"false",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 6"},Object(r.createElement)(l.a,{d:"M3 1.5c.8 0 1.5.7 1.5 1.5S3.8 4.5 3 4.5 1.5 3.8 1.5 3 2.2 1.5 3 1.5M3 0C1.3 0 0 1.3 0 3s1.3 3 3 3 3-1.3 3-3-1.3-3-3-3z"})))}},758:function(e,t,n){"use strict";var o=n(766),c=["a","b","em","i","strong","p"],r=["target","href","rel","name","download"];t.a=function(e){return{__html:Object(o.sanitize)(e,{ALLOWED_TAGS:c,ALLOWED_ATTR:r})}}},765:function(e,t,n){"use strict";var o=n(51),c=n.n(o),r=n(38),a=n.n(r),i=n(37),s=n.n(i),l=n(62),u=n.n(l),m=n(39),p=n.n(m),d=n(42),h=n.n(d),b=n(26),f=n.n(b),g=n(0),_=n(3),O=n(67),y=n(169),w=n(1),j=n.n(w),k=n(18),v=n(43);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=f()(e);if(t){var c=f()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return h()(this,n)}}var C=function(e){p()(o,e);var t,n=S(o);function o(e){var t;return a()(this,o),(t=n.call(this,e)).state={isConnecting:!1},t.connectJetpack=t.connectJetpack.bind(u()(t)),e.setIsPending(!0),t}return s()(o,[{key:"componentDidMount",value:function(){var e=this.props,t=e.autoConnect,n=e.jetpackConnectUrl;t&&n&&this.connectJetpack()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.autoConnect,o=t.createNotice,c=t.error,r=t.isRequesting,a=t.jetpackConnectUrl,i=t.onError,s=t.setIsPending;e.isRequesting&&!r&&s(!1),c&&c!==e.error&&(i&&i(),o("error",c)),n&&a&&this.connectJetpack()}},{key:"connectJetpack",value:(t=c()(regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,n=t.jetpackConnectUrl,o=t.onConnect,this.setState({isConnecting:!0},(function(){o&&o(),window.location=n}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,t=e.autoConnect,n=e.hasErrors,o=e.isRequesting,c=e.onSkip,r=e.skipText;return t?null:Object(g.createElement)(g.Fragment,null,n?Object(g.createElement)(O.a,{isPrimary:!0,onClick:function(){return window.location.reload()}},Object(_.__)("Retry",'woocommerce')):Object(g.createElement)(O.a,{disabled:o,isBusy:this.state.isConnecting,isPrimary:!0,onClick:this.connectJetpack},Object(_.__)("Connect",'woocommerce')),c&&Object(g.createElement)(O.a,{onClick:c},r||Object(_.__)("No thanks",'woocommerce')))}}]),o}(g.Component);C.propTypes={autoConnect:j.a.bool,createNotice:j.a.func.isRequired,error:j.a.string,hasErrors:j.a.bool,isRequesting:j.a.bool,jetpackConnectUrl:j.a.string,onConnect:j.a.func,onError:j.a.func,onSkip:j.a.func,redirectUrl:j.a.string,skipText:j.a.string,setIsPending:j.a.func},C.defaultProps={autoConnect:!1,setIsPending:function(){}},t.a=Object(y.a)(Object(k.withSelect)((function(e,t){var n=e(v.PLUGINS_STORE_NAME),o=n.getJetpackConnectUrl,c=n.isPluginsRequesting,r=n.getPluginsError,a={redirect_url:t.redirectUrl||window.location.href},i=c("getJetpackConnectUrl");return{error:r("getJetpackConnectUrl")||"",isRequesting:i,jetpackConnectUrl:o(a)}})),Object(k.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice}})))(C)},768:function(e,t,n){"use strict";var o=n(0),c=n(32),r=Object(o.createElement)(c.b,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(o.createElement)(c.a,{d:"M9 18.6L3.5 13l1-1L9 16.4l9.5-9.9 1 1z"}));t.a=r},775:function(e,t,n){},784:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return _}));var o=n(80),c=n.n(o),r=n(146),a=n.n(r),i=n(41),s=n.n(i),l=n(0),u=n(3),m=n(72),p=n(2),d=n(13),h=n(23),b=n(53),f=Object(h.g)("dataEndpoints",{countries:{}}).countries;function g(e){var t={};return e.addressLine1.length||(t.addressLine1=Object(u.__)("Please add an address",'woocommerce')),e.countryState.length||(t.countryState=Object(u.__)("Please select a country / region",'woocommerce')),e.city.length||(t.city=Object(u.__)("Please add a city",'woocommerce')),e.postCode.length||(t.postCode=Object(u.__)("Please add a post code",'woocommerce')),t}function _(e){var t=e.getInputProps,n=e.setValue,o=Object(d.useMemo)((function(){return f.reduce((function(e,t){if(!t.states.length)return e.push({key:t.code,label:Object(m.decodeEntities)(t.name)}),e;var n=t.states.map((function(e){return{key:t.code+":"+e.code,label:Object(m.decodeEntities)(t.name)+" â€” "+Object(m.decodeEntities)(e.name)}}));return e.push.apply(e,s()(n)),e}),[])}),[]),r=function(e,t,n){var o=Object(d.useState)(""),c=a()(o,2),r=c[0],i=c[1],s=Object(d.useState)(""),u=a()(s,2),m=u[0],h=u[1];return Object(d.useEffect)((function(){var o=[],c=new RegExp(Object(p.escapeRegExp)(r),"i");if((m.length||r.length)&&(o=e.filter((function(e){return c.test(e.label)}))),r.length&&m.length){var a=new RegExp(Object(p.escapeRegExp)(m.replace(/\s/g,"")),"i");if((o=o.filter((function(e){return a.test(e.label.replace("-","").replace(/\s/g,""))}))).length>1){var i;(i=o.filter((function(e){return c.test(e.key)}))).length>0&&(o=i)}if(o.length>1){var s;1===(s=o.filter((function(e){return a.test(e.key)}))).length&&(o=s)}}1===o.length&&t!==o[0].key&&n("countryState",o[0].key)}),[r,m]),Object(l.createElement)(l.Fragment,null,Object(l.createElement)("input",{onChange:function(e){return i(e.target.value)},value:r,name:"country",type:"text",className:"woocommerce-select-control__autofill-input",tabIndex:"-1",autoComplete:"country"}),Object(l.createElement)("input",{onChange:function(e){return h(e.target.value)},value:m,name:"state",type:"text",className:"woocommerce-select-control__autofill-input",tabIndex:"-1",autoComplete:"address-level1"}))}(o,t("countryState").value,n);return Object(l.createElement)("div",{className:"woocommerce-store-address-fields"},Object(l.createElement)(b.TextControl,c()({label:Object(u.__)("Address line 1",'woocommerce'),required:!0,autoComplete:"address-line1"},t("addressLine1"))),Object(l.createElement)(b.TextControl,c()({label:Object(u.__)("Address line 2 (optional)",'woocommerce'),required:!0,autoComplete:"address-line2"},t("addressLine2"))),Object(l.createElement)(b.SelectControl,c()({label:Object(u.__)("Country / Region",'woocommerce'),required:!0,options:o,excludeSelectedOptions:!1,showAllOnFocus:!0,isSearchable:!0},t("countryState"),{controlClassName:t("countryState").className}),r),Object(l.createElement)(b.TextControl,c()({label:Object(u.__)("City",'woocommerce'),required:!0},t("city"),{autoComplete:"address-level2"})),Object(l.createElement)(b.TextControl,c()({label:Object(u.__)("Post code",'woocommerce'),required:!0,autoComplete:"postal-code"},t("postCode"))))}},920:function(e,t,n){"use strict";n.r(t);var o=n(17),c=n.n(o),r=n(38),a=n.n(r),i=n(37),s=n.n(i),l=n(39),u=n.n(l),m=n(42),p=n.n(m),d=n(26),h=n.n(d),b=n(0),f=n(3),g=n(2),_=n(169),O=n(8),y=n.n(O),w=n(67),j=n(722),k=n(734),v=n(913),S=n(914),C=n(915),E=n(18),P=n(422),x=n(768),N=n(727),R=n(53),T=n(22),M=n(43),I=(n(775),n(72)),A=n(23),D=n(753),L=n(758),q=n(63),U=n(264);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var V=function(e){u()(n,e);var t=F(n);function n(e){var o;return a()(this,n),(o=t.call(this,e)).state={purchaseNowButtonBusy:!1,purchaseLaterButtonBusy:!1},o}return s()(n,[{key:"onClickPurchaseNow",value:function(){var e=this.props,t=e.productIds,n=e.onClickPurchaseNow;if(this.setState({purchaseNowButtonBusy:!0}),t.length){Object(q.b)("tasklist_modal_proceed_checkout",{product_ids:t,purchase_install:!0});var o=Object(U.a)("https://woocommerce.com/cart",{"wccom-replace-with":t.join(",")});n?n(o):window.location=o}}},{key:"onClickPurchaseLater",value:function(){var e=this.props.productIds;Object(q.b)("tasklist_modal_proceed_checkout",{product_ids:e,purchase_install:!1}),this.setState({purchaseLaterButtonBusy:!0}),this.props.onClickPurchaseLater()}},{key:"onClose",value:function(){var e=this.props,t=e.onClose,n=e.productIds;Object(q.b)("tasklist_modal_proceed_checkout",{product_ids:n,purchase_install:!1}),t()}},{key:"renderProducts",value:function(){var e=this.props.productIds,t=Object(A.g)("onboarding",{}),n=t.productTypes,o=void 0===n?{}:n,c=t.themes,r=void 0===c?[]:c,a=[];return e.forEach((function(e){var t=Object(g.find)(o,(function(t){return t.product===e}));t&&a.push({title:t.label,content:t.description});var n=Object(g.find)(r,(function(t){return t.id===e}));n&&a.push({title:Object(f.sprintf)(Object(f.__)("%s â€” %s per year",'woocommerce'),n.title,Object(I.decodeEntities)(n.price)),content:Object(b.createElement)("span",{dangerouslySetInnerHTML:Object(L.a)(n.excerpt)})})})),Object(b.createElement)(R.List,{items:a})}},{key:"render",value:function(){var e=this,t=this.state,n=t.purchaseNowButtonBusy,o=t.purchaseLaterButtonBusy;return Object(b.createElement)(j.a,{title:Object(f.__)("Would you like to purchase and install the following features now?",'woocommerce'),onRequestClose:function(){return e.onClose()},className:"woocommerce-cart-modal"},this.renderProducts(),Object(b.createElement)("p",{className:"woocommerce-cart-modal__help-text"},Object(f.__)("You won't have access to this functionality until the extensions have been purchased and installed.",'woocommerce')),Object(b.createElement)("div",{className:"woocommerce-cart-modal__actions"},Object(b.createElement)(w.a,{isLink:!0,isBusy:o,onClick:function(){return e.onClickPurchaseLater()}},Object(f.__)("I'll do it later",'woocommerce')),Object(b.createElement)(w.a,{isPrimary:!0,isBusy:n,onClick:function(){return e.onClickPurchaseNow()}},Object(f.__)("Purchase & install now",'woocommerce'))))}}]),n}(b.Component),B=Object(_.a)(Object(E.withSelect)((function(e){var t=e(M.PLUGINS_STORE_NAME).getInstalledPlugins,n=(0,e(M.ONBOARDING_STORE_NAME).getProfileItems)(),o=t();return{profileItems:n,productIds:Object(D.d)(n,!1,o)}})))(V),H=n(48),Z=n(51),J=n.n(Z),G=n(62),W=n.n(G),z=n(21),K=n.n(z),Y=n(33);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var ee=function(e){u()(r,e);var t,n,o=X(r);function r(e){var t;a()(this,r),t=o.call(this,e);var n=Object(A.g)("onboarding",{}),c=n.hasHomepage,i=n.hasProducts;return t.stepVisibility={homepage:!c,import:!i},t.state={isDirty:!1,isPending:!1,logo:null,stepIndex:0,isUpdatingLogo:!1,isUpdatingNotice:!1,storeNoticeText:e.demoStoreNotice||""},t.completeStep=t.completeStep.bind(W()(t)),t.createHomepage=t.createHomepage.bind(W()(t)),t.importProducts=t.importProducts.bind(W()(t)),t.updateLogo=t.updateLogo.bind(W()(t)),t.updateNotice=t.updateNotice.bind(W()(t)),t}return s()(r,[{key:"componentDidMount",value:function(){var e=Object(A.g)("onboarding",{}).themeMods;e.custom_logo&&this.setState({logo:{id:e.custom_logo}})}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.state,o=n.isPending,c=n.logo,r=this.props.demoStoreNotice;!c||c.url||o||(this.setState({isPending:!0}),wp.media.attachment(c.id).fetch().then((function(){var e=wp.media.attachment(c.id).get("url");t.setState({isPending:!1,logo:{id:c.id,url:e}})}))),r&&e.demoStoreNotice!==r&&this.setState({storeNoticeText:r})}},{key:"completeStep",value:function(){var e=this.state.stepIndex;this.getSteps()[e+1]?this.setState({stepIndex:e+1}):Object(T.getHistory)().push(Object(T.getNewPath)({},"/",{}))}},{key:"importProducts",value:function(){var e=this,t=this.props.createNotice;this.setState({isPending:!0}),Object(q.b)("tasklist_appearance_import_demo",{}),K()({path:"".concat(Y.f,"/onboarding/tasks/import_sample_products"),method:"POST"}).then((function(n){n.failed&&n.failed.length?t("error",Object(f.__)("There was an error importing some of the sample products.",'woocommerce')):(t("success",Object(f.__)("All sample products have been imported.",'woocommerce')),Object(A.h)("onboarding",$($({},Object(A.g)("onboarding",{})),{},{hasProducts:!0}))),e.setState({isPending:!1}),e.completeStep()})).catch((function(n){t("error",n.message),e.setState({isPending:!1})}))}},{key:"createHomepage",value:function(){var e=this,t=this.props.createNotice;this.setState({isPending:!0}),Object(q.b)("tasklist_appearance_create_homepage",{create_homepage:!0}),K()({path:"/wc-admin/onboarding/tasks/create_homepage",method:"POST"}).then((function(n){t(n.status,n.message,{actions:n.edit_post_link?[{label:Object(f.__)("Customize",'woocommerce'),onClick:function(){Object(q.a)("tasklist_appearance_customize_homepage",{}),window.location="".concat(n.edit_post_link,"&wc_onboarding_active_task=homepage")}}]:null}),e.setState({isPending:!1}),e.completeStep()})).catch((function(n){t("error",n.message),e.setState({isPending:!1})}))}},{key:"updateLogo",value:(n=J()(regeneratorRuntime.mark((function e(){var t,n,o,r,a,i,s,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.updateOptions,o=t.createNotice,r=this.state.logo,a=Object(A.g)("onboarding",{}),i=a.stylesheet,s=a.themeMods,l=$($({},s),{},{custom_logo:r?r.id:null}),Object(q.b)("tasklist_appearance_upload_logo"),Object(A.h)("onboarding",$($({},Object(A.g)("onboarding",{})),{},{themeMods:l})),this.setState({isUpdatingLogo:!0}),e.next=9,n(c()({},"theme_mods_".concat(i),l));case 9:(u=e.sent).success?(this.setState({isUpdatingLogo:!1}),o("success",Object(f.__)("Store logo updated sucessfully.",'woocommerce')),this.completeStep()):o("error",u.message);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"updateNotice",value:(t=J()(regeneratorRuntime.mark((function e(){var t,n,o,c,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.updateOptions,o=t.createNotice,c=this.state.storeNoticeText,Object(q.b)("tasklist_appearance_set_store_notice",{added_text:Boolean(c.length)}),Object(A.h)("onboarding",$($({},Object(A.g)("onboarding",{})),{},{isAppearanceComplete:!0})),this.setState({isUpdatingNotice:!0}),e.next=7,n({woocommerce_task_list_appearance_complete:!0,woocommerce_demo_store:c.length?"yes":"no",woocommerce_demo_store_notice:c});case 7:(r=e.sent).success?(this.setState({isUpdatingNotice:!1}),o("success",Object(f.__)("ðŸŽ¨ Your store is looking great! Don't forget to continue personalizing it.",'woocommerce')),this.completeStep()):o("error",r.message);case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getSteps",value:function(){var e=this,t=this.state,n=t.isDirty,o=t.isPending,c=t.logo,r=t.storeNoticeText,a=t.isUpdatingLogo,i=[{key:"import",label:Object(f.__)("Import sample products",'woocommerce'),description:Object(f.__)("Weâ€™ll add some products that will make it easier to see what your store looks like",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(b.createElement)(w.a,{onClick:this.importProducts,isBusy:o,isPrimary:!0},Object(f.__)("Import products",'woocommerce')),Object(b.createElement)(w.a,{onClick:function(){return e.completeStep()}},Object(f.__)("Skip",'woocommerce'))),visible:this.stepVisibility.import},{key:"homepage",label:Object(f.__)("Create a custom homepage",'woocommerce'),description:Object(f.__)("Create a new homepage and customize it to suit your needs",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(b.createElement)(w.a,{isPrimary:!0,isBusy:o,onClick:this.createHomepage},Object(f.__)("Create homepage",'woocommerce')),Object(b.createElement)(w.a,{onClick:function(){Object(q.b)("tasklist_appearance_create_homepage",{create_homepage:!1}),e.completeStep()}},Object(f.__)("Skip",'woocommerce'))),visible:this.stepVisibility.homepage},{key:"logo",label:Object(f.__)("Upload a logo",'woocommerce'),description:Object(f.__)("Ensure your store is on-brand by adding your logo",'woocommerce'),content:o?null:Object(b.createElement)(b.Fragment,null,Object(b.createElement)(R.ImageUpload,{image:c,onChange:function(t){return e.setState({isDirty:!0,logo:t})}}),Object(b.createElement)(w.a,{disabled:!c&&!n,onClick:this.updateLogo,isBusy:a,isPrimary:!0},Object(f.__)("Proceed",'woocommerce')),Object(b.createElement)(w.a,{isTertiary:!0,onClick:function(){return e.completeStep()}},Object(f.__)("Skip",'woocommerce'))),visible:!0},{key:"notice",label:Object(f.__)("Set a store notice",'woocommerce'),description:Object(f.__)("Optionally display a prominent notice across all pages of your store",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(b.createElement)(R.TextControl,{label:Object(f.__)("Store notice text",'woocommerce'),placeholder:Object(f.__)("Store notice text",'woocommerce'),value:r,onChange:function(t){return e.setState({storeNoticeText:t})}}),Object(b.createElement)(w.a,{onClick:this.updateNotice,isPrimary:!0},Object(f.__)("Complete task",'woocommerce'))),visible:!0}];return Object(g.filter)(i,(function(e){return e.visible}))}},{key:"render",value:function(){var e=this.state,t=e.isPending,n=e.stepIndex,o=e.isUpdatingLogo,c=e.isUpdatingNotice,r=this.getSteps()[n].key;return Object(b.createElement)("div",{className:"woocommerce-task-appearance"},Object(b.createElement)(R.Card,{className:"is-narrow"},Object(b.createElement)(R.Stepper,{isPending:c||o||t,isVertical:!0,currentStep:r,steps:this.getSteps()})))}}]),r}(b.Component),te=Object(_.a)(Object(E.withSelect)((function(e){return{demoStoreNotice:(0,e(M.OPTIONS_STORE_NAME).getOption)("woocommerce_demo_store_notice")}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})))(ee),ne=n(101);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var ae=function(e){u()(c,e);var t,n,o=re(c);function c(){return a()(this,c),o.apply(this,arguments)}return s()(c,[{key:"componentDidMount",value:function(){document.body.classList.add("woocommerce-admin-is-loading");var e=this.props.query;"1"!==e.deny?e["wccom-connected"]&&e.request_token?this.finish():this.request():this.errorMessage(Object(f.__)("You must click approve to install your extensions and connect to WooCommerce.com.",'woocommerce'))}},{key:"baseQuery",value:function(){var e=this.props.query,t=Object(g.omit)(ce(ce({},e),{},{page:"wc-admin"}),["task","wccom-connected","request_token","deny"]);return Object(T.getNewPath)({},"/",t)}},{key:"errorMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(f.__)("There was an error connecting to WooCommerce.com. Please try again.",'woocommerce');document.body.classList.remove("woocommerce-admin-is-loading"),Object(T.getHistory)().push(this.baseQuery()),this.props.createNotice("error",e)}},{key:"request",value:(n=J()(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K()({path:"".concat(Y.f,"/plugins/request-wccom-connect"),method:"POST"});case 3:if(!(t=e.sent)||!t.connectAction){e.next=7;break}return window.location=t.connectAction,e.abrupt("return");case 7:throw new Error;case 10:e.prev=10,e.t0=e.catch(0),this.errorMessage();case 13:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return n.apply(this,arguments)})},{key:"finish",value:(t=J()(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.query,e.prev=1,e.next=4,K()({path:"".concat(Y.f,"/plugins/finish-wccom-connect"),method:"POST",data:{request_token:t.request_token}});case 4:if(!(n=e.sent)||!n.success){e.next=10;break}return e.next=8,this.props.updateProfileItems({wccom_connected:!0});case 8:return this.props.isProfileItemsError?this.errorMessage():(this.props.createNotice("success",Object(f.__)("Store connected to WooCommerce.com and extensions are being installed.",'woocommerce')),document.body.classList.remove("woocommerce-admin-is-loading"),Object(T.getHistory)().push(this.baseQuery())),e.abrupt("return");case 10:throw new Error;case 13:e.prev=13,e.t0=e.catch(1),this.errorMessage();case 16:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){return null}}]),c}(b.Component),ie=Object(_.a)(Object(ne.a)((function(e){var t=e(M.ONBOARDING_STORE_NAME).getOnboardingError;return{isProfileItemsError:Boolean(t("updateProfileItems"))}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateProfileItems:e(M.ONBOARDING_STORE_NAME).updateProfileItems}})))(ae);function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var le=[{title:Object(f.__)("Add manually (recommended)",'woocommerce'),content:Object(f.__)("For small stores we recommend adding products manually",'woocommerce'),before:Object(b.createElement)("i",{className:"material-icons-outlined"},"add_box"),after:Object(b.createElement)("i",{className:"material-icons-outlined"},"chevron_right"),onClick:function(){return Object(q.b)("tasklist_add_product",{method:"manually"})},href:Object(A.f)("post-new.php?post_type=product&wc_onboarding_active_task=products&tutorial=true")},{title:Object(f.__)("Import",'woocommerce'),content:Object(f.__)("For larger stores we recommend importing all products at once via CSV file",'woocommerce'),before:Object(b.createElement)("i",{className:"material-icons-outlined"},"import_export"),after:Object(b.createElement)("i",{className:"material-icons-outlined"},"chevron_right"),onClick:function(){return Object(q.b)("tasklist_add_product",{method:"import"})},href:Object(A.f)("edit.php?post_type=product&page=product_importer&wc_onboarding_active_task=product-import")},{title:Object(f.__)("Migrate",'woocommerce'),content:Object(f.__)("For stores currently selling elsewhere we suggest using a product migration service",'woocommerce'),before:Object(b.createElement)("i",{className:"material-icons-outlined"},"cloud_download"),after:Object(b.createElement)("i",{className:"material-icons-outlined"},"chevron_right"),onClick:function(){return Object(q.b)("tasklist_add_product",{method:"migrate"})},href:"https://woocommerce.com/products/cart2cart/",target:"_blank"}],ue=function(e){u()(n,e);var t=se(n);function n(){return a()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(R.Card,{className:"woocommerce-task-card"},Object(b.createElement)(R.List,{items:le})))}}]),n}(b.Component),me=n(80),pe=n.n(me),de=n(36),he=n.n(de),be=n(765),fe=n(784);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var ye=function(e){u()(o,e);var t,n=Oe(o);function o(){var e;return a()(this,o),(e=n.apply(this,arguments)).onSubmit=e.onSubmit.bind(W()(e)),e}return s()(o,[{key:"onSubmit",value:(t=J()(regeneratorRuntime.mark((function e(t){var n,o,c,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,o=n.onComplete,c=n.createNotice,r=n.isSettingsError,a=n.updateAndPersistSettingsForGroup,i=n.settings,e.next=3,a("general",{general:_e(_e({},i),{},{woocommerce_store_address:t.addressLine1,woocommerce_store_address_2:t.addressLine2,woocommerce_default_country:t.countryState,woocommerce_store_city:t.city,woocommerce_store_postcode:t.postCode})});case 3:r?c("error",Object(f.__)("There was a problem saving your store location.",'woocommerce')):o(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getInitialValues",value:function(){var e=this.props.settings;return{addressLine1:e.woocommerce_store_address||"",addressLine2:e.woocommerce_store_address_2||"",city:e.woocommerce_store_city||"",countryState:e.woocommerce_default_country||"",postCode:e.woocommerce_store_postcode||""}}},{key:"render",value:function(){return this.props.isSettingsRequesting?null:Object(b.createElement)(R.Form,{initialValues:this.getInitialValues(),onSubmitCallback:this.onSubmit,validate:fe.b},(function(e){var t=e.getInputProps,n=e.handleSubmit,o=e.setValue;return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(fe.a,{getInputProps:t,setValue:o}),Object(b.createElement)(w.a,{isPrimary:!0,onClick:n},Object(f.__)("Continue",'woocommerce')))}))}}]),o}(b.Component),we=n(726),je=n(1),ke=n.n(je),ve=n(200);function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var Pe=function(e){u()(o,e);var t,n=Ee(o);function o(){var e;return a()(this,o),(e=n.apply(this,arguments)).updateShippingZones=e.updateShippingZones.bind(W()(e)),e}return s()(o,[{key:"getShippingMethods",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&e.methods&&Array.isArray(e.methods)?t?e.methods?e.methods.filter((function(e){return e.method_id===t})):[]:e.methods:[]}},{key:"disableShippingMethods",value:function(e,t){t.length&&t.forEach((function(t){K()({method:"POST",path:"/wc/v3/shipping/zones/".concat(e.id,"/methods/").concat(t.instance_id),data:{enabled:!1}})}))}},{key:"updateShippingZones",value:(t=J()(regeneratorRuntime.mark((function e(t){var n,o,c,r,a,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.props,o=n.createNotice,c=n.shippingZones,r=!1,a=!1,c.forEach((function(e){0===e.id?r=e.toggleable&&t["".concat(e.id,"_enabled")]:a=""!==t["".concat(e.id,"_rate")]&&parseFloat(t["".concat(e.id,"_rate")])!==parseFloat(0);var n=i.getShippingMethods(e),o=parseFloat(t["".concat(e.id,"_rate")])===parseFloat(0)?"free_shipping":"flat_rate",c=i.getShippingMethods(e,o).length?i.getShippingMethods(e,o)[0]:null;if(!e.toggleable||t["".concat(e.id,"_enabled")]){if(c){var s=n.filter((function(e){return e.instance_id!==c.instance_id}));i.disableShippingMethods(e,s)}K()({method:"POST",path:c?"/wc/v3/shipping/zones/".concat(e.id,"/methods/").concat(c.instance_id):"/wc/v3/shipping/zones/".concat(e.id,"/methods"),data:{method_id:o,enabled:!0,settings:{cost:t["".concat(e.id,"_rate")]}}})}else i.disableShippingMethods(e,n)})),Object(q.b)("tasklist_shipping_set_costs",{shipping_cost:a,rest_world:r}),Object(A.h)("onboarding",Ce(Ce({},Object(A.g)("onboarding",{})),{},{shippingZonesCount:1})),o("success",Object(f.__)("Your shipping rates have been updated.",'woocommerce')),this.props.onComplete();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"renderInputPrefix",value:function(){var e=this.context.getCurrency(),t=e.symbolPosition,n=e.symbol;return 0===t.indexOf("right")?null:Object(b.createElement)("span",{className:"woocommerce-shipping-rate__control-prefix"},n)}},{key:"renderInputSuffix",value:function(e){var t=this.context.getCurrency(),n=t.symbolPosition,o=t.symbol;return 0===n.indexOf("right")?Object(b.createElement)("span",{className:"woocommerce-shipping-rate__control-suffix"},o):parseFloat(e)===parseFloat(0)?Object(b.createElement)("span",{className:"woocommerce-shipping-rate__control-suffix"},Object(f.__)("Free shipping",'woocommerce')):null}},{key:"getFormattedRate",value:function(e){var t=this.context.formatDecimalString,n=t(e);return e.length&&n.length?t(e):t(0)}},{key:"getInitialValues",value:function(){var e=this,t=this.context.formatDecimalString,n={};return this.props.shippingZones.forEach((function(o){var c=e.getShippingMethods(o),r=c.length&&c[0].settings.cost?e.getFormattedRate(c[0].settings.cost.value):t(0);n["".concat(o.id,"_rate")]=r,c.length&&c[0].enabled?n["".concat(o.id,"_enabled")]=!0:n["".concat(o.id,"_enabled")]=!1})),n}},{key:"validate",value:function(e){var t={};return Object.keys(e).filter((function(e){return e.endsWith("_rate")})).forEach((function(n){e[n]<0&&(t[n]=Object(f.__)("Shipping rates can not be negative numbers.",'woocommerce'))})),t}},{key:"render",value:function(){var e=this,t=this.props,n=t.buttonText,o=t.shippingZones;return o.length?Object(b.createElement)(R.Form,{initialValues:this.getInitialValues(),onSubmitCallback:this.updateShippingZones,validate:this.validate},(function(t){var c=t.getInputProps,r=t.handleSubmit,a=t.setTouched,i=t.setValue,s=t.values;return Object(b.createElement)(b.Fragment,null,Object(b.createElement)("div",{className:"woocommerce-shipping-rates"},o.map((function(t){return Object(b.createElement)("div",{className:"woocommerce-shipping-rate",key:t.id},Object(b.createElement)("div",{className:"woocommerce-shipping-rate__icon"},t.locations?t.locations.map((function(e){return Object(b.createElement)(R.Flag,{size:24,code:e.code,key:e.code})})):Object(b.createElement)("i",{className:"material-icons-outlined"},"public")),Object(b.createElement)("div",{className:"woocommerce-shipping-rate__main"},t.toggleable?Object(b.createElement)("label",{htmlFor:"woocommerce-shipping-rate__toggle-".concat(t.id),className:"woocommerce-shipping-rate__name"},t.name,Object(b.createElement)(we.a,pe()({id:"woocommerce-shipping-rate__toggle-".concat(t.id)},c("".concat(t.id,"_enabled"))))):Object(b.createElement)("div",{className:"woocommerce-shipping-rate__name"},t.name),(!t.toggleable||s["".concat(t.id,"_enabled")])&&Object(b.createElement)(R.TextControlWithAffixes,pe()({label:Object(f.__)("Shipping cost",'woocommerce'),required:!0},c("".concat(t.id,"_rate")),{onBlur:function(){a("".concat(t.id,"_rate")),i("".concat(t.id,"_rate"),e.getFormattedRate(s["".concat(t.id,"_rate")]))},prefix:e.renderInputPrefix(),suffix:e.renderInputSuffix(s["".concat(t.id,"_rate")]),className:"muriel-input-text woocommerce-shipping-rate__control-wrapper"}))))}))),Object(b.createElement)(w.a,{isPrimary:!0,onClick:r},n||Object(f.__)("Update",'woocommerce')))})):null}}]),o}(b.Component);Pe.propTypes={buttonText:ke.a.string,onComplete:ke.a.func.isRequired,createNotice:ke.a.func.isRequired,shippingZones:ke.a.array},Pe.defaultProps={shippingZones:[]},Pe.contextType=ve.a;var xe=Pe;function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var Re=function(e){u()(o,e);var t,n=Ne(o);function o(e){var t;return a()(this,o),(t=n.call(this,e)).initialState={isPending:!1,step:"store_location",shippingZones:[]},t.activePlugins=e.activePlugins,t.state=t.initialState,t.completeStep=t.completeStep.bind(W()(t)),t}return s()(o,[{key:"componentDidMount",value:function(){this.reset()}},{key:"reset",value:function(){this.setState(this.initialState)}},{key:"fetchShippingZones",value:(t=J()(regeneratorRuntime.mark((function e(){var t,n,o,c,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isPending:!0}),t=this.props,n=t.countryCode,o=t.countryName,c=[],e.next=5,K()({path:"/wc/v3/shipping/zones"});case 5:return r=e.sent,a=!1,e.next=9,Promise.all(r.map(function(){var e=J()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.id){e.next=8;break}return e.next=3,K()({path:"/wc/v3/shipping/zones/".concat(t.id,"/methods")});case 3:return t.methods=e.sent,t.name=Object(f.__)("Rest of the world",'woocommerce'),t.toggleable=!0,c.push(t),e.abrupt("return");case 8:return e.next=10,K()({path:"/wc/v3/shipping/zones/".concat(t.id,"/locations")});case 10:if(t.locations=e.sent,!t.locations.find((function(e){return n===e.code}))){e.next=18;break}return e.next=15,K()({path:"/wc/v3/shipping/zones/".concat(t.id,"/methods")});case 15:t.methods=e.sent,c.push(t),a=!0;case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:if(a){e.next=17;break}return e.next=12,K()({method:"POST",path:"/wc/v3/shipping/zones",data:{name:o}});case 12:return i=e.sent,e.next=15,K()({method:"POST",path:"/wc/v3/shipping/zones/".concat(i.id,"/locations"),data:[{code:n,type:"country"}]});case 15:i.locations=e.sent,c.push(i);case 17:c.reverse(),this.setState({isPending:!1,shippingZones:c});case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentDidUpdate",value:function(e,t){var n=this.props,o=n.countryCode,c=n.settings,r=c.woocommerce_store_address,a=c.woocommerce_default_country,i=c.woocommerce_store_postcode,s=this.state.step;"rates"!==s||e.countryCode===o&&"rates"===t.step||this.fetchShippingZones();var l=Boolean(r&&a&&i);"store_location"===s&&l&&this.completeStep()}},{key:"completeStep",value:function(){var e=this.props.createNotice,t=this.state.step,n=this.getSteps(),o=n.findIndex((function(e){return e.key===t})),c=n[o+1];c?this.setState({step:c.key}):(e("success",Object(f.__)("ðŸ“¦ Shipping is done! Don't worry, you can always change it later.",'woocommerce')),Object(T.getHistory)().push(Object(T.getNewPath)({},"/",{})))}},{key:"getPluginsToActivate",value:function(){var e=this.props.countryCode,t=[];return["GB","CA","AU"].includes(e)?t.push("woocommerce-shipstation-integration"):"US"===e&&(t.push("woocommerce-services"),t.push("jetpack")),Object(g.difference)(t,this.activePlugins)}},{key:"getSteps",value:function(){var e=this,t=this.props,n=t.countryCode,o=t.isJetpackConnected,c=this.getPluginsToActivate(),r=!o&&"US"===n,a=[{key:"store_location",label:Object(f.__)("Set store location",'woocommerce'),description:Object(f.__)("The address from which your business operates",'woocommerce'),content:Object(b.createElement)(ye,pe()({},this.props,{onComplete:function(t){var n=Object(D.a)(t.countryState);Object(q.b)("tasklist_shipping_set_location",{country:n}),e.completeStep()}})),visible:!0},{key:"rates",label:Object(f.__)("Set shipping costs",'woocommerce'),description:Object(f.__)("Define how much customers pay to ship to different destinations",'woocommerce'),content:Object(b.createElement)(xe,pe()({buttonText:c.length||r?Object(f.__)("Proceed",'woocommerce'):Object(f.__)("Complete task",'woocommerce'),shippingZones:this.state.shippingZones,onComplete:this.completeStep},this.props)),visible:!0},{key:"label_printing",label:Object(f.__)("Enable shipping label printing",'woocommerce'),description:c.includes("woocommerce-shipstation-integration")?he()({mixedString:Object(f.__)("We recommend using ShipStation to save time at the post office by printing your shipping labels at home. Try ShipStation free for 30 days. {{link}}Learn more{{/link}}.",'woocommerce'),components:{link:Object(b.createElement)(R.Link,{href:"https://woocommerce.com/products/shipstation-integration",target:"_blank",type:"external"})}}):Object(f.__)("With WooCommerce Services and Jetpack you can save time at the Post Office by printing your shipping labels at home",'woocommerce'),content:Object(b.createElement)(R.Plugins,pe()({onComplete:function(){Object(q.b)("tasklist_shipping_label_printing",{install:!0,pluginsToActivate:c}),e.completeStep()},onSkip:function(){Object(q.b)("tasklist_shipping_label_printing",{install:!1,pluginsToActivate:c}),Object(T.getHistory)().push(Object(T.getNewPath)({},"/",{}))},pluginSlugs:c},this.props)),visible:c.length},{key:"connect",label:Object(f.__)("Connect your store",'woocommerce'),description:Object(f.__)("Connect your store to WordPress.com to enable label printing",'woocommerce'),content:Object(b.createElement)(be.a,pe()({redirectUrl:Object(A.f)("admin.php?page=wc-admin"),completeStep:this.completeStep},this.props,{onConnect:function(){Object(q.b)("tasklist_shipping_connect_store")}})),visible:r}];return Object(g.filter)(a,(function(e){return e.visible}))}},{key:"render",value:function(){var e=this.state,t=e.isPending,n=e.step,o=this.props.isSettingsRequesting;return Object(b.createElement)("div",{className:"woocommerce-task-shipping"},Object(b.createElement)(R.Card,{className:"is-narrow"},Object(b.createElement)(R.Stepper,{isPending:t||o,isVertical:!0,currentStep:n,steps:this.getSteps()})))}}]),o}(b.Component),Te=Object(_.a)(Object(E.withSelect)((function(e){var t=e(M.SETTINGS_STORE_NAME),n=t.getSettings,o=t.getSettingsError,c=t.isGetSettingsRequesting,r=e(M.PLUGINS_STORE_NAME),a=r.getActivePlugins,i=r.isJetpackConnected,s=n("general").general,l=void 0===s?{}:s,u=Boolean(o("general")),m=c("general"),p=Object(D.a)(l.woocommerce_default_country),d=Object(A.g)("dataEndpoints",{}).countries,h=p?(void 0===d?[]:d).find((function(e){return e.code===p})):null,b=h?h.name:null,f=a();return{countryCode:p,countryName:b,isSettingsError:u,isSettingsRequesting:m,settings:l,activePlugins:f,isJetpackConnected:i()}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateAndPersistSettingsForGroup:e(M.SETTINGS_STORE_NAME).updateAndPersistSettingsForGroup}})))(Re);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var De=function(e){u()(c,e);var t,n,o=Ae(c);function c(e){var t;return a()(this,c),(t=o.call(this,e)).initialState={isPending:!1,stepIndex:0,automatedTaxEnabled:!0,pluginsToActivate:e.pluginsToActivate},t.state=t.initialState,t.completeStep=t.completeStep.bind(W()(t)),t.configureTaxRates=t.configureTaxRates.bind(W()(t)),t.updateAutomatedTax=t.updateAutomatedTax.bind(W()(t)),t.setIsPending=t.setIsPending.bind(W()(t)),t.shouldShowSuccessScreen=t.shouldShowSuccessScreen.bind(W()(t)),t}return s()(c,[{key:"componentDidMount",value:function(){this.reset()}},{key:"reset",value:function(){this.setState(this.initialState)}},{key:"shouldShowSuccessScreen",value:function(){var e=this.state.stepIndex,t=this.props,n=t.isJetpackConnected,o=t.pluginsToActivate,c=t.generalSettings,r=c.woocommerce_store_address,a=c.woocommerce_default_country,i=c.woocommerce_store_postcode,s=Boolean(r&&a&&i);return null!==e&&s&&!o.length&&n&&this.isTaxJarSupported()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.generalSettings,o=t.isJetpackConnected,c=t.taxSettings,r=n.woocommerce_calc_taxes,a=n.woocommerce_store_address,i=n.woocommerce_default_country,s=n.woocommerce_store_postcode,l=this.state.stepIndex,u=this.getSteps()[l],m=u&&u.key;if(null!==l&&this.shouldShowSuccessScreen())this.setState({stepIndex:null});else{c.wc_connect_taxes_enabled&&c.wc_connect_taxes_enabled!==e.taxSettings.wc_connect_taxes_enabled&&this.setState({automatedTaxEnabled:"yes"===c.wc_connect_taxes_enabled}),"connect"===m&&o&&this.completeStep();var p=Boolean(a&&i&&s);"store_location"===m&&p&&this.completeStep(),"no"===e.generalSettings.woocommerce_calc_taxes&&"yes"===r&&(window.location=Object(A.f)("admin.php?page=wc-settings&tab=tax&section=standard"))}}},{key:"isTaxJarSupported",value:function(){var e=this.props,t=e.countryCode,n=e.tosAccepted,o=Object(A.g)("onboarding",{}),c=o.automatedTaxSupportedCountries,r=void 0===c?[]:c;return!o.taxJarActivated&&n&&r.includes(t)}},{key:"completeStep",value:function(){var e=this.state.stepIndex;this.getSteps()[e+1]?this.setState({stepIndex:e+1}):Object(T.getHistory)().push(Object(T.getNewPath)({},"/",{}))}},{key:"configureTaxRates",value:(n=J()(regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.generalSettings,o=t.updateAndPersistSettingsForGroup,"yes"===n.woocommerce_calc_taxes){e.next=5;break}return this.setState({isPending:!0}),e.next=5,o("general",{general:Ie(Ie({},n),{},{woocommerce_calc_taxes:"yes"})});case 5:window.location=Object(A.f)("admin.php?page=wc-settings&tab=tax&section=standard&wc_onboarding_active_task=tax");case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"updateAutomatedTax",value:(t=J()(regeneratorRuntime.mark((function e(){var t,n,o,c,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.createNotice,o=t.updateAndPersistSettingsForGroup,c=t.generalSettings,r=t.taxSettings,a=this.state.automatedTaxEnabled,e.next=4,o("tax",{tax:Ie(Ie({},r),{},{wc_connect_taxes_enabled:a?"yes":"no"})});case 4:return e.next=6,o("general",{general:Ie(Ie({},c),{},{woocommerce_calc_taxes:"yes"})});case 6:this.props.isTaxSettingsError||this.props.isGeneralSettingsError?n("error",Object(f.__)("There was a problem updating your tax settings.",'woocommerce')):(Object(A.h)("onboarding",Ie(Ie({},Object(A.g)("onboarding",{})),{},{isTaxComplete:!0})),n("success",Object(f.__)("You're awesome! One less item on your to-do list âœ…",'woocommerce')),a?Object(T.getHistory)().push(Object(T.getNewPath)({},"/",{})):this.configureTaxRates());case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setIsPending",value:function(e){this.setState({isPending:e})}},{key:"getSteps",value:function(){var e=this,t=this.props,n=t.generalSettings,o=t.isJetpackConnected,c=this.state,r=c.isPending,a=c.pluginsToActivate,i=[{key:"store_location",label:Object(f.__)("Set store location",'woocommerce'),description:Object(f.__)("The address from which your business operates",'woocommerce'),content:Object(b.createElement)(ye,pe()({},this.props,{onComplete:function(t){var n=Object(D.a)(t.countryState);Object(q.b)("tasklist_tax_set_location",{country:n}),e.shouldShowSuccessScreen()?e.setState({stepIndex:null}):null!==e.state.stepIndex&&e.completeStep()},isSettingsRequesting:!1,settings:n})),visible:!0},{key:"plugins",label:Object(f.__)("Install Jetpack and WooCommerce Services",'woocommerce'),description:Object(f.__)("Jetpack and WooCommerce Services allow you to automate sales tax calculations",'woocommerce'),content:Object(b.createElement)(R.Plugins,{onComplete:function(){Object(q.b)("tasklist_tax_install_extensions",{install_extensions:!0}),e.completeStep()},onSkip:function(){Object(q.a)("tasklist_tax_install_extensions",{install_extensions:!1}),window.location.href=Object(A.f)("admin.php?page=wc-settings&tab=tax&section=standard")},skipText:Object(f.__)("Set up tax rates manually",'woocommerce')}),visible:a.length&&this.isTaxJarSupported()},{key:"connect",label:Object(f.__)("Connect your store",'woocommerce'),description:Object(f.__)("Connect your store to WordPress.com to enable automated sales tax calculations",'woocommerce'),content:Object(b.createElement)(be.a,pe()({},this.props,{setIsPending:this.setIsPending,onConnect:function(){Object(q.b)("tasklist_tax_connect_store",{connect:!0})},onSkip:function(){Object(q.a)("tasklist_tax_connect_store",{connect:!1}),window.location.href=Object(A.f)("admin.php?page=wc-settings&tab=tax&section=standard")},skipText:Object(f.__)("Set up tax rates manually",'woocommerce')})),visible:!o&&this.isTaxJarSupported()},{key:"manual_configuration",label:Object(f.__)("Configure tax rates",'woocommerce'),description:Object(f.__)("Head over to the tax rate settings screen to configure your tax rates",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(b.createElement)(w.a,{isPrimary:!0,isBusy:r,onClick:function(){Object(q.b)("tasklist_tax_config_rates"),e.configureTaxRates()}},Object(f.__)("Configure",'woocommerce')),Object(b.createElement)("p",null,"yes"!==n.woocommerce_calc_taxes&&he()({mixedString:Object(f.__)('By clicking "Configure" you\'re enabling tax rates and calculations. More info {{link}}here{{/link}}.','woocommerce'),components:{link:Object(b.createElement)(R.Link,{href:"https://docs.woocommerce.com/document/setting-up-taxes-in-woocommerce/#section-1",target:"_blank",type:"external"})}}))),visible:!this.isTaxJarSupported()}];return Object(g.filter)(i,(function(e){return e.visible}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPending,o=t.stepIndex,c=this.props,r=c.isTaxSettingsRequesting,a=c.taxSettings,i=this.getSteps()[o];return Object(b.createElement)("div",{className:"woocommerce-task-tax"},Object(b.createElement)(R.Card,{className:"is-narrow"},i?Object(b.createElement)(R.Stepper,{isPending:n||r,isVertical:!0,currentStep:i.key,steps:this.getSteps()}):Object(b.createElement)("div",{className:"woocommerce-task-tax__success"},Object(b.createElement)("span",{className:"woocommerce-task-tax__success-icon",role:"img","aria-labelledby":"woocommerce-task-tax__success-message"},"ðŸŽŠ"),Object(b.createElement)(R.H,{id:"woocommerce-task-tax__success-message"},Object(f.__)("Good news!",'woocommerce')),Object(b.createElement)("p",null,he()({mixedString:Object(f.__)("{{strong}}Jetpack{{/strong}} and {{strong}}WooCommerce Services{{/strong}} can automate your sales tax calculations for you.",'woocommerce'),components:{strong:Object(b.createElement)("strong",null)}})),Object(b.createElement)(w.a,{isPrimary:!0,isBusy:Object.keys(a).length&&r,onClick:function(){Object(q.b)("tasklist_tax_setup_automated_proceed",{setup_automatically:!0}),e.setState({automatedTaxEnabled:!0},e.updateAutomatedTax)}},Object(f.__)("Yes please",'woocommerce')),Object(b.createElement)(w.a,{onClick:function(){Object(q.b)("tasklist_tax_setup_automated_proceed",{setup_automatically:!1}),e.setState({automatedTaxEnabled:!1},e.updateAutomatedTax)}},Object(f.__)("No thanks, I'll configure taxes manually",'woocommerce')))))}}]),c}(b.Component),Le=Object(_.a)(Object(E.withSelect)((function(e){var t=e(M.SETTINGS_STORE_NAME),n=t.getSettings,o=t.getSettingsError,c=t.isGetSettingsRequesting,r=e(M.OPTIONS_STORE_NAME).getOption,a=e(M.PLUGINS_STORE_NAME),i=a.getActivePlugins,s=a.isJetpackConnected,l=n("general").general,u=void 0===l?{}:l,m=Boolean(o("general")),p=Object(D.a)(u.woocommerce_default_country),d=n("tax").tax,h=void 0===d?{}:d,b=Boolean(o("tax")),f=c("tax"),_=i(),O=Object(g.difference)(["jetpack","woocommerce-services"],_),y=(r("wc_connect_options")||{}).tos_accepted||r("woocommerce_setup_jetpack_opted_in");return{isGeneralSettingsError:m,generalSettings:u,countryCode:p,taxSettings:h,isTaxSettingsError:b,isTaxSettingsRequesting:f,isJetpackConnected:s(),pluginsToActivate:O,tosAccepted:y}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateAndPersistSettingsForGroup:e(M.SETTINGS_STORE_NAME).updateAndPersistSettingsForGroup}})))(De);function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var Ue=function(e){u()(n,e);var t=qe(n);function n(){var e,o;a()(this,n);for(var c=arguments.length,r=new Array(c),i=0;i<c;i++)r[i]=arguments[i];return p()(o,(e=o=t.call.apply(t,[this].concat(r)),o.getInitialConfigValues=function(){return{account_name:"",account_number:"",bank_name:"",sort_code:"",iban:"",bic:""}},o.validate=function(e){var t={};return e.account_number||e.iban||(t.account_number=t.iban=Object(f.__)("Please enter an account number or IBAN",'woocommerce')),t},o.updateSettings=function(){var e=J()(regeneratorRuntime.mark((function e(t){var n,c,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.props,c=n.updateOptions,r=n.createNotice,a=n.markConfigured,e.next=3,c({woocommerce_bacs_settings:{enabled:"yes"},woocommerce_bacs_accounts:[t]});case 3:e.sent.success?(a("bacs"),r("success",Object(f.__)("Direct bank transfer details added successfully",'woocommerce'))):r("error",Object(f.__)("There was a problem saving your payment setings",'woocommerce'));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e))}return s()(n,[{key:"render",value:function(){var e=this.props.isOptionsRequesting;return Object(b.createElement)(R.Form,{initialValues:this.getInitialConfigValues(),onSubmitCallback:this.updateSettings,validate:this.validate},(function(t){var n=t.getInputProps,o=t.handleSubmit;return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(R.H,null,Object(f.__)("Add your bank details",'woocommerce')),Object(b.createElement)("p",null,Object(f.__)("These details are required to receive payments via bank transfer",'woocommerce')),Object(b.createElement)("div",{className:"woocommerce-task-payment-method__fields"},Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Account name",'woocommerce'),required:!0},n("account_name"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Account number",'woocommerce'),required:!0},n("account_number"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Bank name",'woocommerce'),required:!0},n("bank_name"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Sort code",'woocommerce'),required:!0},n("sort_code"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("IBAN",'woocommerce'),required:!0},n("iban"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("BIC / Swift",'woocommerce'),required:!0},n("bic")))),Object(b.createElement)(w.a,{isPrimary:!0,isBusy:e,onClick:o},Object(f.__)("Save",'woocommerce')))}))}}]),n}(b.Component),Fe=Object(_.a)(Object(E.withSelect)((function(e){return{isOptionsRequesting:(0,e(M.OPTIONS_STORE_NAME).isOptionsUpdating)()}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})))(Ue),Ve=function(){return Object(b.createElement)("svg",{width:"96",height:"32",viewBox:"0 0 96 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(b.createElement)("rect",{width:"32",height:"32",rx:"16",fill:"#8E9196"}),Object(b.createElement)("mask",{id:"bacs0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"8",y:"8",width:"16",height:"16"},Object(b.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.875 12.25L16 8.5L23.125 12.25V13.75H8.875V12.25ZM16 10.195L19.9075 12.25H12.0925L16 10.195ZM10.75 15.25H12.25V20.5H10.75V15.25ZM15.25 20.5V15.25H16.75V20.5H15.25ZM23.125 23.5V22H8.875V23.5H23.125ZM19.75 15.25H21.25V20.5H19.75V15.25Z",fill:"white"})),Object(b.createElement)("g",{mask:"url(#bacs0)"},Object(b.createElement)("rect",{x:"7",y:"7",width:"18",height:"18",fill:"white"})),Object(b.createElement)("mask",{id:"bacs1","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"39",y:"10",width:"18",height:"12"},Object(b.createElement)("path",{d:"M39 17L53.17 17L49.59 20.59L51 22L57 16L51 10L49.59 11.41L53.17 15L39 15L39 17Z",fill:"white"})),Object(b.createElement)("g",{mask:"url(#bacs1)"},Object(b.createElement)("rect",{x:"60",y:"28",width:"24",height:"24",transform:"rotate(-180 60 28)",fill:"#8E9196"})),Object(b.createElement)("rect",{x:"64",width:"32",height:"32",rx:"16",fill:"#8E9196"}),Object(b.createElement)("mask",{id:"bacs2","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"72",y:"8",width:"16",height:"16"},Object(b.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M72.875 12.25L80 8.5L87.125 12.25V13.75H72.875V12.25ZM80 10.195L83.9075 12.25H76.0925L80 10.195ZM74.75 15.25H76.25V20.5H74.75V15.25ZM79.25 20.5V15.25H80.75V20.5H79.25ZM87.125 23.5V22H72.875V23.5H87.125ZM83.75 15.25H85.25V20.5H83.75V15.25Z",fill:"white"})),Object(b.createElement)("g",{mask:"url(#bacs2)"},Object(b.createElement)("rect",{x:"71",y:"7",width:"18",height:"18",fill:"white"})))},Be=function(){return Object(b.createElement)("svg",{width:"96",height:"32",viewBox:"0 0 96 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(b.createElement)("rect",{width:"32",height:"32",rx:"16",fill:"#8E9196"}),Object(b.createElement)("mask",{id:"cod-mask-0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"7",y:"10",width:"18",height:"12"},Object(b.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 13H19.75V10H9.25C8.425 10 7.75 10.675 7.75 11.5V19.75H9.25C9.25 20.995 10.255 22 11.5 22C12.745 22 13.75 20.995 13.75 19.75H18.25C18.25 20.995 19.255 22 20.5 22C21.745 22 22.75 20.995 22.75 19.75H24.25V16L22 13ZM21.625 14.125L23.095 16H19.75V14.125H21.625ZM10.75 19.75C10.75 20.1625 11.0875 20.5 11.5 20.5C11.9125 20.5 12.25 20.1625 12.25 19.75C12.25 19.3375 11.9125 19 11.5 19C11.0875 19 10.75 19.3375 10.75 19.75ZM13.165 18.25C12.7525 17.7925 12.1675 17.5 11.5 17.5C10.8325 17.5 10.2475 17.7925 9.835 18.25H9.25V11.5H18.25V18.25H13.165ZM19.75 19.75C19.75 20.1625 20.0875 20.5 20.5 20.5C20.9125 20.5 21.25 20.1625 21.25 19.75C21.25 19.3375 20.9125 19 20.5 19C20.0875 19 19.75 19.3375 19.75 19.75Z",fill:"white"})),Object(b.createElement)("g",{mask:"url(#cod-mask-0)"},Object(b.createElement)("rect",{x:"7",y:"7",width:"18",height:"18",fill:"white"})),Object(b.createElement)("mask",{id:"cod-mask-1","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"39",y:"10",width:"18",height:"12"},Object(b.createElement)("path",{d:"M39 17L53.17 17L49.59 20.59L51 22L57 16L51 10L49.59 11.41L53.17 15L39 15L39 17Z",fill:"white"})),Object(b.createElement)("g",{mask:"url(#cod-mask-1)"},Object(b.createElement)("rect",{x:"60",y:"28",width:"24",height:"24",transform:"rotate(-180 60 28)",fill:"#8E9196"})),Object(b.createElement)("rect",{x:"64",width:"32",height:"32",rx:"16",fill:"#8E9196"}),Object(b.createElement)("mask",{id:"cod-mask-2","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"76",y:"9",width:"8",height:"14"},Object(b.createElement)("path",{d:"M80.2926 15.175C78.5901 14.7325 78.0426 14.275 78.0426 13.5625C78.0426 12.745 78.8001 12.175 80.0676 12.175C81.4026 12.175 81.8976 12.8125 81.9426 13.75H83.6001C83.5476 12.46 82.7601 11.275 81.1926 10.8925V9.25H78.9426V10.87C77.4876 11.185 76.3176 12.13 76.3176 13.5775C76.3176 15.31 77.7501 16.1725 79.8426 16.675C81.7176 17.125 82.0926 17.785 82.0926 18.4825C82.0926 19 81.7251 19.825 80.0676 19.825C78.5226 19.825 77.9151 19.135 77.8326 18.25H76.1826C76.2726 19.8925 77.5026 20.815 78.9426 21.1225V22.75H81.1926V21.1375C82.6551 20.86 83.8176 20.0125 83.8176 18.475C83.8176 16.345 81.9951 15.6175 80.2926 15.175Z",fill:"white"})),Object(b.createElement)("g",{mask:"url(#cod-mask-2)"},Object(b.createElement)("rect",{x:"71",y:"7",width:"18",height:"18",fill:"white"})))},He=n(202);function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var We=function(e){u()(c,e);var t,n,o=Ge(c);function c(e){var t;return a()(this,c),(t=o.call(this,e)).state={oAuthConnectFailed:!1,connectURL:null,isPending:!1},t.updateSettings=t.updateSettings.bind(W()(t)),t}return s()(c,[{key:"componentDidMount",value:function(){var e=this.props.stripeSettings,t=Object(T.getQuery)();if(t["stripe-connect"]&&"1"===t["stripe-connect"]&&(e.publishable_key&&e.secret_key))return void this.completeMethod();this.requiresManualConfig()||this.fetchOAuthConnectURL()}},{key:"componentDidUpdate",value:function(e){var t=this.props.activePlugins;!e.activePlugins.includes("woocommerce-gateway-stripe")&&t.includes("woocommerce-gateway-stripe")&&this.fetchOAuthConnectURL()}},{key:"requiresManualConfig",value:function(){var e=this.props,t=e.activePlugins,n=e.isJetpackConnected,o=this.state.oAuthConnectFailed;return!n||!t.includes("woocommerce-services")||o}},{key:"completeMethod",value:function(){var e=this.props,t=e.createNotice,n=e.markConfigured;this.setState({isPending:!1}),t("success",Object(f.__)("Stripe connected successfully.",'woocommerce')),n("stripe")}},{key:"fetchOAuthConnectURL",value:(n=J()(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.activePlugins.includes("woocommerce-gateway-stripe")){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,this.setState({isPending:!0}),e.next=7,K()({path:Y.e+"/connect/stripe/oauth/init",method:"POST",data:{returnUrl:Object(A.f)("admin.php?page=wc-admin&task=payments&method=stripe&stripe-connect=1")}});case 7:if((t=e.sent)&&t.oauthUrl){e.next=11;break}return this.setState({oAuthConnectFailed:!0,isPending:!1}),e.abrupt("return");case 11:this.setState({connectURL:t.oauthUrl,isPending:!1}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),this.setState({oAuthConnectFailed:!0,isPending:!1});case 17:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(){return n.apply(this,arguments)})},{key:"renderConnectButton",value:function(){var e=this.state.connectURL;return Object(b.createElement)(w.a,{isPrimary:!0,href:e},Object(f.__)("Connect",'woocommerce'))}},{key:"updateSettings",value:(t=J()(regeneratorRuntime.mark((function e(t){var n,o,c,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,o=n.updateOptions,c=n.stripeSettings,r=n.createNotice,e.next=3,o({woocommerce_stripe_settings:Je(Je({},c),{},{publishable_key:t.publishable_key,secret_key:t.secret_key,enabled:"yes"})});case 3:e.sent.success?this.completeMethod():r("error",Object(f.__)("There was a problem saving your payment setings",'woocommerce'));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getInitialConfigValues",value:function(){return{publishable_key:"",secret_key:""}}},{key:"validateManualConfig",value:function(e){var t={};return null===e.publishable_key.match(/^pk_live_/)&&(t.publishable_key=Object(f.__)('Please enter a valid publishable key. Valid keys start with "pk_live".','woocommerce')),null===e.secret_key.match(/^[rs]k_live_/)&&(t.secret_key=Object(f.__)('Please enter a valid secret key. Valid keys start with "sk_live" or "rk_live".','woocommerce')),t}},{key:"renderManualConfig",value:function(){var e=this.props.isOptionsUpdating,t=he()({mixedString:Object(f.__)("Your API details can be obtained from your {{docsLink}}Stripe account{{/docsLink}}.  Donâ€™t have a Stripe account? {{registerLink}}Create one.{{/registerLink}}",'woocommerce'),components:{docsLink:Object(b.createElement)(R.Link,{href:"https://stripe.com/docs/keys",target:"_blank",type:"external"}),registerLink:Object(b.createElement)(R.Link,{href:"https://dashboard.stripe.com/register",target:"_blank",type:"external"})}});return Object(b.createElement)(R.Form,{initialValues:this.getInitialConfigValues(),onSubmitCallback:this.updateSettings,validate:this.validateManualConfig},(function(n){var o=n.getInputProps,c=n.handleSubmit;return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Live Publishable Key",'woocommerce'),required:!0},o("publishable_key"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Live Secret Key",'woocommerce'),required:!0},o("secret_key"))),Object(b.createElement)(w.a,{isPrimary:!0,isBusy:e,onClick:c},Object(f.__)("Proceed",'woocommerce')),Object(b.createElement)("p",null,t))}))}},{key:"getConnectStep",value:function(){var e=this.state,t=e.connectURL,n=e.isPending,o=e.oAuthConnectFailed,c={key:"connect",label:Object(f.__)("Connect your Stripe account",'woocommerce')};return n?c:Je(Je({},c),{},!o&&t?{description:Object(f.__)("A Stripe account is required to process payments.",'woocommerce'),content:this.renderConnectButton()}:{description:Object(f.__)("Connect your store to your Stripe account. Donâ€™t have a Stripe account? Create one.",'woocommerce'),content:this.renderManualConfig()})}},{key:"render",value:function(){var e=this.props,t=e.installStep,n=e.isOptionsUpdating,o=this.state.isPending;return Object(b.createElement)(R.Stepper,{isVertical:!0,isPending:!t.isComplete||n||o,currentStep:t.isComplete?"connect":"install",steps:[t,this.getConnectStep()]})}}]),c}(b.Component),ze=Object(_.a)(Object(E.withSelect)((function(e){var t=e(M.OPTIONS_STORE_NAME),n=t.getOption,o=t.isOptionsUpdating,c=e(M.PLUGINS_STORE_NAME),r=c.getActivePlugins,a=c.isJetpackConnected;return{activePlugins:r(),isJetpackConnected:a(),isOptionsUpdating:o(),stripeSettings:n("woocommerce_stripe_settings")||[]}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})))(We);function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var $e=function(e){u()(o,e);var t,n=Qe(o);function o(e){var t;return a()(this,o),(t=n.call(this,e)).state={isPending:!1},t.connect=t.connect.bind(W()(t)),t}return s()(o,[{key:"componentDidMount",value:function(){var e=this.props,t=e.createNotice,n=e.markConfigured,o=Object(T.getQuery)();o["square-connect"]&&"1"===o["square-connect"]&&(t("success",Object(f.__)("Square connected successfully.",'woocommerce')),n("square"))}},{key:"connect",value:(t=J()(regeneratorRuntime.mark((function e(){var t,n,o,c,r,a,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.createNotice,o=t.hasCbdIndustry,c=t.options,r=t.updateOptions,this.setState({isPending:!0}),r({woocommerce_square_credit_card_settings:Ye(Ye({},c.woocommerce_square_credit_card_settings),{},{enabled:"yes"})}),a=Object(f.__)("There was an error connecting to Square. Please try again or skip to connect later in store settings.",'woocommerce'),e.prev=4,i=null,o&&(i=window.open("/","_blank")),e.next=9,K()({path:Y.f+"/plugins/connect-square",method:"POST"});case 9:if((s=e.sent)&&s.connectUrl){e.next=15;break}return this.setState({isPending:!1}),n("error",a),o&&i.close(),e.abrupt("return");case 15:this.setState({isPending:!0}),this.redirect(s.connectUrl,i),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(4),this.setState({isPending:!1}),n("error",a);case 23:case"end":return e.stop()}}),e,this,[[4,19]])}))),function(){return t.apply(this,arguments)})},{key:"redirect",value:function(e,t){t?(t.location.href=e,window.location=Object(A.f)("admin.php?page=wc-admin")):window.location=e}},{key:"render",value:function(){var e=this.props.installStep,t=this.state.isPending;return Object(b.createElement)(R.Stepper,{isVertical:!0,isPending:!e.isComplete||t,currentStep:e.isComplete?"connect":"install",steps:[e,{key:"connect",label:Object(f.__)("Connect your Square account",'woocommerce'),description:Object(f.__)("A Square account is required to process payments. You will be redirected to the Square website to create the connection.",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(b.createElement)(w.a,{isPrimary:!0,isBusy:t,onClick:this.connect},Object(f.__)("Connect",'woocommerce')))}]})}}]),o}(b.Component),Xe=Object(_.a)(Object(E.withSelect)((function(e){var t=e(M.OPTIONS_STORE_NAME),n=t.getOption,o=t.isResolving;return{options:n("woocommerce_square_credit_card_settings"),optionsIsRequesting:o("getOption",["woocommerce_square_credit_card_settings"])}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})))($e);function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var tt=function(e){u()(n,e);var t=et(n);function n(){return a()(this,n),t.apply(this,arguments)}return s()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.createNotice,n=e.markConfigured;Object(T.getQuery)()["wcpay-connection-success"]&&(t("success",Object(f.__)("WooCommerce Payments connected successfully.",'woocommerce')),n("wcpay"))}},{key:"render",value:function(){return null}}]),n}(b.Component),nt=Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice}}))(tt),ot=function(){return Object(b.createElement)("svg",{width:"100",height:"64",viewBox:"-10 0 120 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(b.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.78073 0.5H91.1787C96.3299 0.5 100.5 4.77335 100.5 10.0522V41.8929C100.5 47.1717 96.3299 51.4451 91.1787 51.4451H61.9883L65.9948 61.5L48.3742 51.4451H9.82161C4.67036 51.4451 0.500298 47.1717 0.500298 41.8929V10.0522C0.459415 4.81524 4.62947 0.5 9.78073 0.5Z",fill:"#7F54B3"}),Object(b.createElement)("path",{d:"M5.48791 9.1725C6.06028 8.37648 6.91882 7.95752 8.06354 7.87373C10.1486 7.70615 11.3342 8.71165 11.6204 10.8902C12.8877 19.6464 14.2778 27.0619 15.7495 33.1368L24.7029 15.6663C25.5206 14.0743 26.5426 13.2364 27.7691 13.1526C29.568 13.0269 30.6718 14.2 31.1215 16.6718C32.1436 22.2439 33.4519 26.9781 35.0054 31.0001C36.0684 20.3586 37.8672 12.6917 40.402 7.95753C41.0152 6.78445 41.9146 6.19791 43.1002 6.11412C44.0405 6.03033 44.8991 6.3236 45.6759 6.95203C46.4526 7.58047 46.8615 8.37648 46.9432 9.34008C46.9841 10.0942 46.8615 10.7226 46.5344 11.3511C44.94 14.3676 43.6317 19.4369 42.5688 26.4754C41.5467 33.3044 41.1787 38.6251 41.424 42.4376C41.5058 43.485 41.3423 44.4067 40.9334 45.2027C40.4428 46.1244 39.707 46.6272 38.7666 46.711C37.7037 46.7948 36.5998 46.292 35.5369 45.1608C31.7348 41.1807 28.7094 35.2316 26.5018 27.3133C23.8444 32.6759 21.882 36.6979 20.6146 39.3792C18.2025 44.1134 16.1584 46.5434 14.4413 46.6691C13.3374 46.7529 12.3971 45.7893 11.5795 43.7783C9.49445 38.2899 7.24589 27.6904 4.83379 11.9795C4.71114 10.8902 4.91555 9.92662 5.48791 9.1725Z",fill:"white"}),Object(b.createElement)("path",{d:"M93.3864 15.7499C91.9146 13.1105 89.7478 11.5185 86.8451 10.89C86.0683 10.7225 85.3324 10.6387 84.6374 10.6387C80.7127 10.6387 77.5238 12.7335 75.0299 16.923C72.904 20.4841 71.8411 24.4223 71.8411 28.7376C71.8411 31.9635 72.4952 34.7286 73.8034 37.0329C75.2752 39.6723 77.442 41.2644 80.3447 41.8928C81.1215 42.0604 81.8574 42.1442 82.5524 42.1442C86.518 42.1442 89.7069 40.0494 92.1599 35.8598C94.2858 32.2568 95.3488 28.3186 95.3488 24.0034C95.3488 20.7355 94.6946 18.0123 93.3864 15.7499ZM88.2351 27.355C87.6628 30.1201 86.6407 32.173 85.128 33.5556C83.9424 34.6449 82.8386 35.1057 81.8165 34.8962C80.8353 34.6868 80.0177 33.8069 79.4044 32.173C78.9138 30.8742 78.6685 29.5755 78.6685 28.3605C78.6685 27.3131 78.7503 26.2657 78.9547 25.3021C79.3226 23.5844 80.0177 21.9086 81.1215 20.3166C82.4706 18.2637 83.9015 17.4258 85.3733 17.719C86.3545 17.9285 87.1722 18.8083 87.7854 20.4422C88.276 21.741 88.5213 23.0398 88.5213 24.2547C88.5213 25.344 88.3987 26.3914 88.2351 27.355Z",fill:"white"}),Object(b.createElement)("path",{d:"M67.7528 15.7499C66.281 13.1105 64.0734 11.5185 61.2116 10.89C60.4348 10.7225 59.6989 10.6387 59.0039 10.6387C55.0791 10.6387 51.8903 12.7335 49.3964 16.923C47.2705 20.4841 46.2075 24.4223 46.2075 28.7376C46.2075 31.9635 46.8616 34.7286 48.1699 37.0329C49.6417 39.6723 51.8085 41.2644 54.7112 41.8928C55.488 42.0604 56.2238 42.1442 56.9189 42.1442C60.8845 42.1442 64.0734 40.0494 66.5263 35.8598C68.6523 32.2568 69.7152 28.3186 69.7152 24.0034C69.7152 20.7355 69.0611 18.0123 67.7528 15.7499ZM62.6016 27.355C62.0292 30.1201 61.0071 32.173 59.4945 33.5556C58.3089 34.6449 57.205 35.1057 56.183 34.8962C55.2018 34.6868 54.3841 33.8069 53.7709 32.173C53.2803 30.8742 53.035 29.5755 53.035 28.3605C53.035 27.3131 53.1167 26.2657 53.3212 25.3021C53.6891 23.5844 54.3841 21.9086 55.4879 20.3166C56.8371 18.2637 58.268 17.4258 59.7398 17.719C60.721 17.9285 61.5386 18.8083 62.1519 20.4422C62.6425 21.741 62.8878 23.0398 62.8878 24.2547C62.8878 25.344 62.806 26.3914 62.6016 27.355Z",fill:"white"}))};function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var it=function(e){u()(c,e);var t,n,o=at(c);function c(e){var t;return a()(this,c),(t=o.call(this,e)).state={autoConnectFailed:!1,connectURL:"",isPending:!1},t.updateSettings=t.updateSettings.bind(W()(t)),t}return s()(c,[{key:"componentDidMount",value:function(){var e=this.props,t=e.createNotice,n=e.markConfigured,o=Object(T.getQuery)();if(o["paypal-connect"])return"1"===o["paypal-connect"]?(t("success",Object(f.__)("PayPal connected successfully.",'woocommerce')),void n("paypal")):void this.setState({autoConnectFailed:!0});this.fetchOAuthConnectURL()}},{key:"componentDidUpdate",value:function(e){var t=this.props.activePlugins;!e.activePlugins.includes("woocommerce-gateway-paypal-express-checkout")&&t.includes("woocommerce-gateway-paypal-express-checkout")&&this.fetchOAuthConnectURL()}},{key:"fetchOAuthConnectURL",value:(n=J()(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.activePlugins.includes("woocommerce-gateway-paypal-express-checkout")){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isPending:!0}),e.prev=4,e.next=7,K()({path:Y.f+"/plugins/connect-paypal",method:"POST"});case 7:if((t=e.sent)&&t.connectUrl){e.next=11;break}return this.setState({autoConnectFailed:!0}),e.abrupt("return");case 11:this.setState({connectURL:t.connectUrl,isPending:!1}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),this.setState({autoConnectFailed:!0,isPending:!1});case 17:case"end":return e.stop()}}),e,this,[[4,14]])}))),function(){return n.apply(this,arguments)})},{key:"renderConnectButton",value:function(){var e=this.state.connectURL;return Object(b.createElement)(w.a,{isPrimary:!0,href:e},Object(f.__)("Connect",'woocommerce'))}},{key:"updateSettings",value:(t=J()(regeneratorRuntime.mark((function e(t){var n,o,c,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,o=n.createNotice,c=n.options,r=n.updateOptions,a=n.markConfigured,e.next=3,r({woocommerce_ppec_paypal_settings:rt(rt({},c.woocommerce_ppec_paypal_settings),{},{api_username:t.api_username,api_password:t.api_password,enabled:"yes"})});case 3:e.sent.success?(o("success",Object(f.__)("PayPal connected successfully.",'woocommerce')),a("paypal")):o("error",Object(f.__)("There was a problem saving your payment settings.",'woocommerce'));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getInitialConfigValues",value:function(){return{api_username:"",api_password:""}}},{key:"validate",value:function(e){var t={};return e.api_username||(t.api_username=Object(f.__)("Please enter your API username",'woocommerce')),e.api_password||(t.api_password=Object(f.__)("Please enter your API password",'woocommerce')),t}},{key:"renderManualConfig",value:function(){var e=this.props.isOptionsUpdating,t=Object(b.createElement)(R.Link,{href:"https://docs.woocommerce.com/document/paypal-express-checkout/#section-8",target:"_blank",type:"external"}),n=he()({mixedString:Object(f.__)("Your API details can be obtained from your {{link}}PayPal account{{/link}}",'woocommerce'),components:{link:t}});return Object(b.createElement)(R.Form,{initialValues:this.getInitialConfigValues(),onSubmitCallback:this.updateSettings,validate:this.validate},(function(t){var o=t.getInputProps,c=t.handleSubmit;return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("API Username",'woocommerce'),required:!0},o("api_username"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("API Password",'woocommerce'),required:!0},o("api_password"))),Object(b.createElement)(w.a,{onClick:c,isPrimary:!0,isBusy:e},Object(f.__)("Proceed",'woocommerce')),Object(b.createElement)("p",null,n))}))}},{key:"getConnectStep",value:function(){var e=this.state,t=e.autoConnectFailed,n=e.connectURL,o=e.isPending,c={key:"connect",label:Object(f.__)("Connect your PayPal account",'woocommerce')};return o?c:rt(rt({},c),{},!t&&n?{description:Object(f.__)("A Paypal account is required to process payments. You will be redirected to the Paypal website to create the connection.",'woocommerce'),content:this.renderConnectButton()}:{description:Object(f.__)("Connect your store to your PayPal account. Donâ€™t have a PayPal account? Create one.",'woocommerce'),content:this.renderManualConfig()})}},{key:"render",value:function(){var e=this.props.installStep,t=this.state.isPending;return Object(b.createElement)(R.Stepper,{isVertical:!0,isPending:!e.isComplete||t,currentStep:e.isComplete?"connect":"install",steps:[e,this.getConnectStep()]})}}]),c}(b.Component);it.defaultProps={manualConfig:!1};var st=Object(_.a)(Object(E.withSelect)((function(e){var t=e(M.OPTIONS_STORE_NAME),n=t.getOption,o=t.isOptionsUpdating,c=e(M.PLUGINS_STORE_NAME).getActivePlugins,r=n("woocommerce_ppec_paypal_settings");return{activePlugins:c(),options:r,isOptionsUpdating:o()}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})))(it);function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var ut=function(e){u()(n,e);var t=lt(n);function n(e){var o;return a()(this,n),(o=t.call(this,e)).continue=o.continue.bind(W()(o)),o}return s()(n,[{key:"continue",value:function(){var e=this.props;(0,e.markConfigured)("checkout"===e.plugin?"klarna-checkout":"klarna-payments")}},{key:"renderConnectStep",value:function(){var e=this.props.plugin,t="checkout"===e?"klarna-checkout":"klarna-payments",n="checkout"===e?"kco":"klarna_payments",o=Object(b.createElement)(R.Link,{href:A.a+"admin.php?page=wc-settings&tab=checkout&section="+n,target:"_blank",type:"external"}),c=Object(b.createElement)(R.Link,{href:"https://docs.woocommerce.com/document/"+t+"/#section-3",target:"_blank",type:"external"}),r=he()({mixedString:Object(f.__)("Klarna can be configured under your {{link}}store settings{{/link}}. Figure out {{helpLink}}what you need{{/helpLink}}.",'woocommerce'),components:{link:o,helpLink:c}});return Object(b.createElement)(b.Fragment,null,Object(b.createElement)("p",null,r),Object(b.createElement)(w.a,{isPrimary:!0,onClick:this.continue},Object(f.__)("Continue",'woocommerce')))}},{key:"render",value:function(){var e=this.props.installStep;return Object(b.createElement)(R.Stepper,{isVertical:!0,isPending:!e.isComplete,currentStep:e.isComplete?"connect":"install",steps:[e,{key:"connect",label:Object(f.__)("Connect your Klarna account",'woocommerce'),content:this.renderConnectStep()}]})}}]),n}(b.Component);function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var pt=function(e){u()(n,e);var t=mt(n);function n(){var e,o;a()(this,n);for(var c=arguments.length,r=new Array(c),i=0;i<c;i++)r[i]=arguments[i];return p()(o,(e=o=t.call.apply(t,[this].concat(r)),o.getInitialConfigValues=function(){return{merchant_id:"",merchant_key:"",pass_phrase:""}},o.validate=function(e){var t={};return e.merchant_id||(t.merchant_id=Object(f.__)("Please enter your merchant ID",'woocommerce')),e.merchant_key||(t.merchant_key=Object(f.__)("Please enter your merchant key",'woocommerce')),e.pass_phrase||(t.pass_phrase=Object(f.__)("Please enter your passphrase",'woocommerce')),t},o.updateSettings=function(){var e=J()(regeneratorRuntime.mark((function e(t){var n,c,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.props,c=n.updateOptions,r=n.createNotice,a=n.markConfigured,e.next=3,c({woocommerce_currency:"ZAR",woocommerce_payfast_settings:{merchant_id:t.merchant_id,merchant_key:t.merchant_key,pass_phrase:t.pass_phrase,enabled:"yes"}});case 3:e.sent.success?(a("payfast"),r("success",Object(f.__)("PayFast connected successfully",'woocommerce'))):r("error",Object(f.__)("There was a problem saving your payment setings",'woocommerce'));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e))}return s()(n,[{key:"renderConnectStep",value:function(){var e=this.props.isOptionsRequesting,t=he()({mixedString:Object(f.__)("Your API details can be obtained from your {{link}}PayFast account{{/link}}",'woocommerce'),components:{link:Object(b.createElement)(R.Link,{href:"https://www.payfast.co.za/",target:"_blank",type:"external"})}});return Object(b.createElement)(R.Form,{initialValues:this.getInitialConfigValues(),onSubmitCallback:this.updateSettings,validate:this.validate},(function(n){var o=n.getInputProps,c=n.handleSubmit;return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Merchant ID",'woocommerce'),required:!0},o("merchant_id"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Merchant Key",'woocommerce'),required:!0},o("merchant_key"))),Object(b.createElement)(R.TextControl,pe()({label:Object(f.__)("Passphrase",'woocommerce'),required:!0},o("pass_phrase"))),Object(b.createElement)(w.a,{isPrimary:!0,isBusy:e,onClick:c},Object(f.__)("Proceed",'woocommerce')),Object(b.createElement)("p",null,t))}))}},{key:"render",value:function(){var e=this.props,t=e.installStep,n=e.isOptionsRequesting;return Object(b.createElement)(R.Stepper,{isVertical:!0,isPending:!t.isComplete||n,currentStep:t.isComplete?"connect":"install",steps:[t,{key:"connect",label:Object(f.__)("Connect your PayFast account",'woocommerce'),content:this.renderConnectStep()}]})}}]),n}(b.Component),dt=Object(_.a)(Object(E.withSelect)((function(e){return{isOptionsRequesting:(0,e(M.OPTIONS_STORE_NAME).isOptionsUpdating)()}})),Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})))(pt);function ht(e){var t=e.activePlugins,n=e.countryCode,o=e.createNotice,c=e.installAndActivatePlugins,r=e.options,a=e.profileItems,i=Object(A.g)("onboarding",{stripeSupportedCountries:[],wcPayIsConnected:!1}),s=i.stripeSupportedCountries,l=i.wcPayIsConnected,u=Object(g.some)(a.industry,{slug:"cbd-other-hemp-derived-products"})||!1,m=[];if(window.wcAdminFeatures.wcpay){var p=Object(b.createElement)(R.Link,{href:"https://wordpress.com/tos/",target:"_blank",type:"external"}),d=he()({mixedString:Object(f.__)('By clicking "Set up," you agree to the {{link}}Terms of Service{{/link}}','woocommerce'),components:{link:p}}),h=Object(b.createElement)(R.Link,{href:"https://docs.woocommerce.com/document/payments/testing/dev-mode/",target:"_blank",type:"external"}),_=he()({mixedString:Object(f.__)("Setting up a store for a client? {{link}}Start here{{/link}}",'woocommerce'),components:{link:h}}),O=Object(b.createElement)(R.Link,{href:Object(A.f)("admin.php?page=wc-settings&tab=checkout&section=woocommerce_payments"),type:"wp-admin"},Object(f.__)("Settings",'woocommerce'));m.push({key:"wcpay",title:Object(f.__)("WooCommerce Payments",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(f.__)("Accept credit card payments the easy way! No setup fees. No monthly fees. Just 2.9% + $0.30 per transaction on U.S. issued cards. ",'woocommerce'),l&&O,!l&&Object(b.createElement)("p",null,d),a.setup_client&&Object(b.createElement)("p",null,_)),before:Object(b.createElement)(ot,null),onClick:function(e,t){var n=Object(f.__)("There was an error connecting to WooCommerce Payments. Please try again or connect later in store settings.",'woocommerce');c(["woocommerce-payments"]).then((function(){K()({path:Y.f+"/plugins/connect-wcpay",method:"POST"}).then((function(e){window.location=e.connectUrl})).catch((function(){o("error",n),t()}))})).catch((function(e){Object(He.a)(e),t()}))},visible:["US","PR"].includes(n)&&!u,plugins:["woocommerce-payments"],container:Object(b.createElement)(nt,null),isConfigured:l,isEnabled:r.woocommerce_woocommerce_payments_settings&&"yes"===r.woocommerce_woocommerce_payments_settings.enabled,optionName:"woocommerce_woocommerce_payments_settings"})}return m.push({key:"stripe",title:Object(f.__)("Credit cards - powered by Stripe",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(f.__)("Accept debit and credit cards in 135+ currencies, methods such as Alipay, and one-touch checkout with Apple Pay.",'woocommerce')),before:Object(b.createElement)("img",{src:A.e+"images/stripe.png",alt:""}),visible:s.includes(n)&&!u,plugins:["woocommerce-gateway-stripe"],container:Object(b.createElement)(ze,null),isConfigured:r.woocommerce_stripe_settings&&r.woocommerce_stripe_settings.publishable_key&&r.woocommerce_stripe_settings.secret_key,isEnabled:r.woocommerce_stripe_settings&&"yes"===r.woocommerce_stripe_settings.enabled,optionName:"woocommerce_stripe_settings"},{key:"paypal",title:Object(f.__)("PayPal Checkout",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(f.__)("Safe and secure payments using credit cards or your customer's PayPal account.",'woocommerce')),before:Object(b.createElement)("img",{src:A.e+"images/paypal.png",alt:""}),visible:!u,plugins:["woocommerce-gateway-paypal-express-checkout"],container:Object(b.createElement)(st,null),isConfigured:r.woocommerce_ppec_paypal_settings&&r.woocommerce_ppec_paypal_settings.api_username&&r.woocommerce_ppec_paypal_settings.api_password,isEnabled:r.woocommerce_ppec_paypal_settings&&"yes"===r.woocommerce_ppec_paypal_settings.enabled,optionName:"woocommerce_ppec_paypal_settings"},{key:"klarna_checkout",title:Object(f.__)("Klarna Checkout",'woocommerce'),content:Object(f.__)("Choose the payment that you want, pay now, pay later or slice it. No credit card numbers, no passwords, no worries.",'woocommerce'),before:Object(b.createElement)("img",{src:A.e+"images/klarna-black.png",alt:""}),visible:["SE","FI","NO","NL"].includes(n)&&!u,plugins:["klarna-checkout-for-woocommerce"],container:Object(b.createElement)(ut,{plugin:"checkout"}),isConfigured:t.includes("klarna-checkout-for-woocommerce"),isEnabled:r.woocommerce_kco_settings&&"yes"===r.woocommerce_kco_settings.enabled,optionName:"woocommerce_kco_settings"},{key:"klarna_payments",title:Object(f.__)("Klarna Payments",'woocommerce'),content:Object(f.__)("Choose the payment that you want, pay now, pay later or slice it. No credit card numbers, no passwords, no worries.",'woocommerce'),before:Object(b.createElement)("img",{src:A.e+"images/klarna-black.png",alt:""}),visible:["DK","DE","AT"].includes(n)&&!u,plugins:["klarna-payments-for-woocommerce"],container:Object(b.createElement)(ut,{plugin:"payments"}),isConfigured:t.includes("klarna-payments-for-woocommerce"),isEnabled:r.woocommerce_klarna_payments_settings&&"yes"===r.woocommerce_klarna_payments_settings.enabled,optionName:"woocommerce_klarna_payments_settings"},{key:"square",title:Object(f.__)("Square",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(f.__)("Securely accept credit and debit cards with one low rate, no surprise fees (custom rates available). Sell online and in store and track sales and inventory in one place.",'woocommerce'),u&&Object(b.createElement)("span",{className:"text-style-strong"},Object(f.__)(" Selling CBD products is only supported by Square.",'woocommerce'))),before:Object(b.createElement)("img",{src:A.e+"images/square-black.png",alt:""}),visible:u&&["US"].includes(n)||["brick-mortar","brick-mortar-other"].includes(a.selling_venues)&&["US","CA","JP","GB","AU"].includes(n),plugins:["woocommerce-square"],container:Object(b.createElement)(Xe,null),isConfigured:r.wc_square_refresh_tokens&&r.wc_square_refresh_tokens.length,isEnabled:r.woocommerce_square_credit_card_settings&&"yes"===r.woocommerce_square_credit_card_settings.enabled,optionName:"woocommerce_square_credit_card_settings",hasCbdIndustry:u},{key:"payfast",title:Object(f.__)("PayFast",'woocommerce'),content:Object(b.createElement)(b.Fragment,null,Object(f.__)("The PayFast extension for WooCommerce enables you to accept payments by Credit Card and EFT via one of South Africaâ€™s most popular payment gateways. No setup fees or monthly subscription costs.",'woocommerce'),Object(b.createElement)("p",null,Object(f.__)("Selecting this extension will configure your store to use South African rands as the selected currency.",'woocommerce'))),before:Object(b.createElement)("img",{src:A.e+"images/payfast.png",alt:"PayFast logo"}),visible:["ZA"].includes(n)&&!u,plugins:["woocommerce-payfast-gateway"],container:Object(b.createElement)(dt,null),isConfigured:r.woocommerce_payfast_settings&&r.woocommerce_payfast_settings.merchant_id&&r.woocommerce_payfast_settings.merchant_key&&r.woocommerce_payfast_settings.pass_phrase,isEnabled:r.woocommerce_payfast_settings&&"yes"===r.woocommerce_payfast_settings.enabled,optionName:"woocommerce_payfast_settings"},{key:"cod",title:Object(f.__)("Cash on delivery",'woocommerce'),content:Object(f.__)("Take payments in cash upon delivery.",'woocommerce'),before:Object(b.createElement)(Be,null),visible:!u,isEnabled:r.woocommerce_cod_settings&&"yes"===r.woocommerce_cod_settings.enabled,optionName:"woocommerce_cod_settings"},{key:"bacs",title:Object(f.__)("Direct bank transfer",'woocommerce'),content:Object(f.__)("Take payments via bank transfer.",'woocommerce'),before:Object(b.createElement)(Ve,null),visible:!u,container:Object(b.createElement)(Fe,null),isConfigured:r.woocommerce_bacs_accounts&&r.woocommerce_bacs_accounts.length,isEnabled:r.woocommerce_bacs_settings&&"yes"===r.woocommerce_bacs_settings.enabled,optionName:"woocommerce_bacs_settings"}),Object(g.filter)(m,(function(e){return e.visible}))}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var _t=function(e){u()(r,e);var t,n,o=gt(r);function r(e){var t;a()(this,r),t=o.apply(this,arguments);var n=e.methods,c={};return n.forEach((function(e){return c[e.key]=e.isEnabled})),t.state={busyMethod:null,enabledMethods:c,recommendedMethod:t.getRecommendedMethod()},t.completeTask=t.completeTask.bind(W()(t)),t.markConfigured=t.markConfigured.bind(W()(t)),t.skipTask=t.skipTask.bind(W()(t)),t}return s()(r,[{key:"componentDidUpdate",value:function(){var e=this.state.recommendedMethod,t=this.getRecommendedMethod();e!==t&&this.setState({recommendedMethod:t})}},{key:"getRecommendedMethod",value:function(){return this.props.methods.find((function(e){return"wcpay"===e.key&&e.visible}))?"wcpay":"stripe"}},{key:"completeTask",value:(n=J()(regeneratorRuntime.mark((function e(){var t,n,o,c,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.createNotice,o=t.methods,c=t.updateOptions,e.next=3,c({woocommerce_task_list_payments:{completed:1,timestamp:Math.floor(Date.now()/1e3)}});case 3:r=e.sent,Object(q.b)("tasklist_payment_done",{configured:o.filter((function(e){return e.isConfigured})).map((function(e){return e.key}))}),r.success?(n("success",Object(f.__)("ðŸ’° Ka-ching! Your store can now accept payments ðŸ’³",'woocommerce')),Object(T.getHistory)().push(Object(T.getNewPath)({},"/",{}))):n("error",Object(f.__)("There was a problem updating settings",'woocommerce'));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"skipTask",value:function(){var e=this.props,t=e.methods;(0,e.updateOptions)({woocommerce_task_list_payments:{skipped:1,timestamp:Math.floor(Date.now()/1e3)}}),Object(q.b)("tasklist_payment_skip_task",{options:t.map((function(e){return e.key}))}),Object(T.getHistory)().push(Object(T.getNewPath)({},"/",{}))}},{key:"markConfigured",value:function(e){var t=this.state.enabledMethods;this.setState({enabledMethods:ft(ft({},t),{},c()({},e,!0))}),Object(T.getHistory)().push(Object(T.getNewPath)({task:"payments"},"/",{})),Object(q.b)("tasklist_payment_connect_method",{payment_method:e})}},{key:"getCurrentMethod",value:function(){var e=this.props,t=e.methods,n=e.query;if(n.method)return t.find((function(e){return e.key===n.method}))}},{key:"getInstallStep",value:function(){var e=this.getCurrentMethod();if(e.plugins&&e.plugins.length){var t=this.props.activePlugins,n=e.plugins.filter((function(e){return!t.includes(e)})),o=e.plugins.map((function(e){return M.pluginNames[e]})).join(" "+Object(f.__)("and",'woocommerce')+" ");return{key:"install",label:Object(f.sprintf)(Object(f.__)("Install %s",'woocommerce'),o),content:Object(b.createElement)(R.Plugins,{onComplete:function(){Object(q.b)("tasklist_payment_install_method",{plugins:e.plugins})},autoInstall:!0,pluginSlugs:e.plugins}),isComplete:!n.length}}}},{key:"toggleMethod",value:function(e){var t=this.props,n=t.methods,o=t.options,r=t.updateOptions,a=this.state.enabledMethods,i=n.find((function(t){return t.key===e}));a[e]=!a[e],this.setState({enabledMethods:a}),Object(q.b)("tasklist_payment_toggle",{enabled:!i.isEnabled,payment_method:e}),r(c()({},i.optionName,ft(ft({},o[i.optionName]),{},{enabled:i.isEnabled?"no":"yes"})))}},{key:"handleClick",value:(t=J()(regeneratorRuntime.mark((function e(t){var n,o,c,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.methods,o=t.key,c=t.onClick,Object(q.b)("tasklist_payment_setup",{options:n.map((function(e){return e.key})),selected:o}),!c){e.next=8;break}return this.setState({busyMethod:o}),e.next=7,new Promise(c).then((function(){r.setState({busyMethod:null})})).catch((function(){r.setState({busyMethod:null})}));case 7:return e.abrupt("return");case 8:Object(T.updateQueryString)({method:o});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.getCurrentMethod(),n=this.state,o=n.busyMethod,c=n.enabledMethods,r=n.recommendedMethod,a=this.props,i=a.methods,s=a.query,l=a.requesting,u=Object.keys(c).filter((function(e){return c[e]})).length;return t?Object(b.createElement)(R.Card,{className:"woocommerce-task-payment-method is-narrow"},Object(b.cloneElement)(t.container,{query:s,installStep:this.getInstallStep(),markConfigured:this.markConfigured,hasCbdIndustry:t.hasCbdIndustry})):Object(b.createElement)("div",{className:"woocommerce-task-payments"},i.map((function(t){var n=t.before,a=t.container,i=t.content,s=t.isConfigured,l=t.key,u=t.title;if(!t.visible)return null;var m=y()("woocommerce-task-payment","is-narrow",!s&&"woocommerce-task-payment-not-configured","woocommerce-task-payment-"+l),p=l===r&&!s,d=p&&"wcpay"!==l,h=p&&"wcpay"===l;return Object(b.createElement)(R.Card,{key:l,className:m},Object(b.createElement)("div",{className:"woocommerce-task-payment__before"},d&&Object(b.createElement)("div",{className:"woocommerce-task-payment__recommended-ribbon"},Object(b.createElement)("span",null,Object(f.__)("Recommended",'woocommerce'))),n),Object(b.createElement)("div",{className:"woocommerce-task-payment__text"},Object(b.createElement)(R.H,{className:"woocommerce-task-payment__title"},u,h&&Object(b.createElement)("span",{className:"woocommerce-task-payment__recommended-pill"},Object(f.__)("Recommended",'woocommerce'))),Object(b.createElement)("div",{className:"woocommerce-task-payment__content"},i)),Object(b.createElement)("div",{className:"woocommerce-task-payment__after"},a&&!s?Object(b.createElement)(w.a,{isPrimary:l===r,isSecondary:l!==r,isBusy:o===l,disabled:o,onClick:function(){return e.handleClick(t)}},Object(f.__)("Set up",'woocommerce')):Object(b.createElement)(we.a,{checked:c[l],onChange:function(){return e.toggleMethod(l)},onClick:function(e){return e.stopPropagation()}})))})),Object(b.createElement)("div",{className:"woocommerce-task-payments__actions"},u?Object(b.createElement)(w.a,{isPrimary:!0,isBusy:l,onClick:this.completeTask},Object(f.__)("Done",'woocommerce')):Object(b.createElement)(w.a,{isLink:!0,onClick:this.skipTask},Object(f.__)("My store doesnâ€™t take payments",'woocommerce'))))}}]),r}(b.Component),Ot=Object(_.a)(Object(E.withDispatch)((function(e){return{createNotice:e("core/notices").createNotice,installAndActivatePlugins:e(M.PLUGINS_STORE_NAME).installAndActivatePlugins,updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})),Object(ne.a)((function(e,t){var n=t.createNotice,o=t.installAndActivatePlugins,c=e(M.ONBOARDING_STORE_NAME).getProfileItems,r=e(M.OPTIONS_STORE_NAME),a=r.getOption,i=r.isOptionsUpdating,s=e(M.PLUGINS_STORE_NAME),l=s.getActivePlugins,u=s.isJetpackConnected,m=(0,e(M.SETTINGS_STORE_NAME).getSettings)("general").general,p=void 0===m?{}:m,d=l(),h=c(),b=["woocommerce_woocommerce_payments_settings","woocommerce_stripe_settings","woocommerce_ppec_paypal_settings","woocommerce_payfast_settings","woocommerce_square_credit_card_settings","woocommerce_klarna_payments_settings","woocommerce_kco_settings","wc_square_refresh_tokens","woocommerce_cod_settings","woocommerce_bacs_settings","woocommerce_bacs_accounts"].reduce((function(e,t){return e[t]=a(t),e}),{}),f=Object(D.a)(p.woocommerce_default_country);return{countryCode:f,profileItems:h,activePlugins:d,options:b,methods:ht({activePlugins:d,countryCode:f,createNotice:n,installAndActivatePlugins:o,isJetpackConnected:u(),options:b,profileItems:h}),requesting:i()}})))(_t);function yt(e){var t=e.profileItems,n=e.taskListPayments,o=e.query,c=e.toggleCartModal,r=e.installedPlugins,a=Object(A.g)("onboarding",{hasPhysicalProducts:!1,hasProducts:!1,isAppearanceComplete:!1,isTaxComplete:!1,shippingZonesCount:0}),i=a.hasPhysicalProducts,s=a.hasProducts,l=a.isAppearanceComplete,u=a.isTaxComplete,m=a.shippingZonesCount,p=Object(D.d)(t,!0,r),d=Object(D.d)(t,!1,r),h=Boolean(n&&n.completed),g=Boolean(n&&n.skipped),_=[{key:"store_details",title:Object(f.__)("Store details",'woocommerce'),container:null,onClick:function(){window.location=Object(A.f)("admin.php?page=wc-admin&reset_profiler=1")},completed:t.completed,visible:!0,time:Object(f.__)("4 minutes",'woocommerce')},{key:"purchase",title:Object(f.__)("Purchase & install extensions",'woocommerce'),container:null,onClick:function(){return d.length?c():null},visible:p.length,completed:p.length&&!d.length,time:Object(f.__)("2 minutes",'woocommerce')},{key:"connect",title:Object(f.__)("Connect your store to WooCommerce.com",'woocommerce'),container:Object(b.createElement)(ie,{query:o}),visible:t.items_purchased&&!t.wccom_connected,completed:t.wccom_connected,time:Object(f.__)("1 minute",'woocommerce')},{key:"products",title:Object(f.__)("Add my products",'woocommerce'),container:Object(b.createElement)(ue,null),completed:s,visible:!0,time:Object(f.__)("1 minute per product",'woocommerce')},{key:"appearance",title:Object(f.__)("Personalize my store",'woocommerce'),container:Object(b.createElement)(te,null),completed:l,visible:!0,time:Object(f.__)("2 minutes",'woocommerce')},{key:"shipping",title:Object(f.__)("Set up shipping",'woocommerce'),container:Object(b.createElement)(Te,null),completed:m>0,visible:t.product_types&&t.product_types.includes("physical")||i,time:Object(f.__)("1 minute",'woocommerce')},{key:"tax",title:Object(f.__)("Set up tax",'woocommerce'),container:Object(b.createElement)(Le,null),completed:u,visible:!0,time:Object(f.__)("1 minute",'woocommerce')},{key:"payments",title:Object(f.__)("Set up payments",'woocommerce'),container:Object(b.createElement)(Ot,null),completed:h||g,onClick:function(){h||g?window.location=Object(A.f)("admin.php?page=wc-settings&tab=checkout"):Object(T.updateQueryString)({task:"payments"})},visible:!0,time:Object(f.__)("2 minutes",'woocommerce')}];return Object(H.applyFilters)("woocommerce_admin_onboarding_task_list",_,o)}function wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function jt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h()(e);if(t){var c=h()(this).constructor;n=Reflect.construct(o,arguments,c)}else n=o.apply(this,arguments);return p()(this,n)}}var kt=function(e){u()(n,e);var t=jt(n);function n(e){var o;return a()(this,n),(o=t.call(this,e)).state={isCartModalOpen:!1,isWelcomeModalOpen:!e.modalDismissed},o}return s()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.incompleteTasks,n=e.updateOptions;document.body.classList.add("woocommerce-onboarding"),document.body.classList.add("woocommerce-task-dashboard__body"),this.recordTaskView(),this.recordTaskListView(),t.length||n({woocommerce_task_list_complete:"yes"}),this.possiblyTrackCompletedTasks()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.completedTaskKeys,o=t.incompleteTasks,c=t.query,r=t.updateOptions,a=e.completedTaskKeys,i=e.incompleteTasks;e.query.task!==c.task&&(window.document.documentElement.scrollTop=0,this.recordTaskView()),!o.length&&i.length&&r({woocommerce_task_list_complete:"yes"}),Object(g.isEqual)(a,n)||this.possiblyTrackCompletedTasks()}},{key:"possiblyTrackCompletedTasks",value:function(){var e=this.props,t=e.completedTaskKeys,n=e.trackedCompletedTasks,o=e.updateOptions;Object(g.isEqual)(n,t)||o({woocommerce_task_list_tracked_completed_tasks:t})}},{key:"componentWillUnmount",value:function(){document.body.classList.remove("woocommerce-onboarding"),document.body.classList.remove("woocommerce-task-dashboard__body")}},{key:"getTasks",value:function(){var e=this.props,t=e.profileItems,n=e.query,o=e.taskListPayments,c=e.installedPlugins;return yt({profileItems:t,taskListPayments:o,query:n,toggleCartModal:this.toggleCartModal.bind(this),installedPlugins:c}).filter((function(e){return e.visible}))}},{key:"getPluginsInformation",value:function(){var e=this.props,t=e.isJetpackConnected,n=e.activePlugins,o=e.installedPlugins;return{wcs_installed:o.includes("woocommerce-services"),wcs_active:n.includes("woocommerce-services"),jetpack_installed:o.includes("jetpack"),jetpack_active:n.includes("jetpack"),jetpack_connected:t}}},{key:"recordTaskView",value:function(){var e=this.props.query.task,t=this.getPluginsInformation();e&&Object(q.b)("task_view",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({task_name:e},t))}},{key:"recordTaskListView",value:function(){if(!this.getCurrentTask()){var e=this.props.profileItems,t=this.getTasks();Object(q.b)("tasklist_view",{number_tasks:t.length,store_connected:e.wccom_connected})}}},{key:"keepTaskCard",value:function(){Object(q.b)("tasklist_completed",{action:"keep_card"}),this.props.updateOptions({woocommerce_task_list_prompt_shown:!0})}},{key:"hideTaskCard",value:function(e){Object(q.b)("tasklist_completed",{action:e}),this.props.updateOptions({woocommerce_task_list_hidden:"yes",woocommerce_task_list_prompt_shown:!0})}},{key:"getCurrentTask",value:function(){var e=this.props.query.task,t=this.getTasks().find((function(t){return t.key===e}));return t||null}},{key:"renderMenu",value:function(){var e=this;return Object(b.createElement)("div",{className:"woocommerce-card__menu woocommerce-card__header-item"},Object(b.createElement)(R.EllipsisMenu,{label:Object(f.__)("Task List Options",'woocommerce'),renderContent:function(){return Object(b.createElement)("div",{className:"woocommerce-task-card__section-controls"},Object(b.createElement)(w.a,{onClick:function(){return e.hideTaskCard("remove_card")}},Object(f.__)("Hide this",'woocommerce')))}}))}},{key:"toggleCartModal",value:function(){var e=this.state.isCartModalOpen;e||Object(q.b)("tasklist_purchase_extensions"),this.setState({isCartModalOpen:!e})}},{key:"closeWelcomeModal",value:function(){document.body.classList.contains("woocommerce-admin-is-loading")||(this.setState({isWelcomeModalOpen:!1}),this.props.updateOptions({woocommerce_task_list_welcome_modal_dismissed:!0}))}},{key:"renderWelcomeModal",value:function(){var e=this;return Object(b.createElement)(j.a,{title:Object(b.createElement)(b.Fragment,null,Object(b.createElement)("span",{role:"img","aria-hidden":"true",focusable:"false",className:"woocommerce-task-dashboard__welcome-modal-icon"},"ðŸš€"),Object(f.__)("Woo hoo - you're almost there!",'woocommerce')),onRequestClose:function(){return e.closeWelcomeModal()},className:"woocommerce-task-dashboard__welcome-modal"},Object(b.createElement)("div",{className:"woocommerce-task-dashboard__welcome-modal-wrapper"},Object(b.createElement)("div",{className:"woocommerce-task-dashboard__welcome-modal-message"},Object(b.createElement)("p",null,Object(f.__)("Based on the information you provided weâ€™ve prepared some final set up tasks for you to perform.",'woocommerce')),Object(b.createElement)("p",null,Object(f.__)("Once complete your store will be ready for launch - exciting!",'woocommerce'))),Object(b.createElement)(w.a,{isPrimary:!0,onClick:function(){return e.closeWelcomeModal()}},Object(f.__)("Continue",'woocommerce'))))}},{key:"render",value:function(){var e=this,t=this.props.query,n=this.state,o=n.isCartModalOpen,c=n.isWelcomeModalOpen,r=this.getCurrentTask(),a=this.getTasks().map((function(e){return e.className=y()(e.completed?"is-complete":null,e.className),e.before=Object(b.createElement)("div",{className:"woocommerce-task__icon"},e.completed&&Object(b.createElement)(P.a,{icon:x.a})),e.title=Object(b.createElement)(k.a,{as:"div",variant:e.completed?"body.small":"button"},e.title),e.completed||(e.after=e.time?Object(b.createElement)("span",{className:"woocommerce-task-estimated-time"},e.time):Object(b.createElement)(P.a,{icon:N.a})),e.onClick||(e.onClick=function(){return Object(T.updateQueryString)({task:e.key})}),e})),i=a.filter((function(e){return e.completed})).length,s=y()("woocommerce-task-card__progress-bar",{completed:a.length===i});return Object(b.createElement)(b.Fragment,null,Object(b.createElement)("div",{className:"woocommerce-task-dashboard__container"},r?Object(b.cloneElement)(r.container,{query:t}):Object(b.createElement)(b.Fragment,null,Object(b.createElement)(v.a,{size:"large",className:"woocommerce-task-card woocommerce-dashboard-card"},Object(b.createElement)("progress",{className:s,max:a.length,value:i}),Object(b.createElement)(S.a,{size:"medium"},Object(b.createElement)(k.a,{variant:"title.small"},Object(f.__)("Finish setup",'woocommerce')),this.renderMenu()),Object(b.createElement)(C.a,null,Object(b.createElement)(R.List,{items:a}))),c&&this.renderWelcomeModal())),o&&Object(b.createElement)(B,{onClose:function(){return e.toggleCartModal()},onClickPurchaseLater:function(){return e.toggleCartModal()}}))}}]),n}(b.Component);t.default=Object(_.a)(Object(ne.a)((function(e,t){var n=e(M.ONBOARDING_STORE_NAME).getProfileItems,o=e(M.OPTIONS_STORE_NAME).getOption,c=e(M.PLUGINS_STORE_NAME),r=c.getActivePlugins,a=c.getInstalledPlugins,i=c.isJetpackConnected,s=n(),l=o("woocommerce_task_list_welcome_modal_dismissed")||!1,u=o("woocommerce_task_list_payments"),m=o("woocommerce_task_list_tracked_completed_tasks")||[],p=o("woocommerce_task_list_payments"),d=a(),h=yt({profileItems:s,options:p,query:t.query,installedPlugins:d}),b=h.filter((function(e){return e.completed})).map((function(e){return e.key})),f=h.filter((function(e){return e.visible&&!e.completed})),g=r();return{modalDismissed:l,profileItems:s,taskListPayments:u,isJetpackConnected:i(),incompleteTasks:f,trackedCompletedTasks:m,completedTaskKeys:b,activePlugins:g,installedPlugins:d}})),Object(E.withDispatch)((function(e){return{updateOptions:e(M.OPTIONS_STORE_NAME).updateOptions}})))(kt)}}]);
