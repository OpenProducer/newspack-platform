(()=>{var e={4184:(e,t)=>{var n;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var i=a.apply(null,n);i&&e.push(i)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var s in n)r.call(n,s)&&n[s]&&e.push(s);else e.push(n.toString())}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},5366:(e,t,n)=>{"object"==typeof window&&window.Jetpack_Block_Assets_Base_Url&&(n.p=window.Jetpack_Block_Assets_Base_Url)},4981:e=>{"use strict";e.exports=window.wp.blocks},5609:e=>{"use strict";e.exports=window.wp.components},9307:e=>{"use strict";e.exports=window.wp.element},907:(e,t,n)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:()=>r})},2982:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(907);var a=n(181);function o(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},181:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(907);function a(e,t){if(e){if("string"==typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})();var r={};(()=>{"use strict";n(5366);var e=n(2982),t=n(9307),r=n(4981),a=n(5609);const o=function(e){var n=e.size,r=void 0===n?24:n;return(0,t.createElement)(a.SVG,{className:"newspack-logo",width:r,height:r,viewBox:"0 0 32 32"},(0,t.createElement)(a.Path,{d:"M16 32c8.836 0 16-7.164 16-16S24.836 0 16 0 0 7.164 0 16s7.163 16 16 16z",fill:"#36f"}),(0,t.createElement)(a.Path,{d:"M22.988 16.622h-1.72l-1.103-1.124h2.823v1.124zm0-3.31H18.02l-1.102-1.124h6.071v1.124zm0-3.31h-8.217l-1.103-1.125h9.32v1.125zm0 13.12L9.012 8.878v4.749l.069.071h-.07v9.426h3.451v-5.98l5.867 5.98h4.66z",fill:"#fff"}))};(0,r.setCategories)([].concat((0,e.Z)((0,r.getCategories)().filter((function(e){return"newspack"!==e.slug}))),[{slug:"newspack",title:"Newspack",icon:(0,t.createElement)(o,null)}]))})(),(()=>{"use strict";n.r(r);var e=n(4981),t=n(9307);const a=window.wp.primitives,o=(0,t.createElement)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(a.Path,{d:"M18 8H6c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2zm.5 6c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5v-4c0-.3.2-.5.5-.5h12c.3 0 .5.2.5.5v4zM4 4v1.5h16V4H4zm0 16h16v-1.5H4V20z"})),i=window.wp.i18n;function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){u(o,r,a,i,s,"next",e)}function s(e){u(o,r,a,i,s,"throw",e)}i(void 0)}))}}var p=n(2982);var f,v=n(181);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],_n=!0,i=!1;try{for(n=n.call(e);!(_n=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);_n=!0);}catch(s){i=!0,a=s}finally{try{_n||null==n.return||n.return()}finally{if(i)throw a}}return o}}(e,t)||(0,v.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var b=new Uint8Array(16);function w(){if(!f&&!(f="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(b)}const h=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const y=function(e){return"string"==typeof e&&h.test(e)};for(var g=[],k=0;k<256;++k)g.push((k+256).toString(16).substr(1));const E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]).toLowerCase();if(!y(n))throw TypeError("Stringified UUID is invalid");return n};const S=function(e,t,n){var r=(e=e||{}).random||(e.rng||w)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return E(r)};var _=n(4184),j=n.n(_);const x=window.wp.blockEditor;var O=n(5609);const P=window.wp.apiFetch;var A=n.n(P);const C=(0,t.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(a.Path,{d:"M20.1 5.1L16.9 2 6.2 12.7l-1.3 4.4 4.5-1.3L20.1 5.1zM4 20.8h8v-1.5H4v1.5z"}));var __=i.__,z=function(e){return[{label:__("Select a provider","newspack-ads"),value:""}].concat((0,p.Z)(e.map((function(e){return{label:e.name,value:e.id}}))))};const M=function(e){var n,r=e.label,a=void 0===r?__("Ad Unit","newspack"):r,o=e.providers,c=void 0===o?[]:o,u=e.bidders,d=void 0===u?{}:u,f=e.value,v=void 0===f?{}:f,b=e.disabled,w=void 0!==b&&b,h=e.onChange,y=void 0===h?function(){}:h,g=m((0,t.useState)({}),2),k=g[0],E=g[1],S=c.find((function(e){return(null==e?void 0:e.id)===(v.provider||"gam")}))||c[0];return(0,t.useEffect)((function(){var e={};Object.keys(d).forEach((function(t){var n,r=d[t],a=null==S?void 0:S.units.find((function(e){return e.value===v.ad_unit})),o=v.ad_unit&&a&&(n=r.ad_sizes,a.sizes.some((function(e){return(n||[]).find((function(t){return t[0]===e[0]&&t[1]===e[1]}))})));e[t]=v.ad_unit&&a&&!o?(0,i.sprintf)(__("%s does not support the selected ad unit sizes.","newspack"),r.name,""):null})),E(e)}),[c,v.ad_unit]),c.length?(0,t.createElement)(t.Fragment,null,c.length>1&&(0,t.createElement)(O.SelectControl,{label:__("Provider","newspack"),value:null==S?void 0:S.id,options:z(c),onChange:function(e){return y(l(l({},v),{},{provider:e}))},disabled:w}),(0,t.createElement)(O.SelectControl,{label:a,value:v.ad_unit,options:(n=S,null!=n&&n.units?[{label:__("Select an Ad Unit","newspack-ads"),value:""}].concat((0,p.Z)(n.units.map((function(e){return{label:e.name,value:e.value}})))):[]),onChange:function(e){return y(l(l({},v),{},{ad_unit:e}))},disabled:w}),"gam"===(null==S?void 0:S.id)&&Object.keys(d).map((function(e){var n=d[e],r=(0,i.sprintf)(__("%s Placement ID","newspack-ads"),n.name);return(0,t.createElement)(O.TextControl,{key:e,value:v.bidders_ids?v.bidders_ids[e]:null,label:r,disabled:k[e]||w,onChange:function(t){return y(l(l({},v),{},{bidders_ids:l(l({},v.bidders_ids),{},s({},e,t))}))}})})),"gam"===(null==S?void 0:S.id)&&Object.keys(k).map((function(e){return k[e]?(0,t.createElement)(O.Notice,{key:e,status:"warning",isDismissible:!1},k[e]):null}))):(0,t.createElement)(O.Notice,{isWarning:!0,noticeText:__("There is no provider available.","newspack-ads"),isDismissible:!1})};var T=i.__;const B=function(e){var n,r=e.attributes,a=e.setAttributes,i=m((0,t.useState)(!1),2),s=i[0],c=i[1],u=m((0,t.useState)(null),2),f=u[0],v=u[1],b=m((0,t.useState)(!1),2),w=b[0],h=b[1],y=m((0,t.useState)(null),2),g=y[0],k=y[1],E=m((0,t.useState)([]),2),_=E[0],P=E[1],z=m((0,t.useState)({}),2),B=z[0],N=z[1],Z=(0,x.useBlockProps)({className:"newspack-ads-ad-block"}),D=_.find((function(e){return e.id.toString()===r.provider})),V=null==D||null===(n=D.units)||void 0===n?void 0:n.find((function(e){return e.value.toString()===r.ad_unit})),U=(null==V?void 0:V.sizes)||[],R=Math.max.apply(Math,(0,p.Z)(U.map((function(e){return e[0]}))))||300,I=Math.max.apply(Math,(0,p.Z)(U.map((function(e){return e[1]}))))||100;return(0,t.useEffect)(d(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.activeAd&&!r.ad_unit&&a({ad_unit:r.activeAd}),c(!0),e.prev=2,e.t0=P,e.next=6,A()({path:"/newspack-ads/v1/providers"});case 6:e.t1=e.sent,(0,e.t0)(e.t1),e.next=13;break;case 10:e.prev=10,e.t2=e.catch(2),v(e.t2);case 13:return e.prev=13,e.t3=N,e.next=17,A()({path:"/newspack-ads/v1/bidders"});case 17:e.t4=e.sent,(0,e.t3)(e.t4),e.next=24;break;case 21:e.prev=21,e.t5=e.catch(13),k(e.t5);case 24:c(!1);case 25:case"end":return e.stop()}}),e,null,[[2,10],[13,21]])}))),[]),(0,t.createElement)("div",Z,!w&&V?(0,t.createElement)(t.Fragment,null,!s&&(0,t.createElement)(x.BlockControls,null,(0,t.createElement)(O.ToolbarGroup,null,(0,t.createElement)(O.ToolbarButton,{icon:C,label:T("Edit","newspack-ads"),onClick:function(){return h(!0)}}))),f&&(0,t.createElement)(O.Notice,{isError:!0,noticeText:f,isDismissible:!1}),"gam"===D&&g&&(0,t.createElement)(O.Notice,{isWarning:!0,noticeText:g,isDismissible:!1}),(0,t.createElement)("div",{className:"newspack-ads-ad-block-placeholder",style:{width:R,height:I}},(null==U?void 0:U.length)>0&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(O.SVG,{className:"newspack-ads-ad-block-mock",width:R,viewBox:"0 0 "+R+" "+I},(0,t.createElement)("rect",{width:R,height:I,strokeDasharray:"2"}),(0,t.createElement)("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",strokeDasharray:"2"})),(0,t.createElement)("span",{className:"newspack-ads-ad-block-ad-label"},_.length>1&&"".concat(D.name," - ")," ",V.name,(0,t.createElement)("br",null),U.map((function(e){return"".concat(e[0],"x").concat(e[1])})).join(", "))),s&&(0,t.createElement)(O.Spinner,null))):(0,t.createElement)(O.Placeholder,{label:T("Ad Unit","newspack-ads"),icon:o},(0,t.createElement)("div",{className:"newspack-ads-ad-block-edit"},s?(0,t.createElement)(O.Spinner,null):(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:j()({"newspack-ads-ad-block-edit-fields":!0,"one-column":_.length<2&&!Object.keys(B).length})},(0,t.createElement)(M,{providers:_,bidders:B,value:r,onChange:function(e){h(!0),a(l(l({},e),{},{id:S()}))}})),(0,t.createElement)("div",{className:"newspack-ads-ad-block-save-button"},(0,t.createElement)(O.Button,{disabled:!V,onClick:function(){return h(!1)},isPrimary:!0},T("Save","newspack-ads")))))))};var N=i.__,Z={title:N("Ad Unit","newspack-ads"),icon:{src:o,foreground:"#36f"},category:(0,e.getCategories)().some((function(e){return"newspack"===e.slug}))?"newspack":"common",keywords:[N("ad","newspack-ads"),N("advert","newspack-ads"),N("ads","newspack-ads")],description:N("Render an ad unit from your inventory.","newspack-ads"),attributes:{id:{type:"string"},provider:{type:"string",default:"gam"},ad_unit:{type:"string"},bidders_ids:{type:"object",default:{}},activeAd:{type:"string"}},supports:{html:!1,align:["left","center","right","wide","full"],color:{text:!1,background:!0}},edit:B,save:function(){return null}};(0,e.registerBlockType)("newspack-ads/".concat("ad-unit"),Z)})();var a=window;for(var o in r)a[o]=r[o];r.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();