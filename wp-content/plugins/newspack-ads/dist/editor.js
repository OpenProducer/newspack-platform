(()=>{var e={9085:(e,t,s)=>{"object"==typeof window&&window.Jetpack_Block_Assets_Base_Url&&(s.p=window.Jetpack_Block_Assets_Base_Url)},790:e=>{"use strict";e.exports=window.ReactJSXRuntime},4997:e=>{"use strict";e.exports=window.wp.blocks},6427:e=>{"use strict";e.exports=window.wp.components},6942:(e,t)=>{var s;!function(){"use strict";var a={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var s=arguments[t];s&&(e=r(e,i(s)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var s in e)a.call(e,s)&&e[s]&&(t=r(t,s));return t}function r(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(s=function(){return n}.apply(t,[]))||(e.exports=s)}()}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,s),i.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var n=a.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=a[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{"use strict";s(9085);var e=s(4997),t=s(6427),a=s(790);const n=({size:e=24})=>(0,a.jsxs)(t.SVG,{className:"newspack-logo",width:e,height:e,viewBox:"0 0 32 32",children:[(0,a.jsx)(t.Path,{d:"M16 32c8.836 0 16-7.164 16-16S24.836 0 16 0 0 7.164 0 16s7.163 16 16 16z",fill:"#36f"}),(0,a.jsx)(t.Path,{d:"M22.988 16.622h-1.72l-1.103-1.124h2.823v1.124zm0-3.31H18.02l-1.102-1.124h6.071v1.124zm0-3.31h-8.217l-1.103-1.125h9.32v1.125zm0 13.12L9.012 8.878v4.749l.069.071h-.07v9.426h3.451v-5.98l5.867 5.98h4.66z",fill:"#fff"})]});(0,e.setCategories)([...(0,e.getCategories)().filter((({slug:e})=>"newspack"!==e)),{slug:"newspack",title:"Newspack",icon:(0,a.jsx)(n,{})}])})(),(()=>{"use strict";var e=s(4997);const t=window.wp.primitives;var a=s(790);const n=(0,a.jsx)(t.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)(t.Path,{d:"M18 8H6c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2zm.5 6c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5v-4c0-.3.2-.5.5-.5h12c.3 0 .5.2.5.5v4zM4 4v1.5h16V4H4zm0 16h16v-1.5H4V20z"})}),i=window.wp.i18n;var r=s(6942),o=s.n(r);const c=window.wp.element,d=window.wp.blockEditor;var l=s(6427);const p=window.wp.apiFetch;var u=s.n(p);const w=(0,a.jsx)(t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(t.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),h=e=>[{label:(0,i.__)("Select a provider","newspack-ads"),value:""},...e.map((e=>({label:e.name,value:e.id})))],v=({label:e=(0,i.__)("Ad Unit","newspack"),providers:t=[],bidders:s={},value:n={},disabled:r=!1,onChange:o=(()=>{})})=>{const[d,p]=(0,c.useState)({}),u=t.find((e=>e?.id===(n.provider||"gam")))||t[0];return(0,c.useEffect)((()=>{const e={};Object.keys(s).forEach((t=>{const a=s[t],r=u?.units.find((e=>e.value===n.ad_unit)),o=n.ad_unit&&r&&(c=a.ad_sizes,r.sizes.some((e=>(c||[]).find((t=>t[0]===e[0]&&t[1]===e[1])))));var c;e[t]=n.ad_unit&&r&&!o?(0,i.sprintf)(
// Translators: Ad bidder name.
// Translators: Ad bidder name.
(0,i.__)("%s does not support the selected ad unit sizes.","newspack"),a.name,""):null})),p(e)}),[t,n.ad_unit]),t.length?(0,a.jsxs)(c.Fragment,{children:[t.length>1&&(0,a.jsx)(l.SelectControl,{label:(0,i.__)("Provider","newspack"),value:u?.id,options:h(t),onChange:e=>o({...n,provider:e}),disabled:r}),(0,a.jsx)(l.SelectControl,{label:e,value:n.ad_unit,options:(w=u,w?.units?[{label:(0,i.__)("Select an Ad Unit","newspack-ads"),value:""},...w.units.map((e=>({label:e.name,value:e.value})))]:[]),onChange:e=>o({...n,ad_unit:e}),disabled:r}),"gam"===u?.id&&Object.keys(s).map((e=>{const t=s[e],c=(0,i.sprintf)((0,i.__)("%s Placement ID","newspack-ads"),t.name);
// Translators: Bidder name.
return(0,a.jsx)(l.TextControl,{value:n.bidders_ids?n.bidders_ids[e]:null,label:c,disabled:d[e]||r,onChange:t=>o({...n,bidders_ids:{...n.bidders_ids,[e]:t}})},e)})),"gam"===u?.id&&Object.keys(d).map((e=>d[e]?(0,a.jsx)(l.Notice,{status:"warning",isDismissible:!1,children:d[e]},e):null))]}):(0,a.jsx)(l.Notice,{isWarning:!0,noticeText:(0,i.__)("There is no provider available.","newspack-ads"),isDismissible:!1});var w},g={title:(0,i.__)("Ad Unit","newspack-ads"),icon:{src:n,foreground:"#36f"},category:(0,e.getCategories)().some((({slug:e})=>"newspack"===e))?"newspack":"common",keywords:[(0,i.__)("ad","newspack-ads"),(0,i.__)("advert","newspack-ads"),(0,i.__)("ads","newspack-ads")],description:(0,i.__)("Render an ad unit from your inventory.","newspack-ads"),attributes:{provider:{type:"string"},ad_unit:{type:"string"},bidders_ids:{type:"object",default:{}},activeAd:{type:"string"}},supports:{html:!1,align:["left","center","right","wide","full"],color:{text:!1,background:!0}},edit:function({attributes:e,setAttributes:t}){const[s,r]=(0,c.useState)(!1),[p,h]=(0,c.useState)(null),[g,m]=(0,c.useState)(!1),[x,b]=(0,c.useState)(null),[f,_]=(0,c.useState)([]),[k,j]=(0,c.useState)({}),y=(0,d.useBlockProps)({className:"newspack-ads-ad-block"}),S=f.find((t=>t.id.toString()===e.provider)),z=S?.units?.find((t=>t.value.toString()===e.ad_unit)),B=z?.sizes||[],C=B.length?Math.max(...B.map((e=>e[0]))):300,A=B.length?Math.max(...B.map((e=>e[1]))):200;return(0,c.useEffect)((()=>{(async()=>{e.activeAd&&!e.ad_unit&&t({ad_unit:e.activeAd}),r(!0);try{_(await u()({path:"/newspack-ads/v1/providers"}))}catch(e){h(e)}try{j(await u()({path:"/newspack-ads/v1/bidders"}))}catch(e){b(e)}r(!1)})()}),[]),(0,c.useEffect)((()=>{f?.length&&!e.provider&&t({provider:f[0].id})}),[f]),(0,a.jsx)("div",{...y,children:!g&&z?(0,a.jsxs)(c.Fragment,{children:[!s&&(0,a.jsx)(d.BlockControls,{children:(0,a.jsx)(l.ToolbarGroup,{children:(0,a.jsx)(l.ToolbarButton,{icon:w,label:(0,i.__)("Edit","newspack-ads"),onClick:()=>m(!0)})})}),p&&(0,a.jsx)(l.Notice,{isError:!0,noticeText:p,isDismissible:!1}),"gam"===S&&x&&(0,a.jsx)(l.Notice,{isWarning:!0,noticeText:x,isDismissible:!1}),(0,a.jsxs)("div",{className:"newspack-ads-ad-block-placeholder",style:{width:C,height:A},children:[(0,a.jsxs)(c.Fragment,{children:[(0,a.jsxs)(l.SVG,{className:"newspack-ads-ad-block-mock",width:C,viewBox:"0 0 "+C+" "+A,children:[(0,a.jsx)("rect",{width:C,height:A,strokeDasharray:"2"}),(0,a.jsx)("line",{x1:"0",y1:"0",x2:"100%",y2:"100%",strokeDasharray:"2"})]}),(0,a.jsxs)("span",{className:"newspack-ads-ad-block-ad-label",children:[f.length>1&&`${S.name} - `," ",z.name,(0,a.jsx)("br",{}),B.length?B.map((e=>`${e[0]}x${e[1]}`)).join(", "):(0,i.__)("Unknown size","newspack-ads")]})]}),s&&(0,a.jsx)(l.Spinner,{})]})]}):(0,a.jsx)(l.Placeholder,{label:(0,i.__)("Ad Unit","newspack-ads"),icon:n,children:(0,a.jsx)("div",{className:"newspack-ads-ad-block-edit",children:s?(0,a.jsx)(l.Spinner,{}):(0,a.jsx)(c.Fragment,{children:(0,a.jsxs)("div",{className:o()({"newspack-ads-ad-block-edit-fields":!0}),children:[(0,a.jsx)(v,{providers:f,bidders:k,value:e,onChange:e=>{m(!0),t(e)}}),(0,a.jsx)(l.Button,{disabled:!z,onClick:()=>m(!1),isPrimary:!0,children:(0,i.__)("Save","newspack-ads")})]})})})})})},save:()=>null};(0,e.registerBlockType)("newspack-ads/ad-unit",g)})()})();