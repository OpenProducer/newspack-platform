import*as e from"@wordpress/interactivity";var t={d:(e,o)=>{for(var i in o)t.o(o,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:o[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},o={};t.d(o,{N:()=>f,S:()=>v});const i=(h={getConfig:()=>e.getConfig,privateApis:()=>e.privateApis,store:()=>e.store},u={},t.d(u,h),u),{directivePrefix:n,getRegionRootFragment:a,initialVdom:r,toVdom:s,render:c}=(0,i.privateApis)("I acknowledge that using private APIs means my theme or plugin will inevitably break in the next version of WordPress."),d=new Map,l=e=>{const t=new URL(e,window.location);return t.pathname+t.search},g=(e,{vdom:t}={})=>{const o={},i=`data-${n}-router-region`;e.querySelectorAll(`[${i}]`).forEach((e=>{const n=e.getAttribute(i);o[n]=t?.has(e)?t.get(e):s(e)}));const a=e.querySelector("title")?.innerText;return{regions:o,title:a}},w=e=>{const t=`data-${n}-router-region`;document.querySelectorAll(`[${t}]`).forEach((o=>{const i=o.getAttribute(t),n=a(o);c(e.regions[i],n)})),e.title&&(document.title=e.title)},m=e=>(window.location.assign(e),new Promise((()=>{})));var h,u;window.addEventListener("popstate",(async()=>{const e=l(window.location),t=d.has(e)&&await d.get(e);t?(w(t),v.url=window.location.href):window.location.reload()})),d.set(l(window.location),Promise.resolve(g(document,{vdom:r})));let p="";const{state:v,actions:f}=(0,i.store)("core/router",{state:{url:window.location.href,navigation:{hasStarted:!1,hasFinished:!1,texts:{}}},actions:{*navigate(e,t={}){const{clientNavigationDisabled:o}=(0,i.getConfig)();o&&(yield m(e));const n=l(e),{navigation:a}=v,{loadingAnimation:r=!0,screenReaderAnnouncement:s=!0,timeout:c=1e4}=t;p=e,f.prefetch(n,t);const g=new Promise((e=>setTimeout(e,c))),h=setTimeout((()=>{p===e&&(r&&(a.hasStarted=!0,a.hasFinished=!1),s&&(a.message=a.texts.loading))}),400),u=yield Promise.race([d.get(n),g]);clearTimeout(h),p===e&&(u?(w(u),window.history[t.replace?"replaceState":"pushState"]({},"",e),v.url=e,r&&(a.hasStarted=!1,a.hasFinished=!0),s&&(a.message=a.texts.loaded+(a.message===a.texts.loaded?"Â ":""))):yield m(e))},prefetch(e,t={}){const{clientNavigationDisabled:o}=(0,i.getConfig)();if(o)return;const n=l(e);!t.force&&d.has(n)||d.set(n,(async(e,{html:t})=>{try{if(!t){const o=await window.fetch(e);if(200!==o.status)return!1;t=await o.text()}const o=(new window.DOMParser).parseFromString(t,"text/html");return g(o)}catch(e){return!1}})(n,t))}}});var y=o.N,S=o.S;export{y as actions,S as state};
//# sourceMappingURL=router.min.js.map