{
  "version": 3,
  "sources": ["../../../../packages/block-editor/src/utils/fit-text-utils.js", "../../../../packages/block-editor/src/utils/fit-text-frontend.js"],
  "sourcesContent": ["/**\n * Shared utility functions for fit text functionality.\n * Uses callback-based approach for maximum code reuse between editor and frontend.\n */\n\n/**\n * Generate CSS rule for single text element.\n *\n * @param {string} elementSelector CSS selector for the text element\n * @param {number} fontSize        Font size in pixels\n * @return {string} CSS rule string\n */\nfunction generateCSSRule( elementSelector, fontSize ) {\n\treturn `${ elementSelector } { font-size: ${ fontSize }px !important; }`;\n}\n\n/**\n * Find optimal font size using simple binary search between 5-600px.\n *\n * @param {HTMLElement} textElement     The text element\n * @param {string}      elementSelector CSS selector for the text element\n * @param {Function}    applyStylesFn   Function to apply test styles\n * @return {number} Optimal font size\n */\nfunction findOptimalFontSize( textElement, elementSelector, applyStylesFn ) {\n\tconst alreadyHasScrollableHeight =\n\t\ttextElement.scrollHeight > textElement.clientHeight;\n\tlet minSize = 5;\n\tlet maxSize = 600;\n\tlet bestSize = minSize;\n\n\twhile ( minSize <= maxSize ) {\n\t\tconst midSize = Math.floor( ( minSize + maxSize ) / 2 );\n\t\tapplyStylesFn( generateCSSRule( elementSelector, midSize ) );\n\n\t\tconst fitsWidth = textElement.scrollWidth <= textElement.clientWidth;\n\t\tconst fitsHeight =\n\t\t\talreadyHasScrollableHeight ||\n\t\t\ttextElement.scrollHeight <= textElement.clientHeight;\n\n\t\tif ( fitsWidth && fitsHeight ) {\n\t\t\tbestSize = midSize;\n\t\t\tminSize = midSize + 1;\n\t\t} else {\n\t\t\tmaxSize = midSize - 1;\n\t\t}\n\t}\n\n\treturn bestSize;\n}\n\n/**\n * Complete fit text optimization for a single text element.\n * Handles the full flow using callbacks for style management.\n *\n * @param {HTMLElement} textElement     The text element (paragraph, heading, etc.)\n * @param {string}      elementSelector CSS selector for the text element\n * @param {Function}    applyStylesFn   Function to apply CSS styles (pass empty string to clear)\n */\nexport function optimizeFitText( textElement, elementSelector, applyStylesFn ) {\n\tif ( ! textElement ) {\n\t\treturn;\n\t}\n\n\tapplyStylesFn( '' );\n\n\tconst optimalSize = findOptimalFontSize(\n\t\ttextElement,\n\t\telementSelector,\n\t\tapplyStylesFn\n\t);\n\n\tconst cssRule = generateCSSRule( elementSelector, optimalSize );\n\tapplyStylesFn( cssRule );\n}\n", "/**\n * Frontend fit text functionality.\n * Automatically detects and initializes fit text on blocks with the has-fit-text class.\n */\n\n/**\n * Internal dependencies\n */\nimport { optimizeFitText } from './fit-text-utils';\n\n/**\n * Counter for generating unique element IDs.\n */\nlet idCounter = 0;\n\n/**\n * Get or create a unique style element for a fit text element.\n *\n * @param {string} elementId Unique identifier for the element.\n * @return {HTMLElement} Style element.\n */\nfunction getOrCreateStyleElement( elementId ) {\n\tconst styleId = `fit-text-${ elementId }`;\n\tlet styleElement = document.getElementById( styleId );\n\tif ( ! styleElement ) {\n\t\tstyleElement = document.createElement( 'style' );\n\t\tstyleElement.id = styleId;\n\t\tdocument.head.appendChild( styleElement );\n\t}\n\treturn styleElement;\n}\n\n/**\n * Generate a unique identifier for a fit text element.\n *\n * @param {HTMLElement} element The element to identify.\n * @return {string} Unique identifier.\n */\nfunction getElementIdentifier( element ) {\n\tif ( ! element.dataset.fitTextId ) {\n\t\telement.dataset.fitTextId = `fit-text-${ ++idCounter }`;\n\t}\n\treturn element.dataset.fitTextId;\n}\n\n/**\n * Initialize fit text functionality for a single element.\n *\n * @param {HTMLElement} element Element with fit text enabled.\n */\nfunction initializeFitText( element ) {\n\tconst elementId = getElementIdentifier( element );\n\n\tconst applyFitText = () => {\n\t\tconst styleElement = getOrCreateStyleElement( elementId );\n\t\tconst elementSelector = `[data-fit-text-id=\\\"${ elementId }\\\"]`;\n\n\t\t// Style management callback\n\t\tconst applyStylesFn = ( css ) => {\n\t\t\tstyleElement.textContent = css;\n\t\t};\n\n\t\toptimizeFitText( element, elementSelector, applyStylesFn );\n\t};\n\n\t// Initial sizing\n\tapplyFitText();\n\n\t// Watch for parent container resize\n\tif ( window.ResizeObserver && element.parentElement ) {\n\t\tconst resizeObserver = new window.ResizeObserver( applyFitText );\n\t\tresizeObserver.observe( element.parentElement );\n\t}\n}\n\n/**\n * Initialize fit text on all elements with the has-fit-text class.\n */\nfunction initializeAllFitText() {\n\tconst elements = document.querySelectorAll( '.has-fit-text' );\n\telements.forEach( initializeFitText );\n}\n\nwindow.addEventListener( 'load', initializeAllFitText );\n"],
  "mappings": ";AAYA,SAAS,gBAAiB,iBAAiB,UAAW;AACrD,SAAO,GAAI,eAAgB,iBAAkB,QAAS;AACvD;AAUA,SAAS,oBAAqB,aAAa,iBAAiB,eAAgB;AAC3E,QAAM,6BACL,YAAY,eAAe,YAAY;AACxC,MAAI,UAAU;AACd,MAAI,UAAU;AACd,MAAI,WAAW;AAEf,SAAQ,WAAW,SAAU;AAC5B,UAAM,UAAU,KAAK,OAAS,UAAU,WAAY,CAAE;AACtD,kBAAe,gBAAiB,iBAAiB,OAAQ,CAAE;AAE3D,UAAM,YAAY,YAAY,eAAe,YAAY;AACzD,UAAM,aACL,8BACA,YAAY,gBAAgB,YAAY;AAEzC,QAAK,aAAa,YAAa;AAC9B,iBAAW;AACX,gBAAU,UAAU;IACrB,OAAO;AACN,gBAAU,UAAU;IACrB;EACD;AAEA,SAAO;AACR;AAUO,SAAS,gBAAiB,aAAa,iBAAiB,eAAgB;AAC9E,MAAK,CAAE,aAAc;AACpB;EACD;AAEA,gBAAe,EAAG;AAElB,QAAM,cAAc;IACnB;IACA;IACA;EACD;AAEA,QAAM,UAAU,gBAAiB,iBAAiB,WAAY;AAC9D,gBAAe,OAAQ;AACxB;;;AC7DA,IAAI,YAAY;AAQhB,SAAS,wBAAyB,WAAY;AAC7C,QAAM,UAAU,YAAa,SAAU;AACvC,MAAI,eAAe,SAAS,eAAgB,OAAQ;AACpD,MAAK,CAAE,cAAe;AACrB,mBAAe,SAAS,cAAe,OAAQ;AAC/C,iBAAa,KAAK;AAClB,aAAS,KAAK,YAAa,YAAa;EACzC;AACA,SAAO;AACR;AAQA,SAAS,qBAAsB,SAAU;AACxC,MAAK,CAAE,QAAQ,QAAQ,WAAY;AAClC,YAAQ,QAAQ,YAAY,YAAa,EAAE,SAAU;EACtD;AACA,SAAO,QAAQ,QAAQ;AACxB;AAOA,SAAS,kBAAmB,SAAU;AACrC,QAAM,YAAY,qBAAsB,OAAQ;AAEhD,QAAM,eAAe,MAAM;AAC1B,UAAM,eAAe,wBAAyB,SAAU;AACxD,UAAM,kBAAkB,sBAAwB,SAAU;AAG1D,UAAM,gBAAgB,CAAE,QAAS;AAChC,mBAAa,cAAc;IAC5B;AAEA,oBAAiB,SAAS,iBAAiB,aAAc;EAC1D;AAGA,eAAa;AAGb,MAAK,OAAO,kBAAkB,QAAQ,eAAgB;AACrD,UAAM,iBAAiB,IAAI,OAAO,eAAgB,YAAa;AAC/D,mBAAe,QAAS,QAAQ,aAAc;EAC/C;AACD;AAKA,SAAS,uBAAuB;AAC/B,QAAM,WAAW,SAAS,iBAAkB,eAAgB;AAC5D,WAAS,QAAS,iBAAkB;AACrC;AAEA,OAAO,iBAAkB,QAAQ,oBAAqB;",
  "names": []
}
