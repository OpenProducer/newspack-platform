"use strict";var wp;(wp||={}).coreData=(()=>{var Xf=Object.create;var bi=Object.defineProperty;var Zf=Object.getOwnPropertyDescriptor;var eh=Object.getOwnPropertyNames;var th=Object.getPrototypeOf,rh=Object.prototype.hasOwnProperty;var yn=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var we=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),zt=(t,e)=>{for(var r in e)bi(t,r,{get:e[r],enumerable:!0})},Va=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of eh(e))!rh.call(t,i)&&i!==r&&bi(t,i,{get:()=>e[i],enumerable:!(n=Zf(e,i))||n.enumerable});return t};var V=(t,e,r)=>(r=t!=null?Xf(th(t)):{},Va(e||!t||!t.__esModule?bi(r,"default",{value:t,enumerable:!0}):r,t)),nh=t=>Va(bi({},"__esModule",{value:!0}),t);var Ye=we((Qw,ja)=>{ja.exports=window.wp.data});var xr=we((Xw,Fa)=>{"use strict";Fa.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(i=n;i--!==0;)if(!t(e[i],r[i]))return!1;return!0}if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(i of e.entries())if(!r.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],r.get(i[0])))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(i of e.entries())if(!r.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if(n=e.length,n!=r.length)return!1;for(i=n;i--!==0;)if(e[i]!==r[i])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;i--!==0;){var o=s[i];if(!t(e[o],r[o]))return!1}return!0}return e!==e&&r!==r}});var Ps=we((Zw,Ga)=>{Ga.exports=window.wp.compose});var Ka=we((e_,Ya)=>{Ya.exports=window.wp.undoManager});var Qa=we((I_,Ja)=>{"use strict";function Zt(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zt=function(e){return typeof e}:Zt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zt(t)}function uh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dh(t,e,r){return e&&$a(t.prototype,e),r&&$a(t,r),t}function za(t,e){var r=t._map,n=t._arrayTreeMap,i=t._objectTreeMap;if(r.has(e))return r.get(e);for(var s=Object.keys(e).sort(),o=Array.isArray(e)?n:i,c=0;c<s.length;c++){var f=s[c];if(o=o.get(f),o===void 0)return;var u=e[f];if(o=o.get(u),o===void 0)return}var d=o.get("_ekm_value");if(d)return r.delete(d[0]),d[0]=e,o.set("_ekm_value",d),r.set(e,d),d}var fh=(function(){function t(e){if(uh(this,t),this.clear(),e instanceof t){var r=[];e.forEach(function(i,s){r.push([s,i])}),e=r}if(e!=null)for(var n=0;n<e.length;n++)this.set(e[n][0],e[n][1])}return dh(t,[{key:"set",value:function(r,n){if(r===null||Zt(r)!=="object")return this._map.set(r,n),this;for(var i=Object.keys(r).sort(),s=[r,n],o=Array.isArray(r)?this._arrayTreeMap:this._objectTreeMap,c=0;c<i.length;c++){var f=i[c];o.has(f)||o.set(f,new t),o=o.get(f);var u=r[f];o.has(u)||o.set(u,new t),o=o.get(u)}var d=o.get("_ekm_value");return d&&this._map.delete(d[0]),o.set("_ekm_value",s),this._map.set(r,s),this}},{key:"get",value:function(r){if(r===null||Zt(r)!=="object")return this._map.get(r);var n=za(this,r);if(n)return n[1]}},{key:"has",value:function(r){return r===null||Zt(r)!=="object"?this._map.has(r):za(this,r)!==void 0}},{key:"delete",value:function(r){return this.has(r)?(this.set(r,void 0),!0):!1}},{key:"forEach",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this;this._map.forEach(function(s,o){o!==null&&Zt(o)==="object"&&(s=s[1]),r.call(i,s,o,n)})}},{key:"clear",value:function(){this._map=new Map,this._arrayTreeMap=new Map,this._objectTreeMap=new Map}},{key:"size",get:function(){return this._map.size}}]),t})();Ja.exports=fh});var gt=we((k_,Xa)=>{Xa.exports=window.wp.url});var mt=we((X_,cc)=>{cc.exports=window.wp.apiFetch});var Rn=we((Z_,lc)=>{lc.exports=window.wp.blocks});var Hs=we((eb,uc)=>{uc.exports=window.wp.i18n});var hu=we((Pb,fu)=>{fu.exports=window.wp.hooks});var Du=we((Ou,Ko)=>{(function(t){if(typeof Ou=="object"&&typeof Ko<"u")Ko.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var e;e=typeof window>"u"?typeof global>"u"?typeof self>"u"?this:self:global:window,e.SimplePeer=t()}})(function(){var t=Math.floor,e=Math.abs,r=Math.pow;return(function(){function n(i,s,o){function c(d,h){if(!s[d]){if(!i[d]){var p=typeof yn=="function"&&yn;if(!h&&p)return p(d,!0);if(f)return f(d,!0);var m=new Error("Cannot find module '"+d+"'");throw m.code="MODULE_NOT_FOUND",m}var w=s[d]={exports:{}};i[d][0].call(w.exports,function(b){var R=i[d][1][b];return c(R||b)},w,w.exports,n,i,s,o)}return s[d].exports}for(var f=typeof yn=="function"&&yn,u=0;u<o.length;u++)c(o[u]);return c}return n})()({1:[function(n,i,s){"use strict";function o(_){var E=_.length;if(0<E%4)throw new Error("Invalid string. Length must be a multiple of 4");var C=_.indexOf("=");C===-1&&(C=E);var S=C===E?0:4-C%4;return[C,S]}function c(_,E,C){return 3*(E+C)/4-C}function f(_){var E,C,S=o(_),A=S[0],D=S[1],T=new w(c(_,A,D)),x=0,L=0<D?A-4:A;for(C=0;C<L;C+=4)E=m[_.charCodeAt(C)]<<18|m[_.charCodeAt(C+1)]<<12|m[_.charCodeAt(C+2)]<<6|m[_.charCodeAt(C+3)],T[x++]=255&E>>16,T[x++]=255&E>>8,T[x++]=255&E;return D===2&&(E=m[_.charCodeAt(C)]<<2|m[_.charCodeAt(C+1)]>>4,T[x++]=255&E),D===1&&(E=m[_.charCodeAt(C)]<<10|m[_.charCodeAt(C+1)]<<4|m[_.charCodeAt(C+2)]>>2,T[x++]=255&E>>8,T[x++]=255&E),T}function u(_){return p[63&_>>18]+p[63&_>>12]+p[63&_>>6]+p[63&_]}function d(_,E,C){for(var S,A=[],D=E;D<C;D+=3)S=(16711680&_[D]<<16)+(65280&_[D+1]<<8)+(255&_[D+2]),A.push(u(S));return A.join("")}function h(_){for(var E,C=_.length,S=C%3,A=[],D=16383,T=0,x=C-S;T<x;T+=D)A.push(d(_,T,T+D>x?x:T+D));return S===1?(E=_[C-1],A.push(p[E>>2]+p[63&E<<4]+"==")):S===2&&(E=(_[C-2]<<8)+_[C-1],A.push(p[E>>10]+p[63&E>>4]+p[63&E<<2]+"=")),A.join("")}s.byteLength=function(_){var E=o(_),C=E[0],S=E[1];return 3*(C+S)/4-S},s.toByteArray=f,s.fromByteArray=h;for(var p=[],m=[],w=typeof Uint8Array>"u"?Array:Uint8Array,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=0,y=b.length;R<y;++R)p[R]=b[R],m[b.charCodeAt(R)]=R;m[45]=62,m[95]=63},{}],2:[function(){},{}],3:[function(n,i,s){(function(){(function(){"use strict";var o=String.fromCharCode,c=Math.min;function f(a){if(2147483647<a)throw new RangeError('The value "'+a+'" is invalid for option "size"');var l=new Uint8Array(a);return l.__proto__=u.prototype,l}function u(a,l,g){if(typeof a=="number"){if(typeof l=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(a)}return d(a,l,g)}function d(a,l,g){if(typeof a=="string")return w(a,l);if(ArrayBuffer.isView(a))return b(a);if(a==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(I(a,ArrayBuffer)||a&&I(a.buffer,ArrayBuffer))return R(a,l,g);if(typeof a=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var v=a.valueOf&&a.valueOf();if(v!=null&&v!==a)return u.from(v,l,g);var k=y(a);if(k)return k;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof a[Symbol.toPrimitive]=="function")return u.from(a[Symbol.toPrimitive]("string"),l,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function h(a){if(typeof a!="number")throw new TypeError('"size" argument must be of type number');if(0>a)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function p(a,l,g){return h(a),0>=a||l===void 0?f(a):typeof g=="string"?f(a).fill(l,g):f(a).fill(l)}function m(a){return h(a),f(0>a?0:0|_(a))}function w(a,l){if((typeof l!="string"||l==="")&&(l="utf8"),!u.isEncoding(l))throw new TypeError("Unknown encoding: "+l);var g=0|E(a,l),v=f(g),k=v.write(a,l);return k!==g&&(v=v.slice(0,k)),v}function b(a){for(var l=0>a.length?0:0|_(a.length),g=f(l),v=0;v<l;v+=1)g[v]=255&a[v];return g}function R(a,l,g){if(0>l||a.byteLength<l)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<l+(g||0))throw new RangeError('"length" is outside of buffer bounds');var v;return v=l===void 0&&g===void 0?new Uint8Array(a):g===void 0?new Uint8Array(a,l):new Uint8Array(a,l,g),v.__proto__=u.prototype,v}function y(a){if(u.isBuffer(a)){var l=0|_(a.length),g=f(l);return g.length===0||a.copy(g,0,0,l),g}return a.length===void 0?a.type==="Buffer"&&Array.isArray(a.data)?b(a.data):void 0:typeof a.length!="number"||O(a.length)?f(0):b(a)}function _(a){if(a>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|a}function E(a,l){if(u.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||I(a,ArrayBuffer))return a.byteLength;if(typeof a!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);var g=a.length,v=2<arguments.length&&arguments[2]===!0;if(!v&&g===0)return 0;for(var k=!1;;)switch(l){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return pt(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*g;case"hex":return g>>>1;case"base64":return Pe(a).length;default:if(k)return v?-1:pt(a).length;l=(""+l).toLowerCase(),k=!0}}function C(a,l,g){var v=!1;if((l===void 0||0>l)&&(l=0),l>this.length||((g===void 0||g>this.length)&&(g=this.length),0>=g)||(g>>>=0,l>>>=0,g<=l))return"";for(a||(a="utf8");;)switch(a){case"hex":return xt(this,l,g);case"utf8":case"utf-8":return ye(this,l,g);case"ascii":return G(this,l,g);case"latin1":case"binary":return _i(this,l,g);case"base64":return J(this,l,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ht(this,l,g);default:if(v)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),v=!0}}function S(a,l,g){var v=a[l];a[l]=a[g],a[g]=v}function A(a,l,g,v,k){if(a.length===0)return-1;if(typeof g=="string"?(v=g,g=0):2147483647<g?g=2147483647:-2147483648>g&&(g=-2147483648),g=+g,O(g)&&(g=k?0:a.length-1),0>g&&(g=a.length+g),g>=a.length){if(k)return-1;g=a.length-1}else if(0>g)if(k)g=0;else return-1;if(typeof l=="string"&&(l=u.from(l,v)),u.isBuffer(l))return l.length===0?-1:D(a,l,g,v,k);if(typeof l=="number")return l&=255,typeof Uint8Array.prototype.indexOf=="function"?k?Uint8Array.prototype.indexOf.call(a,l,g):Uint8Array.prototype.lastIndexOf.call(a,l,g):D(a,[l],g,v,k);throw new TypeError("val must be string, number or Buffer")}function D(a,l,g,v,k){function U(mn,Rr){return P===1?mn[Rr]:mn.readUInt16BE(Rr*P)}var P=1,W=a.length,ue=l.length;if(v!==void 0&&(v=(v+"").toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(2>a.length||2>l.length)return-1;P=2,W/=2,ue/=2,g/=2}var Z;if(k){var Q=-1;for(Z=g;Z<W;Z++)if(U(a,Z)!==U(l,Q===-1?0:Z-Q))Q!==-1&&(Z-=Z-Q),Q=-1;else if(Q===-1&&(Q=Z),Z-Q+1===ue)return Q*P}else for(g+ue>W&&(g=W-ue),Z=g;0<=Z;Z--){for(var X=!0,Sr=0;Sr<ue;Sr++)if(U(a,Z+Sr)!==U(l,Sr)){X=!1;break}if(X)return Z}return-1}function T(a,l,g,v){g=+g||0;var k=a.length-g;v?(v=+v,v>k&&(v=k)):v=k;var U=l.length;v>U/2&&(v=U/2);for(var P,W=0;W<v;++W){if(P=parseInt(l.substr(2*W,2),16),O(P))return W;a[g+W]=P}return W}function x(a,l,g,v){return ze(pt(l,a.length-g),a,g,v)}function L(a,l,g,v){return ze(pn(l),a,g,v)}function M(a,l,g,v){return L(a,l,g,v)}function K(a,l,g,v){return ze(Pe(l),a,g,v)}function q(a,l,g,v){return ze(gn(l,a.length-g),a,g,v)}function J(a,l,g){return l===0&&g===a.length?N.fromByteArray(a):N.fromByteArray(a.slice(l,g))}function ye(a,l,g){g=c(a.length,g);for(var v=[],k=l;k<g;){var U=a[k],P=null,W=239<U?4:223<U?3:191<U?2:1;if(k+W<=g){var ue,Z,Q,X;W===1?128>U&&(P=U):W===2?(ue=a[k+1],(192&ue)==128&&(X=(31&U)<<6|63&ue,127<X&&(P=X))):W===3?(ue=a[k+1],Z=a[k+2],(192&ue)==128&&(192&Z)==128&&(X=(15&U)<<12|(63&ue)<<6|63&Z,2047<X&&(55296>X||57343<X)&&(P=X))):W===4&&(ue=a[k+1],Z=a[k+2],Q=a[k+3],(192&ue)==128&&(192&Z)==128&&(192&Q)==128&&(X=(15&U)<<18|(63&ue)<<12|(63&Z)<<6|63&Q,65535<X&&1114112>X&&(P=X)))}P===null?(P=65533,W=1):65535<P&&(P-=65536,v.push(55296|1023&P>>>10),P=56320|1023&P),v.push(P),k+=W}return Me(v)}function Me(a){var l=a.length;if(l<=4096)return o.apply(String,a);for(var g="",v=0;v<l;)g+=o.apply(String,a.slice(v,v+=4096));return g}function G(a,l,g){var v="";g=c(a.length,g);for(var k=l;k<g;++k)v+=o(127&a[k]);return v}function _i(a,l,g){var v="";g=c(a.length,g);for(var k=l;k<g;++k)v+=o(a[k]);return v}function xt(a,l,g){var v=a.length;(!l||0>l)&&(l=0),(!g||0>g||g>v)&&(g=v);for(var k="",U=l;U<g;++U)k+=hn(a[U]);return k}function ht(a,l,g){for(var v=a.slice(l,g),k="",U=0;U<v.length;U+=2)k+=o(v[U]+256*v[U+1]);return k}function se(a,l,g){if(a%1!=0||0>a)throw new RangeError("offset is not uint");if(a+l>g)throw new RangeError("Trying to access beyond buffer length")}function oe(a,l,g,v,k,U){if(!u.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(l>k||l<U)throw new RangeError('"value" argument is out of bounds');if(g+v>a.length)throw new RangeError("Index out of range")}function At(a,l,g,v){if(g+v>a.length)throw new RangeError("Index out of range");if(0>g)throw new RangeError("Index out of range")}function $e(a,l,g,v,k){return l=+l,g>>>=0,k||At(a,l,g,4,34028234663852886e22,-34028234663852886e22),j.write(a,l,g,v,23,4),g+4}function It(a,l,g,v,k){return l=+l,g>>>=0,k||At(a,l,g,8,17976931348623157e292,-17976931348623157e292),j.write(a,l,g,v,52,8),g+8}function $t(a){if(a=a.split("=")[0],a=a.trim().replace(H,""),2>a.length)return"";for(;a.length%4!=0;)a+="=";return a}function hn(a){return 16>a?"0"+a.toString(16):a.toString(16)}function pt(a,l){l=l||1/0;for(var g,v=a.length,k=null,U=[],P=0;P<v;++P){if(g=a.charCodeAt(P),55295<g&&57344>g){if(!k){if(56319<g){-1<(l-=3)&&U.push(239,191,189);continue}else if(P+1===v){-1<(l-=3)&&U.push(239,191,189);continue}k=g;continue}if(56320>g){-1<(l-=3)&&U.push(239,191,189),k=g;continue}g=(k-55296<<10|g-56320)+65536}else k&&-1<(l-=3)&&U.push(239,191,189);if(k=null,128>g){if(0>(l-=1))break;U.push(g)}else if(2048>g){if(0>(l-=2))break;U.push(192|g>>6,128|63&g)}else if(65536>g){if(0>(l-=3))break;U.push(224|g>>12,128|63&g>>6,128|63&g)}else if(1114112>g){if(0>(l-=4))break;U.push(240|g>>18,128|63&g>>12,128|63&g>>6,128|63&g)}else throw new Error("Invalid code point")}return U}function pn(a){for(var l=[],g=0;g<a.length;++g)l.push(255&a.charCodeAt(g));return l}function gn(a,l){for(var g,v,k,U=[],P=0;P<a.length&&!(0>(l-=2));++P)g=a.charCodeAt(P),v=g>>8,k=g%256,U.push(k),U.push(v);return U}function Pe(a){return N.toByteArray($t(a))}function ze(a,l,g,v){for(var k=0;k<v&&!(k+g>=l.length||k>=a.length);++k)l[k+g]=a[k];return k}function I(a,l){return a instanceof l||a!=null&&a.constructor!=null&&a.constructor.name!=null&&a.constructor.name===l.name}function O(a){return a!==a}var N=n("base64-js"),j=n("ieee754");s.Buffer=u,s.SlowBuffer=function(a){return+a!=a&&(a=0),u.alloc(+a)},s.INSPECT_MAX_BYTES=50,s.kMaxLength=2147483647,u.TYPED_ARRAY_SUPPORT=(function(){try{var a=new Uint8Array(1);return a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},a.foo()===42}catch{return!1}})(),u.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(a,l,g){return d(a,l,g)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(a,l,g){return p(a,l,g)},u.allocUnsafe=function(a){return m(a)},u.allocUnsafeSlow=function(a){return m(a)},u.isBuffer=function(a){return a!=null&&a._isBuffer===!0&&a!==u.prototype},u.compare=function(a,l){if(I(a,Uint8Array)&&(a=u.from(a,a.offset,a.byteLength)),I(l,Uint8Array)&&(l=u.from(l,l.offset,l.byteLength)),!u.isBuffer(a)||!u.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===l)return 0;for(var g=a.length,v=l.length,k=0,U=c(g,v);k<U;++k)if(a[k]!==l[k]){g=a[k],v=l[k];break}return g<v?-1:v<g?1:0},u.isEncoding=function(a){switch((a+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(a,l){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return u.alloc(0);var g;if(l===void 0)for(l=0,g=0;g<a.length;++g)l+=a[g].length;var v=u.allocUnsafe(l),k=0;for(g=0;g<a.length;++g){var U=a[g];if(I(U,Uint8Array)&&(U=u.from(U)),!u.isBuffer(U))throw new TypeError('"list" argument must be an Array of Buffers');U.copy(v,k),k+=U.length}return v},u.byteLength=E,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var a=this.length;if(a%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var l=0;l<a;l+=2)S(this,l,l+1);return this},u.prototype.swap32=function(){var a=this.length;if(a%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var l=0;l<a;l+=4)S(this,l,l+3),S(this,l+1,l+2);return this},u.prototype.swap64=function(){var a=this.length;if(a%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var l=0;l<a;l+=8)S(this,l,l+7),S(this,l+1,l+6),S(this,l+2,l+5),S(this,l+3,l+4);return this},u.prototype.toString=function(){var a=this.length;return a===0?"":arguments.length===0?ye(this,0,a):C.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(a){if(!u.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||u.compare(this,a)===0},u.prototype.inspect=function(){var a="",l=s.INSPECT_MAX_BYTES;return a=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(a+=" ... "),"<Buffer "+a+">"},u.prototype.compare=function(a,l,g,v,k){if(I(a,Uint8Array)&&(a=u.from(a,a.offset,a.byteLength)),!u.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(l===void 0&&(l=0),g===void 0&&(g=a?a.length:0),v===void 0&&(v=0),k===void 0&&(k=this.length),0>l||g>a.length||0>v||k>this.length)throw new RangeError("out of range index");if(v>=k&&l>=g)return 0;if(v>=k)return-1;if(l>=g)return 1;if(l>>>=0,g>>>=0,v>>>=0,k>>>=0,this===a)return 0;for(var U=k-v,P=g-l,W=c(U,P),ue=this.slice(v,k),Z=a.slice(l,g),Q=0;Q<W;++Q)if(ue[Q]!==Z[Q]){U=ue[Q],P=Z[Q];break}return U<P?-1:P<U?1:0},u.prototype.includes=function(a,l,g){return this.indexOf(a,l,g)!==-1},u.prototype.indexOf=function(a,l,g){return A(this,a,l,g,!0)},u.prototype.lastIndexOf=function(a,l,g){return A(this,a,l,g,!1)},u.prototype.write=function(a,l,g,v){if(l===void 0)v="utf8",g=this.length,l=0;else if(g===void 0&&typeof l=="string")v=l,g=this.length,l=0;else if(isFinite(l))l>>>=0,isFinite(g)?(g>>>=0,v===void 0&&(v="utf8")):(v=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var k=this.length-l;if((g===void 0||g>k)&&(g=k),0<a.length&&(0>g||0>l)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");v||(v="utf8");for(var U=!1;;)switch(v){case"hex":return T(this,a,l,g);case"utf8":case"utf-8":return x(this,a,l,g);case"ascii":return L(this,a,l,g);case"latin1":case"binary":return M(this,a,l,g);case"base64":return K(this,a,l,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,a,l,g);default:if(U)throw new TypeError("Unknown encoding: "+v);v=(""+v).toLowerCase(),U=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(a,l){var g=this.length;a=~~a,l=l===void 0?g:~~l,0>a?(a+=g,0>a&&(a=0)):a>g&&(a=g),0>l?(l+=g,0>l&&(l=0)):l>g&&(l=g),l<a&&(l=a);var v=this.subarray(a,l);return v.__proto__=u.prototype,v},u.prototype.readUIntLE=function(a,l,g){a>>>=0,l>>>=0,g||se(a,l,this.length);for(var v=this[a],k=1,U=0;++U<l&&(k*=256);)v+=this[a+U]*k;return v},u.prototype.readUIntBE=function(a,l,g){a>>>=0,l>>>=0,g||se(a,l,this.length);for(var v=this[a+--l],k=1;0<l&&(k*=256);)v+=this[a+--l]*k;return v},u.prototype.readUInt8=function(a,l){return a>>>=0,l||se(a,1,this.length),this[a]},u.prototype.readUInt16LE=function(a,l){return a>>>=0,l||se(a,2,this.length),this[a]|this[a+1]<<8},u.prototype.readUInt16BE=function(a,l){return a>>>=0,l||se(a,2,this.length),this[a]<<8|this[a+1]},u.prototype.readUInt32LE=function(a,l){return a>>>=0,l||se(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},u.prototype.readUInt32BE=function(a,l){return a>>>=0,l||se(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},u.prototype.readIntLE=function(a,l,g){a>>>=0,l>>>=0,g||se(a,l,this.length);for(var v=this[a],k=1,U=0;++U<l&&(k*=256);)v+=this[a+U]*k;return k*=128,v>=k&&(v-=r(2,8*l)),v},u.prototype.readIntBE=function(a,l,g){a>>>=0,l>>>=0,g||se(a,l,this.length);for(var v=l,k=1,U=this[a+--v];0<v&&(k*=256);)U+=this[a+--v]*k;return k*=128,U>=k&&(U-=r(2,8*l)),U},u.prototype.readInt8=function(a,l){return a>>>=0,l||se(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},u.prototype.readInt16LE=function(a,l){a>>>=0,l||se(a,2,this.length);var g=this[a]|this[a+1]<<8;return 32768&g?4294901760|g:g},u.prototype.readInt16BE=function(a,l){a>>>=0,l||se(a,2,this.length);var g=this[a+1]|this[a]<<8;return 32768&g?4294901760|g:g},u.prototype.readInt32LE=function(a,l){return a>>>=0,l||se(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},u.prototype.readInt32BE=function(a,l){return a>>>=0,l||se(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},u.prototype.readFloatLE=function(a,l){return a>>>=0,l||se(a,4,this.length),j.read(this,a,!0,23,4)},u.prototype.readFloatBE=function(a,l){return a>>>=0,l||se(a,4,this.length),j.read(this,a,!1,23,4)},u.prototype.readDoubleLE=function(a,l){return a>>>=0,l||se(a,8,this.length),j.read(this,a,!0,52,8)},u.prototype.readDoubleBE=function(a,l){return a>>>=0,l||se(a,8,this.length),j.read(this,a,!1,52,8)},u.prototype.writeUIntLE=function(a,l,g,v){if(a=+a,l>>>=0,g>>>=0,!v){var k=r(2,8*g)-1;oe(this,a,l,g,k,0)}var U=1,P=0;for(this[l]=255&a;++P<g&&(U*=256);)this[l+P]=255&a/U;return l+g},u.prototype.writeUIntBE=function(a,l,g,v){if(a=+a,l>>>=0,g>>>=0,!v){var k=r(2,8*g)-1;oe(this,a,l,g,k,0)}var U=g-1,P=1;for(this[l+U]=255&a;0<=--U&&(P*=256);)this[l+U]=255&a/P;return l+g},u.prototype.writeUInt8=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,1,255,0),this[l]=255&a,l+1},u.prototype.writeUInt16LE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,2,65535,0),this[l]=255&a,this[l+1]=a>>>8,l+2},u.prototype.writeUInt16BE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,2,65535,0),this[l]=a>>>8,this[l+1]=255&a,l+2},u.prototype.writeUInt32LE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,4,4294967295,0),this[l+3]=a>>>24,this[l+2]=a>>>16,this[l+1]=a>>>8,this[l]=255&a,l+4},u.prototype.writeUInt32BE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,4,4294967295,0),this[l]=a>>>24,this[l+1]=a>>>16,this[l+2]=a>>>8,this[l+3]=255&a,l+4},u.prototype.writeIntLE=function(a,l,g,v){if(a=+a,l>>>=0,!v){var k=r(2,8*g-1);oe(this,a,l,g,k-1,-k)}var U=0,P=1,W=0;for(this[l]=255&a;++U<g&&(P*=256);)0>a&&W===0&&this[l+U-1]!==0&&(W=1),this[l+U]=255&(a/P>>0)-W;return l+g},u.prototype.writeIntBE=function(a,l,g,v){if(a=+a,l>>>=0,!v){var k=r(2,8*g-1);oe(this,a,l,g,k-1,-k)}var U=g-1,P=1,W=0;for(this[l+U]=255&a;0<=--U&&(P*=256);)0>a&&W===0&&this[l+U+1]!==0&&(W=1),this[l+U]=255&(a/P>>0)-W;return l+g},u.prototype.writeInt8=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,1,127,-128),0>a&&(a=255+a+1),this[l]=255&a,l+1},u.prototype.writeInt16LE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,2,32767,-32768),this[l]=255&a,this[l+1]=a>>>8,l+2},u.prototype.writeInt16BE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,2,32767,-32768),this[l]=a>>>8,this[l+1]=255&a,l+2},u.prototype.writeInt32LE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,4,2147483647,-2147483648),this[l]=255&a,this[l+1]=a>>>8,this[l+2]=a>>>16,this[l+3]=a>>>24,l+4},u.prototype.writeInt32BE=function(a,l,g){return a=+a,l>>>=0,g||oe(this,a,l,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),this[l]=a>>>24,this[l+1]=a>>>16,this[l+2]=a>>>8,this[l+3]=255&a,l+4},u.prototype.writeFloatLE=function(a,l,g){return $e(this,a,l,!0,g)},u.prototype.writeFloatBE=function(a,l,g){return $e(this,a,l,!1,g)},u.prototype.writeDoubleLE=function(a,l,g){return It(this,a,l,!0,g)},u.prototype.writeDoubleBE=function(a,l,g){return It(this,a,l,!1,g)},u.prototype.copy=function(a,l,g,v){if(!u.isBuffer(a))throw new TypeError("argument should be a Buffer");if(g||(g=0),v||v===0||(v=this.length),l>=a.length&&(l=a.length),l||(l=0),0<v&&v<g&&(v=g),v===g||a.length===0||this.length===0)return 0;if(0>l)throw new RangeError("targetStart out of bounds");if(0>g||g>=this.length)throw new RangeError("Index out of range");if(0>v)throw new RangeError("sourceEnd out of bounds");v>this.length&&(v=this.length),a.length-l<v-g&&(v=a.length-l+g);var k=v-g;if(this===a&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(l,g,v);else if(this===a&&g<l&&l<v)for(var U=k-1;0<=U;--U)a[U+l]=this[U+g];else Uint8Array.prototype.set.call(a,this.subarray(g,v),l);return k},u.prototype.fill=function(a,l,g,v){if(typeof a=="string"){if(typeof l=="string"?(v=l,l=0,g=this.length):typeof g=="string"&&(v=g,g=this.length),v!==void 0&&typeof v!="string")throw new TypeError("encoding must be a string");if(typeof v=="string"&&!u.isEncoding(v))throw new TypeError("Unknown encoding: "+v);if(a.length===1){var k=a.charCodeAt(0);(v==="utf8"&&128>k||v==="latin1")&&(a=k)}}else typeof a=="number"&&(a&=255);if(0>l||this.length<l||this.length<g)throw new RangeError("Out of range index");if(g<=l)return this;l>>>=0,g=g===void 0?this.length:g>>>0,a||(a=0);var U;if(typeof a=="number")for(U=l;U<g;++U)this[U]=a;else{var P=u.isBuffer(a)?a:u.from(a,v),W=P.length;if(W===0)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(U=0;U<g-l;++U)this[U+l]=P[U%W]}return this};var H=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,n("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(n,i,s){(function(o){(function(){function c(){let u;try{u=s.storage.getItem("debug")}catch{}return!u&&typeof o<"u"&&"env"in o&&(u=o.env.DEBUG),u}s.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;let d="color: "+this.color;u.splice(1,0,d,"color: inherit");let h=0,p=0;u[0].replace(/%[a-zA-Z%]/g,m=>{m==="%%"||(h++,m==="%c"&&(p=h))}),u.splice(p,0,d)},s.save=function(u){try{u?s.storage.setItem("debug",u):s.storage.removeItem("debug")}catch{}},s.load=c,s.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},s.storage=(function(){try{return localStorage}catch{}})(),s.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],s.log=console.debug||console.log||(()=>{}),i.exports=n("./common")(s);let{formatters:f}=i.exports;f.j=function(u){try{return JSON.stringify(u)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}).call(this)}).call(this,n("_process"))},{"./common":5,_process:12}],5:[function(n,i){i.exports=function(s){function o(u){function d(...m){if(!d.enabled)return;let w=d,b=+new Date,R=b-(h||b);w.diff=R,w.prev=h,w.curr=b,h=b,m[0]=o.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let y=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(E,C)=>{if(E==="%%")return"%";y++;let S=o.formatters[C];if(typeof S=="function"){let A=m[y];E=S.call(w,A),m.splice(y,1),y--}return E}),o.formatArgs.call(w,m),(w.log||o.log).apply(w,m)}let h,p=null;return d.namespace=u,d.useColors=o.useColors(),d.color=o.selectColor(u),d.extend=c,d.destroy=o.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>p===null?o.enabled(u):p,set:m=>{p=m}}),typeof o.init=="function"&&o.init(d),d}function c(u,d){let h=o(this.namespace+(typeof d>"u"?":":d)+u);return h.log=this.log,h}function f(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}return o.debug=o,o.default=o,o.coerce=function(u){return u instanceof Error?u.stack||u.message:u},o.disable=function(){let u=[...o.names.map(f),...o.skips.map(f).map(d=>"-"+d)].join(",");return o.enable(""),u},o.enable=function(u){o.save(u),o.names=[],o.skips=[];let d,h=(typeof u=="string"?u:"").split(/[\s,]+/),p=h.length;for(d=0;d<p;d++)h[d]&&(u=h[d].replace(/\*/g,".*?"),u[0]==="-"?o.skips.push(new RegExp("^"+u.substr(1)+"$")):o.names.push(new RegExp("^"+u+"$")))},o.enabled=function(u){if(u[u.length-1]==="*")return!0;let d,h;for(d=0,h=o.skips.length;d<h;d++)if(o.skips[d].test(u))return!1;for(d=0,h=o.names.length;d<h;d++)if(o.names[d].test(u))return!0;return!1},o.humanize=n("ms"),o.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(s).forEach(u=>{o[u]=s[u]}),o.names=[],o.skips=[],o.formatters={},o.selectColor=function(u){let d=0;for(let h=0;h<u.length;h++)d=(d<<5)-d+u.charCodeAt(h),d|=0;return o.colors[e(d)%o.colors.length]},o.enable(o.load()),o}},{ms:11}],6:[function(n,i){"use strict";function s(o,c){for(let f in c)Object.defineProperty(o,f,{value:c[f],enumerable:!0,configurable:!0});return o}i.exports=function(o,c,f){if(!o||typeof o=="string")throw new TypeError("Please pass an Error to err-code");f||(f={}),typeof c=="object"&&(f=c,c=""),c&&(f.code=c);try{return s(o,f)}catch{f.message=o.message,f.stack=o.stack;let d=function(){};return d.prototype=Object.create(Object.getPrototypeOf(o)),s(new d,f)}}},{}],7:[function(n,i){"use strict";function s(T){console&&console.warn&&console.warn(T)}function o(){o.init.call(this)}function c(T){if(typeof T!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof T)}function f(T){return T._maxListeners===void 0?o.defaultMaxListeners:T._maxListeners}function u(T,x,L,M){var K,q,J;if(c(L),q=T._events,q===void 0?(q=T._events=Object.create(null),T._eventsCount=0):(q.newListener!==void 0&&(T.emit("newListener",x,L.listener?L.listener:L),q=T._events),J=q[x]),J===void 0)J=q[x]=L,++T._eventsCount;else if(typeof J=="function"?J=q[x]=M?[L,J]:[J,L]:M?J.unshift(L):J.push(L),K=f(T),0<K&&J.length>K&&!J.warned){J.warned=!0;var ye=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+(x+" listeners added. Use emitter.setMaxListeners() to increase limit"));ye.name="MaxListenersExceededWarning",ye.emitter=T,ye.type=x,ye.count=J.length,s(ye)}return T}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(T,x,L){var M={fired:!1,wrapFn:void 0,target:T,type:x,listener:L},K=d.bind(M);return K.listener=L,M.wrapFn=K,K}function p(T,x,L){var M=T._events;if(M===void 0)return[];var K=M[x];return K===void 0?[]:typeof K=="function"?L?[K.listener||K]:[K]:L?R(K):w(K,K.length)}function m(T){var x=this._events;if(x!==void 0){var L=x[T];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}function w(T,x){for(var L=Array(x),M=0;M<x;++M)L[M]=T[M];return L}function b(T,x){for(;x+1<T.length;x++)T[x]=T[x+1];T.pop()}function R(T){for(var x=Array(T.length),L=0;L<x.length;++L)x[L]=T[L].listener||T[L];return x}function y(T,x,L){typeof T.on=="function"&&_(T,"error",x,L)}function _(T,x,L,M){if(typeof T.on=="function")M.once?T.once(x,L):T.on(x,L);else if(typeof T.addEventListener=="function")T.addEventListener(x,function K(q){M.once&&T.removeEventListener(x,K),L(q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof T)}var E,C=typeof Reflect=="object"?Reflect:null,S=C&&typeof C.apply=="function"?C.apply:function(T,x,L){return Function.prototype.apply.call(T,x,L)};E=C&&typeof C.ownKeys=="function"?C.ownKeys:Object.getOwnPropertySymbols?function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:function(T){return Object.getOwnPropertyNames(T)};var A=Number.isNaN||function(T){return T!==T};i.exports=o,i.exports.once=function(T,x){return new Promise(function(L,M){function K(J){T.removeListener(x,q),M(J)}function q(){typeof T.removeListener=="function"&&T.removeListener("error",K),L([].slice.call(arguments))}_(T,x,q,{once:!0}),x!=="error"&&y(T,K,{once:!0})})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var D=10;Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return D},set:function(T){if(typeof T!="number"||0>T||A(T))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+T+".");D=T}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(T){if(typeof T!="number"||0>T||A(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(T){for(var x=[],L=1;L<arguments.length;L++)x.push(arguments[L]);var M=T==="error",K=this._events;if(K!==void 0)M=M&&K.error===void 0;else if(!M)return!1;if(M){var q;if(0<x.length&&(q=x[0]),q instanceof Error)throw q;var J=new Error("Unhandled error."+(q?" ("+q.message+")":""));throw J.context=q,J}var ye=K[T];if(ye===void 0)return!1;if(typeof ye=="function")S(ye,this,x);else for(var Me=ye.length,G=w(ye,Me),L=0;L<Me;++L)S(G[L],this,x);return!0},o.prototype.addListener=function(T,x){return u(this,T,x,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(T,x){return u(this,T,x,!0)},o.prototype.once=function(T,x){return c(x),this.on(T,h(this,T,x)),this},o.prototype.prependOnceListener=function(T,x){return c(x),this.prependListener(T,h(this,T,x)),this},o.prototype.removeListener=function(T,x){var L,M,K,q,J;if(c(x),M=this._events,M===void 0)return this;if(L=M[T],L===void 0)return this;if(L===x||L.listener===x)--this._eventsCount==0?this._events=Object.create(null):(delete M[T],M.removeListener&&this.emit("removeListener",T,L.listener||x));else if(typeof L!="function"){for(K=-1,q=L.length-1;0<=q;q--)if(L[q]===x||L[q].listener===x){J=L[q].listener,K=q;break}if(0>K)return this;K===0?L.shift():b(L,K),L.length===1&&(M[T]=L[0]),M.removeListener!==void 0&&this.emit("removeListener",T,J||x)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(T){var x,L,M;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[T]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete L[T]),this;if(arguments.length===0){var K,q=Object.keys(L);for(M=0;M<q.length;++M)K=q[M],K!=="removeListener"&&this.removeAllListeners(K);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(x=L[T],typeof x=="function")this.removeListener(T,x);else if(x!==void 0)for(M=x.length-1;0<=M;M--)this.removeListener(T,x[M]);return this},o.prototype.listeners=function(T){return p(this,T,!0)},o.prototype.rawListeners=function(T){return p(this,T,!1)},o.listenerCount=function(T,x){return typeof T.listenerCount=="function"?T.listenerCount(x):m.call(T,x)},o.prototype.listenerCount=m,o.prototype.eventNames=function(){return 0<this._eventsCount?E(this._events):[]}},{}],8:[function(n,i){i.exports=function(){if(typeof globalThis>"u")return null;var s={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return s.RTCPeerConnection?s:null}},{}],9:[function(n,i,s){s.read=function(o,c,f,u,d){var h,p,m=8*d-u-1,w=(1<<m)-1,b=w>>1,R=-7,y=f?d-1:0,_=f?-1:1,E=o[c+y];for(y+=_,h=E&(1<<-R)-1,E>>=-R,R+=m;0<R;h=256*h+o[c+y],y+=_,R-=8);for(p=h&(1<<-R)-1,h>>=-R,R+=u;0<R;p=256*p+o[c+y],y+=_,R-=8);if(h===0)h=1-b;else{if(h===w)return p?NaN:(E?-1:1)*(1/0);p+=r(2,u),h-=b}return(E?-1:1)*p*r(2,h-u)},s.write=function(o,c,f,u,d,h){var p,m,w,b=Math.LN2,R=Math.log,y=8*h-d-1,_=(1<<y)-1,E=_>>1,C=d===23?r(2,-24)-r(2,-77):0,S=u?0:h-1,A=u?1:-1,D=0>c||c===0&&0>1/c?1:0;for(c=e(c),isNaN(c)||c===1/0?(m=isNaN(c)?1:0,p=_):(p=t(R(c)/b),1>c*(w=r(2,-p))&&(p--,w*=2),c+=1<=p+E?C/w:C*r(2,1-E),2<=c*w&&(p++,w/=2),p+E>=_?(m=0,p=_):1<=p+E?(m=(c*w-1)*r(2,d),p+=E):(m=c*r(2,E-1)*r(2,d),p=0));8<=d;o[f+S]=255&m,S+=A,m/=256,d-=8);for(p=p<<d|m,y+=d;0<y;o[f+S]=255&p,S+=A,p/=256,y-=8);o[f+S-A]|=128*D}},{}],10:[function(n,i){i.exports=typeof Object.create=="function"?function(s,o){o&&(s.super_=o,s.prototype=Object.create(o.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:function(s,o){if(o){s.super_=o;var c=function(){};c.prototype=o.prototype,s.prototype=new c,s.prototype.constructor=s}}},{}],11:[function(n,i){var s=Math.round;function o(h){if(h+="",!(100<h.length)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h);if(p){var m=parseFloat(p[1]),w=(p[2]||"ms").toLowerCase();return w==="years"||w==="year"||w==="yrs"||w==="yr"||w==="y"?315576e5*m:w==="weeks"||w==="week"||w==="w"?6048e5*m:w==="days"||w==="day"||w==="d"?864e5*m:w==="hours"||w==="hour"||w==="hrs"||w==="hr"||w==="h"?36e5*m:w==="minutes"||w==="minute"||w==="mins"||w==="min"||w==="m"?6e4*m:w==="seconds"||w==="second"||w==="secs"||w==="sec"||w==="s"?1e3*m:w==="milliseconds"||w==="millisecond"||w==="msecs"||w==="msec"||w==="ms"?m:void 0}}}function c(h){var p=e(h);return 864e5<=p?s(h/864e5)+"d":36e5<=p?s(h/36e5)+"h":6e4<=p?s(h/6e4)+"m":1e3<=p?s(h/1e3)+"s":h+"ms"}function f(h){var p=e(h);return 864e5<=p?u(h,p,864e5,"day"):36e5<=p?u(h,p,36e5,"hour"):6e4<=p?u(h,p,6e4,"minute"):1e3<=p?u(h,p,1e3,"second"):h+" ms"}function u(h,p,m,w){return s(h/m)+" "+w+(p>=1.5*m?"s":"")}var d=24*(60*6e4);i.exports=function(h,p){p=p||{};var m=typeof h;if(m=="string"&&0<h.length)return o(h);if(m==="number"&&isFinite(h))return p.long?f(h):c(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))}},{}],12:[function(n,i){function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function c(C){if(m===setTimeout)return setTimeout(C,0);if((m===s||!m)&&setTimeout)return m=setTimeout,setTimeout(C,0);try{return m(C,0)}catch{try{return m.call(null,C,0)}catch{return m.call(this,C,0)}}}function f(C){if(w===clearTimeout)return clearTimeout(C);if((w===o||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(C);try{return w(C)}catch{try{return w.call(null,C)}catch{return w.call(this,C)}}}function u(){_&&R&&(_=!1,R.length?y=R.concat(y):E=-1,y.length&&d())}function d(){if(!_){var C=c(u);_=!0;for(var S=y.length;S;){for(R=y,y=[];++E<S;)R&&R[E].run();E=-1,S=y.length}R=null,_=!1,f(C)}}function h(C,S){this.fun=C,this.array=S}function p(){}var m,w,b=i.exports={};(function(){try{m=typeof setTimeout=="function"?setTimeout:s}catch{m=s}try{w=typeof clearTimeout=="function"?clearTimeout:o}catch{w=o}})();var R,y=[],_=!1,E=-1;b.nextTick=function(C){var S=Array(arguments.length-1);if(1<arguments.length)for(var A=1;A<arguments.length;A++)S[A-1]=arguments[A];y.push(new h(C,S)),y.length!==1||_||c(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=p,b.addListener=p,b.once=p,b.off=p,b.removeListener=p,b.removeAllListeners=p,b.emit=p,b.prependListener=p,b.prependOnceListener=p,b.listeners=function(){return[]},b.binding=function(){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},{}],13:[function(n,i){(function(s){(function(){let o;i.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?s:window):c=>(o||(o=Promise.resolve())).then(c).catch(f=>setTimeout(()=>{throw f},0))}).call(this)}).call(this,typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{}],14:[function(n,i){(function(s,o){(function(){"use strict";var c=n("safe-buffer").Buffer,f=o.crypto||o.msCrypto;i.exports=f&&f.getRandomValues?function(u,d){if(u>4294967295)throw new RangeError("requested too many random bytes");var h=c.allocUnsafe(u);if(0<u)if(65536<u)for(var p=0;p<u;p+=65536)f.getRandomValues(h.slice(p,p+65536));else f.getRandomValues(h);return typeof d=="function"?s.nextTick(function(){d(null,h)}):h}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,n("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{_process:12,"safe-buffer":30}],15:[function(n,i){"use strict";function s(p,m){p.prototype=Object.create(m.prototype),p.prototype.constructor=p,p.__proto__=m}function o(p,m,w){function b(y,_,E){return typeof m=="string"?m:m(y,_,E)}w||(w=Error);var R=(function(y){function _(E,C,S){return y.call(this,b(E,C,S))||this}return s(_,y),_})(w);R.prototype.name=w.name,R.prototype.code=p,h[p]=R}function c(p,m){if(Array.isArray(p)){var w=p.length;return p=p.map(function(b){return b+""}),2<w?"one of ".concat(m," ").concat(p.slice(0,w-1).join(", "),", or ")+p[w-1]:w===2?"one of ".concat(m," ").concat(p[0]," or ").concat(p[1]):"of ".concat(m," ").concat(p[0])}return"of ".concat(m," ").concat(p+"")}function f(p,m,w){return p.substr(!w||0>w?0:+w,m.length)===m}function u(p,m,w){return(w===void 0||w>p.length)&&(w=p.length),p.substring(w-m.length,w)===m}function d(p,m,w){return typeof w!="number"&&(w=0),!(w+m.length>p.length)&&p.indexOf(m,w)!==-1}var h={};o("ERR_INVALID_OPT_VALUE",function(p,m){return'The value "'+m+'" is invalid for option "'+p+'"'},TypeError),o("ERR_INVALID_ARG_TYPE",function(p,m,w){var b;typeof m=="string"&&f(m,"not ")?(b="must not be",m=m.replace(/^not /,"")):b="must be";var R;if(u(p," argument"))R="The ".concat(p," ").concat(b," ").concat(c(m,"type"));else{var y=d(p,".")?"property":"argument";R='The "'.concat(p,'" ').concat(y," ").concat(b," ").concat(c(m,"type"))}return R+=". Received type ".concat(typeof w),R},TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",function(p){return"The "+p+" method is not implemented"}),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",function(p){return"Cannot call "+p+" after a stream was destroyed"}),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",function(p){return"Unknown encoding: "+p},TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),i.exports.codes=h},{}],16:[function(n,i){(function(s){(function(){"use strict";function o(b){return this instanceof o?(d.call(this,b),h.call(this,b),this.allowHalfOpen=!0,void(b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",c))))):new o(b)}function c(){this._writableState.ended||s.nextTick(f,this)}function f(b){b.end()}var u=Object.keys||function(b){var R=[];for(var y in b)R.push(y);return R};i.exports=o;var d=n("./_stream_readable"),h=n("./_stream_writable");n("inherits")(o,d);for(var p,m=u(h.prototype),w=0;w<m.length;w++)p=m[w],o.prototype[p]||(o.prototype[p]=h.prototype[p]);Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=b,this._writableState.destroyed=b)}})}).call(this)}).call(this,n("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(n,i){"use strict";function s(c){return this instanceof s?void o.call(this,c):new s(c)}i.exports=s;var o=n("./_stream_transform");n("inherits")(s,o),s.prototype._transform=function(c,f,u){u(null,c)}},{"./_stream_transform":19,inherits:10}],18:[function(n,i){(function(s,o){(function(){"use strict";function c(a){return se.from(a)}function f(a){return se.isBuffer(a)||a instanceof oe}function u(a,l,g){return typeof a.prependListener=="function"?a.prependListener(l,g):void(a._events&&a._events[l]?Array.isArray(a._events[l])?a._events[l].unshift(g):a._events[l]=[g,a._events[l]]:a.on(l,g))}function d(a,l,g){Me=Me||n("./_stream_duplex"),a=a||{},typeof g!="boolean"&&(g=l instanceof Me),this.objectMode=!!a.objectMode,g&&(this.objectMode=this.objectMode||!!a.readableObjectMode),this.highWaterMark=gn(this,a,"readableHighWaterMark",g),this.buffer=new hn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=a.emitClose!==!1,this.autoDestroy=!!a.autoDestroy,this.destroyed=!1,this.defaultEncoding=a.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,a.encoding&&(!$e&&($e=n("string_decoder/").StringDecoder),this.decoder=new $e(a.encoding),this.encoding=a.encoding)}function h(a){if(Me=Me||n("./_stream_duplex"),!(this instanceof h))return new h(a);var l=this instanceof Me;this._readableState=new d(a,this,l),this.readable=!0,a&&(typeof a.read=="function"&&(this._read=a.read),typeof a.destroy=="function"&&(this._destroy=a.destroy)),ht.call(this)}function p(a,l,g,v,k){G("readableAddChunk",l);var U=a._readableState;if(l===null)U.reading=!1,y(a,U);else{var P;if(k||(P=w(U,l)),P)j(a,P);else if(!(U.objectMode||l&&0<l.length))v||(U.reading=!1,C(a,U));else if(typeof l=="string"||U.objectMode||Object.getPrototypeOf(l)===se.prototype||(l=c(l)),v)U.endEmitted?j(a,new N):m(a,U,l,!0);else if(U.ended)j(a,new I);else{if(U.destroyed)return!1;U.reading=!1,U.decoder&&!g?(l=U.decoder.write(l),U.objectMode||l.length!==0?m(a,U,l,!1):C(a,U)):m(a,U,l,!1)}}return!U.ended&&(U.length<U.highWaterMark||U.length===0)}function m(a,l,g,v){l.flowing&&l.length===0&&!l.sync?(l.awaitDrain=0,a.emit("data",g)):(l.length+=l.objectMode?1:g.length,v?l.buffer.unshift(g):l.buffer.push(g),l.needReadable&&_(a)),C(a,l)}function w(a,l){var g;return f(l)||typeof l=="string"||l===void 0||a.objectMode||(g=new ze("chunk",["string","Buffer","Uint8Array"],l)),g}function b(a){return 1073741824<=a?a=1073741824:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function R(a,l){return 0>=a||l.length===0&&l.ended?0:l.objectMode?1:a===a?(a>l.highWaterMark&&(l.highWaterMark=b(a)),a<=l.length?a:l.ended?l.length:(l.needReadable=!0,0)):l.flowing&&l.length?l.buffer.head.data.length:l.length}function y(a,l){if(G("onEofChunk"),!l.ended){if(l.decoder){var g=l.decoder.end();g&&g.length&&(l.buffer.push(g),l.length+=l.objectMode?1:g.length)}l.ended=!0,l.sync?_(a):(l.needReadable=!1,!l.emittedReadable&&(l.emittedReadable=!0,E(a)))}}function _(a){var l=a._readableState;G("emitReadable",l.needReadable,l.emittedReadable),l.needReadable=!1,l.emittedReadable||(G("emitReadable",l.flowing),l.emittedReadable=!0,s.nextTick(E,a))}function E(a){var l=a._readableState;G("emitReadable_",l.destroyed,l.length,l.ended),!l.destroyed&&(l.length||l.ended)&&(a.emit("readable"),l.emittedReadable=!1),l.needReadable=!l.flowing&&!l.ended&&l.length<=l.highWaterMark,M(a)}function C(a,l){l.readingMore||(l.readingMore=!0,s.nextTick(S,a,l))}function S(a,l){for(;!l.reading&&!l.ended&&(l.length<l.highWaterMark||l.flowing&&l.length===0);){var g=l.length;if(G("maybeReadMore read 0"),a.read(0),g===l.length)break}l.readingMore=!1}function A(a){return function(){var l=a._readableState;G("pipeOnDrain",l.awaitDrain),l.awaitDrain&&l.awaitDrain--,l.awaitDrain===0&&xt(a,"data")&&(l.flowing=!0,M(a))}}function D(a){var l=a._readableState;l.readableListening=0<a.listenerCount("readable"),l.resumeScheduled&&!l.paused?l.flowing=!0:0<a.listenerCount("data")&&a.resume()}function T(a){G("readable nexttick read 0"),a.read(0)}function x(a,l){l.resumeScheduled||(l.resumeScheduled=!0,s.nextTick(L,a,l))}function L(a,l){G("resume",l.reading),l.reading||a.read(0),l.resumeScheduled=!1,a.emit("resume"),M(a),l.flowing&&!l.reading&&a.read(0)}function M(a){var l=a._readableState;for(G("flow",l.flowing);l.flowing&&a.read()!==null;);}function K(a,l){if(l.length===0)return null;var g;return l.objectMode?g=l.buffer.shift():!a||a>=l.length?(g=l.decoder?l.buffer.join(""):l.buffer.length===1?l.buffer.first():l.buffer.concat(l.length),l.buffer.clear()):g=l.buffer.consume(a,l.decoder),g}function q(a){var l=a._readableState;G("endReadable",l.endEmitted),l.endEmitted||(l.ended=!0,s.nextTick(J,l,a))}function J(a,l){if(G("endReadableNT",a.endEmitted,a.length),!a.endEmitted&&a.length===0&&(a.endEmitted=!0,l.readable=!1,l.emit("end"),a.autoDestroy)){var g=l._writableState;(!g||g.autoDestroy&&g.finished)&&l.destroy()}}function ye(a,l){for(var g=0,v=a.length;g<v;g++)if(a[g]===l)return g;return-1}i.exports=h;var Me;h.ReadableState=d;var G,_i=n("events").EventEmitter,xt=function(a,l){return a.listeners(l).length},ht=n("./internal/streams/stream"),se=n("buffer").Buffer,oe=o.Uint8Array||function(){},At=n("util");G=At&&At.debuglog?At.debuglog("stream"):function(){};var $e,It,$t,hn=n("./internal/streams/buffer_list"),pt=n("./internal/streams/destroy"),pn=n("./internal/streams/state"),gn=pn.getHighWaterMark,Pe=n("../errors").codes,ze=Pe.ERR_INVALID_ARG_TYPE,I=Pe.ERR_STREAM_PUSH_AFTER_EOF,O=Pe.ERR_METHOD_NOT_IMPLEMENTED,N=Pe.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n("inherits")(h,ht);var j=pt.errorOrDestroy,H=["error","close","destroy","pause","resume"];Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(a){this._readableState&&(this._readableState.destroyed=a)}}),h.prototype.destroy=pt.destroy,h.prototype._undestroy=pt.undestroy,h.prototype._destroy=function(a,l){l(a)},h.prototype.push=function(a,l){var g,v=this._readableState;return v.objectMode?g=!0:typeof a=="string"&&(l=l||v.defaultEncoding,l!==v.encoding&&(a=se.from(a,l),l=""),g=!0),p(this,a,l,!1,g)},h.prototype.unshift=function(a){return p(this,a,null,!0,!1)},h.prototype.isPaused=function(){return this._readableState.flowing===!1},h.prototype.setEncoding=function(a){$e||($e=n("string_decoder/").StringDecoder);var l=new $e(a);this._readableState.decoder=l,this._readableState.encoding=this._readableState.decoder.encoding;for(var g=this._readableState.buffer.head,v="";g!==null;)v+=l.write(g.data),g=g.next;return this._readableState.buffer.clear(),v!==""&&this._readableState.buffer.push(v),this._readableState.length=v.length,this},h.prototype.read=function(a){G("read",a),a=parseInt(a,10);var l=this._readableState,g=a;if(a!==0&&(l.emittedReadable=!1),a===0&&l.needReadable&&((l.highWaterMark===0?0<l.length:l.length>=l.highWaterMark)||l.ended))return G("read: emitReadable",l.length,l.ended),l.length===0&&l.ended?q(this):_(this),null;if(a=R(a,l),a===0&&l.ended)return l.length===0&&q(this),null;var v=l.needReadable;G("need readable",v),(l.length===0||l.length-a<l.highWaterMark)&&(v=!0,G("length less than watermark",v)),l.ended||l.reading?(v=!1,G("reading or ended",v)):v&&(G("do read"),l.reading=!0,l.sync=!0,l.length===0&&(l.needReadable=!0),this._read(l.highWaterMark),l.sync=!1,!l.reading&&(a=R(g,l)));var k;return k=0<a?K(a,l):null,k===null?(l.needReadable=l.length<=l.highWaterMark,a=0):(l.length-=a,l.awaitDrain=0),l.length===0&&(!l.ended&&(l.needReadable=!0),g!==a&&l.ended&&q(this)),k!==null&&this.emit("data",k),k},h.prototype._read=function(){j(this,new O("_read()"))},h.prototype.pipe=function(a,l){function g(Cr,Tr){G("onunpipe"),Cr===Q&&Tr&&Tr.hasUnpiped===!1&&(Tr.hasUnpiped=!0,k())}function v(){G("onend"),a.end()}function k(){G("cleanup"),a.removeListener("close",W),a.removeListener("finish",ue),a.removeListener("drain",Rr),a.removeListener("error",P),a.removeListener("unpipe",g),Q.removeListener("end",v),Q.removeListener("end",Z),Q.removeListener("data",U),Ba=!0,X.awaitDrain&&(!a._writableState||a._writableState.needDrain)&&Rr()}function U(Cr){G("ondata");var Tr=a.write(Cr);G("dest.write",Tr),Tr===!1&&((X.pipesCount===1&&X.pipes===a||1<X.pipesCount&&ye(X.pipes,a)!==-1)&&!Ba&&(G("false write response, pause",X.awaitDrain),X.awaitDrain++),Q.pause())}function P(Cr){G("onerror",Cr),Z(),a.removeListener("error",P),xt(a,"error")===0&&j(a,Cr)}function W(){a.removeListener("finish",ue),Z()}function ue(){G("onfinish"),a.removeListener("close",W),Z()}function Z(){G("unpipe"),Q.unpipe(a)}var Q=this,X=this._readableState;switch(X.pipesCount){case 0:X.pipes=a;break;case 1:X.pipes=[X.pipes,a];break;default:X.pipes.push(a)}X.pipesCount+=1,G("pipe count=%d opts=%j",X.pipesCount,l);var Sr=(!l||l.end!==!1)&&a!==s.stdout&&a!==s.stderr,mn=Sr?v:Z;X.endEmitted?s.nextTick(mn):Q.once("end",mn),a.on("unpipe",g);var Rr=A(Q);a.on("drain",Rr);var Ba=!1;return Q.on("data",U),u(a,"error",P),a.once("close",W),a.once("finish",ue),a.emit("pipe",Q),X.flowing||(G("pipe resume"),Q.resume()),a},h.prototype.unpipe=function(a){var l=this._readableState,g={hasUnpiped:!1};if(l.pipesCount===0)return this;if(l.pipesCount===1)return a&&a!==l.pipes?this:(a||(a=l.pipes),l.pipes=null,l.pipesCount=0,l.flowing=!1,a&&a.emit("unpipe",this,g),this);if(!a){var v=l.pipes,k=l.pipesCount;l.pipes=null,l.pipesCount=0,l.flowing=!1;for(var U=0;U<k;U++)v[U].emit("unpipe",this,{hasUnpiped:!1});return this}var P=ye(l.pipes,a);return P===-1?this:(l.pipes.splice(P,1),l.pipesCount-=1,l.pipesCount===1&&(l.pipes=l.pipes[0]),a.emit("unpipe",this,g),this)},h.prototype.on=function(a,l){var g=ht.prototype.on.call(this,a,l),v=this._readableState;return a==="data"?(v.readableListening=0<this.listenerCount("readable"),v.flowing!==!1&&this.resume()):a=="readable"&&!v.endEmitted&&!v.readableListening&&(v.readableListening=v.needReadable=!0,v.flowing=!1,v.emittedReadable=!1,G("on readable",v.length,v.reading),v.length?_(this):!v.reading&&s.nextTick(T,this)),g},h.prototype.addListener=h.prototype.on,h.prototype.removeListener=function(a,l){var g=ht.prototype.removeListener.call(this,a,l);return a==="readable"&&s.nextTick(D,this),g},h.prototype.removeAllListeners=function(a){var l=ht.prototype.removeAllListeners.apply(this,arguments);return(a==="readable"||a===void 0)&&s.nextTick(D,this),l},h.prototype.resume=function(){var a=this._readableState;return a.flowing||(G("resume"),a.flowing=!a.readableListening,x(this,a)),a.paused=!1,this},h.prototype.pause=function(){return G("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(G("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},h.prototype.wrap=function(a){var l=this,g=this._readableState,v=!1;for(var k in a.on("end",function(){if(G("wrapped end"),g.decoder&&!g.ended){var P=g.decoder.end();P&&P.length&&l.push(P)}l.push(null)}),a.on("data",function(P){if(G("wrapped data"),g.decoder&&(P=g.decoder.write(P)),!(g.objectMode&&P==null)&&(g.objectMode||P&&P.length)){var W=l.push(P);W||(v=!0,a.pause())}}),a)this[k]===void 0&&typeof a[k]=="function"&&(this[k]=(function(P){return function(){return a[P].apply(a,arguments)}})(k));for(var U=0;U<H.length;U++)a.on(H[U],this.emit.bind(this,H[U]));return this._read=function(P){G("wrapped _read",P),v&&(v=!1,a.resume())},this},typeof Symbol=="function"&&(h.prototype[Symbol.asyncIterator]=function(){return It===void 0&&(It=n("./internal/streams/async_iterator")),It(this)}),Object.defineProperty(h.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(h.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(h.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(a){this._readableState&&(this._readableState.flowing=a)}}),h._fromList=K,Object.defineProperty(h.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(h.from=function(a,l){return $t===void 0&&($t=n("./internal/streams/from")),$t(h,a,l)})}).call(this)}).call(this,n("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(n,i){"use strict";function s(b,R){var y=this._transformState;y.transforming=!1;var _=y.writecb;if(_===null)return this.emit("error",new h);y.writechunk=null,y.writecb=null,R!=null&&this.push(R),_(b);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function o(b){return this instanceof o?(w.call(this,b),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&(typeof b.transform=="function"&&(this._transform=b.transform),typeof b.flush=="function"&&(this._flush=b.flush)),void this.on("prefinish",c)):new o(b)}function c(){var b=this;typeof this._flush!="function"||this._readableState.destroyed?f(this,null,null):this._flush(function(R,y){f(b,R,y)})}function f(b,R,y){if(R)return b.emit("error",R);if(y!=null&&b.push(y),b._writableState.length)throw new m;if(b._transformState.transforming)throw new p;return b.push(null)}i.exports=o;var u=n("../errors").codes,d=u.ERR_METHOD_NOT_IMPLEMENTED,h=u.ERR_MULTIPLE_CALLBACK,p=u.ERR_TRANSFORM_ALREADY_TRANSFORMING,m=u.ERR_TRANSFORM_WITH_LENGTH_0,w=n("./_stream_duplex");n("inherits")(o,w),o.prototype.push=function(b,R){return this._transformState.needTransform=!1,w.prototype.push.call(this,b,R)},o.prototype._transform=function(b,R,y){y(new d("_transform()"))},o.prototype._write=function(b,R,y){var _=this._transformState;if(_.writecb=y,_.writechunk=b,_.writeencoding=R,!_.transforming){var E=this._readableState;(_.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},o.prototype._read=function(){var b=this._transformState;b.writechunk===null||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))},o.prototype._destroy=function(b,R){w.prototype._destroy.call(this,b,function(y){R(y)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(n,i){(function(s,o){(function(){"use strict";function c(I){var O=this;this.next=null,this.entry=null,this.finish=function(){q(O,I)}}function f(I){return G.from(I)}function u(I){return G.isBuffer(I)||I instanceof _i}function d(){}function h(I,O,N){J=J||n("./_stream_duplex"),I=I||{},typeof N!="boolean"&&(N=O instanceof J),this.objectMode=!!I.objectMode,N&&(this.objectMode=this.objectMode||!!I.writableObjectMode),this.highWaterMark=se(this,I,"writableHighWaterMark",N),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var j=I.decodeStrings===!1;this.decodeStrings=!j,this.defaultEncoding=I.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(H){C(O,H)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function p(I){J=J||n("./_stream_duplex");var O=this instanceof J;return O||ze.call(p,this)?(this._writableState=new h(I,this,O),this.writable=!0,I&&(typeof I.write=="function"&&(this._write=I.write),typeof I.writev=="function"&&(this._writev=I.writev),typeof I.destroy=="function"&&(this._destroy=I.destroy),typeof I.final=="function"&&(this._final=I.final)),void Me.call(this)):new p(I)}function m(I,O){var N=new pn;Pe(I,N),s.nextTick(O,N)}function w(I,O,N,j){var H;return N===null?H=new pt:typeof N!="string"&&!O.objectMode&&(H=new At("chunk",["string","Buffer"],N)),!H||(Pe(I,H),s.nextTick(j,H),!1)}function b(I,O,N){return I.objectMode||I.decodeStrings===!1||typeof O!="string"||(O=G.from(O,N)),O}function R(I,O,N,j,H,a){if(!N){var l=b(O,j,H);j!==l&&(N=!0,H="buffer",j=l)}var g=O.objectMode?1:j.length;O.length+=g;var v=O.length<O.highWaterMark;if(v||(O.needDrain=!0),O.writing||O.corked){var k=O.lastBufferedRequest;O.lastBufferedRequest={chunk:j,encoding:H,isBuf:N,callback:a,next:null},k?k.next=O.lastBufferedRequest:O.bufferedRequest=O.lastBufferedRequest,O.bufferedRequestCount+=1}else y(I,O,!1,g,j,H,a);return v}function y(I,O,N,j,H,a,l){O.writelen=j,O.writecb=l,O.writing=!0,O.sync=!0,O.destroyed?O.onwrite(new hn("write")):N?I._writev(H,O.onwrite):I._write(H,a,O.onwrite),O.sync=!1}function _(I,O,N,j,H){--O.pendingcb,N?(s.nextTick(H,j),s.nextTick(M,I,O),I._writableState.errorEmitted=!0,Pe(I,j)):(H(j),I._writableState.errorEmitted=!0,Pe(I,j),M(I,O))}function E(I){I.writing=!1,I.writecb=null,I.length-=I.writelen,I.writelen=0}function C(I,O){var N=I._writableState,j=N.sync,H=N.writecb;if(typeof H!="function")throw new It;if(E(N),O)_(I,N,j,O,H);else{var a=T(N)||I.destroyed;a||N.corked||N.bufferProcessing||!N.bufferedRequest||D(I,N),j?s.nextTick(S,I,N,a,H):S(I,N,a,H)}}function S(I,O,N,j){N||A(I,O),O.pendingcb--,j(),M(I,O)}function A(I,O){O.length===0&&O.needDrain&&(O.needDrain=!1,I.emit("drain"))}function D(I,O){O.bufferProcessing=!0;var N=O.bufferedRequest;if(I._writev&&N&&N.next){var j=O.bufferedRequestCount,H=Array(j),a=O.corkedRequestsFree;a.entry=N;for(var l=0,g=!0;N;)H[l]=N,N.isBuf||(g=!1),N=N.next,l+=1;H.allBuffers=g,y(I,O,!0,O.length,H,"",a.finish),O.pendingcb++,O.lastBufferedRequest=null,a.next?(O.corkedRequestsFree=a.next,a.next=null):O.corkedRequestsFree=new c(O),O.bufferedRequestCount=0}else{for(;N;){var v=N.chunk,k=N.encoding,U=N.callback,P=O.objectMode?1:v.length;if(y(I,O,!1,P,v,k,U),N=N.next,O.bufferedRequestCount--,O.writing)break}N===null&&(O.lastBufferedRequest=null)}O.bufferedRequest=N,O.bufferProcessing=!1}function T(I){return I.ending&&I.length===0&&I.bufferedRequest===null&&!I.finished&&!I.writing}function x(I,O){I._final(function(N){O.pendingcb--,N&&Pe(I,N),O.prefinished=!0,I.emit("prefinish"),M(I,O)})}function L(I,O){O.prefinished||O.finalCalled||(typeof I._final!="function"||O.destroyed?(O.prefinished=!0,I.emit("prefinish")):(O.pendingcb++,O.finalCalled=!0,s.nextTick(x,I,O)))}function M(I,O){var N=T(O);if(N&&(L(I,O),O.pendingcb===0&&(O.finished=!0,I.emit("finish"),O.autoDestroy))){var j=I._readableState;(!j||j.autoDestroy&&j.endEmitted)&&I.destroy()}return N}function K(I,O,N){O.ending=!0,M(I,O),N&&(O.finished?s.nextTick(N):I.once("finish",N)),O.ended=!0,I.writable=!1}function q(I,O,N){var j=I.entry;for(I.entry=null;j;){var H=j.callback;O.pendingcb--,H(N),j=j.next}O.corkedRequestsFree.next=I}i.exports=p;var J;p.WritableState=h;var ye={deprecate:n("util-deprecate")},Me=n("./internal/streams/stream"),G=n("buffer").Buffer,_i=o.Uint8Array||function(){},xt=n("./internal/streams/destroy"),ht=n("./internal/streams/state"),se=ht.getHighWaterMark,oe=n("../errors").codes,At=oe.ERR_INVALID_ARG_TYPE,$e=oe.ERR_METHOD_NOT_IMPLEMENTED,It=oe.ERR_MULTIPLE_CALLBACK,$t=oe.ERR_STREAM_CANNOT_PIPE,hn=oe.ERR_STREAM_DESTROYED,pt=oe.ERR_STREAM_NULL_VALUES,pn=oe.ERR_STREAM_WRITE_AFTER_END,gn=oe.ERR_UNKNOWN_ENCODING,Pe=xt.errorOrDestroy;n("inherits")(p,Me),h.prototype.getBuffer=function(){for(var I=this.bufferedRequest,O=[];I;)O.push(I),I=I.next;return O},(function(){try{Object.defineProperty(h.prototype,"buffer",{get:ye.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var ze;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(ze=Function.prototype[Symbol.hasInstance],Object.defineProperty(p,Symbol.hasInstance,{value:function(I){return!!ze.call(this,I)||this===p&&I&&I._writableState instanceof h}})):ze=function(I){return I instanceof this},p.prototype.pipe=function(){Pe(this,new $t)},p.prototype.write=function(I,O,N){var j=this._writableState,H=!1,a=!j.objectMode&&u(I);return a&&!G.isBuffer(I)&&(I=f(I)),typeof O=="function"&&(N=O,O=null),a?O="buffer":!O&&(O=j.defaultEncoding),typeof N!="function"&&(N=d),j.ending?m(this,N):(a||w(this,j,I,N))&&(j.pendingcb++,H=R(this,j,a,I,O,N)),H},p.prototype.cork=function(){this._writableState.corked++},p.prototype.uncork=function(){var I=this._writableState;I.corked&&(I.corked--,!I.writing&&!I.corked&&!I.bufferProcessing&&I.bufferedRequest&&D(this,I))},p.prototype.setDefaultEncoding=function(I){if(typeof I=="string"&&(I=I.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((I+"").toLowerCase())))throw new gn(I);return this._writableState.defaultEncoding=I,this},Object.defineProperty(p.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),p.prototype._write=function(I,O,N){N(new $e("_write()"))},p.prototype._writev=null,p.prototype.end=function(I,O,N){var j=this._writableState;return typeof I=="function"?(N=I,I=null,O=null):typeof O=="function"&&(N=O,O=null),I!=null&&this.write(I,O),j.corked&&(j.corked=1,this.uncork()),j.ending||K(this,j,N),this},Object.defineProperty(p.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(I){this._writableState&&(this._writableState.destroyed=I)}}),p.prototype.destroy=xt.destroy,p.prototype._undestroy=xt.undestroy,p.prototype._destroy=function(I,O){O(I)}}).call(this)}).call(this,n("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(n,i){(function(s){(function(){"use strict";function o(A,D,T){return D in A?Object.defineProperty(A,D,{value:T,enumerable:!0,configurable:!0,writable:!0}):A[D]=T,A}function c(A,D){return{value:A,done:D}}function f(A){var D=A[m];if(D!==null){var T=A[E].read();T!==null&&(A[y]=null,A[m]=null,A[w]=null,D(c(T,!1)))}}function u(A){s.nextTick(f,A)}function d(A,D){return function(T,x){A.then(function(){return D[R]?void T(c(void 0,!0)):void D[_](T,x)},x)}}var h,p=n("./end-of-stream"),m=Symbol("lastResolve"),w=Symbol("lastReject"),b=Symbol("error"),R=Symbol("ended"),y=Symbol("lastPromise"),_=Symbol("handlePromise"),E=Symbol("stream"),C=Object.getPrototypeOf(function(){}),S=Object.setPrototypeOf((h={get stream(){return this[E]},next:function(){var A=this,D=this[b];if(D!==null)return Promise.reject(D);if(this[R])return Promise.resolve(c(void 0,!0));if(this[E].destroyed)return new Promise(function(M,K){s.nextTick(function(){A[b]?K(A[b]):M(c(void 0,!0))})});var T,x=this[y];if(x)T=new Promise(d(x,this));else{var L=this[E].read();if(L!==null)return Promise.resolve(c(L,!1));T=new Promise(this[_])}return this[y]=T,T}},o(h,Symbol.asyncIterator,function(){return this}),o(h,"return",function(){var A=this;return new Promise(function(D,T){A[E].destroy(null,function(x){return x?void T(x):void D(c(void 0,!0))})})}),h),C);i.exports=function(A){var D,T=Object.create(S,(D={},o(D,E,{value:A,writable:!0}),o(D,m,{value:null,writable:!0}),o(D,w,{value:null,writable:!0}),o(D,b,{value:null,writable:!0}),o(D,R,{value:A._readableState.endEmitted,writable:!0}),o(D,_,{value:function(x,L){var M=T[E].read();M?(T[y]=null,T[m]=null,T[w]=null,x(c(M,!1))):(T[m]=x,T[w]=L)},writable:!0}),D));return T[y]=null,p(A,function(x){if(x&&x.code!=="ERR_STREAM_PREMATURE_CLOSE"){var L=T[w];return L!==null&&(T[y]=null,T[m]=null,T[w]=null,L(x)),void(T[b]=x)}var M=T[m];M!==null&&(T[y]=null,T[m]=null,T[w]=null,M(c(void 0,!0))),T[R]=!0}),A.on("readable",u.bind(null,T)),T}}).call(this)}).call(this,n("_process"))},{"./end-of-stream":24,_process:12}],22:[function(n,i){"use strict";function s(y,_){var E=Object.keys(y);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(y);_&&(C=C.filter(function(S){return Object.getOwnPropertyDescriptor(y,S).enumerable})),E.push.apply(E,C)}return E}function o(y){for(var _,E=1;E<arguments.length;E++)_=arguments[E]==null?{}:arguments[E],E%2?s(Object(_),!0).forEach(function(C){c(y,C,_[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(_)):s(Object(_)).forEach(function(C){Object.defineProperty(y,C,Object.getOwnPropertyDescriptor(_,C))});return y}function c(y,_,E){return _ in y?Object.defineProperty(y,_,{value:E,enumerable:!0,configurable:!0,writable:!0}):y[_]=E,y}function f(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}function u(y,_){for(var E,C=0;C<_.length;C++)E=_[C],E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}function d(y,_,E){return _&&u(y.prototype,_),E&&u(y,E),y}function h(y,_,E){m.prototype.copy.call(y,_,E)}var p=n("buffer"),m=p.Buffer,w=n("util"),b=w.inspect,R=b&&b.custom||"inspect";i.exports=(function(){function y(){f(this,y),this.head=null,this.tail=null,this.length=0}return d(y,[{key:"push",value:function(_){var E={data:_,next:null};0<this.length?this.tail.next=E:this.head=E,this.tail=E,++this.length}},{key:"unshift",value:function(_){var E={data:_,next:this.head};this.length===0&&(this.tail=E),this.head=E,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var E=this.head,C=""+E.data;E=E.next;)C+=_+E.data;return C}},{key:"concat",value:function(_){if(this.length===0)return m.alloc(0);for(var E=m.allocUnsafe(_>>>0),C=this.head,S=0;C;)h(C.data,E,S),S+=C.data.length,C=C.next;return E}},{key:"consume",value:function(_,E){var C;return _<this.head.data.length?(C=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?C=this.shift():C=E?this._getString(_):this._getBuffer(_),C}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var E=this.head,C=1,S=E.data;for(_-=S.length;E=E.next;){var A=E.data,D=_>A.length?A.length:_;if(S+=D===A.length?A:A.slice(0,_),_-=D,_===0){D===A.length?(++C,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=A.slice(D));break}++C}return this.length-=C,S}},{key:"_getBuffer",value:function(_){var E=m.allocUnsafe(_),C=this.head,S=1;for(C.data.copy(E),_-=C.data.length;C=C.next;){var A=C.data,D=_>A.length?A.length:_;if(A.copy(E,E.length-_,0,D),_-=D,_===0){D===A.length?(++S,this.head=C.next?C.next:this.tail=null):(this.head=C,C.data=A.slice(D));break}++S}return this.length-=S,E}},{key:R,value:function(_,E){return b(this,o({},E,{depth:0,customInspect:!1}))}}]),y})()},{buffer:3,util:2}],23:[function(n,i){(function(s){(function(){"use strict";function o(u,d){f(u,d),c(u)}function c(u){u._writableState&&!u._writableState.emitClose||u._readableState&&!u._readableState.emitClose||u.emit("close")}function f(u,d){u.emit("error",d)}i.exports={destroy:function(u,d){var h=this,p=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return p||m?(d?d(u):u&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,s.nextTick(f,this,u)):s.nextTick(f,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,function(w){!d&&w?h._writableState?h._writableState.errorEmitted?s.nextTick(c,h):(h._writableState.errorEmitted=!0,s.nextTick(o,h,w)):s.nextTick(o,h,w):d?(s.nextTick(c,h),d(w)):s.nextTick(c,h)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(u,d){var h=u._readableState,p=u._writableState;h&&h.autoDestroy||p&&p.autoDestroy?u.destroy(d):u.emit("error",d)}}}).call(this)}).call(this,n("_process"))},{_process:12}],24:[function(n,i){"use strict";function s(d){var h=!1;return function(){if(!h){h=!0;for(var p=arguments.length,m=Array(p),w=0;w<p;w++)m[w]=arguments[w];d.apply(this,m)}}}function o(){}function c(d){return d.setHeader&&typeof d.abort=="function"}function f(d,h,p){if(typeof h=="function")return f(d,null,h);h||(h={}),p=s(p||o);var m=h.readable||h.readable!==!1&&d.readable,w=h.writable||h.writable!==!1&&d.writable,b=function(){d.writable||y()},R=d._writableState&&d._writableState.finished,y=function(){w=!1,R=!0,m||p.call(d)},_=d._readableState&&d._readableState.endEmitted,E=function(){m=!1,_=!0,w||p.call(d)},C=function(D){p.call(d,D)},S=function(){var D;return m&&!_?(d._readableState&&d._readableState.ended||(D=new u),p.call(d,D)):w&&!R?(d._writableState&&d._writableState.ended||(D=new u),p.call(d,D)):void 0},A=function(){d.req.on("finish",y)};return c(d)?(d.on("complete",y),d.on("abort",S),d.req?A():d.on("request",A)):w&&!d._writableState&&(d.on("end",b),d.on("close",b)),d.on("end",E),d.on("finish",y),h.error!==!1&&d.on("error",C),d.on("close",S),function(){d.removeListener("complete",y),d.removeListener("abort",S),d.removeListener("request",A),d.req&&d.req.removeListener("finish",y),d.removeListener("end",b),d.removeListener("close",b),d.removeListener("finish",y),d.removeListener("end",E),d.removeListener("error",C),d.removeListener("close",S)}}var u=n("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;i.exports=f},{"../../../errors":15}],25:[function(n,i){i.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(n,i){"use strict";function s(R){var y=!1;return function(){y||(y=!0,R.apply(void 0,arguments))}}function o(R){if(R)throw R}function c(R){return R.setHeader&&typeof R.abort=="function"}function f(R,y,_,E){E=s(E);var C=!1;R.on("close",function(){C=!0}),p===void 0&&(p=n("./end-of-stream")),p(R,{readable:y,writable:_},function(A){return A?E(A):(C=!0,void E())});var S=!1;return function(A){if(!C)return S?void 0:(S=!0,c(R)?R.abort():typeof R.destroy=="function"?R.destroy():void E(A||new b("pipe")))}}function u(R){R()}function d(R,y){return R.pipe(y)}function h(R){return R.length&&typeof R[R.length-1]=="function"?R.pop():o}var p,m=n("../../../errors").codes,w=m.ERR_MISSING_ARGS,b=m.ERR_STREAM_DESTROYED;i.exports=function(){for(var R=arguments.length,y=Array(R),_=0;_<R;_++)y[_]=arguments[_];var E=h(y);if(Array.isArray(y[0])&&(y=y[0]),2>y.length)throw new w("streams");var C,S=y.map(function(A,D){var T=D<y.length-1;return f(A,T,0<D,function(x){C||(C=x),x&&S.forEach(u),T||(S.forEach(u),E(C))})});return y.reduce(d)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(n,i){"use strict";function s(c,f,u){return c.highWaterMark==null?f?c[u]:null:c.highWaterMark}var o=n("../../../errors").codes.ERR_INVALID_OPT_VALUE;i.exports={getHighWaterMark:function(c,f,u,d){var h=s(f,d,u);if(h!=null){if(!(isFinite(h)&&t(h)===h)||0>h){var p=d?u:"highWaterMark";throw new o(p,h)}return t(h)}return c.objectMode?16:16384}}},{"../../../errors":15}],28:[function(n,i){i.exports=n("events").EventEmitter},{events:7}],29:[function(n,i,s){s=i.exports=n("./lib/_stream_readable.js"),s.Stream=s,s.Readable=s,s.Writable=n("./lib/_stream_writable.js"),s.Duplex=n("./lib/_stream_duplex.js"),s.Transform=n("./lib/_stream_transform.js"),s.PassThrough=n("./lib/_stream_passthrough.js"),s.finished=n("./lib/internal/streams/end-of-stream.js"),s.pipeline=n("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(n,i,s){function o(d,h){for(var p in d)h[p]=d[p]}function c(d,h,p){return u(d,h,p)}var f=n("buffer"),u=f.Buffer;u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?i.exports=f:(o(f,s),s.Buffer=c),c.prototype=Object.create(u.prototype),o(u,c),c.from=function(d,h,p){if(typeof d=="number")throw new TypeError("Argument must not be a number");return u(d,h,p)},c.alloc=function(d,h,p){if(typeof d!="number")throw new TypeError("Argument must be a number");var m=u(d);return h===void 0?m.fill(0):typeof p=="string"?m.fill(h,p):m.fill(h),m},c.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return u(d)},c.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return f.SlowBuffer(d)}},{buffer:3}],31:[function(n,i,s){"use strict";function o(S){if(!S)return"utf8";for(var A;;)switch(S){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return S;default:if(A)return;S=(""+S).toLowerCase(),A=!0}}function c(S){var A=o(S);if(typeof A!="string"&&(E.isEncoding===C||!C(S)))throw new Error("Unknown encoding: "+S);return A||S}function f(S){this.encoding=c(S);var A;switch(this.encoding){case"utf16le":this.text=m,this.end=w,A=4;break;case"utf8":this.fillLast=p,A=4;break;case"base64":this.text=b,this.end=R,A=3;break;default:return this.write=y,void(this.end=_)}this.lastNeed=0,this.lastTotal=0,this.lastChar=E.allocUnsafe(A)}function u(S){return 127>=S?0:S>>5==6?2:S>>4==14?3:S>>3==30?4:S>>6==2?-1:-2}function d(S,A,D){var T=A.length-1;if(T<D)return 0;var x=u(A[T]);return 0<=x?(0<x&&(S.lastNeed=x-1),x):--T<D||x===-2?0:(x=u(A[T]),0<=x?(0<x&&(S.lastNeed=x-2),x):--T<D||x===-2?0:(x=u(A[T]),0<=x?(0<x&&(x===2?x=0:S.lastNeed=x-3),x):0))}function h(S,A){if((192&A[0])!=128)return S.lastNeed=0,"\uFFFD";if(1<S.lastNeed&&1<A.length){if((192&A[1])!=128)return S.lastNeed=1,"\uFFFD";if(2<S.lastNeed&&2<A.length&&(192&A[2])!=128)return S.lastNeed=2,"\uFFFD"}}function p(S){var A=this.lastTotal-this.lastNeed,D=h(this,S,A);return D===void 0?this.lastNeed<=S.length?(S.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,A,0,S.length),void(this.lastNeed-=S.length)):D}function m(S,A){if((S.length-A)%2==0){var D=S.toString("utf16le",A);if(D){var T=D.charCodeAt(D.length-1);if(55296<=T&&56319>=T)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1],D.slice(0,-1)}return D}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=S[S.length-1],S.toString("utf16le",A,S.length-1)}function w(S){var A=S&&S.length?this.write(S):"";if(this.lastNeed){var D=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,D)}return A}function b(S,A){var D=(S.length-A)%3;return D==0?S.toString("base64",A):(this.lastNeed=3-D,this.lastTotal=3,D==1?this.lastChar[0]=S[S.length-1]:(this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1]),S.toString("base64",A,S.length-D))}function R(S){var A=S&&S.length?this.write(S):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function y(S){return S.toString(this.encoding)}function _(S){return S&&S.length?this.write(S):""}var E=n("safe-buffer").Buffer,C=E.isEncoding||function(S){switch(S=""+S,S&&S.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};s.StringDecoder=f,f.prototype.write=function(S){if(S.length===0)return"";var A,D;if(this.lastNeed){if(A=this.fillLast(S),A===void 0)return"";D=this.lastNeed,this.lastNeed=0}else D=0;return D<S.length?A?A+this.text(S,D):this.text(S,D):A||""},f.prototype.end=function(S){var A=S&&S.length?this.write(S):"";return this.lastNeed?A+"\uFFFD":A},f.prototype.text=function(S,A){var D=d(this,S,A);if(!this.lastNeed)return S.toString("utf8",A);this.lastTotal=D;var T=S.length-(D-this.lastNeed);return S.copy(this.lastChar,0,T),S.toString("utf8",A,T)},f.prototype.fillLast=function(S){return this.lastNeed<=S.length?(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,S.length),void(this.lastNeed-=S.length))}},{"safe-buffer":30}],32:[function(n,i){(function(s){(function(){function o(c){try{if(!s.localStorage)return!1}catch{return!1}var f=s.localStorage[c];return f!=null&&(f+"").toLowerCase()==="true"}i.exports=function(c,f){function u(){if(!d){if(o("throwDeprecation"))throw new Error(f);o("traceDeprecation")?console.trace(f):console.warn(f),d=!0}return c.apply(this,arguments)}if(o("noDeprecation"))return c;var d=!1;return u}}).call(this)}).call(this,typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{}],"/":[function(n,i){function s(R){return R.replace(/a=ice-options:trickle\s\n/g,"")}function o(R){console.warn(R)}let c=n("debug")("simple-peer"),f=n("get-browser-rtc"),u=n("randombytes"),d=n("readable-stream"),h=n("queue-microtask"),p=n("err-code"),{Buffer:m}=n("buffer"),w=65536;class b extends d.Duplex{constructor(y){if(y=Object.assign({allowHalfOpen:!1},y),super(y),this._id=u(4).toString("hex").slice(0,7),this._debug("new peer %o",y),this.channelName=y.initiator?y.channelName||u(20).toString("hex"):null,this.initiator=y.initiator||!1,this.channelConfig=y.channelConfig||b.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},b.config,y.config),this.offerOptions=y.offerOptions||{},this.answerOptions=y.answerOptions||{},this.sdpTransform=y.sdpTransform||(_=>_),this.streams=y.streams||(y.stream?[y.stream]:[]),this.trickle=y.trickle===void 0||y.trickle,this.allowHalfTrickle=y.allowHalfTrickle!==void 0&&y.allowHalfTrickle,this.iceCompleteTimeout=y.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=y.wrtc&&typeof y.wrtc=="object"?y.wrtc:f(),!this._wrtc)throw p(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(_){return void this.destroy(p(_,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=_=>{this._onIceCandidate(_)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(_=>{this.destroy(p(_,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=_=>{this._setupData(_)},this.streams&&this.streams.forEach(_=>{this.addStream(_)}),this._pc.ontrack=_=>{this._onTrack(_)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(y){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof y=="string")try{y=JSON.parse(y)}catch{y={}}this._debug("signal()"),y.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),y.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(y.transceiverRequest.kind,y.transceiverRequest.init)),y.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(y.candidate):this._pendingCandidates.push(y.candidate)),y.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(y)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(_=>{this._addIceCandidate(_)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(_=>{this.destroy(p(_,"ERR_SET_REMOTE_DESCRIPTION"))}),y.sdp||y.candidate||y.renegotiate||y.transceiverRequest||this.destroy(p(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(y){let _=new this._wrtc.RTCIceCandidate(y);this._pc.addIceCandidate(_).catch(E=>{!_.address||_.address.endsWith(".local")?o("Ignoring unsupported ICE candidate."):this.destroy(p(E,"ERR_ADD_ICE_CANDIDATE"))})}send(y){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(y)}}addTransceiver(y,_){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(y,_),this._needsNegotiation()}catch(E){this.destroy(p(E,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:y,init:_}})}}addStream(y){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),y.getTracks().forEach(_=>{this.addTrack(_,y)})}}addTrack(y,_){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");let E=this._senderMap.get(y)||new Map,C=E.get(_);if(!C)C=this._pc.addTrack(y,_),E.set(_,C),this._senderMap.set(y,E),this._needsNegotiation();else throw C.removed?p(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):p(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(y,_,E){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");let C=this._senderMap.get(y),S=C?C.get(E):null;if(!S)throw p(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");_&&this._senderMap.set(_,C),S.replaceTrack==null?this.destroy(p(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):S.replaceTrack(_)}removeTrack(y,_){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");let E=this._senderMap.get(y),C=E?E.get(_):null;if(!C)throw p(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{C.removed=!0,this._pc.removeTrack(C)}catch(S){S.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(C):this.destroy(p(S,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(y){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),y.getTracks().forEach(_=>{this.removeTrack(_,y)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,h(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(y){this._destroy(y,()=>{})}_destroy(y,_){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",y&&(y.message||y)),h(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",y&&(y.message||y)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,y&&this.emit("error",y),this.emit("close"),_()}))}_setupData(y){if(!y.channel)return this.destroy(p(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=y.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=w),this.channelName=this._channel.label,this._channel.onmessage=E=>{this._onChannelMessage(E)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=E=>{let C=E.error instanceof Error?E.error:new Error(`Datachannel error: ${E.message} ${E.filename}:${E.lineno}:${E.colno}`);this.destroy(p(C,"ERR_DATA_CHANNEL"))};let _=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(_&&this._onChannelClose(),_=!0):_=!1},5e3)}_read(){}_write(y,_,E){if(this.destroyed)return E(p(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(y)}catch(C){return this.destroy(p(C,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>w?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=E):E(null)}else this._debug("write before connect"),this._chunk=y,this._cb=E}_onFinish(){if(!this.destroyed){let y=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?y():this.once("connect",y)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=s(y.sdp)),y.sdp=this.sdpTransform(y.sdp);let _=()=>{if(!this.destroyed){let E=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp})}};this._pc.setLocalDescription(y).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(E=>{this.destroy(p(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(p(y,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(y=>{y.mid||!y.sender.track||y.requested||(y.requested=!0,this.addTransceiver(y.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=s(y.sdp)),y.sdp=this.sdpTransform(y.sdp);let _=()=>{if(!this.destroyed){let E=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(y).then(()=>{this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(E=>{this.destroy(p(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(p(y,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(p(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;let y=this._pc.iceConnectionState,_=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",y,_),this.emit("iceStateChange",y,_),(y==="connected"||y==="completed")&&(this._pcReady=!0,this._maybeReady()),y==="failed"&&this.destroy(p(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),y==="closed"&&this.destroy(p(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(y){let _=E=>(Object.prototype.toString.call(E.values)==="[object Array]"&&E.values.forEach(C=>{Object.assign(E,C)}),E);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(E=>{let C=[];E.forEach(S=>{C.push(_(S))}),y(null,C)},E=>y(E)):0<this._pc.getStats.length?this._pc.getStats(E=>{if(this.destroyed)return;let C=[];E.result().forEach(S=>{let A={};S.names().forEach(D=>{A[D]=S.stat(D)}),A.id=S.id,A.type=S.type,A.timestamp=S.timestamp,C.push(_(A))}),y(null,C)},E=>y(E)):y(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let y=()=>{this.destroyed||this.getStats((_,E)=>{if(this.destroyed)return;_&&(E=[]);let C={},S={},A={},D=!1;E.forEach(x=>{(x.type==="remotecandidate"||x.type==="remote-candidate")&&(C[x.id]=x),(x.type==="localcandidate"||x.type==="local-candidate")&&(S[x.id]=x),(x.type==="candidatepair"||x.type==="candidate-pair")&&(A[x.id]=x)});let T=x=>{D=!0;let L=S[x.localCandidateId];L&&(L.ip||L.address)?(this.localAddress=L.ip||L.address,this.localPort=+L.port):L&&L.ipAddress?(this.localAddress=L.ipAddress,this.localPort=+L.portNumber):typeof x.googLocalAddress=="string"&&(L=x.googLocalAddress.split(":"),this.localAddress=L[0],this.localPort=+L[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let M=C[x.remoteCandidateId];M&&(M.ip||M.address)?(this.remoteAddress=M.ip||M.address,this.remotePort=+M.port):M&&M.ipAddress?(this.remoteAddress=M.ipAddress,this.remotePort=+M.portNumber):typeof x.googRemoteAddress=="string"&&(M=x.googRemoteAddress.split(":"),this.remoteAddress=M[0],this.remotePort=+M[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(E.forEach(x=>{x.type==="transport"&&x.selectedCandidatePairId&&T(A[x.selectedCandidatePairId]),(x.type==="googCandidatePair"&&x.googActiveConnection==="true"||(x.type==="candidatepair"||x.type==="candidate-pair")&&x.selected)&&T(x)}),!D&&(!Object.keys(A).length||Object.keys(S).length))return void setTimeout(y,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(L){return this.destroy(p(L,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');let x=this._cb;this._cb=null,x(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};y()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>w)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(y=>{this._pc.removeTrack(y),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(y){this.destroyed||(y.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:y.candidate.candidate,sdpMLineIndex:y.candidate.sdpMLineIndex,sdpMid:y.candidate.sdpMid}}):!y.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),y.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(y){if(this.destroyed)return;let _=y.data;_ instanceof ArrayBuffer&&(_=m.from(_)),this.push(_)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);let y=this._cb;this._cb=null,y(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(y){this.destroyed||y.streams.forEach(_=>{this._debug("on track"),this.emit("track",y.track,_),this._remoteTracks.push({track:y.track,stream:_}),this._remoteStreams.some(E=>E.id===_.id)||(this._remoteStreams.push(_),h(()=>{this._debug("on stream"),this.emit("stream",_)}))})}_debug(){let y=[].slice.call(arguments);y[0]="["+this._id+"] "+y[0],c.apply(null,y)}}b.WEBRTC_SUPPORT=!!f(),b.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},b.channelConfig={},i.exports=b},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})});var na=we((NE,sd)=>{sd.exports=window.wp.richText});var vr=we((s0,kd)=>{kd.exports=window.wp.deprecated});var Od=we((a0,Ud)=>{Ud.exports=window.wp.privateApis});var Ra=we((P0,Qd)=>{Qd.exports=window.wp.htmlEntities});var Ht=we((av,yf)=>{yf.exports=window.wp.element});var bf=we((lv,_f)=>{_f.exports=window.ReactJSXRuntime});var Nf=we((xv,Lf)=>{Lf.exports=window.wp.warning});var Yf=we((Lv,Gf)=>{Gf.exports=window.wp.blockEditor});var zw={};zt(zw,{EntityProvider:()=>vf,__experimentalFetchLinkSuggestions:()=>Zd,__experimentalFetchUrlData:()=>tf,__experimentalUseEntityRecord:()=>If,__experimentalUseEntityRecords:()=>Of,__experimentalUseResourcePermissions:()=>jf,fetchBlockPatterns:()=>Ta,privateApis:()=>Qf,store:()=>Re,useEntityBlockEditor:()=>$f,useEntityId:()=>fn,useEntityProp:()=>Jf,useEntityRecord:()=>ka,useEntityRecords:()=>Ds,useResourcePermissions:()=>Vf});var Ms=V(Ye());var ca=V(xr()),xd=V(Ps()),li=V(Ye()),Ad=V(Ka());var qa=V(xr());function Bs(t,e){if(!t)return e;let r=!1,n={};for(let i in e)(0,qa.default)(t[i],e[i])?n[i]=t[i]:(r=!0,n[i]=e[i]);if(!r)return t;for(let i in t)n.hasOwnProperty(i)||(n[i]=t[i]);return n}function ih(t){return typeof t=="string"?t.split(","):Array.isArray(t)?t:null}var Oe=ih;var sh=t=>e=>(r,n)=>r===void 0||t(n)?e(r,n):r,wn=sh;var oh=t=>(...e)=>async({resolveSelect:r})=>{await r[t](...e)},Jt=oh;var ah=t=>e=>(r={},n)=>{let i=n[t];if(i===void 0)return r;let s=e(r[i],n);return s===r[i]?r:{...r,[i]:s}},Ei=ah;var ch=t=>e=>(r,n)=>e(r,t(n)),_n=ch;function lh(t){let e=new WeakMap;return r=>{let n;return e.has(r)?n=e.get(r):(n=t(r),r!==null&&typeof r=="object"&&e.set(r,n)),n}}var Vs=lh;function js(t,e){return(t.rawAttributes||[]).includes(e)}function kt(t,e,r){if(!t||typeof t!="object")return t;let n=Array.isArray(e)?e:e.split(".");return n.reduce((i,s,o)=>(i[s]===void 0&&(Number.isInteger(n[o+1])?i[s]=[]:i[s]={}),o===n.length-1&&(i[s]=r),i[s]),t),t}function Fs(t,e,r){if(!t||typeof t!="object"||typeof e!="string"&&!Array.isArray(e))return t;let n=Array.isArray(e)?e:e.split("."),i=t;return n.forEach(s=>{i=i?.[s]}),i!==void 0?i:r}function bn(t){return/^\s*\d+\s*$/.test(t)}var Qt=["create","read","update","delete"];function En(t){let e={};if(!t)return e;let r={create:"POST",read:"GET",update:"PUT",delete:"DELETE"};for(let[n,i]of Object.entries(r))e[n]=t.includes(i);return e}function Xt(t,e,r){return(typeof e=="object"?[t,e.kind,e.name,e.id]:[t,e,r]).filter(Boolean).join("/")}var vn=Symbol("RECEIVE_INTERMEDIATE_RESULTS");function Gs(t,e,r){return{type:"RECEIVE_ITEMS",items:Array.isArray(t)?t:[t],persistedEdits:e,meta:r}}function Ha(t,e,r,n=!1){return{type:"REMOVE_ITEMS",itemIds:Array.isArray(r)?r:[r],kind:t,name:e,invalidateCache:n}}function Wa(t,e={},r,n){return{...Gs(t,r,n),query:e}}var tc=V(Qa()),rc=V(Ye());var Za=V(gt());function hh(t){let e={stableKey:"",page:1,perPage:10,fields:null,include:null,context:"default"},r=Object.keys(t).sort();for(let n=0;n<r.length;n++){let i=r[n],s=t[i];switch(i){case"page":e[i]=Number(s);break;case"per_page":e.perPage=Number(s);break;case"context":e.context=s;break;default:i==="_fields"&&(e.fields=Oe(s)??[],s=e.fields.join()),i==="include"&&(typeof s=="number"&&(s=s.toString()),e.include=(Oe(s)??[]).map(Number),s=e.include.join()),e.stableKey+=(e.stableKey?"&":"")+(0,Za.addQueryArgs)("",{[i]:s}).slice(1)}}return e}var Ut=Vs(hh);var ec=new WeakMap;function ph(t,e){let{stableKey:r,page:n,perPage:i,include:s,fields:o,context:c}=Ut(e),f;if(t.queries?.[c]?.[r]&&(f=t.queries[c][r].itemIds),!f)return null;let u=i===-1?0:(n-1)*i,d=i===-1?f.length:Math.min(u+i,f.length),h=[];for(let p=u;p<d;p++){let m=f[p];if(Array.isArray(s)&&!s.includes(m)||m===void 0)continue;if(!t.items[c]?.hasOwnProperty(m))return null;let w=t.items[c][m],b;if(Array.isArray(o)){b={};for(let R=0;R<o.length;R++){let y=o[R].split("."),_=w;y.forEach(E=>{_=_?.[E]}),kt(b,y,_)}}else{if(!t.itemIsComplete[c]?.[m])return null;b=w}h.push(b)}return h}var Ys=(0,rc.createSelector)((t,e={})=>{let r=ec.get(t);if(r){let i=r.get(e);if(i!==void 0)return i}else r=new tc.default,ec.set(t,r);let n=ph(t,e);return r.set(e,n),n});function Ks(t,e={}){let{stableKey:r,context:n}=Ut(e);return t.queries?.[n]?.[r]?.meta?.totalItems??null}function nc(t,e={}){let{stableKey:r,context:n}=Ut(e);return t.queries?.[n]?.[r]?.meta?.totalPages??null}var Sd=V(Ye()),Rd=V(Ps());var Ot=function(){return Ot=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ot.apply(this,arguments)};function ic(t){return t.toLowerCase()}var gh=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],mh=/[^A-Z0-9]+/gi;function vi(t,e){e===void 0&&(e={});for(var r=e.splitRegexp,n=r===void 0?gh:r,i=e.stripRegexp,s=i===void 0?mh:i,o=e.transform,c=o===void 0?ic:o,f=e.delimiter,u=f===void 0?" ":f,d=sc(sc(t,n,"$1\0$2"),s,"\0"),h=0,p=d.length;d.charAt(h)==="\0";)h++;for(;d.charAt(p-1)==="\0";)p--;return d.slice(h,p).split("\0").map(c).join(u)}function sc(t,e,r){return e instanceof RegExp?t.replace(e,r):e.reduce(function(n,i){return n.replace(i,r)},t)}function qs(t,e){var r=t.charAt(0),n=t.substr(1).toLowerCase();return e>0&&r>="0"&&r<="9"?"_"+r+n:""+r.toUpperCase()+n}function Sn(t,e){return e===void 0&&(e={}),vi(t,Ot({delimiter:"",transform:qs},e))}function yh(t,e){return e===0?t.toLowerCase():qs(t,e)}function Si(t,e){return e===void 0&&(e={}),Sn(t,Ot({transform:yh},e))}function oc(t){return t.charAt(0).toUpperCase()+t.substr(1)}function wh(t){return oc(t.toLowerCase())}function ac(t,e){return e===void 0&&(e={}),vi(t,Ot({delimiter:" ",transform:wh},e))}var bs=V(mt()),Es=V(Rn()),he=V(Hs());var Se={};zt(Se,{AbsolutePosition:()=>qi,AbstractConnector:()=>ho,AbstractStruct:()=>$r,AbstractType:()=>me,Array:()=>pr,ContentAny:()=>Ft,ContentBinary:()=>yr,ContentDeleted:()=>zr,ContentEmbed:()=>Ct,ContentFormat:()=>fe,ContentJSON:()=>ei,ContentString:()=>Ze,ContentType:()=>We,Doc:()=>Rt,GC:()=>ke,ID:()=>vt,Item:()=>re,Map:()=>gr,PermanentUserData:()=>go,RelativePosition:()=>qr,Snapshot:()=>Wn,Text:()=>Hr,Transaction:()=>Wi,UndoManager:()=>fr,UpdateEncoderV1:()=>at,XmlElement:()=>Wr,XmlFragment:()=>mr,XmlHook:()=>Zn,XmlText:()=>es,YArrayEvent:()=>Ji,YEvent:()=>hr,YMapEvent:()=>Qi,YTextEvent:()=>Xi,YXmlEvent:()=>Zi,applyUpdate:()=>ti,applyUpdateV2:()=>Gt,cleanupYTextFormatting:()=>Zl,compareIDs:()=>lr,compareRelativePositions:()=>kp,convertUpdateFormatV1ToV2:()=>Qp,convertUpdateFormatV2ToV1:()=>Pl,createAbsolutePositionFromRelativePosition:()=>Ip,createDeleteSet:()=>rs,createDeleteSetFromStructStore:()=>So,createDocFromSnapshot:()=>Mp,createID:()=>Y,createRelativePositionFromJSON:()=>vp,createRelativePositionFromTypeIndex:()=>Rp,createSnapshot:()=>ko,decodeRelativePosition:()=>Ap,decodeSnapshot:()=>Dp,decodeSnapshotV2:()=>Rl,decodeStateVector:()=>To,decodeUpdate:()=>Kp,decodeUpdateV2:()=>Ul,diffUpdate:()=>$p,diffUpdateV2:()=>Uo,emptySnapshot:()=>Lp,encodeRelativePosition:()=>Tp,encodeSnapshot:()=>Op,encodeSnapshotV2:()=>Sl,encodeStateAsUpdate:()=>Xr,encodeStateAsUpdateV2:()=>Qr,encodeStateVector:()=>Ao,encodeStateVectorFromUpdate:()=>qp,encodeStateVectorFromUpdateV2:()=>Dl,equalDeleteSets:()=>_l,equalSnapshots:()=>Up,findIndexSS:()=>He,findRootTypeKey:()=>Io,getItem:()=>Gn,getState:()=>le,getTypeChildren:()=>tg,isDeleted:()=>wr,isParentOf:()=>Hn,iterateDeletedStructs:()=>ur,logType:()=>bp,logUpdate:()=>Yp,logUpdateV2:()=>kl,mergeUpdates:()=>Ol,mergeUpdatesV2:()=>zn,obfuscateUpdate:()=>zp,obfuscateUpdateV2:()=>Jp,parseUpdateMeta:()=>Hp,parseUpdateMetaV2:()=>Ll,readUpdate:()=>mp,readUpdateV2:()=>Co,relativePositionToJSON:()=>Ep,snapshot:()=>Np,snapshotContainsUpdate:()=>Bp,transact:()=>ee,tryGc:()=>Fp,typeListToArraySnapshot:()=>rg,typeMapGetSnapshot:()=>sg});var _e=()=>new Map,Ri=t=>{let e=_e();return t.forEach((r,n)=>{e.set(n,r)}),e},ne=(t,e,r)=>{let n=t.get(e);return n===void 0&&t.set(e,n=r()),n},dc=(t,e)=>{let r=[];for(let[n,i]of t)r.push(e(i,n));return r},fc=(t,e)=>{for(let[r,n]of t)if(e(n,r))return!0;return!1};var Je=()=>new Set;var Ti=t=>t[t.length-1];var hc=(t,e)=>{for(let r=0;r<e.length;r++)t.push(e[r])},rt=Array.from;var pc=(t,e)=>{for(let r=0;r<t.length;r++)if(e(t[r],r,t))return!0;return!1};var gc=(t,e)=>{let r=new Array(t);for(let n=0;n<t;n++)r[n]=e(n,r);return r};var er=Array.isArray;var Ee=class{constructor(){this._observers=_e()}on(e,r){ne(this._observers,e,Je).add(r)}once(e,r){let n=(...i)=>{this.off(e,n),r(...i)};this.on(e,n)}off(e,r){let n=this._observers.get(e);n!==void 0&&(n.delete(r),n.size===0&&this._observers.delete(e))}emit(e,r){return rt((this._observers.get(e)||_e()).values()).forEach(n=>n(...r))}destroy(){this._observers=_e()}};var xe=Math.floor;var Ar=Math.abs;var mc=Math.log10;var Ir=(t,e)=>t<e?t:e,wt=(t,e)=>t>e?t:e,rb=Number.isNaN;var xi=t=>t!==0?t<0:1/t<0;var Ws=String.fromCharCode,nb=String.fromCodePoint,ib=Ws(65535),_h=t=>t.toLowerCase(),bh=/^\s*/g,Eh=t=>t.replace(bh,""),vh=/([A-Z])/g,$s=(t,e)=>Eh(t.replace(vh,r=>`${e}${_h(r)}`));var Sh=t=>{let e=unescape(encodeURIComponent(t)),r=e.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=e.codePointAt(i);return n},Ur=typeof TextEncoder<"u"?new TextEncoder:null,Rh=t=>Ur.encode(t),Tn=Ur?Rh:Sh;var kr=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});kr&&kr.decode(new Uint8Array).length===1&&(kr=null);var yc=(t,e)=>gc(e,()=>t).join("");var zs=t=>t===void 0?null:t;var Js=class{constructor(){this.map=new Map}setItem(e,r){this.map.set(e,r)}getItem(e){return this.map.get(e)}},wc=new Js,Qs=!0;try{typeof localStorage<"u"&&(wc=localStorage,Qs=!1)}catch{}var Ai=wc,_c=t=>Qs||addEventListener("storage",t),bc=t=>Qs||removeEventListener("storage",t);var vc=Object.assign,Th=Object.keys,Sc=(t,e)=>{for(let r in t)e(t[r],r)};var xn=t=>Th(t).length;var Rc=t=>{for(let e in t)return!1;return!0},xh=(t,e)=>{for(let r in t)if(!e(t[r],r))return!1;return!0},Xs=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),Zs=(t,e)=>t===e||xn(t)===xn(e)&&xh(t,(r,n)=>(r!==void 0||Xs(e,n))&&e[n]===r);var An=(t,e,r=0)=>{try{for(;r<t.length;r++)t[r](...e)}finally{r<t.length&&An(t,e,r+1)}},Tc=()=>{};var eo=t=>t,Ah=(t,e)=>t===e;var Dr=(t,e)=>{if(t==null||e==null)return Ah(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:{if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;break}case Set:{if(t.size!==e.size)return!1;for(let r of t)if(!e.has(r))return!1;break}case Map:{if(t.size!==e.size)return!1;for(let r of t.keys())if(!e.has(r)||!Dr(t.get(r),e.get(r)))return!1;break}case Object:if(xn(t)!==xn(e))return!1;for(let r in t)if(!Xs(t,r)||!Dr(t[r],e[r]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Dr(t[r],e[r]))return!1;break;default:return!1}return!0},xc=(t,e)=>e.includes(t);var Lr=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),ki=typeof window<"u"&&typeof document<"u"&&!Lr,sb=typeof navigator<"u"?/Mac/.test(navigator.platform):!1,nt,Ih=[],kh=()=>{if(nt===void 0)if(Lr){nt=_e();let t=process.argv,e=null;for(let r=0;r<t.length;r++){let n=t[r];n[0]==="-"?(e!==null&&nt.set(e,""),e=n):e!==null?(nt.set(e,n),e=null):Ih.push(n)}e!==null&&nt.set(e,"")}else typeof location=="object"?(nt=_e(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){let[e,r]=t.split("=");nt.set(`--${$s(e,"-")}`,r),nt.set(`-${$s(e,"-")}`,r)}})):nt=_e();return nt},to=t=>kh().has(t);var In=t=>Lr?zs(process.env[t.toUpperCase()]):zs(Ai.getItem(t));var Uh=t=>to("--"+t)||In(t)!==null,ob=Uh("production"),Ac=Lr&&xc(process.env.FORCE_COLOR,["true","1","2"]),Ic=!to("no-colors")&&(!Lr||process.stdout.isTTY||Ac)&&(!Lr||to("color")||Ac||In("COLORTERM")!==null||(In("TERM")||"").includes("color"));var no=Number.MAX_SAFE_INTEGER,ab=Number.MIN_SAFE_INTEGER,cb=1<<31;var kc=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&xe(t)===t),lb=Number.isNaN,ub=Number.parseInt;var Ae=t=>new Error(t),Qe=()=>{throw Ae("Method unimplemented")},De=()=>{throw Ae("Unexpected case")};var Dc=Ae("Unexpected end of array"),Lc=Ae("Integer out of Range"),Nr=class{constructor(e){this.arr=e,this.pos=0}},ae=t=>new Nr(t),io=t=>t.pos!==t.arr.length;var Oh=(t,e)=>{let r=Ln(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,r},de=t=>Oh(t,F(t));var _t=t=>t.arr[t.pos++];var F=t=>{let e=0,r=1,n=t.arr.length;for(;t.pos<n;){let i=t.arr[t.pos++];if(e=e+(i&127)*r,r*=128,i<128)return e;if(e>no)throw Lc}throw Dc},On=t=>{let e=t.arr[t.pos++],r=e&63,n=64,i=(e&64)>0?-1:1;if((e&128)===0)return i*r;let s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],r=r+(e&127)*n,n*=128,e<128)return i*r;if(r>no)throw Lc}throw Dc};var Dh=t=>{let e=F(t);if(e===0)return"";{let r=String.fromCodePoint(_t(t));if(--e<100)for(;e--;)r+=String.fromCodePoint(_t(t));else for(;e>0;){let n=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+n);t.pos+=n,r+=String.fromCodePoint.apply(null,i),e-=n}return decodeURIComponent(escape(r))}},Lh=t=>kr.decode(de(t)),Be=kr?Lh:Dh;var so=(t,e)=>{let r=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,r},Nh=t=>so(t,4).getFloat32(0,!1),Mh=t=>so(t,8).getFloat64(0,!1),Ph=t=>so(t,8).getBigInt64(0,!1);var Bh=[t=>{},t=>null,On,Nh,Mh,Ph,t=>!1,t=>!0,Be,t=>{let e=F(t),r={};for(let n=0;n<e;n++){let i=Be(t);r[i]=Dt(t)}return r},t=>{let e=F(t),r=[];for(let n=0;n<e;n++)r.push(Dt(t));return r},de],Dt=t=>Bh[127-_t(t)](t),Un=class extends Nr{constructor(e,r){super(e),this.reader=r,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),io(this)?this.count=F(this)+1:this.count=-1),this.count--,this.s}};var rr=class extends Nr{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=On(this);let e=xi(this.s);this.count=1,e&&(this.s=-this.s,this.count=F(this)+2)}return this.count--,this.s}};var Mr=class extends Nr{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){let e=On(this),r=e&1;this.diff=xe(e/2),this.count=1,r&&(this.count=F(this)+2)}return this.s+=this.diff,this.count--,this.s}},Ui=class{constructor(e){this.decoder=new rr(e),this.str=Be(this.decoder),this.spos=0}read(){let e=this.spos+this.decoder.read(),r=this.str.slice(this.spos,e);return this.spos=e,r}};var Nc=t=>new Uint8Array(t),Ln=(t,e,r)=>new Uint8Array(t,e,r),Mc=t=>new Uint8Array(t),Vh=t=>{let e="";for(let r=0;r<t.byteLength;r++)e+=Ws(t[r]);return btoa(e)},jh=t=>Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"),Fh=t=>{let e=atob(t),r=Nc(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r},Gh=t=>{let e=Buffer.from(t,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},Br=ki?Vh:jh,Nt=ki?Fh:Gh;var Pc=t=>{let e=Nc(t.byteLength);return e.set(t),e};var ir=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},ce=()=>new ir;var Yh=t=>{let e=t.cpos;for(let r=0;r<t.bufs.length;r++)e+=t.bufs[r].length;return e};var te=t=>{let e=new Uint8Array(Yh(t)),r=0;for(let n=0;n<t.bufs.length;n++){let i=t.bufs[n];e.set(i,r),r+=i.length}return e.set(Ln(t.cbuf.buffer,0,t.cpos),r),e},Kh=(t,e)=>{let r=t.cbuf.length;r-t.cpos<e&&(t.bufs.push(Ln(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(wt(r,e)*2),t.cpos=0)},ve=(t,e)=>{let r=t.cbuf.length;t.cpos===r&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(r*2),t.cpos=0),t.cbuf[t.cpos++]=e};var bt=ve;var B=(t,e)=>{for(;e>127;)ve(t,128|127&e),e=xe(e/128);ve(t,127&e)},Mn=(t,e)=>{let r=xi(e);for(r&&(e=-e),ve(t,(e>63?128:0)|(r?64:0)|63&e),e=xe(e/64);e>0;)ve(t,(e>127?128:0)|127&e),e=xe(e/128)},oo=new Uint8Array(3e4),qh=oo.length/3,Hh=(t,e)=>{if(e.length<qh){let r=Ur.encodeInto(e,oo).written||0;B(t,r);for(let n=0;n<r;n++)ve(t,oo[n])}else ie(t,Tn(e))},Wh=(t,e)=>{let r=unescape(encodeURIComponent(e)),n=r.length;B(t,n);for(let i=0;i<n;i++)ve(t,r.codePointAt(i))},Le=Ur&&Ur.encodeInto?Hh:Wh;var Fc=(t,e)=>jr(t,te(e)),jr=(t,e)=>{let r=t.cbuf.length,n=t.cpos,i=Ir(r-n,e.length),s=e.length-i;t.cbuf.set(e.subarray(0,i),n),t.cpos+=i,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(wt(r*2,s)),t.cbuf.set(e.subarray(i)),t.cpos=s)},ie=(t,e)=>{B(t,e.byteLength),jr(t,e)},ao=(t,e)=>{Kh(t,e);let r=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,r},$h=(t,e)=>ao(t,4).setFloat32(0,e,!1),zh=(t,e)=>ao(t,8).setFloat64(0,e,!1),Jh=(t,e)=>ao(t,8).setBigInt64(0,e,!1);var Bc=new DataView(new ArrayBuffer(4)),Qh=t=>(Bc.setFloat32(0,t),Bc.getFloat32(0)===t),Mt=(t,e)=>{switch(typeof e){case"string":ve(t,119),Le(t,e);break;case"number":kc(e)&&Ar(e)<=2147483647?(ve(t,125),Mn(t,e)):Qh(e)?(ve(t,124),$h(t,e)):(ve(t,123),zh(t,e));break;case"bigint":ve(t,122),Jh(t,e);break;case"object":if(e===null)ve(t,126);else if(er(e)){ve(t,117),B(t,e.length);for(let r=0;r<e.length;r++)Mt(t,e[r])}else if(e instanceof Uint8Array)ve(t,116),ie(t,e);else{ve(t,118);let r=Object.keys(e);B(t,r.length);for(let n=0;n<r.length;n++){let i=r[n];Le(t,i),Mt(t,e[i])}}break;case"boolean":ve(t,e?120:121);break;default:ve(t,127)}},Nn=class extends ir{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&B(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}};var Vc=t=>{t.count>0&&(Mn(t.encoder,t.count===1?t.s:-t.s),t.count>1&&B(t.encoder,t.count-2))},sr=class{constructor(){this.encoder=new ir,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Vc(this),this.count=1,this.s=e)}toUint8Array(){return Vc(this),te(this.encoder)}};var jc=t=>{if(t.count>0){let e=t.diff*2+(t.count===1?0:1);Mn(t.encoder,e),t.count>1&&B(t.encoder,t.count-2)}},Vr=class{constructor(){this.encoder=new ir,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(jc(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return jc(this),te(this.encoder)}},Oi=class{constructor(){this.sarr=[],this.s="",this.lensE=new sr}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){let e=new ir;return this.sarr.push(this.s),this.s="",Le(e,this.sarr.join("")),jr(e,this.lensE.toUint8Array()),te(e)}};var hb=crypto.subtle,Gc=crypto.getRandomValues.bind(crypto);var Yc=Math.random,co=()=>Gc(new Uint32Array(1))[0];var Xh="10000000-1000-4000-8000"+-1e11,Di=()=>Xh.replace(/[018]/g,t=>(t^co()&15>>t/4).toString(16));var Ve=Date.now;var Et=t=>new Promise(t);var Zh=Promise.all.bind(Promise),qc=t=>Promise.reject(t),Bn=t=>Promise.resolve(t);var lo=class{constructor(e,r){this.left=e,this.right=r}},it=(t,e)=>new lo(t,e);var or=typeof document<"u"?document:{};var mb=typeof DOMParser<"u"?new DOMParser:null;var Hc=t=>dc(t,(e,r)=>`${r}:${e};`).join("");var yb=or.ELEMENT_NODE,wb=or.TEXT_NODE,_b=or.CDATA_SECTION_NODE,bb=or.COMMENT_NODE,Eb=or.DOCUMENT_NODE,vb=or.DOCUMENT_TYPE_NODE,Sb=or.DOCUMENT_FRAGMENT_NODE;var st=Symbol;var Ie=st(),Xe=st(),Ni=st(),Fr=st(),Mi=st(),jn=st(),Pi=st(),Gr=st(),ar=st(),zc=t=>{let e=[],r=[],n=0;for(;n<t.length;n++){let i=t[n];i.constructor===String||i.constructor===Number?e.push(i):i.constructor===Object&&r.push(JSON.stringify(i))}return r},Wc=[Mi,Pi,Gr,Ni],uo=0,$c=Ve(),Jc=(t,e)=>{let r=Wc[uo],n=In("log"),i=n!==null&&(n==="*"||n==="true"||new RegExp(n,"gi").test(e));return uo=(uo+1)%Wc.length,e+=": ",i?(...s)=>{let o=Ve(),c=o-$c;$c=o,t(r,e,ar,...s.map(f=>typeof f=="string"||typeof f=="symbol"?f:JSON.stringify(f)),r," +"+c+"ms")}:Tc};var ip={[Ie]:it("font-weight","bold"),[Xe]:it("font-weight","normal"),[Ni]:it("color","blue"),[Mi]:it("color","green"),[Fr]:it("color","grey"),[jn]:it("color","red"),[Pi]:it("color","purple"),[Gr]:it("color","orange"),[ar]:it("color","black")},sp=t=>{let e=[],r=[],n=_e(),i=[],s=0;for(;s<t.length;s++){let o=t[s],c=ip[o];if(c!==void 0)n.set(c.left,c.right);else if(o.constructor===String||o.constructor===Number){let f=Hc(n);s>0||f.length>0?(e.push("%c"+o),r.push(f)):e.push(o)}else break}for(s>0&&(i=r,i.unshift(e.join("")));s<t.length;s++){let o=t[s];o instanceof Symbol||i.push(o)}return i},op=Ic?sp:zc,Fn=(...t)=>{console.log(...op(t)),ap.forEach(e=>e.print(t))};var ap=Je();var Qc=t=>Jc(Fn,t);var Zc=t=>({[Symbol.iterator](){return this},next:t}),el=(t,e)=>Zc(()=>{let r;do r=t.next();while(!r.done&&!e(r.value));return r}),Bi=(t,e)=>Zc(()=>{let{done:r,value:n}=t.next();return{done:r,value:r?void 0:e(n)}});var ho=class extends Ee{constructor(e,r){super(),this.doc=e,this.awareness=r}},Kn=class{constructor(e,r){this.clock=e,this.len=r}},Vt=class{constructor(){this.clients=new Map}},ur=(t,e,r)=>e.clients.forEach((n,i)=>{let s=t.doc.store.clients.get(i);for(let o=0;o<n.length;o++){let c=n[o];Tl(t,s,c.clock,c.len,r)}}),dp=(t,e)=>{let r=0,n=t.length-1;for(;r<=n;){let i=xe((r+n)/2),s=t[i],o=s.clock;if(o<=e){if(e<o+s.len)return i;r=i+1}else n=i-1}return null},wr=(t,e)=>{let r=t.clients.get(e.client);return r!==void 0&&dp(r,e.clock)!==null},vo=t=>{t.clients.forEach(e=>{e.sort((i,s)=>i.clock-s.clock);let r,n;for(r=1,n=1;r<e.length;r++){let i=e[n-1],s=e[r];i.clock+i.len>=s.clock?i.len=wt(i.len,s.clock+s.len-i.clock):(n<r&&(e[n]=s),n++)}e.length=n})},Yr=t=>{let e=new Vt;for(let r=0;r<t.length;r++)t[r].clients.forEach((n,i)=>{if(!e.clients.has(i)){let s=n.slice();for(let o=r+1;o<t.length;o++)hc(s,t[o].clients.get(i)||[]);e.clients.set(i,s)}});return vo(e),e},qn=(t,e,r,n)=>{ne(t.clients,e,()=>[]).push(new Kn(r,n))},rs=()=>new Vt,So=t=>{let e=rs();return t.clients.forEach((r,n)=>{let i=[];for(let s=0;s<r.length;s++){let o=r[s];if(o.deleted){let c=o.id.clock,f=o.length;if(s+1<r.length)for(let u=r[s+1];s+1<r.length&&u.deleted;u=r[++s+1])f+=u.length;i.push(new Kn(c,f))}}i.length>0&&e.clients.set(n,i)}),e},ot=(t,e)=>{B(t.restEncoder,e.clients.size),rt(e.clients.entries()).sort((r,n)=>n[0]-r[0]).forEach(([r,n])=>{t.resetDsCurVal(),B(t.restEncoder,r);let i=n.length;B(t.restEncoder,i);for(let s=0;s<i;s++){let o=n[s];t.writeDsClock(o.clock),t.writeDsLen(o.len)}})},St=t=>{let e=new Vt,r=F(t.restDecoder);for(let n=0;n<r;n++){t.resetDsCurVal();let i=F(t.restDecoder),s=F(t.restDecoder);if(s>0){let o=ne(e.clients,i,()=>[]);for(let c=0;c<s;c++)o.push(new Kn(t.readDsClock(),t.readDsLen()))}}return e},nl=(t,e,r)=>{let n=new Vt,i=F(t.restDecoder);for(let s=0;s<i;s++){t.resetDsCurVal();let o=F(t.restDecoder),c=F(t.restDecoder),f=r.clients.get(o)||[],u=le(r,o);for(let d=0;d<c;d++){let h=t.readDsClock(),p=h+t.readDsLen();if(h<u){u<p&&qn(n,o,u,p-u);let m=He(f,h),w=f[m];for(!w.deleted&&w.id.clock<h&&(f.splice(m+1,0,ts(e,w,h-w.id.clock)),m++);m<f.length&&(w=f[m++],w.id.clock<p);)w.deleted||(p<w.id.clock+w.length&&f.splice(m,0,ts(e,w,p-w.id.clock)),w.delete(e))}else qn(n,o,h,p-h)}}if(n.clients.size>0){let s=new qe;return B(s.restEncoder,0),ot(s,n),s.toUint8Array()}return null},_l=(t,e)=>{if(t.clients.size!==e.clients.size)return!1;for(let[r,n]of t.clients.entries()){let i=e.clients.get(r);if(i===void 0||n.length!==i.length)return!1;for(let s=0;s<n.length;s++){let o=n[s],c=i[s];if(o.clock!==c.clock||o.len!==c.len)return!1}}return!0},bl=co,Rt=class t extends Ee{constructor({guid:e=Di(),collectionid:r=null,gc:n=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:o=!1,shouldLoad:c=!0}={}){super(),this.gc=n,this.gcFilter=i,this.clientID=bl(),this.guid=e,this.collectionid=r,this.share=new Map,this.store=new Hi,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=c,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=Et(u=>{this.on("load",()=>{this.isLoaded=!0,u(this)})});let f=()=>Et(u=>{let d=h=>{(h===void 0||h===!0)&&(this.off("sync",d),u())};this.on("sync",d)});this.on("sync",u=>{u===!1&&this.isSynced&&(this.whenSynced=f()),this.isSynced=u===void 0||u===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=f()}load(){let e=this._item;e!==null&&!this.shouldLoad&&ee(e.parent.doc,r=>{r.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(rt(this.subdocs).map(e=>e.guid))}transact(e,r=null){return ee(this,e,r)}get(e,r=me){let n=ne(this.share,e,()=>{let s=new r;return s._integrate(this,null),s}),i=n.constructor;if(r!==me&&i!==r)if(i===me){let s=new r;s._map=n._map,n._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=s}),s._start=n._start;for(let o=s._start;o!==null;o=o.right)o.parent=s;return s._length=n._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return n}getArray(e=""){return this.get(e,pr)}getText(e=""){return this.get(e,Hr)}getMap(e=""){return this.get(e,gr)}getXmlFragment(e=""){return this.get(e,mr)}toJSON(){let e={};return this.share.forEach((r,n)=>{e[n]=r.toJSON()}),e}destroy(){rt(this.subdocs).forEach(r=>r.destroy());let e=this._item;if(e!==null){this._item=null;let r=e.content;r.doc=new t({guid:this.guid,...r.opts,shouldLoad:!1}),r.doc._item=e,ee(e.parent.doc,n=>{let i=r.doc;e.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(e,r){super.on(e,r)}off(e,r){super.off(e,r)}},dr=class{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return F(this.restDecoder)}readDsLen(){return F(this.restDecoder)}},Fe=class extends dr{readLeftID(){return Y(F(this.restDecoder),F(this.restDecoder))}readRightID(){return Y(F(this.restDecoder),F(this.restDecoder))}readClient(){return F(this.restDecoder)}readInfo(){return _t(this.restDecoder)}readString(){return Be(this.restDecoder)}readParentInfo(){return F(this.restDecoder)===1}readTypeRef(){return F(this.restDecoder)}readLen(){return F(this.restDecoder)}readAny(){return Dt(this.restDecoder)}readBuf(){return Pc(de(this.restDecoder))}readJSON(){return JSON.parse(Be(this.restDecoder))}readKey(){return Be(this.restDecoder)}},Ki=class{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=F(this.restDecoder),this.dsCurrVal}readDsLen(){let e=F(this.restDecoder)+1;return this.dsCurrVal+=e,e}},je=class extends Ki{constructor(e){super(e),this.keys=[],F(e),this.keyClockDecoder=new Mr(de(e)),this.clientDecoder=new rr(de(e)),this.leftClockDecoder=new Mr(de(e)),this.rightClockDecoder=new Mr(de(e)),this.infoDecoder=new Un(de(e),_t),this.stringDecoder=new Ui(de(e)),this.parentInfoDecoder=new Un(de(e),_t),this.typeRefDecoder=new rr(de(e)),this.lenDecoder=new rr(de(e))}readLeftID(){return new vt(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new vt(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return Dt(this.restDecoder)}readBuf(){return de(this.restDecoder)}readJSON(){return Dt(this.restDecoder)}readKey(){let e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{let r=this.stringDecoder.read();return this.keys.push(r),r}}},jt=class{constructor(){this.restEncoder=ce()}toUint8Array(){return te(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){B(this.restEncoder,e)}writeDsLen(e){B(this.restEncoder,e)}},at=class extends jt{writeLeftID(e){B(this.restEncoder,e.client),B(this.restEncoder,e.clock)}writeRightID(e){B(this.restEncoder,e.client),B(this.restEncoder,e.clock)}writeClient(e){B(this.restEncoder,e)}writeInfo(e){bt(this.restEncoder,e)}writeString(e){Le(this.restEncoder,e)}writeParentInfo(e){B(this.restEncoder,e?1:0)}writeTypeRef(e){B(this.restEncoder,e)}writeLen(e){B(this.restEncoder,e)}writeAny(e){Mt(this.restEncoder,e)}writeBuf(e){ie(this.restEncoder,e)}writeJSON(e){Le(this.restEncoder,JSON.stringify(e))}writeKey(e){Le(this.restEncoder,e)}},Kr=class{constructor(){this.restEncoder=ce(),this.dsCurrVal=0}toUint8Array(){return te(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){let r=e-this.dsCurrVal;this.dsCurrVal=e,B(this.restEncoder,r)}writeDsLen(e){e===0&&De(),B(this.restEncoder,e-1),this.dsCurrVal+=e}},qe=class extends Kr{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Vr,this.clientEncoder=new sr,this.leftClockEncoder=new Vr,this.rightClockEncoder=new Vr,this.infoEncoder=new Nn(bt),this.stringEncoder=new Oi,this.parentInfoEncoder=new Nn(bt),this.typeRefEncoder=new sr,this.lenEncoder=new sr}toUint8Array(){let e=ce();return B(e,0),ie(e,this.keyClockEncoder.toUint8Array()),ie(e,this.clientEncoder.toUint8Array()),ie(e,this.leftClockEncoder.toUint8Array()),ie(e,this.rightClockEncoder.toUint8Array()),ie(e,te(this.infoEncoder)),ie(e,this.stringEncoder.toUint8Array()),ie(e,te(this.parentInfoEncoder)),ie(e,this.typeRefEncoder.toUint8Array()),ie(e,this.lenEncoder.toUint8Array()),jr(e,te(this.restEncoder)),te(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Mt(this.restEncoder,e)}writeBuf(e){ie(this.restEncoder,e)}writeJSON(e){Mt(this.restEncoder,e)}writeKey(e){let r=this.keyMap.get(e);r===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(r)}},fp=(t,e,r,n)=>{n=wt(n,e[0].id.clock);let i=He(e,n);B(t.restEncoder,e.length-i),t.writeClient(r),B(t.restEncoder,n);let s=e[i];s.write(t,n-s.id.clock);for(let o=i+1;o<e.length;o++)e[o].write(t,0)},Ro=(t,e,r)=>{let n=new Map;r.forEach((i,s)=>{le(e,s)>i&&n.set(s,i)}),ri(e).forEach((i,s)=>{r.has(s)||n.set(s,0)}),B(t.restEncoder,n.size),rt(n.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{fp(t,e.clients.get(i),i,s)})},hp=(t,e)=>{let r=_e(),n=F(t.restDecoder);for(let i=0;i<n;i++){let s=F(t.restDecoder),o=new Array(s),c=t.readClient(),f=F(t.restDecoder);r.set(c,{i:0,refs:o});for(let u=0;u<s;u++){let d=t.readInfo();switch(31&d){case 0:{let h=t.readLen();o[u]=new ke(Y(c,f),h),f+=h;break}case 10:{let h=F(t.restDecoder);o[u]=new Ue(Y(c,f),h),f+=h;break}default:{let h=(d&192)===0,p=new re(Y(c,f),null,(d&128)===128?t.readLeftID():null,null,(d&64)===64?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(d&32)===32?t.readString():null,ru(t,d));o[u]=p,f+=p.length}}}}return r},pp=(t,e,r)=>{let n=[],i=rt(r.keys()).sort((m,w)=>m-w);if(i.length===0)return null;let s=()=>{if(i.length===0)return null;let m=r.get(i[i.length-1]);for(;m.refs.length===m.i;)if(i.pop(),i.length>0)m=r.get(i[i.length-1]);else return null;return m},o=s();if(o===null&&n.length===0)return null;let c=new Hi,f=new Map,u=(m,w)=>{let b=f.get(m);(b==null||b>w)&&f.set(m,w)},d=o.refs[o.i++],h=new Map,p=()=>{for(let m of n){let w=m.id.client,b=r.get(w);b?(b.i--,c.clients.set(w,b.refs.slice(b.i)),r.delete(w),b.i=0,b.refs=[]):c.clients.set(w,[m]),i=i.filter(R=>R!==w)}n.length=0};for(;;){if(d.constructor!==Ue){let w=ne(h,d.id.client,()=>le(e,d.id.client))-d.id.clock;if(w<0)n.push(d),u(d.id.client,d.id.clock-1),p();else{let b=d.getMissing(t,e);if(b!==null){n.push(d);let R=r.get(b)||{refs:[],i:0};if(R.refs.length===R.i)u(b,le(e,b)),p();else{d=R.refs[R.i++];continue}}else(w===0||w<d.length)&&(d.integrate(t,w),h.set(d.id.client,d.id.clock+d.length))}}if(n.length>0)d=n.pop();else if(o!==null&&o.i<o.refs.length)d=o.refs[o.i++];else{if(o=s(),o===null)break;d=o.refs[o.i++]}}if(c.clients.size>0){let m=new qe;return Ro(m,c,new Map),B(m.restEncoder,0),{missing:f,update:m.toUint8Array()}}return null},gp=(t,e)=>Ro(t,e.doc.store,e.beforeState),Co=(t,e,r,n=new je(t))=>ee(e,i=>{i.local=!1;let s=!1,o=i.doc,c=o.store,f=hp(n,o),u=pp(i,c,f),d=c.pendingStructs;if(d){for(let[p,m]of d.missing)if(m<le(c,p)){s=!0;break}if(u){for(let[p,m]of u.missing){let w=d.missing.get(p);(w==null||w>m)&&d.missing.set(p,m)}d.update=zn([d.update,u.update])}}else c.pendingStructs=u;let h=nl(n,i,c);if(c.pendingDs){let p=new je(ae(c.pendingDs));F(p.restDecoder);let m=nl(p,i,c);h&&m?c.pendingDs=zn([h,m]):c.pendingDs=h||m}else c.pendingDs=h;if(s){let p=c.pendingStructs.update;c.pendingStructs=null,Gt(i.doc,p)}},r,!1),mp=(t,e,r)=>Co(t,e,r,new Fe(t)),Gt=(t,e,r,n=je)=>{let i=ae(e);Co(i,t,r,new n(i))},ti=(t,e,r)=>Gt(t,e,r,Fe),yp=(t,e,r=new Map)=>{Ro(t,e.store,r),ot(t,So(e.store))},Qr=(t,e=new Uint8Array([0]),r=new qe)=>{let n=To(e);yp(r,t,n);let i=[r.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(Uo(t.store.pendingStructs.update,e)),i.length>1){if(r.constructor===at)return Ol(i.map((s,o)=>o===0?s:Pl(s)));if(r.constructor===qe)return zn(i)}return i[0]},Xr=(t,e)=>Qr(t,e,new at),El=t=>{let e=new Map,r=F(t.restDecoder);for(let n=0;n<r;n++){let i=F(t.restDecoder),s=F(t.restDecoder);e.set(i,s)}return e},To=t=>El(new dr(ae(t))),xo=(t,e)=>(B(t.restEncoder,e.size),rt(e.entries()).sort((r,n)=>n[0]-r[0]).forEach(([r,n])=>{B(t.restEncoder,r),B(t.restEncoder,n)}),t),wp=(t,e)=>xo(t,ri(e.store)),_p=(t,e=new Kr)=>(t instanceof Map?xo(e,t):wp(e,t),e.toUint8Array()),Ao=t=>_p(t,new jt),po=class{constructor(){this.l=[]}},il=()=>new po,sl=(t,e)=>t.l.push(e),ol=(t,e)=>{let r=t.l,n=r.length;t.l=r.filter(i=>e!==i),n===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},vl=(t,e,r)=>An(t.l,[e,r]),vt=class{constructor(e,r){this.client=e,this.clock=r}},lr=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,Y=(t,e)=>new vt(t,e),al=(t,e)=>{B(t,e.client),B(t,e.clock)},cl=t=>Y(F(t),F(t)),Io=t=>{for(let[e,r]of t.doc.share.entries())if(r===t)return e;throw De()},Hn=(t,e)=>{for(;e!==null;){if(e.parent===t)return!0;e=e.parent._item}return!1},bp=t=>{let e=[],r=t._start;for(;r;)e.push(r),r=r.right;console.log("Children: ",e),console.log("Children content: ",e.filter(n=>!n.deleted).map(n=>n.content))},go=class{constructor(e,r=e.getMap("users")){let n=new Map;this.yusers=r,this.doc=e,this.clients=new Map,this.dss=n;let i=(s,o)=>{let c=s.get("ds"),f=s.get("ids"),u=d=>this.clients.set(d,o);c.observe(d=>{d.changes.added.forEach(h=>{h.content.getContent().forEach(p=>{p instanceof Uint8Array&&this.dss.set(o,Yr([this.dss.get(o)||rs(),St(new dr(ae(p)))]))})})}),this.dss.set(o,Yr(c.map(d=>St(new dr(ae(d)))))),f.observe(d=>d.changes.added.forEach(h=>h.content.getContent().forEach(u))),f.forEach(u)};r.observe(s=>{s.keysChanged.forEach(o=>i(r.get(o),o))}),r.forEach(i)}setUserMapping(e,r,n,{filter:i=()=>!0}={}){let s=this.yusers,o=s.get(n);o||(o=new gr,o.set("ids",new pr),o.set("ds",new pr),s.set(n,o)),o.get("ids").push([r]),s.observe(c=>{setTimeout(()=>{let f=s.get(n);if(f!==o){o=f,this.clients.forEach((h,p)=>{n===h&&o.get("ids").push([p])});let u=new jt,d=this.dss.get(n);d&&(ot(u,d),o.get("ds").push([u.toUint8Array()]))}},0)}),e.on("afterTransaction",c=>{setTimeout(()=>{let f=o.get("ds"),u=c.deleteSet;if(c.local&&u.clients.size>0&&i(c,u)){let d=new jt;ot(d,u),f.push([d.toUint8Array()])}})})}getUserByClientId(e){return this.clients.get(e)||null}getUserByDeletedId(e){for(let[r,n]of this.dss.entries())if(wr(n,e))return r;return null}},qr=class{constructor(e,r,n,i=0){this.type=e,this.tname=r,this.item=n,this.assoc=i}},Ep=t=>{let e={};return t.type&&(e.type=t.type),t.tname&&(e.tname=t.tname),t.item&&(e.item=t.item),t.assoc!=null&&(e.assoc=t.assoc),e},vp=t=>new qr(t.type==null?null:Y(t.type.client,t.type.clock),t.tname||null,t.item==null?null:Y(t.item.client,t.item.clock),t.assoc==null?0:t.assoc),qi=class{constructor(e,r,n=0){this.type=e,this.index=r,this.assoc=n}},Sp=(t,e,r=0)=>new qi(t,e,r),Vi=(t,e,r)=>{let n=null,i=null;return t._item===null?i=Io(t):n=Y(t._item.id.client,t._item.id.clock),new qr(n,i,e,r)},Rp=(t,e,r=0)=>{let n=t._start;if(r<0){if(e===0)return Vi(t,null,r);e--}for(;n!==null;){if(!n.deleted&&n.countable){if(n.length>e)return Vi(t,Y(n.id.client,n.id.clock+e),r);e-=n.length}if(n.right===null&&r<0)return Vi(t,n.lastId,r);n=n.right}return Vi(t,null,r)},Cp=(t,e)=>{let{type:r,tname:n,item:i,assoc:s}=e;if(i!==null)B(t,0),al(t,i);else if(n!==null)bt(t,1),Le(t,n);else if(r!==null)bt(t,2),al(t,r);else throw De();return Mn(t,s),t},Tp=t=>{let e=ce();return Cp(e,t),te(e)},xp=t=>{let e=null,r=null,n=null;switch(F(t)){case 0:n=cl(t);break;case 1:r=Be(t);break;case 2:e=cl(t)}let i=io(t)?On(t):0;return new qr(e,r,n,i)},Ap=t=>xp(ae(t)),Ip=(t,e)=>{let r=e.store,n=t.item,i=t.type,s=t.tname,o=t.assoc,c=null,f=0;if(n!==null){if(le(r,n.client)<=n.clock)return null;let u=bo(r,n),d=u.item;if(!(d instanceof re))return null;if(c=d.parent,c._item===null||!c._item.deleted){f=d.deleted||!d.countable?0:u.diff+(o>=0?0:1);let h=d.left;for(;h!==null;)!h.deleted&&h.countable&&(f+=h.length),h=h.left}}else{if(s!==null)c=e.get(s);else if(i!==null){if(le(r,i.client)<=i.clock)return null;let{item:u}=bo(r,i);if(u instanceof re&&u.content instanceof We)c=u.content.type;else return null}else throw De();o>=0?f=c._length:f=0}return Sp(c,f,t.assoc)},kp=(t,e)=>t===e||t!==null&&e!==null&&t.tname===e.tname&&lr(t.item,e.item)&&lr(t.type,e.type)&&t.assoc===e.assoc,Wn=class{constructor(e,r){this.ds=e,this.sv=r}},Up=(t,e)=>{let r=t.ds.clients,n=e.ds.clients,i=t.sv,s=e.sv;if(i.size!==s.size||r.size!==n.size)return!1;for(let[o,c]of i.entries())if(s.get(o)!==c)return!1;for(let[o,c]of r.entries()){let f=n.get(o)||[];if(c.length!==f.length)return!1;for(let u=0;u<c.length;u++){let d=c[u],h=f[u];if(d.clock!==h.clock||d.len!==h.len)return!1}}return!0},Sl=(t,e=new Kr)=>(ot(e,t.ds),xo(e,t.sv),e.toUint8Array()),Op=t=>Sl(t,new jt),Rl=(t,e=new Ki(ae(t)))=>new Wn(St(e),El(e)),Dp=t=>Rl(t,new dr(ae(t))),ko=(t,e)=>new Wn(t,e),Lp=ko(rs(),new Map),Np=t=>ko(So(t.store),ri(t.store)),cr=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!wr(e.ds,t.id),mo=(t,e)=>{let r=ne(t.meta,mo,Je),n=t.doc.store;r.has(e)||(e.sv.forEach((i,s)=>{i<le(n,s)&&Ne(t,Y(s,i))}),ur(t,e.ds,i=>{}),r.add(e))},Mp=(t,e,r=new Rt)=>{if(t.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");let{sv:n,ds:i}=e,s=new qe;return t.transact(o=>{let c=0;n.forEach(f=>{f>0&&c++}),B(s.restEncoder,c);for(let[f,u]of n){if(u===0)continue;u<le(t.store,f)&&Ne(o,Y(f,u));let d=t.store.clients.get(f)||[],h=He(d,u-1);B(s.restEncoder,h+1),s.writeClient(f),B(s.restEncoder,0);for(let p=0;p<=h;p++)d[p].write(s,0)}ot(s,i)}),Gt(r,s.toUint8Array(),"snapshot"),r},Pp=(t,e,r=je)=>{let n=new r(ae(e)),i=new ct(n,!1);for(let o=i.curr;o!==null;o=i.next())if((t.sv.get(o.id.client)||0)<o.id.clock+o.length)return!1;let s=Yr([t.ds,St(n)]);return _l(t.ds,s)},Bp=(t,e)=>Pp(t,e,Fe),Hi=class{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}},ri=t=>{let e=new Map;return t.clients.forEach((r,n)=>{let i=r[r.length-1];e.set(n,i.id.clock+i.length)}),e},le=(t,e)=>{let r=t.clients.get(e);if(r===void 0)return 0;let n=r[r.length-1];return n.id.clock+n.length},Cl=(t,e)=>{let r=t.clients.get(e.id.client);if(r===void 0)r=[],t.clients.set(e.id.client,r);else{let n=r[r.length-1];if(n.id.clock+n.length!==e.id.clock)throw De()}r.push(e)},He=(t,e)=>{let r=0,n=t.length-1,i=t[n],s=i.id.clock;if(s===e)return n;let o=xe(e/(s+i.length-1)*n);for(;r<=n;){if(i=t[o],s=i.id.clock,s<=e){if(e<s+i.length)return o;r=o+1}else n=o-1;o=xe((r+n)/2)}throw De()},Vp=(t,e)=>{let r=t.clients.get(e.client);return r[He(r,e.clock)]},Gn=Vp,yo=(t,e,r)=>{let n=He(e,r),i=e[n];return i.id.clock<r&&i instanceof re?(e.splice(n+1,0,ts(t,i,r-i.id.clock)),n+1):n},Ne=(t,e)=>{let r=t.doc.store.clients.get(e.client);return r[yo(t,r,e.clock)]},ll=(t,e,r)=>{let n=e.clients.get(r.client),i=He(n,r.clock),s=n[i];return r.clock!==s.id.clock+s.length-1&&s.constructor!==ke&&n.splice(i+1,0,ts(t,s,r.clock-s.id.clock+1)),s},jp=(t,e,r)=>{let n=t.clients.get(e.id.client);n[He(n,e.id.clock)]=r},Tl=(t,e,r,n,i)=>{if(n===0)return;let s=r+n,o=yo(t,e,r),c;do c=e[o++],s<c.id.clock+c.length&&yo(t,e,s),i(c);while(o<e.length&&e[o].id.clock<s)},Wi=class{constructor(e,r,n){this.doc=e,this.deleteSet=new Vt,this.beforeState=ri(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=r,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}},ul=(t,e)=>e.deleteSet.clients.size===0&&!fc(e.afterState,(r,n)=>e.beforeState.get(n)!==r)?!1:(vo(e.deleteSet),gp(t,e),ot(t,e.deleteSet),!0),dl=(t,e,r)=>{let n=e._item;(n===null||n.id.clock<(t.beforeState.get(n.id.client)||0)&&!n.deleted)&&ne(t.changed,e,Je).add(r)},Gi=(t,e)=>{let r=t[e],n=t[e-1],i=e;for(;i>0;r=n,n=t[--i-1]){if(n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)){r instanceof re&&r.parentSub!==null&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n);continue}break}let s=e-i;return s&&t.splice(e+1-s,s),s},xl=(t,e,r)=>{for(let[n,i]of t.clients.entries()){let s=e.clients.get(n);for(let o=i.length-1;o>=0;o--){let c=i[o],f=c.clock+c.len;for(let u=He(s,c.clock),d=s[u];u<s.length&&d.id.clock<f;d=s[++u]){let h=s[u];if(c.clock+c.len<=h.id.clock)break;h instanceof re&&h.deleted&&!h.keep&&r(h)&&h.gc(e,!1)}}}},Al=(t,e)=>{t.clients.forEach((r,n)=>{let i=e.clients.get(n);for(let s=r.length-1;s>=0;s--){let o=r[s],c=Ir(i.length-1,1+He(i,o.clock+o.len-1));for(let f=c,u=i[f];f>0&&u.id.clock>=o.clock;u=i[f])f-=1+Gi(i,f)}})},Fp=(t,e,r)=>{xl(t,e,r),Al(t,e)},Il=(t,e)=>{if(e<t.length){let r=t[e],n=r.doc,i=n.store,s=r.deleteSet,o=r._mergeStructs;try{vo(s),r.afterState=ri(r.doc.store),n.emit("beforeObserverCalls",[r,n]);let c=[];r.changed.forEach((f,u)=>c.push(()=>{(u._item===null||!u._item.deleted)&&u._callObserver(r,f)})),c.push(()=>{r.changedParentTypes.forEach((f,u)=>{u._dEH.l.length>0&&(u._item===null||!u._item.deleted)&&(f=f.filter(d=>d.target._item===null||!d.target._item.deleted),f.forEach(d=>{d.currentTarget=u,d._path=null}),f.sort((d,h)=>d.path.length-h.path.length),vl(u._dEH,f,r))})}),c.push(()=>n.emit("afterTransaction",[r,n])),An(c,[]),r._needFormattingCleanup&&lg(r)}finally{n.gc&&xl(s,i,n.gcFilter),Al(s,i),r.afterState.forEach((d,h)=>{let p=r.beforeState.get(h)||0;if(p!==d){let m=i.clients.get(h),w=wt(He(m,p),1);for(let b=m.length-1;b>=w;)b-=1+Gi(m,b)}});for(let d=o.length-1;d>=0;d--){let{client:h,clock:p}=o[d].id,m=i.clients.get(h),w=He(m,p);w+1<m.length&&Gi(m,w+1)>1||w>0&&Gi(m,w)}if(!r.local&&r.afterState.get(n.clientID)!==r.beforeState.get(n.clientID)&&(Fn(Gr,Ie,"[yjs] ",Xe,jn,"Changed the client-id because another client seems to be using it."),n.clientID=bl()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){let d=new at;ul(d,r)&&n.emit("update",[d.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){let d=new qe;ul(d,r)&&n.emit("updateV2",[d.toUint8Array(),r.origin,n,r])}let{subdocsAdded:c,subdocsLoaded:f,subdocsRemoved:u}=r;(c.size>0||u.size>0||f.size>0)&&(c.forEach(d=>{d.clientID=n.clientID,d.collectionid==null&&(d.collectionid=n.collectionid),n.subdocs.add(d)}),u.forEach(d=>n.subdocs.delete(d)),n.emit("subdocs",[{loaded:f,added:c,removed:u},n,r]),u.forEach(d=>d.destroy())),t.length<=e+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,t])):Il(t,e+1)}}},ee=(t,e,r=null,n=!0)=>{let i=t._transactionCleanups,s=!1,o=null;t._transaction===null&&(s=!0,t._transaction=new Wi(t,r,n),i.push(t._transaction),i.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{o=e(t._transaction)}finally{if(s){let c=t._transaction===i[0];t._transaction=null,c&&Il(i,0)}}return o},wo=class{constructor(e,r){this.insertions=r,this.deletions=e,this.meta=new Map}},fl=(t,e,r)=>{ur(t,r.deletions,n=>{n instanceof re&&e.scope.some(i=>Hn(i,n))&&Mo(n,!1)})},hl=(t,e,r)=>{let n=null,i=null,s=t.doc,o=t.scope;if(ee(s,c=>{for(;e.length>0&&n===null;){let f=s.store,u=e.pop(),d=new Set,h=[],p=!1;ur(c,u.insertions,m=>{if(m instanceof re){if(m.redone!==null){let{item:w,diff:b}=bo(f,m.id);b>0&&(w=Ne(c,Y(w.id.client,w.id.clock+b))),m=w}!m.deleted&&o.some(w=>Hn(w,m))&&h.push(m)}}),ur(c,u.deletions,m=>{m instanceof re&&o.some(w=>Hn(w,m))&&!wr(u.insertions,m.id)&&d.add(m)}),d.forEach(m=>{p=tu(c,m,d,u.insertions,t.ignoreRemoteMapChanges,t)!==null||p});for(let m=h.length-1;m>=0;m--){let w=h[m];t.deleteFilter(w)&&(w.delete(c),p=!0)}n=p?u:null}c.changed.forEach((f,u)=>{f.has(null)&&u._searchMarker&&(u._searchMarker.length=0)}),i=c},t),n!=null){let c=i.changedParentTypes;t.emit("stack-item-popped",[{stackItem:n,type:r,changedParentTypes:c},t])}return n},fr=class extends Ee{constructor(e,{captureTimeout:r=500,captureTransaction:n=f=>!0,deleteFilter:i=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:c=er(e)?e[0].doc:e.doc}={}){super(),this.scope=[],this.addToScope(e),this.deleteFilter=i,s.add(this),this.trackedOrigins=s,this.captureTransaction=n,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=c,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=r,this.afterTransactionHandler=f=>{if(!this.captureTransaction(f)||!this.scope.some(R=>f.changedParentTypes.has(R))||!this.trackedOrigins.has(f.origin)&&(!f.origin||!this.trackedOrigins.has(f.origin.constructor)))return;let u=this.undoing,d=this.redoing,h=u?this.redoStack:this.undoStack;u?this.stopCapturing():d||this.clear(!1,!0);let p=new Vt;f.afterState.forEach((R,y)=>{let _=f.beforeState.get(y)||0,E=R-_;E>0&&qn(p,y,_,E)});let m=Ve(),w=!1;if(this.lastChange>0&&m-this.lastChange<this.captureTimeout&&h.length>0&&!u&&!d){let R=h[h.length-1];R.deletions=Yr([R.deletions,f.deleteSet]),R.insertions=Yr([R.insertions,p])}else h.push(new wo(f.deleteSet,p)),w=!0;!u&&!d&&(this.lastChange=m),ur(f,f.deleteSet,R=>{R instanceof re&&this.scope.some(y=>Hn(y,R))&&Mo(R,!0)});let b=[{stackItem:h[h.length-1],origin:f.origin,type:u?"redo":"undo",changedParentTypes:f.changedParentTypes},this];w?this.emit("stack-item-added",b):this.emit("stack-item-updated",b)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){e=er(e)?e:[e],e.forEach(r=>{this.scope.every(n=>n!==r)&&this.scope.push(r)})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,r=!0){(e&&this.canUndo()||r&&this.canRedo())&&this.doc.transact(n=>{e&&(this.undoStack.forEach(i=>fl(n,this,i)),this.undoStack=[]),r&&(this.redoStack.forEach(i=>fl(n,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:r}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=hl(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=hl(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}};function*Gp(t){let e=F(t.restDecoder);for(let r=0;r<e;r++){let n=F(t.restDecoder),i=t.readClient(),s=F(t.restDecoder);for(let o=0;o<n;o++){let c=t.readInfo();if(c===10){let f=F(t.restDecoder);yield new Ue(Y(i,s),f),s+=f}else if((31&c)!==0){let f=(c&192)===0,u=new re(Y(i,s),null,(c&128)===128?t.readLeftID():null,null,(c&64)===64?t.readRightID():null,f?t.readParentInfo()?t.readString():t.readLeftID():null,f&&(c&32)===32?t.readString():null,ru(t,c));yield u,s+=u.length}else{let f=t.readLen();yield new ke(Y(i,s),f),s+=f}}}}var ct=class{constructor(e,r){this.gen=Gp(e),this.curr=null,this.done=!1,this.filterSkips=r,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ue);return this.curr}},Yp=t=>kl(t,Fe),kl=(t,e=je)=>{let r=[],n=new e(ae(t)),i=new ct(n,!1);for(let o=i.curr;o!==null;o=i.next())r.push(o);Fn("Structs: ",r);let s=St(n);Fn("DeleteSet: ",s)},Kp=t=>Ul(t,Fe),Ul=(t,e=je)=>{let r=[],n=new e(ae(t)),i=new ct(n,!1);for(let s=i.curr;s!==null;s=i.next())r.push(s);return{structs:r,ds:St(n)}},$n=class{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}},Ol=t=>zn(t,Fe,at),Dl=(t,e=Kr,r=je)=>{let n=new e,i=new ct(new r(ae(t)),!1),s=i.curr;if(s!==null){let o=0,c=s.id.client,f=s.id.clock!==0,u=f?0:s.id.clock+s.length;for(;s!==null;s=i.next())c!==s.id.client&&(u!==0&&(o++,B(n.restEncoder,c),B(n.restEncoder,u)),c=s.id.client,u=0,f=s.id.clock!==0),s.constructor===Ue&&(f=!0),f||(u=s.id.clock+s.length);u!==0&&(o++,B(n.restEncoder,c),B(n.restEncoder,u));let d=ce();return B(d,o),Fc(d,n.restEncoder),n.restEncoder=d,n.toUint8Array()}else return B(n.restEncoder,0),n.toUint8Array()},qp=t=>Dl(t,jt,Fe),Ll=(t,e=je)=>{let r=new Map,n=new Map,i=new ct(new e(ae(t)),!1),s=i.curr;if(s!==null){let o=s.id.client,c=s.id.clock;for(r.set(o,c);s!==null;s=i.next())o!==s.id.client&&(n.set(o,c),r.set(s.id.client,s.id.clock),o=s.id.client),c=s.id.clock+s.length;n.set(o,c)}return{from:r,to:n}},Hp=t=>Ll(t,Fe),Wp=(t,e)=>{if(t.constructor===ke){let{client:r,clock:n}=t.id;return new ke(Y(r,n+e),t.length-e)}else if(t.constructor===Ue){let{client:r,clock:n}=t.id;return new Ue(Y(r,n+e),t.length-e)}else{let r=t,{client:n,clock:i}=r.id;return new re(Y(n,i+e),null,Y(n,i+e-1),null,r.rightOrigin,r.parent,r.parentSub,r.content.splice(e))}},zn=(t,e=je,r=qe)=>{if(t.length===1)return t[0];let n=t.map(d=>new e(ae(d))),i=n.map(d=>new ct(d,!0)),s=null,o=new r,c=new $n(o);for(;i=i.filter(p=>p.curr!==null),i.sort((p,m)=>{if(p.curr.id.client===m.curr.id.client){let w=p.curr.id.clock-m.curr.id.clock;return w===0?p.curr.constructor===m.curr.constructor?0:p.curr.constructor===Ue?1:-1:w}else return m.curr.id.client-p.curr.id.client}),i.length!==0;){let d=i[0],h=d.curr.id.client;if(s!==null){let p=d.curr,m=!1;for(;p!==null&&p.id.clock+p.length<=s.struct.id.clock+s.struct.length&&p.id.client>=s.struct.id.client;)p=d.next(),m=!0;if(p===null||p.id.client!==h||m&&p.id.clock>s.struct.id.clock+s.struct.length)continue;if(h!==s.struct.id.client)Pt(c,s.struct,s.offset),s={struct:p,offset:0},d.next();else if(s.struct.id.clock+s.struct.length<p.id.clock)if(s.struct.constructor===Ue)s.struct.length=p.id.clock+p.length-s.struct.id.clock;else{Pt(c,s.struct,s.offset);let w=p.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Ue(Y(h,s.struct.id.clock+s.struct.length),w),offset:0}}else{let w=s.struct.id.clock+s.struct.length-p.id.clock;w>0&&(s.struct.constructor===Ue?s.struct.length-=w:p=Wp(p,w)),s.struct.mergeWith(p)||(Pt(c,s.struct,s.offset),s={struct:p,offset:0},d.next())}}else s={struct:d.curr,offset:0},d.next();for(let p=d.curr;p!==null&&p.id.client===h&&p.id.clock===s.struct.id.clock+s.struct.length&&p.constructor!==Ue;p=d.next())Pt(c,s.struct,s.offset),s={struct:p,offset:0}}s!==null&&(Pt(c,s.struct,s.offset),s=null),Oo(c);let f=n.map(d=>St(d)),u=Yr(f);return ot(o,u),o.toUint8Array()},Uo=(t,e,r=je,n=qe)=>{let i=To(e),s=new n,o=new $n(s),c=new r(ae(t)),f=new ct(c,!1);for(;f.curr;){let d=f.curr,h=d.id.client,p=i.get(h)||0;if(f.curr.constructor===Ue){f.next();continue}if(d.id.clock+d.length>p)for(Pt(o,d,wt(p-d.id.clock,0)),f.next();f.curr&&f.curr.id.client===h;)Pt(o,f.curr,0),f.next();else for(;f.curr&&f.curr.id.client===h&&f.curr.id.clock+f.curr.length<=p;)f.next()}Oo(o);let u=St(c);return ot(s,u),s.toUint8Array()},$p=(t,e)=>Uo(t,e,Fe,at),Nl=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:te(t.encoder.restEncoder)}),t.encoder.restEncoder=ce(),t.written=0)},Pt=(t,e,r)=>{t.written>0&&t.currClient!==e.id.client&&Nl(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),B(t.encoder.restEncoder,e.id.clock+r)),e.write(t.encoder,r),t.written++},Oo=t=>{Nl(t);let e=t.encoder.restEncoder;B(e,t.clientStructs.length);for(let r=0;r<t.clientStructs.length;r++){let n=t.clientStructs[r];B(e,n.written),jr(e,n.restEncoder)}},ns=(t,e,r,n)=>{let i=new r(ae(t)),s=new ct(i,!1),o=new n,c=new $n(o);for(let u=s.curr;u!==null;u=s.next())Pt(c,e(u),0);Oo(c);let f=St(i);return ot(o,f),o.toUint8Array()},Ml=({formatting:t=!0,subdocs:e=!0,yxml:r=!0}={})=>{let n=0,i=_e(),s=_e(),o=_e(),c=_e();return c.set(null,null),f=>{switch(f.constructor){case ke:case Ue:return f;case re:{let u=f,d=u.content;switch(d.constructor){case zr:break;case We:{if(r){let h=d.type;h instanceof Wr&&(h.nodeName=ne(s,h.nodeName,()=>"node-"+n)),h instanceof Zn&&(h.hookName=ne(s,h.hookName,()=>"hook-"+n))}break}case Ft:{let h=d;h.arr=h.arr.map(()=>n);break}case yr:{let h=d;h.content=new Uint8Array([n]);break}case Jr:{let h=d;e&&(h.opts={},h.doc.guid=n+"");break}case Ct:{let h=d;h.embed={};break}case fe:{let h=d;t&&(h.key=ne(o,h.key,()=>n+""),h.value=ne(c,h.value,()=>({i:n})));break}case ei:{let h=d;h.arr=h.arr.map(()=>n);break}case Ze:{let h=d;h.str=yc(n%10+"",h.str.length);break}default:De()}return u.parentSub&&(u.parentSub=ne(i,u.parentSub,()=>n+"")),n++,f}default:De()}}},zp=(t,e)=>ns(t,Ml(e),Fe,at),Jp=(t,e)=>ns(t,Ml(e),je,qe),Qp=t=>ns(t,eo,Fe,qe),Pl=t=>ns(t,eo,je,at),pl="You must not compute changes after the event-handler fired.",hr=class{constructor(e,r){this.target=e,this.currentTarget=e,this.transaction=r,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Xp(this.currentTarget,this.target))}deletes(e){return wr(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ae(pl);let e=new Map,r=this.target;this.transaction.changed.get(r).forEach(i=>{if(i!==null){let s=r._map.get(i),o,c;if(this.adds(s)){let f=s.left;for(;f!==null&&this.adds(f);)f=f.left;if(this.deletes(s))if(f!==null&&this.deletes(f))o="delete",c=Ti(f.content.getContent());else return;else f!==null&&this.deletes(f)?(o="update",c=Ti(f.content.getContent())):(o="add",c=void 0)}else if(this.deletes(s))o="delete",c=Ti(s.content.getContent());else return;e.set(i,{action:o,oldValue:c})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ae(pl);let r=this.target,n=Je(),i=Je(),s=[];if(e={added:n,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(r).has(null)){let c=null,f=()=>{c&&s.push(c)};for(let u=r._start;u!==null;u=u.right)u.deleted?this.deletes(u)&&!this.adds(u)&&((c===null||c.delete===void 0)&&(f(),c={delete:0}),c.delete+=u.length,i.add(u)):this.adds(u)?((c===null||c.insert===void 0)&&(f(),c={insert:[]}),c.insert=c.insert.concat(u.content.getContent()),n.add(u)):((c===null||c.retain===void 0)&&(f(),c={retain:0}),c.retain+=u.length);c!==null&&c.retain===void 0&&f()}this._changes=e}return e}},Xp=(t,e)=>{let r=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)r.unshift(e._item.parentSub);else{let n=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)i.deleted||n++,i=i.right;r.unshift(n)}e=e._item.parent}return r},Bl=80,Do=0,_o=class{constructor(e,r){e.marker=!0,this.p=e,this.index=r,this.timestamp=Do++}},Zp=t=>{t.timestamp=Do++},Vl=(t,e,r)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=r,t.timestamp=Do++},eg=(t,e,r)=>{if(t.length>=Bl){let n=t.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return Vl(n,e,r),n}else{let n=new _o(e,r);return t.push(n),n}},is=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;let r=t._searchMarker.length===0?null:t._searchMarker.reduce((s,o)=>Ar(e-s.index)<Ar(e-o.index)?s:o),n=t._start,i=0;for(r!==null&&(n=r.p,i=r.index,Zp(r));n.right!==null&&i<e;){if(!n.deleted&&n.countable){if(e<i+n.length)break;i+=n.length}n=n.right}for(;n.left!==null&&i>e;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);return r!==null&&Ar(r.index-i)<n.parent.length/Bl?(Vl(r,n,i),r):eg(t._searchMarker,n,i)},Jn=(t,e,r)=>{for(let n=t.length-1;n>=0;n--){let i=t[n];if(r>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){t.splice(n,1);continue}i.p=s,s.marker=!0}(e<i.index||r>0&&e===i.index)&&(i.index=wt(e,i.index+r))}},tg=t=>{let e=t._start,r=[];for(;e;)r.push(e),e=e.right;return r},ss=(t,e,r)=>{let n=t,i=e.changedParentTypes;for(;ne(i,t,()=>[]).push(r),t._item!==null;)t=t._item.parent;vl(n._eH,r,e)},me=class{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=il(),this._dEH=il(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,r){this.doc=e,this._item=r}_copy(){throw Qe()}clone(){throw Qe()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,r){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){sl(this._eH,e)}observeDeep(e){sl(this._dEH,e)}unobserve(e){ol(this._eH,e)}unobserveDeep(e){ol(this._dEH,e)}toJSON(){}},jl=(t,e,r)=>{e<0&&(e=t._length+e),r<0&&(r=t._length+r);let n=r-e,i=[],s=t._start;for(;s!==null&&n>0;){if(s.countable&&!s.deleted){let o=s.content.getContent();if(o.length<=e)e-=o.length;else{for(let c=e;c<o.length&&n>0;c++)i.push(o[c]),n--;e=0}}s=s.right}return i},Fl=t=>{let e=[],r=t._start;for(;r!==null;){if(r.countable&&!r.deleted){let n=r.content.getContent();for(let i=0;i<n.length;i++)e.push(n[i])}r=r.right}return e},rg=(t,e)=>{let r=[],n=t._start;for(;n!==null;){if(n.countable&&cr(n,e)){let i=n.content.getContent();for(let s=0;s<i.length;s++)r.push(i[s])}n=n.right}return r},Qn=(t,e)=>{let r=0,n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){let i=n.content.getContent();for(let s=0;s<i.length;s++)e(i[s],r++,t)}n=n.right}},Gl=(t,e)=>{let r=[];return Qn(t,(n,i)=>{r.push(e(n,i,t))}),r},ng=t=>{let e=t._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(r===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};r=e.content.getContent(),n=0,e=e.right}let i=r[n++];return r.length<=n&&(r=null),{done:!1,value:i}}}},Yl=(t,e)=>{let r=is(t,e),n=t._start;for(r!==null&&(n=r.p,e-=r.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(e<n.length)return n.content.getContent()[e];e-=n.length}},$i=(t,e,r,n)=>{let i=r,s=t.doc,o=s.clientID,c=s.store,f=r===null?e._start:r.right,u=[],d=()=>{u.length>0&&(i=new re(Y(o,le(c,o)),i,i&&i.lastId,f,f&&f.id,e,null,new Ft(u)),i.integrate(t,0),u=[])};n.forEach(h=>{if(h===null)u.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(h);break;default:switch(d(),h.constructor){case Uint8Array:case ArrayBuffer:i=new re(Y(o,le(c,o)),i,i&&i.lastId,f,f&&f.id,e,null,new yr(new Uint8Array(h))),i.integrate(t,0);break;case Rt:i=new re(Y(o,le(c,o)),i,i&&i.lastId,f,f&&f.id,e,null,new Jr(h)),i.integrate(t,0);break;default:if(h instanceof me)i=new re(Y(o,le(c,o)),i,i&&i.lastId,f,f&&f.id,e,null,new We(h)),i.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),d()},Kl=Ae("Length exceeded!"),ql=(t,e,r,n)=>{if(r>e._length)throw Kl;if(r===0)return e._searchMarker&&Jn(e._searchMarker,r,n.length),$i(t,e,null,n);let i=r,s=is(e,r),o=e._start;for(s!==null&&(o=s.p,r-=s.index,r===0&&(o=o.prev,r+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(r<=o.length){r<o.length&&Ne(t,Y(o.id.client,o.id.clock+r));break}r-=o.length}return e._searchMarker&&Jn(e._searchMarker,i,n.length),$i(t,e,o,n)},ig=(t,e,r)=>{let i=(e._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return $i(t,e,i,r)},Hl=(t,e,r,n)=>{if(n===0)return;let i=r,s=n,o=is(e,r),c=e._start;for(o!==null&&(c=o.p,r-=o.index);c!==null&&r>0;c=c.right)!c.deleted&&c.countable&&(r<c.length&&Ne(t,Y(c.id.client,c.id.clock+r)),r-=c.length);for(;n>0&&c!==null;)c.deleted||(n<c.length&&Ne(t,Y(c.id.client,c.id.clock+n)),c.delete(t),n-=c.length),c=c.right;if(n>0)throw Kl;e._searchMarker&&Jn(e._searchMarker,i,-s+n)},zi=(t,e,r)=>{let n=e._map.get(r);n!==void 0&&n.delete(t)},Lo=(t,e,r,n)=>{let i=e._map.get(r)||null,s=t.doc,o=s.clientID,c;if(n==null)c=new Ft([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:c=new Ft([n]);break;case Uint8Array:c=new yr(n);break;case Rt:c=new Jr(n);break;default:if(n instanceof me)c=new We(n);else throw new Error("Unexpected content type")}new re(Y(o,le(s.store,o)),i,i&&i.lastId,null,null,e,r,c).integrate(t,0)},No=(t,e)=>{let r=t._map.get(e);return r!==void 0&&!r.deleted?r.content.getContent()[r.length-1]:void 0},Wl=t=>{let e={};return t._map.forEach((r,n)=>{r.deleted||(e[n]=r.content.getContent()[r.length-1])}),e},$l=(t,e)=>{let r=t._map.get(e);return r!==void 0&&!r.deleted},sg=(t,e,r)=>{let n=t._map.get(e)||null;for(;n!==null&&(!r.sv.has(n.id.client)||n.id.clock>=(r.sv.get(n.id.client)||0));)n=n.left;return n!==null&&cr(n,r)?n.content.getContent()[n.length-1]:void 0},ji=t=>el(t.entries(),e=>!e[1].deleted),Ji=class extends hr{constructor(e,r){super(e,r),this._transaction=r}},pr=class t extends me{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){let r=new t;return r.push(e),r}_integrate(e,r){super._integrate(e,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new t}clone(){let e=new t;return e.insert(0,this.toArray().map(r=>r instanceof me?r.clone():r)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(e,r){super._callObserver(e,r),ss(this,e,new Ji(this,e))}insert(e,r){this.doc!==null?ee(this.doc,n=>{ql(n,this,e,r)}):this._prelimContent.splice(e,0,...r)}push(e){this.doc!==null?ee(this.doc,r=>{ig(r,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,r=1){this.doc!==null?ee(this.doc,n=>{Hl(n,this,e,r)}):this._prelimContent.splice(e,r)}get(e){return Yl(this,e)}toArray(){return Fl(this)}slice(e=0,r=this.length){return jl(this,e,r)}toJSON(){return this.map(e=>e instanceof me?e.toJSON():e)}map(e){return Gl(this,e)}forEach(e){Qn(this,e)}[Symbol.iterator](){return ng(this)}_write(e){e.writeTypeRef(Cg)}},og=t=>new pr,Qi=class extends hr{constructor(e,r,n){super(e,r),this.keysChanged=n}},gr=class t extends me{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,r){super._integrate(e,r),this._prelimContent.forEach((n,i)=>{this.set(i,n)}),this._prelimContent=null}_copy(){return new t}clone(){let e=new t;return this.forEach((r,n)=>{e.set(n,r instanceof me?r.clone():r)}),e}_callObserver(e,r){ss(this,e,new Qi(this,e,r))}toJSON(){let e={};return this._map.forEach((r,n)=>{if(!r.deleted){let i=r.content.getContent()[r.length-1];e[n]=i instanceof me?i.toJSON():i}}),e}get size(){return[...ji(this._map)].length}keys(){return Bi(ji(this._map),e=>e[0])}values(){return Bi(ji(this._map),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Bi(ji(this._map),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this._map.forEach((r,n)=>{r.deleted||e(r.content.getContent()[r.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?ee(this.doc,r=>{zi(r,this,e)}):this._prelimContent.delete(e)}set(e,r){return this.doc!==null?ee(this.doc,n=>{Lo(n,this,e,r)}):this._prelimContent.set(e,r),r}get(e){return No(this,e)}has(e){return $l(this,e)}clear(){this.doc!==null?ee(this.doc,e=>{this.forEach(function(r,n,i){zi(e,i,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(Tg)}},ag=t=>new gr,Bt=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&Zs(t,e),Xn=class{constructor(e,r,n,i){this.left=e,this.right=r,this.index=n,this.currentAttributes=i}forward(){switch(this.right===null&&De(),this.right.content.constructor){case fe:this.right.deleted||Zr(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}},gl=(t,e,r)=>{for(;e.right!==null&&r>0;){switch(e.right.content.constructor){case fe:e.right.deleted||Zr(e.currentAttributes,e.right.content);break;default:e.right.deleted||(r<e.right.length&&Ne(t,Y(e.right.id.client,e.right.id.clock+r)),e.index+=e.right.length,r-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},Fi=(t,e,r)=>{let n=new Map,i=is(e,r);if(i){let s=new Xn(i.p.left,i.p,i.index,n);return gl(t,s,r-i.index)}else{let s=new Xn(null,e._start,0,n);return gl(t,s,r)}},zl=(t,e,r,n)=>{for(;r.right!==null&&(r.right.deleted===!0||r.right.content.constructor===fe&&Bt(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();let i=t.doc,s=i.clientID;n.forEach((o,c)=>{let f=r.left,u=r.right,d=new re(Y(s,le(i.store,s)),f,f&&f.lastId,u,u&&u.id,e,null,new fe(c,o));d.integrate(t,0),r.right=d,r.forward()})},Zr=(t,e)=>{let{key:r,value:n}=e;n===null?t.delete(r):t.set(r,n)},Jl=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===fe&&Bt(e[t.right.content.key]||null,t.right.content.value)))break;t.forward()}},Ql=(t,e,r,n)=>{let i=t.doc,s=i.clientID,o=new Map;for(let c in n){let f=n[c],u=r.currentAttributes.get(c)||null;if(!Bt(u,f)){o.set(c,u);let{left:d,right:h}=r;r.right=new re(Y(s,le(i.store,s)),d,d&&d.lastId,h,h&&h.id,e,null,new fe(c,f)),r.right.integrate(t,0),r.forward()}}return o},fo=(t,e,r,n,i)=>{r.currentAttributes.forEach((p,m)=>{i[m]===void 0&&(i[m]=null)});let s=t.doc,o=s.clientID;Jl(r,i);let c=Ql(t,e,r,i),f=n.constructor===String?new Ze(n):n instanceof me?new We(n):new Ct(n),{left:u,right:d,index:h}=r;e._searchMarker&&Jn(e._searchMarker,r.index,f.getLength()),d=new re(Y(o,le(s.store,o)),u,u&&u.lastId,d,d&&d.id,e,null,f),d.integrate(t,0),r.right=d,r.index=h,r.forward(),zl(t,e,r,c)},ml=(t,e,r,n,i)=>{let s=t.doc,o=s.clientID;Jl(r,i);let c=Ql(t,e,r,i);e:for(;r.right!==null&&(n>0||c.size>0&&(r.right.deleted||r.right.content.constructor===fe));){if(!r.right.deleted)switch(r.right.content.constructor){case fe:{let{key:f,value:u}=r.right.content,d=i[f];if(d!==void 0){if(Bt(d,u))c.delete(f);else{if(n===0)break e;c.set(f,u)}r.right.delete(t)}else r.currentAttributes.set(f,u);break}default:n<r.right.length&&Ne(t,Y(r.right.id.client,r.right.id.clock+n)),n-=r.right.length;break}r.forward()}if(n>0){let f="";for(;n>0;n--)f+=`
`;r.right=new re(Y(o,le(s.store,o)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,e,null,new Ze(f)),r.right.integrate(t,0),r.forward()}zl(t,e,r,c)},Xl=(t,e,r,n,i)=>{let s=e,o=_e();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===fe){let u=s.content;o.set(u.key,u)}s=s.right}let c=0,f=!1;for(;e!==s;){if(r===e&&(f=!0),!e.deleted){let u=e.content;switch(u.constructor){case fe:{let{key:d,value:h}=u,p=n.get(d)||null;(o.get(d)!==u||p===h)&&(e.delete(t),c++,!f&&(i.get(d)||null)===h&&p!==h&&(p===null?i.delete(d):i.set(d,p))),!f&&!e.deleted&&Zr(i,u);break}}}e=e.right}return c},cg=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;let r=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===fe){let n=e.content.key;r.has(n)?e.delete(t):r.add(n)}e=e.left}},Zl=t=>{let e=0;return ee(t.doc,r=>{let n=t._start,i=t._start,s=_e(),o=Ri(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case fe:Zr(o,i.content);break;default:e+=Xl(r,n,i,s,o),s=Ri(o),n=i;break}i=i.right}}),e},lg=t=>{let e=new Set,r=t.doc;for(let[n,i]of t.afterState.entries()){let s=t.beforeState.get(n)||0;i!==s&&Tl(t,r.store.clients.get(n),s,i,o=>{!o.deleted&&o.content.constructor===fe&&o.constructor!==ke&&e.add(o.parent)})}ee(r,n=>{ur(t,t.deleteSet,i=>{if(i instanceof ke||!i.parent._hasFormatting||e.has(i.parent))return;let s=i.parent;i.content.constructor===fe?e.add(s):cg(n,i)});for(let i of e)Zl(i)})},yl=(t,e,r)=>{let n=r,i=Ri(e.currentAttributes),s=e.right;for(;r>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case We:case Ct:case Ze:r<e.right.length&&Ne(t,Y(e.right.id.client,e.right.id.clock+r)),r-=e.right.length,e.right.delete(t);break}e.forward()}s&&Xl(t,s,e.right,i,e.currentAttributes);let o=(e.left||e.right).parent;return o._searchMarker&&Jn(o._searchMarker,e.index,-n+r),e},Xi=class extends hr{constructor(e,r,n){super(e,r),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){let e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){let e=this.target.doc,r=[];ee(e,n=>{let i=new Map,s=new Map,o=this.target._start,c=null,f={},u="",d=0,h=0,p=()=>{if(c!==null){let m=null;switch(c){case"delete":h>0&&(m={delete:h}),h=0;break;case"insert":(typeof u=="object"||u.length>0)&&(m={insert:u},i.size>0&&(m.attributes={},i.forEach((w,b)=>{w!==null&&(m.attributes[b]=w)}))),u="";break;case"retain":d>0&&(m={retain:d},Rc(f)||(m.attributes=vc({},f))),d=0;break}m&&r.push(m),c=null}};for(;o!==null;){switch(o.content.constructor){case We:case Ct:this.adds(o)?this.deletes(o)||(p(),c="insert",u=o.content.getContent()[0],p()):this.deletes(o)?(c!=="delete"&&(p(),c="delete"),h+=1):o.deleted||(c!=="retain"&&(p(),c="retain"),d+=1);break;case Ze:this.adds(o)?this.deletes(o)||(c!=="insert"&&(p(),c="insert"),u+=o.content.str):this.deletes(o)?(c!=="delete"&&(p(),c="delete"),h+=o.length):o.deleted||(c!=="retain"&&(p(),c="retain"),d+=o.length);break;case fe:{let{key:m,value:w}=o.content;if(this.adds(o)){if(!this.deletes(o)){let b=i.get(m)||null;Bt(b,w)?w!==null&&o.delete(n):(c==="retain"&&p(),Bt(w,s.get(m)||null)?delete f[m]:f[m]=w)}}else if(this.deletes(o)){s.set(m,w);let b=i.get(m)||null;Bt(b,w)||(c==="retain"&&p(),f[m]=b)}else if(!o.deleted){s.set(m,w);let b=f[m];b!==void 0&&(Bt(b,w)?b!==null&&o.delete(n):(c==="retain"&&p(),w===null?delete f[m]:f[m]=w))}o.deleted||(c==="insert"&&p(),Zr(i,o.content));break}}o=o.right}for(p();r.length>0;){let m=r[r.length-1];if(m.retain!==void 0&&m.attributes===void 0)r.pop();else break}}),this._delta=r}return this._delta}},Hr=class t extends me{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(e,r){super._integrate(e,r);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new t}clone(){let e=new t;return e.applyDelta(this.toDelta()),e}_callObserver(e,r){super._callObserver(e,r);let n=new Xi(this,e,r);ss(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){let e="",r=this._start;for(;r!==null;)!r.deleted&&r.countable&&r.content.constructor===Ze&&(e+=r.content.str),r=r.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:r=!0}={}){this.doc!==null?ee(this.doc,n=>{let i=new Xn(null,this._start,0,new Map);for(let s=0;s<e.length;s++){let o=e[s];if(o.insert!==void 0){let c=!r&&typeof o.insert=="string"&&s===e.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof c!="string"||c.length>0)&&fo(n,this,i,c,o.attributes||{})}else o.retain!==void 0?ml(n,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&yl(n,i,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,r,n){let i=[],s=new Map,o=this.doc,c="",f=this._start;function u(){if(c.length>0){let h={},p=!1;s.forEach((w,b)=>{p=!0,h[b]=w});let m={insert:c};p&&(m.attributes=h),i.push(m),c=""}}let d=()=>{for(;f!==null;){if(cr(f,e)||r!==void 0&&cr(f,r))switch(f.content.constructor){case Ze:{let h=s.get("ychange");e!==void 0&&!cr(f,e)?(h===void 0||h.user!==f.id.client||h.type!=="removed")&&(u(),s.set("ychange",n?n("removed",f.id):{type:"removed"})):r!==void 0&&!cr(f,r)?(h===void 0||h.user!==f.id.client||h.type!=="added")&&(u(),s.set("ychange",n?n("added",f.id):{type:"added"})):h!==void 0&&(u(),s.delete("ychange")),c+=f.content.str;break}case We:case Ct:{u();let h={insert:f.content.getContent()[0]};if(s.size>0){let p={};h.attributes=p,s.forEach((m,w)=>{p[w]=m})}i.push(h);break}case fe:cr(f,e)&&(u(),Zr(s,f.content));break}f=f.right}u()};return e||r?ee(o,h=>{e&&mo(h,e),r&&mo(h,r),d()},"cleanup"):d(),i}insert(e,r,n){if(r.length<=0)return;let i=this.doc;i!==null?ee(i,s=>{let o=Fi(s,this,e);n||(n={},o.currentAttributes.forEach((c,f)=>{n[f]=c})),fo(s,this,o,r,n)}):this._pending.push(()=>this.insert(e,r,n))}insertEmbed(e,r,n={}){let i=this.doc;i!==null?ee(i,s=>{let o=Fi(s,this,e);fo(s,this,o,r,n)}):this._pending.push(()=>this.insertEmbed(e,r,n))}delete(e,r){if(r===0)return;let n=this.doc;n!==null?ee(n,i=>{yl(i,Fi(i,this,e),r)}):this._pending.push(()=>this.delete(e,r))}format(e,r,n){if(r===0)return;let i=this.doc;i!==null?ee(i,s=>{let o=Fi(s,this,e);o.right!==null&&ml(s,this,o,r,n)}):this._pending.push(()=>this.format(e,r,n))}removeAttribute(e){this.doc!==null?ee(this.doc,r=>{zi(r,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,r){this.doc!==null?ee(this.doc,n=>{Lo(n,this,e,r)}):this._pending.push(()=>this.setAttribute(e,r))}getAttribute(e){return No(this,e)}getAttributes(){return Wl(this)}_write(e){e.writeTypeRef(xg)}},ug=t=>new Hr,Yn=class{constructor(e,r=()=>!0){this._filter=r,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,r=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(r)))do if(r=e.content.type,!e.deleted&&(r.constructor===Wr||r.constructor===mr)&&r._start!==null)e=r._start;else for(;e!==null;)if(e.right!==null){e=e.right;break}else e.parent===this._root?e=null:e=e.parent._item;while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}},mr=class t extends me{constructor(){super(),this._prelimContent=[]}get firstChild(){let e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,r){super._integrate(e,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new t}clone(){let e=new t;return e.insert(0,this.toArray().map(r=>r instanceof me?r.clone():r)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Yn(this,e)}querySelector(e){e=e.toUpperCase();let n=new Yn(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return n.done?null:n.value}querySelectorAll(e){return e=e.toUpperCase(),rt(new Yn(this,r=>r.nodeName&&r.nodeName.toUpperCase()===e))}_callObserver(e,r){ss(this,e,new Zi(this,r,e))}toString(){return Gl(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,r={},n){let i=e.createDocumentFragment();return n!==void 0&&n._createAssociation(i,this),Qn(this,s=>{i.insertBefore(s.toDOM(e,r,n),null)}),i}insert(e,r){this.doc!==null?ee(this.doc,n=>{ql(n,this,e,r)}):this._prelimContent.splice(e,0,...r)}insertAfter(e,r){if(this.doc!==null)ee(this.doc,n=>{let i=e&&e instanceof me?e._item:e;$i(n,this,i,r)});else{let n=this._prelimContent,i=e===null?0:n.findIndex(s=>s===e)+1;if(i===0&&e!==null)throw Ae("Reference item not found");n.splice(i,0,...r)}}delete(e,r=1){this.doc!==null?ee(this.doc,n=>{Hl(n,this,e,r)}):this._prelimContent.splice(e,r)}toArray(){return Fl(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Yl(this,e)}slice(e=0,r=this.length){return jl(this,e,r)}forEach(e){Qn(this,e)}_write(e){e.writeTypeRef(Ig)}},dg=t=>new mr,Wr=class t extends mr{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,r){super._integrate(e,r),this._prelimAttrs.forEach((n,i)=>{this.setAttribute(i,n)}),this._prelimAttrs=null}_copy(){return new t(this.nodeName)}clone(){let e=new t(this.nodeName),r=this.getAttributes();return Sc(r,(n,i)=>{typeof n=="string"&&e.setAttribute(i,n)}),e.insert(0,this.toArray().map(n=>n instanceof me?n.clone():n)),e}toString(){let e=this.getAttributes(),r=[],n=[];for(let c in e)n.push(c);n.sort();let i=n.length;for(let c=0;c<i;c++){let f=n[c];r.push(f+'="'+e[f]+'"')}let s=this.nodeName.toLocaleLowerCase(),o=r.length>0?" "+r.join(" "):"";return`<${s}${o}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?ee(this.doc,r=>{zi(r,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,r){this.doc!==null?ee(this.doc,n=>{Lo(n,this,e,r)}):this._prelimAttrs.set(e,r)}getAttribute(e){return No(this,e)}hasAttribute(e){return $l(this,e)}getAttributes(){return Wl(this)}toDOM(e=document,r={},n){let i=e.createElement(this.nodeName),s=this.getAttributes();for(let o in s){let c=s[o];typeof c=="string"&&i.setAttribute(o,c)}return Qn(this,o=>{i.appendChild(o.toDOM(e,r,n))}),n!==void 0&&n._createAssociation(i,this),i}_write(e){e.writeTypeRef(Ag),e.writeKey(this.nodeName)}},fg=t=>new Wr(t.readKey()),Zi=class extends hr{constructor(e,r,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}},Zn=class t extends gr{constructor(e){super(),this.hookName=e}_copy(){return new t(this.hookName)}clone(){let e=new t(this.hookName);return this.forEach((r,n)=>{e.set(n,r)}),e}toDOM(e=document,r={},n){let i=r[this.hookName],s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(s,this),s}_write(e){e.writeTypeRef(kg),e.writeKey(this.hookName)}},hg=t=>new Zn(t.readKey()),es=class t extends Hr{get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new t}clone(){let e=new t;return e.applyDelta(this.toDelta()),e}toDOM(e=document,r,n){let i=e.createTextNode(this.toString());return n!==void 0&&n._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{let r=[];for(let i in e.attributes){let s=[];for(let o in e.attributes[i])s.push({key:o,value:e.attributes[i][o]});s.sort((o,c)=>o.key<c.key?-1:1),r.push({nodeName:i,attrs:s})}r.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let n="";for(let i=0;i<r.length;i++){let s=r[i];n+=`<${s.nodeName}`;for(let o=0;o<s.attrs.length;o++){let c=s.attrs[o];n+=` ${c.key}="${c.value}"`}n+=">"}n+=e.insert;for(let i=r.length-1;i>=0;i--)n+=`</${r[i].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(Ug)}},pg=t=>new es,$r=class{constructor(e,r){this.id=e,this.length=r}get deleted(){throw Qe()}mergeWith(e){return!1}write(e,r,n){throw Qe()}integrate(e,r){throw Qe()}},gg=0,ke=class extends $r{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,r){r>0&&(this.id.clock+=r,this.length-=r),Cl(e.doc.store,this)}write(e,r){e.writeInfo(gg),e.writeLen(this.length-r)}getMissing(e,r){return null}},yr=class t{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new t(this.content)}splice(e){throw Qe()}mergeWith(e){return!1}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeBuf(this.content)}getRef(){return 3}},mg=t=>new yr(t.readBuf()),zr=class t{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new t(this.len)}splice(e){let r=new t(this.len-e);return this.len=e,r}mergeWith(e){return this.len+=e.len,!0}integrate(e,r){qn(e.deleteSet,r.id.client,r.id.clock,this.len),r.markDeleted()}delete(e){}gc(e){}write(e,r){e.writeLen(this.len-r)}getRef(){return 1}},yg=t=>new zr(t.readLen()),eu=(t,e)=>new Rt({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1}),Jr=class t{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;let r={};this.opts=r,e.gc||(r.gc=!1),e.autoLoad&&(r.autoLoad=!0),e.meta!==null&&(r.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new t(eu(this.doc.guid,this.opts))}splice(e){throw Qe()}mergeWith(e){return!1}integrate(e,r){this.doc._item=r,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,r){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}},wg=t=>new Jr(eu(t.readString(),t.readAny())),Ct=class t{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new t(this.embed)}splice(e){throw Qe()}mergeWith(e){return!1}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeJSON(this.embed)}getRef(){return 5}},_g=t=>new Ct(t.readJSON()),fe=class t{constructor(e,r){this.key=e,this.value=r}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new t(this.key,this.value)}splice(e){throw Qe()}mergeWith(e){return!1}integrate(e,r){let n=r.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,r){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}},bg=t=>new fe(t.readKey(),t.readJSON()),ei=class t{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new t(this.arr)}splice(e){let r=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),r}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){let n=this.arr.length;e.writeLen(n-r);for(let i=r;i<n;i++){let s=this.arr[i];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}},Eg=t=>{let e=t.readLen(),r=[];for(let n=0;n<e;n++){let i=t.readString();i==="undefined"?r.push(void 0):r.push(JSON.parse(i))}return new ei(r)},Ft=class t{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new t(this.arr)}splice(e){let r=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),r}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){let n=this.arr.length;e.writeLen(n-r);for(let i=r;i<n;i++){let s=this.arr[i];e.writeAny(s)}}getRef(){return 8}},vg=t=>{let e=t.readLen(),r=[];for(let n=0;n<e;n++)r.push(t.readAny());return new Ft(r)},Ze=class t{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new t(this.str)}splice(e){let r=new t(this.str.slice(e));this.str=this.str.slice(0,e);let n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"\uFFFD",r.str="\uFFFD"+r.str.slice(1)),r}mergeWith(e){return this.str+=e.str,!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeString(r===0?this.str:this.str.slice(r))}getRef(){return 4}},Sg=t=>new Ze(t.readString()),Rg=[og,ag,ug,fg,dg,hg,pg],Cg=0,Tg=1,xg=2,Ag=3,Ig=4,kg=5,Ug=6,We=class t{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new t(this.type._copy())}splice(e){throw Qe()}mergeWith(e){return!1}integrate(e,r){this.type._integrate(e.doc,r)}delete(e){let r=this.type._start;for(;r!==null;)r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e),r=r.right;this.type._map.forEach(n=>{n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e)}),e.changed.delete(this.type)}gc(e){let r=this.type._start;for(;r!==null;)r.gc(e,!0),r=r.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(e,!0),n=n.left}),this.type._map=new Map}write(e,r){this.type._write(e)}getRef(){return 7}},Og=t=>new We(Rg[t.readTypeRef()](t)),bo=(t,e)=>{let r=e,n=0,i;do n>0&&(r=Y(r.client,r.clock+n)),i=Gn(t,r),n=r.clock-i.id.clock,r=i.redone;while(r!==null&&i instanceof re);return{item:i,diff:n}},Mo=(t,e)=>{for(;t!==null&&t.keep!==e;)t.keep=e,t=t.parent._item},ts=(t,e,r)=>{let{client:n,clock:i}=e.id,s=new re(Y(n,i+r),e,Y(n,i+r-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(r));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Y(e.redone.client,e.redone.clock+r)),e.right=s,s.right!==null&&(s.right.left=s),t._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=r,s},wl=(t,e)=>pc(t,r=>wr(r.deletions,e)),tu=(t,e,r,n,i,s)=>{let o=t.doc,c=o.store,f=o.clientID,u=e.redone;if(u!==null)return Ne(t,u);let d=e.parent._item,h=null,p;if(d!==null&&d.deleted===!0){if(d.redone===null&&(!r.has(d)||tu(t,d,r,n,i,s)===null))return null;for(;d.redone!==null;)d=Ne(t,d.redone)}let m=d===null?e.parent:d.content.type;if(e.parentSub===null){for(h=e.left,p=e;h!==null;){let y=h;for(;y!==null&&y.parent._item!==d;)y=y.redone===null?null:Ne(t,y.redone);if(y!==null&&y.parent._item===d){h=y;break}h=h.left}for(;p!==null;){let y=p;for(;y!==null&&y.parent._item!==d;)y=y.redone===null?null:Ne(t,y.redone);if(y!==null&&y.parent._item===d){p=y;break}p=p.right}}else if(p=null,e.right&&!i){for(h=e;h!==null&&h.right!==null&&(h.right.redone||wr(n,h.right.id)||wl(s.undoStack,h.right.id)||wl(s.redoStack,h.right.id));)for(h=h.right;h.redone;)h=Ne(t,h.redone);if(h&&h.right!==null)return null}else h=m._map.get(e.parentSub)||null;let w=le(c,f),b=Y(f,w),R=new re(b,h,h&&h.lastId,p,p&&p.id,m,e.parentSub,e.content.copy());return e.redone=b,Mo(R,!0),R.integrate(t,0),R},re=class t extends $r{constructor(e,r,n,i,s,o,c,f){super(e,f.getLength()),this.origin=n,this.left=r,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=c,this.redone=null,this.content=f,this.info=this.content.isCountable()?2:0}set marker(e){(this.info&8)>0!==e&&(this.info^=8)}get marker(){return(this.info&8)>0}get keep(){return(this.info&1)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(this.info&2)>0}get deleted(){return(this.info&4)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,r){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=le(r,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=le(r,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===vt&&this.id.client!==this.parent.client&&this.parent.clock>=le(r,this.parent.client))return this.parent.client;if(this.origin&&(this.left=ll(e,r,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Ne(e,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===ke||this.right&&this.right.constructor===ke)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===t&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===t&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===vt){let n=Gn(r,this.parent);n.constructor===ke?this.parent=null:this.parent=n.content.type}return null}integrate(e,r){if(r>0&&(this.id.clock+=r,this.left=ll(e,e.doc.store,Y(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(r),this.length-=r),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,i;if(n!==null)i=n.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;let s=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),s.add(i),lr(this.origin,i.origin)){if(i.id.client<this.id.client)n=i,s.clear();else if(lr(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(Gn(e.doc.store,i.origin)))s.has(Gn(e.doc.store,i.origin))||(n=i,s.clear());else break;i=i.right}this.left=n}if(this.left!==null){let n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Cl(e.doc.store,this),this.content.integrate(e,this),dl(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new ke(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Y(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&lr(e.origin,this.lastId)&&this.right===e&&lr(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){let r=this.parent._searchMarker;return r&&r.forEach(n=>{n.p===e&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){let r=this.parent;this.countable&&this.parentSub===null&&(r._length-=this.length),this.markDeleted(),qn(e.deleteSet,this.id.client,this.id.clock,this.length),dl(e,r,this.parentSub),this.content.delete(e)}}gc(e,r){if(!this.deleted)throw De();this.content.gc(e),r?jp(e,this,new ke(this.id,this.length)):this.content=new zr(this.length)}write(e,r){let n=r>0?Y(this.id.client,this.id.clock+r-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=this.content.getRef()&31|(n===null?0:128)|(i===null?0:64)|(s===null?0:32);if(e.writeInfo(o),n!==null&&e.writeLeftID(n),i!==null&&e.writeRightID(i),n===null&&i===null){let c=this.parent;if(c._item!==void 0){let f=c._item;if(f===null){let u=Io(c);e.writeParentInfo(!0),e.writeString(u)}else e.writeParentInfo(!1),e.writeLeftID(f.id)}else c.constructor===String?(e.writeParentInfo(!0),e.writeString(c)):c.constructor===vt?(e.writeParentInfo(!1),e.writeLeftID(c)):De();s!==null&&e.writeString(s)}this.content.write(e,r)}},ru=(t,e)=>Dg[e&31](t),Dg=[()=>{De()},yg,Eg,mg,Sg,_g,bg,Og,vg,wg,()=>{De()}],Lg=10,Ue=class extends $r{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,r){De()}write(e,r){e.writeInfo(Lg),B(e.restEncoder,this.length-r)}getMissing(e,r){return null}},nu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},iu="__ $YJS$ __";nu[iu]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");nu[iu]=!0;var su=1,en="fromPersistence",Tt="document",ou="state",au="version",tn="gutenberg",ni="syncManager",_r="_crdt_document";function Po(t){let e=new Map(Object.entries(t)),r=new Rt({meta:e});return r.getMap(ou).set(au,su),r}function cu(t){return JSON.stringify({document:Br(Qr(t))})}function lu(t){try{let{document:e}=JSON.parse(t),r=new Map;r.set(en,!0);let n=Po({meta:r}),i=Nt(e);return Gt(n,i),n.clientID=Math.floor(Math.random()*1e9),n}catch{return null}}function uu(t){let e=t.meta?.[_r];return e?lu(e):null}function du(t){return{[_r]:cu(t)}}var Zu=V(hu());var br=t=>Et((e,r)=>{t.onerror=n=>r(new Error(n.target.error)),t.onsuccess=n=>e(n.target.result)}),pu=(t,e)=>Et((r,n)=>{let i=indexedDB.open(t);i.onupgradeneeded=s=>e(s.target.result),i.onerror=s=>n(Ae(s.target.error)),i.onsuccess=s=>{let o=s.target.result;o.onversionchange=()=>{o.close()},typeof addEventListener<"u"&&addEventListener("unload",()=>o.close()),r(o)}}),gu=t=>br(indexedDB.deleteDatabase(t)),mu=(t,e)=>e.forEach(r=>t.createObjectStore.apply(t,r)),rn=(t,e,r="readwrite")=>{let n=t.transaction(e,r);return e.map(i=>Bg(n,i))},Bo=(t,e)=>br(t.count(e)),yu=(t,e)=>br(t.get(e)),Vo=(t,e)=>br(t.delete(e)),wu=(t,e,r)=>br(t.put(e,r));var os=(t,e)=>br(t.add(e)),_u=(t,e,r)=>br(t.getAll(e,r));var Ng=(t,e,r)=>{let n=null;return Pg(t,e,i=>(n=i,!1),r).then(()=>n)},bu=(t,e=null)=>Ng(t,e,"prev");var Mg=(t,e)=>Et((r,n)=>{t.onerror=n,t.onsuccess=async i=>{let s=i.target.result;if(s===null||await e(s)===!1)return r();s.continue()}});var Pg=(t,e,r,n="next")=>Mg(t.openKeyCursor(e,n),i=>r(i.key)),Bg=(t,e)=>t.objectStore(e);var Eu=(t,e)=>IDBKeyRange.upperBound(t,e),vu=(t,e)=>IDBKeyRange.lowerBound(t,e);var jo="custom",Su="updates",Ru=500,Cu=(t,e=()=>{},r=()=>{})=>{let[n]=rn(t.db,[Su]);return _u(n,vu(t._dbref,!1)).then(i=>{t._destroyed||(e(n),ee(t.doc,()=>{i.forEach(s=>ti(t.doc,s))},t,!1),r(n))}).then(()=>bu(n).then(i=>{t._dbref=i+1})).then(()=>Bo(n).then(i=>{t._dbsize=i})).then(()=>n)},jg=(t,e=!0)=>Cu(t).then(r=>{(e||t._dbsize>=Ru)&&os(r,Xr(t.doc)).then(()=>Vo(r,Eu(t._dbref,!0))).then(()=>Bo(r).then(n=>{t._dbsize=n}))});var as=class extends Ee{constructor(e,r){super(),this.doc=r,this.name=e,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=pu(e,n=>mu(n,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=Et(n=>this.on("synced",()=>n(this))),this._db.then(n=>{this.db=n,Cu(this,o=>os(o,Xr(r)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(n,i)=>{if(this.db&&i!==this){let[s]=rn(this.db,[Su]);os(s,n),++this._dbsize>=Ru&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{jg(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},r.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),r.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(e=>{e.close()})}clearData(){return this.destroy().then(()=>{gu(this.name)})}get(e){return this._db.then(r=>{let[n]=rn(r,[jo],"readonly");return yu(n,e)})}set(e,r){return this._db.then(n=>{let[i]=rn(n,[jo]);return wu(i,r,e)})}del(e){return this._db.then(r=>{let[n]=rn(r,[jo]);return Vo(n,e)})}};function Tu(t,e,r){let n=`${t}-${e}`,i=new as(n,r);return Promise.resolve({destroy:()=>i.destroy()})}var Fg=1200,Gg=2500,cs=3e4,Fo=t=>{if(t.shouldConnect&&t.ws===null){let e=new WebSocket(t.url),r=t.binaryType,n=null;r&&(e.binaryType=r),t.ws=e,t.connecting=!0,t.connected=!1,e.onmessage=o=>{t.lastMessageReceived=Ve();let c=o.data,f=typeof c=="string"?JSON.parse(c):c;f&&f.type==="pong"&&(clearTimeout(n),n=setTimeout(s,cs/2)),t.emit("message",[f,t])};let i=o=>{t.ws!==null&&(t.ws=null,t.connecting=!1,t.connected?(t.connected=!1,t.emit("disconnect",[{type:"disconnect",error:o},t])):t.unsuccessfulReconnects++,setTimeout(Fo,Ir(mc(t.unsuccessfulReconnects+1)*Fg,Gg),t)),clearTimeout(n)},s=()=>{t.ws===e&&t.send({type:"ping"})};e.onclose=()=>i(null),e.onerror=o=>i(o),e.onopen=()=>{t.lastMessageReceived=Ve(),t.connecting=!1,t.connected=!0,t.unsuccessfulReconnects=0,t.emit("connect",[{type:"connect"},t]),n=setTimeout(s,cs/2)}}},ls=class extends Ee{constructor(e,{binaryType:r}={}){super(),this.url=e,this.ws=null,this.binaryType=r||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&cs<Ve()-this.lastMessageReceived&&this.ws.close()},cs/2),Fo(this)}send(e){this.ws&&this.ws.send(JSON.stringify(e))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Fo(this)}};var xu=new Map,Go=class{constructor(e){this.room=e,this.onmessage=null,this._onChange=r=>r.key===e&&this.onmessage!==null&&this.onmessage({data:Nt(r.newValue||"")}),_c(this._onChange)}postMessage(e){Ai.setItem(this.room,Br(Mc(e)))}close(){bc(this._onChange)}},Kg=typeof BroadcastChannel>"u"?Go:BroadcastChannel,Yo=t=>ne(xu,t,()=>{let e=Je(),r=new Kg(t);return r.onmessage=n=>e.forEach(i=>i(n.data,"broadcastchannel")),{bc:r,subs:e}}),Au=(t,e)=>(Yo(t).subs.add(e),e),Iu=(t,e)=>{let r=Yo(t),n=r.subs.delete(e);return n&&r.subs.size===0&&(r.bc.close(),xu.delete(t)),n},ku=(t,e,r=null)=>{let n=Yo(t);n.bc.postMessage(e),n.subs.forEach(i=>i(e,r))};var Uu=()=>{let t=!0;return(e,r)=>{if(t){t=!1;try{e()}finally{t=!0}}else r!==void 0&&r()}};var Yu=V(Du());var us=0,ds=1,Lu=2,qo=(t,e)=>{B(t,us);let r=Ao(e);ie(t,r)},Ho=(t,e,r)=>{B(t,ds),ie(t,Xr(e,r))},Hg=(t,e,r)=>Ho(e,r,de(t)),Nu=(t,e,r)=>{try{ti(e,de(t),r)}catch(n){console.error("Caught error while handling a Yjs update",n)}},Mu=(t,e)=>{B(t,Lu),ie(t,e)},Wg=Nu,Pu=(t,e,r,n)=>{let i=F(t);switch(i){case us:Hg(t,e,r);break;case ds:Nu(t,r,n);break;case Lu:Wg(t,r,n);break;default:throw new Error("Unknown message type")}return i};var Wo=3e4,fs=class extends Ee{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let r=Ve();this.getLocalState()!==null&&Wo/2<=r-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let n=[];this.meta.forEach((i,s)=>{s!==this.clientID&&Wo<=r-i.lastUpdated&&this.states.has(s)&&n.push(s)}),n.length>0&&hs(this,n,"timeout")},xe(Wo/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){let r=this.clientID,n=this.meta.get(r),i=n===void 0?0:n.clock+1,s=this.states.get(r);e===null?this.states.delete(r):this.states.set(r,e),this.meta.set(r,{clock:i,lastUpdated:Ve()});let o=[],c=[],f=[],u=[];e===null?u.push(r):s==null?e!=null&&o.push(r):(c.push(r),Dr(s,e)||f.push(r)),(o.length>0||f.length>0||u.length>0)&&this.emit("change",[{added:o,updated:f,removed:u},"local"]),this.emit("update",[{added:o,updated:c,removed:u},"local"])}setLocalStateField(e,r){let n=this.getLocalState();n!==null&&this.setLocalState({...n,[e]:r})}getStates(){return this.states}},hs=(t,e,r)=>{let n=[];for(let i=0;i<e.length;i++){let s=e[i];if(t.states.has(s)){if(t.states.delete(s),s===t.clientID){let o=t.meta.get(s);t.meta.set(s,{clock:o.clock+1,lastUpdated:Ve()})}n.push(s)}}n.length>0&&(t.emit("change",[{added:[],updated:[],removed:n},r]),t.emit("update",[{added:[],updated:[],removed:n},r]))},ii=(t,e,r=t.states)=>{let n=e.length,i=ce();B(i,n);for(let s=0;s<n;s++){let o=e[s],c=r.get(o)||null,f=t.meta.get(o).clock;B(i,o),B(i,f),Le(i,JSON.stringify(c))}return te(i)};var Bu=(t,e,r)=>{let n=ae(e),i=Ve(),s=[],o=[],c=[],f=[],u=F(n);for(let d=0;d<u;d++){let h=F(n),p=F(n),m=JSON.parse(Be(n)),w=t.meta.get(h),b=t.states.get(h),R=w===void 0?0:w.clock;(R<p||R===p&&m===null&&t.states.has(h))&&(m===null?h===t.clientID&&t.getLocalState()!=null?p++:t.states.delete(h):t.states.set(h,m),t.meta.set(h,{clock:p,lastUpdated:i}),w===void 0&&m!==null?s.push(h):w!==void 0&&m===null?f.push(h):m!==null&&(Dr(m,b)||c.push(h),o.push(h)))}(s.length>0||c.length>0||f.length>0)&&t.emit("change",[{added:s,updated:c,removed:f},r]),(s.length>0||o.length>0||f.length>0)&&t.emit("update",[{added:s,updated:o,removed:f},r])};var Vu=(t,e)=>{let r=Tn(t).buffer,n=Tn(e).buffer;return crypto.subtle.importKey("raw",r,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},$o=(t,e)=>{if(!e)return Bn(t);let r=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,t).then(n=>{let i=ce();return Le(i,"AES-GCM"),ie(i,r),ie(i,new Uint8Array(n)),te(i)})},ju=(t,e)=>{let r=ce();return Mt(r,t),$o(te(r),e)},zo=(t,e)=>{if(!e)return Bn(t);let r=ae(t);Be(r)!=="AES-GCM"&&qc(Ae("Unknown encryption algorithm"));let i=de(r),s=de(r);return crypto.subtle.decrypt({name:"AES-GCM",iv:i},e,s).then(o=>new Uint8Array(o))},ps=(t,e)=>zo(t,e).then(r=>Dt(ae(new Uint8Array(r))));var be=Qc("y-webrtc"),nn=0,Ku=3,si=1,Xo=4,sn=new Map,et=new Map,qu=t=>{let e=!0;t.webrtcConns.forEach(r=>{r.synced||(e=!1)}),(!e&&t.synced||e&&!t.synced)&&(t.synced=e,t.provider.emit("synced",[{synced:e}]),be("synced ",Ie,t.name,Xe," with all peers"))},Hu=(t,e,r)=>{let n=ae(e),i=ce(),s=F(n);if(t===void 0)return null;let o=t.awareness,c=t.doc,f=!1;switch(s){case nn:{B(i,nn);let u=Pu(n,i,c,t);u===ds&&!t.synced&&r(),u===us&&(f=!0);break}case Ku:B(i,si),ie(i,ii(o,Array.from(o.getStates().keys()))),f=!0;break;case si:Bu(o,de(n),t);break;case Xo:{let u=_t(n)===1,d=Be(n);if(d!==t.peerId&&(t.bcConns.has(d)&&!u||!t.bcConns.has(d)&&u)){let h=[],p=[];u?(t.bcConns.add(d),p.push(d)):(t.bcConns.delete(d),h.push(d)),t.provider.emit("peers",[{added:p,removed:h,webrtcPeers:Array.from(t.webrtcConns.keys()),bcPeers:Array.from(t.bcConns)}]),Wu(t)}break}default:return console.error("Unable to compute message"),i}return f?i:null},Jg=(t,e)=>{let r=t.room;return be("received message from ",Ie,t.remotePeerId,Fr," (",r.name,")",Xe,ar),Hu(r,e,()=>{t.synced=!0,be("synced ",Ie,r.name,Xe," with ",Ie,t.remotePeerId),qu(r)})},Jo=(t,e)=>{be("send message to ",Ie,t.remotePeerId,Xe,Fr," (",t.room.name,")",ar);try{t.peer.send(te(e))}catch{}},Qg=(t,e)=>{be("broadcast message in ",Ie,t.name,Xe),t.webrtcConns.forEach(r=>{try{r.peer.send(e)}catch{}})},oi=class{constructor(t,e,r,n){be("establishing connection to ",Ie,r),this.room=n,this.remotePeerId=r,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Yu.default({initiator:e,...n.provider.peerOpts}),this.peer.on("signal",i=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),ai(t,n,{to:r,from:n.peerId,type:"signal",token:this.glareToken,signal:i})}),this.peer.on("connect",()=>{be("connected to ",Ie,r),this.connected=!0;let s=n.provider.doc,o=n.awareness,c=ce();B(c,nn),qo(c,s),Jo(this,c);let f=o.getStates();if(f.size>0){let u=ce();B(u,si),ie(u,ii(o,Array.from(f.keys()))),Jo(this,u)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,n.webrtcConns.has(this.remotePeerId)&&(n.webrtcConns.delete(this.remotePeerId),n.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(n.webrtcConns.keys()),bcPeers:Array.from(n.bcConns)}])),qu(n),this.peer.destroy(),be("closed connection to ",Ie,r),Qo(n)}),this.peer.on("error",i=>{be("Error in connection to ",Ie,r,": ",i),Qo(n)}),this.peer.on("data",i=>{let s=Jg(this,i);s!==null&&Jo(this,s)})}destroy(){this.peer.destroy()}},Yt=(t,e)=>$o(e,t.key).then(r=>t.mux(()=>ku(t.name,r))),Gu=(t,e)=>{t.bcconnected&&Yt(t,e),Qg(t,e)},Qo=t=>{sn.forEach(e=>{e.connected&&(e.send({type:"subscribe",topics:[t.name]}),t.webrtcConns.size<t.provider.maxConns&&ai(e,t,{type:"announce",from:t.peerId}))})},Wu=t=>{if(t.provider.filterBcConns){let e=ce();B(e,Xo),bt(e,1),Le(e,t.peerId),Yt(t,te(e))}},Xg=class{constructor(t,e,r,n){this.peerId=Di(),this.doc=t,this.awareness=e.awareness,this.provider=e,this.synced=!1,this.name=r,this.key=n,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=Uu(),this.bcconnected=!1,this._bcSubscriber=i=>zo(new Uint8Array(i),n).then(s=>this.mux(()=>{let o=Hu(this,s,()=>{});o&&Yt(this,te(o))})),this._docUpdateHandler=(i,s)=>{let o=ce();B(o,nn),Mu(o,i),Gu(this,te(o))},this._awarenessUpdateHandler=({added:i,updated:s,removed:o},c)=>{let f=i.concat(s).concat(o),u=ce();B(u,si),ie(u,ii(this.awareness,f)),Gu(this,te(u))},this._beforeUnloadHandler=()=>{hs(this.awareness,[t.clientID],"window unload"),et.forEach(i=>{i.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Qo(this);let t=this.name;Au(t,this._bcSubscriber),this.bcconnected=!0,Wu(this);let e=ce();B(e,nn),qo(e,this.doc),Yt(this,te(e));let r=ce();B(r,nn),Ho(r,this.doc),Yt(this,te(r));let n=ce();B(n,Ku),Yt(this,te(n));let i=ce();B(i,si),ie(i,ii(this.awareness,[this.doc.clientID])),Yt(this,te(i))}disconnect(){sn.forEach(e=>{e.connected&&e.send({type:"unsubscribe",topics:[this.name]})}),hs(this.awareness,[this.doc.clientID],"disconnect");let t=ce();B(t,Xo),bt(t,0),Le(t,this.peerId),Yt(this,te(t)),Iu(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(e=>e.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}},Zg=(t,e,r,n)=>{if(et.has(r))throw Ae(`A Yjs Doc connected to room "${r}" already exists!`);let i=new Xg(t,e,r,n);return et.set(r,i),i},ai=(t,e,r)=>{e.key?ju(r,e.key).then(n=>{t.send({type:"publish",topic:e.name,data:Br(n)})}):t.send({type:"publish",topic:e.name,data:r})},Zo=class extends ls{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{be(`connected (${t})`);let e=Array.from(et.keys());this.send({type:"subscribe",topics:e}),et.forEach(r=>ai(this,r,{type:"announce",from:r.peerId}))}),this.on("message",e=>{switch(e.type){case"publish":{let r=e.topic,n=et.get(r);if(n==null||typeof r!="string")return;let i=s=>{let o=n.webrtcConns,c=n.peerId;if(s==null||s.from===c||s.to!==void 0&&s.to!==c||n.bcConns.has(s.from))return;let f=o.has(s.from)?()=>{}:()=>n.provider.emit("peers",[{removed:[],added:[s.from],webrtcPeers:Array.from(n.webrtcConns.keys()),bcPeers:Array.from(n.bcConns)}]);switch(s.type){case"announce":o.size<n.provider.maxConns&&(ne(o,s.from,()=>new oi(this,!0,s.from,n)),f());break;case"signal":if(s.signal.type==="offer"){let u=o.get(s.from);if(u){let d=s.token,h=u.glareToken;if(h&&h>d){be("offer rejected: ",s.from);return}u.glareToken=void 0}}if(s.signal.type==="answer"){be("offer answered by: ",s.from);let u=o.get(s.from);u.glareToken=void 0}s.to===c&&(ne(o,s.from,()=>new oi(this,!1,s.from,n)).peer.signal(s.signal),f());break}};n.key?typeof e.data=="string"&&ps(Nt(e.data),n.key).then(i):i(e.data)}}}),this.on("disconnect",()=>be(`disconnect (${t})`))}},$u=class extends Ee{constructor(t,e,{signaling:r=["wss://y-webrtc-eu.fly.dev"],password:n=null,awareness:i=new fs(e),maxConns:s=20+xe(Yc()*15),filterBcConns:o=!0,peerOpts:c={}}={}){super(),this.roomName=t,this.doc=e,this.filterBcConns=o,this.awareness=i,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=s,this.peerOpts=c,this.key=n?Vu(n,t):Bn(null),this.room=null,this.key.then(f=>{this.room=Zg(e,this,t,f),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),e.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{let e=ne(sn,t,()=>new Zo(t));this.signalingConns.push(e),e.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),sn.delete(t.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),et.delete(this.roomName)}),super.destroy()}};var Ju=V(gt());function em(t,e){t.on("connect",()=>{be(`connected (${e})`);let r=Array.from(et.keys());t.send({type:"subscribe",topics:r}),et.forEach(n=>ai(t,n,{type:"announce",from:n.peerId}))}),t.on("message",r=>{switch(r.type){case"publish":{let n=r.topic,i=et.get(n);if(i===null||typeof n!="string"||i===void 0)return;let s=o=>{let c=i.webrtcConns,f=i.peerId;if(o===null||o.from===f||o.to!==void 0&&o.to!==f||i.bcConns.has(o.from))return;let u=c.has(o.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[o.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(o.type){case"announce":c.size<i.provider.maxConns&&(ne(c,o.from,()=>new oi(t,!0,o.from,i)),u());break;case"signal":if(o.signal.type==="offer"){let d=c.get(o.from);if(d){let h=o.token,p=d.glareToken;if(p&&p>h){be("offer rejected: ",o.from);return}d.glareToken=void 0}}if(o.signal.type==="answer"){be("offer answered by: ",o.from);let d=c.get(o.from);d&&(d.glareToken=void 0)}o.to===f&&(ne(c,o.from,()=>new oi(t,!1,o.from,i)).peer.signal(o.signal),u());break}};i.key?typeof r.data=="string"&&ps(Nt(r.data),i.key).then(s):s(r.data)}}}),t.on("disconnect",()=>be(`disconnect (${e})`))}function zu(t){if(t.shouldConnect&&t.ws===null){let e=Math.floor(1e5+Math.random()*9e5),r=t.url,n=new window.EventSource((0,Ju.addQueryArgs)(r,{subscriber_id:e,action:"gutenberg_signaling_server"})),i=null;n.onmessage=f=>{t.lastMessageReceived=Date.now();let u=f.data;if(u){let d=JSON.parse(u);Array.isArray(d)&&d.forEach(s)}},t.ws=n,t.connecting=!0,t.connected=!1;let s=f=>{f&&f.type==="pong"&&(clearTimeout(i),i=setTimeout(c,gs/2)),t.emit("message",[f,t])},o=f=>{t.ws!==null&&(t.ws.close(),t.ws=null,t.connecting=!1,t.connected?(t.connected=!1,t.emit("disconnect",[{type:"disconnect",error:f},t])):t.unsuccessfulReconnects++),clearTimeout(i)},c=()=>{t.ws&&t.ws.readyState===window.EventSource.OPEN&&t.send({type:"ping"})};t.ws&&(t.ws.onclose=()=>{o(null)},t.ws.send=function(u){window.fetch(r,{body:new URLSearchParams({subscriber_id:e.toString(),action:"gutenberg_signaling_server",message:u}),method:"POST"}).catch(()=>{be("Error sending to server with message: "+u)})}),n.onerror=()=>{},n.onopen=()=>{t.connected||n.readyState===window.EventSource.OPEN&&(t.lastMessageReceived=Date.now(),t.connecting=!1,t.connected=!0,t.unsuccessfulReconnects=0,t.emit("connect",[{type:"connect"},t]),i=setTimeout(c,gs/2))}}}var gs=3e4,tm=class extends Ee{constructor(t){super(),this.url=t,this.ws=null,this.binaryType=null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&gs<Date.now()-this.lastMessageReceived&&this.ws&&this.ws.close()},gs/2),zu(this),this.providers=new Set,em(this,t)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&zu(this)}},Qu=class extends $u{connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{let e=ne(sn,t,t.startsWith("ws://")||t.startsWith("wss://")?()=>new Zo(t):()=>new tm(t));this.signalingConns.push(e),e.providers.add(this)}),this.room&&this.room.connect()}};function Xu({signaling:t,password:e}){return function(r,n,i){let s=`${r}-${n}`,o=new Qu(s,i,{signaling:t,password:e});return Promise.resolve({destroy:()=>o.destroy()})}}var on=null;function rm(){let t=window?.wp?.ajax?.settings?.url;return t?[Tu,Xu({password:window?.__experimentalCollaborativeEditingSecret,signaling:[t]})]:[]}function nm(t){return typeof t=="function"}function ed(){if(on)return on;let t=(0,Zu.applyFilters)("sync.providers",rm());return Array.isArray(t)?(on=t.filter(nm),on):(on=[],on)}var td=(t,e)=>{let r=e==="undo"?t.undoStack:t.redoStack;for(;r.length>0;){let n=r.pop(),i=e==="undo"?n.undoStack:n.redoStack,s=i.pop(),o=!1;if(e==="undo"?(n.undoStack=[s],o=n.undo()!==null,n.undoStack=i):(n.redoStack=[s],o=n.redo()!==null,n.redoStack=i),o)return s}return null},rd=class extends Ee{constructor(t=[],e={}){super(),this.docs=new Map,this.trackedOrigins=e.trackedOrigins||new Set([null]),e.trackedOrigins=this.trackedOrigins,this._defaultOpts=e,this.undoStack=[],this.redoStack=[],this.addToScope(t)}addToScope(t){t=er(t)?t:[t],t.forEach(e=>{let r=e.doc,n=ne(this.docs,r,()=>{let i=new fr([e],this._defaultOpts);return i.on("stack-cleared",({undoStackCleared:s,redoStackCleared:o})=>{this.clear(s,o)}),r.on("destroy",()=>{this.docs.delete(r),this.undoStack=this.undoStack.filter(s=>s.doc!==r),this.redoStack=this.redoStack.filter(s=>s.doc!==r)}),i.on("stack-item-added",s=>{(s.type==="undo"?this.undoStack:this.redoStack).push(i),this.emit("stack-item-added",[{...s,ydoc:r},this])}),i.on("stack-item-updated",s=>{this.emit("stack-item-updated",[{...s,ydoc:r},this])}),i.on("stack-item-popped",s=>{this.emit("stack-item-popped",[{...s,ydoc:r},this])}),i});n.scope.every(i=>i!==e)&&n.scope.push(e)})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}undo(){return td(this,"undo")}redo(){return td(this,"redo")}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&(this.docs.forEach(r=>{t&&(this.undoStack=[]),e&&(this.redoStack=[]),r.clear(t,e)}),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}]))}stopCapturing(){this.docs.forEach(t=>{t.stopCapturing()})}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.docs.forEach(t=>t.destroy()),super.destroy()}};function nd(){let t=new rd([],{captureTimeout:200,trackedOrigins:new Set([tn])});return{addRecord(e,r=!1){},addToScope(e){t.addToScope(e)},undo(){if(t.canUndo())return t.undo(),[]},redo(){if(t.canRedo())return t.redo(),[]},hasUndo(){return t.canUndo()},hasRedo(){return t.canRedo()}}}function ea(){let t=new Map,e=nd();async function r(u,d,h,p,m){let w=ed();if(w.length===0)return;let b=i(d,h);if(t.has(b))return;let R=Po({objectType:d}),y=R.getMap(Tt),_=()=>{S.forEach(D=>D.destroy()),y.unobserveDeep(E),R.destroy(),t.delete(b)},E=(D,T)=>{T.local&&!(T.origin instanceof fr)||c(d,h)};e.addToScope(y);let C={handlers:m,objectId:h,objectType:d,syncConfig:u,unload:_,ydoc:R};t.set(b,C);let S=await Promise.all(w.map(D=>D(d,h,R)));if(y.observeDeep(E),s(u,R,p)){R.transact(()=>{u.applyChangesToCRDTDoc(R,p)},ni);let D=f(d,h);m.editRecord({meta:D}),m.saveRecord()}}function n(u,d){t.get(i(u,d))?.unload()}function i(u,d){return`${u}_${d}`}function s(u,d,h){if(!u.supports?.crdtPersistence)return!0;let p=uu(h);if(!p)return!0;let m=Qr(p);d.transact(()=>{Gt(d,m)},ni);let w=u.getChangesFromCRDTDoc(p,h);return p.destroy(),Object.keys(w).length>0}function o(u,d,h,p){let m=i(u,d),w=t.get(m);if(!w)return;let{syncConfig:b,ydoc:R}=w;R.transact(()=>{b.applyChangesToCRDTDoc(R,h)},p)}async function c(u,d){let h=i(u,d),p=t.get(h);if(!p)return;let{handlers:m,syncConfig:w,ydoc:b}=p,R=w.getChangesFromCRDTDoc(b,await m.getEditedRecord());Object.keys(R).length!==0&&m.editRecord(R)}function f(u,d){let h=i(u,d),p=t.get(h);return p?.syncConfig.supports?.crdtPersistence?du(p.ydoc):{}}return{createMeta:f,load:r,undoManager:e,unload:n,update:o}}var ms;function Kt(){return ms||(ms=ea(),ms)}var pd=V(xr()),gd=V(Rn());var ys,im=new Uint8Array(16);function ta(){if(!ys&&(ys=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ys))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ys(im)}var Ce=[];for(let t=0;t<256;++t)Ce.push((t+256).toString(16).slice(1));function id(t,e=0){return Ce[t[e+0]]+Ce[t[e+1]]+Ce[t[e+2]]+Ce[t[e+3]]+"-"+Ce[t[e+4]]+Ce[t[e+5]]+"-"+Ce[t[e+6]]+Ce[t[e+7]]+"-"+Ce[t[e+8]]+Ce[t[e+9]]+"-"+Ce[t[e+10]]+Ce[t[e+11]]+Ce[t[e+12]]+Ce[t[e+13]]+Ce[t[e+14]]+Ce[t[e+15]]}var sm=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ra={randomUUID:sm};function om(t,e,r){if(ra.randomUUID&&!e&&!t)return ra.randomUUID();t=t||{};let n=t.random||(t.rng||ta)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return id(n)}var ci=om;var _s=V(xr()),od=V(na());var ad=V(Rn()),ia=new WeakMap;function am(t){let e={...t};for(let[r,n]of Object.entries(t))n instanceof od.RichTextData&&(e[r]=n.valueOf());return e}function cd(t){return t.map(e=>{let r=e instanceof Se.Map?e.toJSON():e,{name:n,innerBlocks:i,attributes:s,...o}=r;return delete o.validationIssues,delete o.originalContent,{...o,name:n,attributes:am(s),innerBlocks:cd(i)}})}function sa(t,e){let r=e.toJSON(),n={innerBlocks:null,clientId:null},i=(0,_s.default)(Object.assign({},t,n),Object.assign({},r,n)),s=t.innerBlocks||[],o=e.get("innerBlocks");return i&&s.length===o.length&&s.every((c,f)=>sa(c,o.get(f)))}function ld(t,e){return new Se.Map(Object.entries(e).map(([r,n])=>[r,ud(t,r,n)]))}function ud(t,e,r){return fd(t,e)?new Se.Text(r?.toString()??""):r}function dd(t){return new Se.Map(Object.entries(t).map(([e,r])=>{switch(e){case"attributes":return[e,ld(t.name,r)];case"innerBlocks":{let n=new Se.Array;return Array.isArray(r)?(n.insert(0,r.map(i=>dd(i))),[e,n]):[e,n]}default:return[e,r]}}))}function oa(t,e,r){ia.has(e)||ia.set(e,cd(e));let i=(ia.get(e)??[]).filter(p=>cm(p)),s=Math.min(i.length??0,t.length),o=0,c=0;for(;o<s&&sa(i[o],t.get(o));o++);for(;c<s-o&&sa(i[i.length-c-1],t.get(t.length-c-1));c++);let f=s-o-c,u=Math.max(0,i.length-t.length),d=Math.max(0,t.length-i.length);for(let p=0;p<f;p++,o++){let m=i[o],w=t.get(o);Object.entries(m).forEach(([b,R])=>{switch(b){case"attributes":{let y=w.get(b);if(!y){w.set(b,ld(m.name,R));break}Object.entries(R).forEach(([_,E])=>{if((0,_s.default)(y?.get(_),E))return;if(fd(m.name,_)&&typeof E=="string"){let S=y.get(_);lm(S,E,r)}else y.set(_,ud(m.name,_,E))}),y.forEach((_,E)=>{R.hasOwnProperty(E)||y.delete(E)});break}case"innerBlocks":{let y=w.get(b);oa(y,R??[],r);break}default:(0,_s.default)(m[b],w.get(b))||w.set(b,R)}}),w.forEach((b,R)=>{m.hasOwnProperty(R)||w.delete(R)})}t.delete(o,d);for(let p=0;p<u;p++,o++){let m=[dd(i[o])];t.insert(o,m)}let h=new Set;for(let p=0;p<t.length;p++){let m=t.get(p),w=m.get("clientId");h.has(w)&&(w=ci(),m.set("clientId",w)),h.add(w)}}function cm(t){return t.name==="core/gallery"?!t.innerBlocks.some(e=>e.attributes&&e.attributes.blob):!0}var ws;function fd(t,e){if(!ws){ws=new Map;for(let r of(0,ad.getBlockTypes)()){let n=new Map;for(let[i,s]of Object.entries(r.attributes??{}))s.type==="rich-text"&&n.set(i,!0);ws.set(r.name,n)}}return ws.get(t)?.has(e)??!1}function lm(t,e,r){t.delete(0,t.toString().length),t.insert(0,e)}var hd=null,md=new Set(["author","blocks","comment_status","date","excerpt","featured_media","format","ping_status","meta","slug","status","sticky","tags","template","title"]),yd=new Set([_r]);function wd(t,e){let r=t.getMap(Tt);Object.entries(e).forEach(([n,i])=>{if(typeof i=="function")return;function s(o){r.set(n,o)}{let o=r.get(n);cn(o,i,s)}})}function _d(t,e,r){let n=t.getMap(Tt);Object.entries(e).forEach(([i,s])=>{if(!md.has(i)||typeof s=="function")return;function o(c){n.set(i,c)}switch(i){case"blocks":{let c=n.get("blocks");c instanceof Se.Array||(c=new Se.Array,o(c)),oa(c,s??[],hd);break}case"excerpt":{let c=n.get("excerpt"),f=aa(s);cn(c,f,o);break}case"meta":{let c=n.get("meta");c instanceof Se.Map||(c=new Se.Map,o(c)),Object.entries(s??{}).forEach(([f,u])=>{yd.has(f)||cn(c.get(f),u,d=>{c.set(f,d)})});break}case"slug":{if(!s)break;let c=n.get("slug");cn(c,s,o);break}case"title":{let c=n.get("title"),f=aa(s);!c&&f==="Auto Draft"&&(f=""),cn(c,f,o);break}default:{let c=n.get(i);cn(c,s,o)}}}),"selection"in e&&(hd=e.selection?.selectionStart??null)}function bd(t){return t.getMap(Tt).toJSON()}function Ed(t,e,r){let n=t.getMap(Tt),i={},s=Object.fromEntries(Object.entries(n.toJSON()).filter(([o,c])=>{if(!md.has(o))return!1;let f=e[o];switch(o){case"blocks":{if(t.meta?.get(en)&&e.content){let u=n.get("blocks");return(0,gd.__unstableSerializeAndClean)(u.toJSON()).trim()!==e.content.raw.trim()}return!0}case"date":{let u=["draft","auto-draft","pending"].includes(n.get("status"))&&(f===null||e.modified===f);return!c&&u?!1:an(f,c)}case"meta":{i=Object.fromEntries(Object.entries(c??{}).filter(([d])=>!yd.has(d)));let u={...f,...i};return an(f,u)}case"status":return c==="auto-draft"?!1:an(f,c);case"excerpt":case"title":return an(aa(f),c);default:return an(f,c)}}));return typeof s.meta=="object"&&(s.meta={...e.meta,...i}),s}function aa(t){if(typeof t=="string")return t;if(t&&typeof t=="object"&&"raw"in t&&typeof t.raw=="string")return t.raw}function an(t,e){return!(0,pd.default)(t,e)}function cn(t,e,r){an(t,e)&&r(e)}var pe="id",um=["title","excerpt","content"],dm={blocks:{read:t=>(0,Es.parse)(t.content?.raw??""),write:t=>({content:(0,Es.__unstableSerializeAndClean)(t.blocks)})}},vs=[{label:(0,he.__)("Base"),kind:"root",key:!1,name:"__unstableBase",baseURL:"/",baseURLParams:{_fields:["description","gmt_offset","home","name","site_icon","site_icon_url","site_logo","timezone_string","url","page_for_posts","page_on_front","show_on_front"].join(",")},plural:"__unstableBases"},{label:(0,he.__)("Post Type"),name:"postType",kind:"root",key:"slug",baseURL:"/wp/v2/types",baseURLParams:{context:"edit"},plural:"postTypes"},{name:"media",kind:"root",baseURL:"/wp/v2/media",baseURLParams:{context:"edit"},plural:"mediaItems",label:(0,he.__)("Media"),rawAttributes:["caption","title","description"],supportsPagination:!0},{name:"taxonomy",kind:"root",key:"slug",baseURL:"/wp/v2/taxonomies",baseURLParams:{context:"edit"},plural:"taxonomies",label:(0,he.__)("Taxonomy")},{name:"sidebar",kind:"root",baseURL:"/wp/v2/sidebars",baseURLParams:{context:"edit"},plural:"sidebars",transientEdits:{blocks:!0},label:(0,he.__)("Widget areas")},{name:"widget",kind:"root",baseURL:"/wp/v2/widgets",baseURLParams:{context:"edit"},plural:"widgets",transientEdits:{blocks:!0},label:(0,he.__)("Widgets")},{name:"widgetType",kind:"root",baseURL:"/wp/v2/widget-types",baseURLParams:{context:"edit"},plural:"widgetTypes",label:(0,he.__)("Widget types")},{label:(0,he.__)("User"),name:"user",kind:"root",baseURL:"/wp/v2/users",getTitle:t=>t?.name||t?.slug,baseURLParams:{context:"edit"},plural:"users",supportsPagination:!0},{name:"comment",kind:"root",baseURL:"/wp/v2/comments",baseURLParams:{context:"edit"},plural:"comments",label:(0,he.__)("Comment"),supportsPagination:!0},{name:"menu",kind:"root",baseURL:"/wp/v2/menus",baseURLParams:{context:"edit"},plural:"menus",label:(0,he.__)("Menu"),supportsPagination:!0},{name:"menuItem",kind:"root",baseURL:"/wp/v2/menu-items",baseURLParams:{context:"edit"},plural:"menuItems",label:(0,he.__)("Menu Item"),rawAttributes:["title"],supportsPagination:!0},{name:"menuLocation",kind:"root",baseURL:"/wp/v2/menu-locations",baseURLParams:{context:"edit"},plural:"menuLocations",label:(0,he.__)("Menu Location"),key:"name"},{label:(0,he.__)("Global Styles"),name:"globalStyles",kind:"root",baseURL:"/wp/v2/global-styles",baseURLParams:{context:"edit"},plural:"globalStylesVariations",getTitle:()=>(0,he.__)("Custom Styles"),getRevisionsUrl:(t,e)=>`/wp/v2/global-styles/${t}/revisions${e?"/"+e:""}`,supportsPagination:!0},{label:(0,he.__)("Themes"),name:"theme",kind:"root",baseURL:"/wp/v2/themes",baseURLParams:{context:"edit"},plural:"themes",key:"stylesheet"},{label:(0,he.__)("Plugins"),name:"plugin",kind:"root",baseURL:"/wp/v2/plugins",baseURLParams:{context:"edit"},plural:"plugins",key:"plugin"},{label:(0,he.__)("Status"),name:"status",kind:"root",baseURL:"/wp/v2/statuses",baseURLParams:{context:"edit"},plural:"statuses",key:"slug"},{label:(0,he.__)("Registered Templates"),name:"registeredTemplate",kind:"root",baseURL:"/wp/v2/registered-templates",key:"id"},{label:(0,he.__)("Font Collections"),name:"fontCollection",kind:"root",baseURL:"/wp/v2/font-collections",baseURLParams:{context:"view"},plural:"fontCollections",key:"slug"}],vd={root:{media:{since:"6.9",alternative:{kind:"postType",name:"attachment"}}}},Ss=[{kind:"postType",loadEntities:hm},{kind:"taxonomy",loadEntities:pm},{kind:"root",name:"site",plural:"sites",loadEntities:gm}],fm=(t,e,r,n)=>{let i={};if(!n&&t?.status==="auto-draft"&&(!e.status&&!i.status&&(i.status="draft"),(!e.title||e.title==="Auto Draft")&&!i.title&&(!t?.title||t?.title==="Auto Draft")&&(i.title="")),t&&window.__experimentalEnableSync){let s=`postType/${r}`,o=t.id,c=Kt()?.createMeta(s,o);i.meta={...e.meta,...c}}return i};async function hm(){let t=await(0,bs.default)({path:"/wp/v2/types?context=view"});return Object.entries(t??{}).map(([e,r])=>{let n=["wp_template","wp_template_part"].includes(e),i=r?.rest_namespace??"wp/v2",s={kind:"postType",baseURL:`/${i}/${r.rest_base}`,baseURLParams:{context:"edit"},name:e,label:r.name,transientEdits:{...dm,selection:!0},mergedEdits:{meta:!0},rawAttributes:um,getTitle:o=>o?.title?.rendered||o?.title||(n?ac(o.slug??""):String(o.id)),__unstablePrePersist:(o,c)=>fm(o,c,e,n),__unstable_rest_base:r.rest_base,supportsPagination:!0,getRevisionsUrl:(o,c)=>`/${i}/${r.rest_base}/${o}/revisions${c?"/"+c:""}`,revisionKey:n&&!window?.__experimentalTemplateActivate?"wp_id":pe};return window.__experimentalEnableSync&&(s.syncConfig={applyChangesToCRDTDoc:(o,c)=>_d(o,c,r),getChangesFromCRDTDoc:(o,c)=>Ed(o,c,r),supports:{crdtPersistence:!0}}),s})}async function pm(){let t=await(0,bs.default)({path:"/wp/v2/taxonomies?context=view"});return Object.entries(t??{}).map(([e,r])=>({kind:"taxonomy",baseURL:`/${r?.rest_namespace??"wp/v2"}/${r.rest_base}`,baseURLParams:{context:"edit"},name:e,label:r.name,getTitle:i=>i?.name,supportsPagination:!0}))}async function gm(){let t={label:(0,he.__)("Site"),name:"site",kind:"root",key:!1,baseURL:"/wp/v2/settings",meta:{}};window.__experimentalEnableSync&&(t.syncConfig={applyChangesToCRDTDoc:wd,getChangesFromCRDTDoc:bd});let e=await(0,bs.default)({path:t.baseURL,method:"OPTIONS"}),r={};return Object.entries(e?.schema?.properties??{}).forEach(([n,i])=>{typeof i=="object"&&i.title&&(r[n]=i.title)}),[{...t,meta:{labels:r}}]}var Er=(t,e,r="get")=>{let n=t==="root"?"":Sn(t),i=Sn(e);return`${r}${n}${i}`};function Cd(t){let{query:e}=t;return e?Ut(e).context:"default"}function mm(t,e,r,n){if(r===1&&n===-1)return e;let s=(r-1)*n,o=Math.max(t?.length??0,s+e.length),c=new Array(o);for(let f=0;f<o;f++){let u=f>=s&&f<s+n;c[f]=u?e[f-s]:t?.[f]}return c}function Td(t,e){return Object.fromEntries(Object.entries(t).filter(([r])=>!e.some(n=>Number.isInteger(n)?n===+r:n===r)))}function ym(t={},e){switch(e.type){case"RECEIVE_ITEMS":{let r=Cd(e),n=e.key||pe;return{...t,[r]:{...t[r],...e.items.reduce((i,s)=>{let o=s?.[n];return i[o]=Bs(t?.[r]?.[o],s),i},{})}}}case"REMOVE_ITEMS":return Object.fromEntries(Object.entries(t).map(([r,n])=>[r,Td(n,e.itemIds)]))}return t}function wm(t={},e){switch(e.type){case"RECEIVE_ITEMS":{let r=Cd(e),{query:n,key:i=pe}=e,s=n?Ut(n):{},o=!n||!Array.isArray(s.fields);return{...t,[r]:{...t[r],...e.items.reduce((c,f)=>{let u=f?.[i];return c[u]=t?.[r]?.[u]||o,c},{})}}}case"REMOVE_ITEMS":return Object.fromEntries(Object.entries(t).map(([r,n])=>[r,Td(n,e.itemIds)]))}return t}var _m=(0,Rd.compose)([wn(t=>"query"in t),_n(t=>t.query?{...t,...Ut(t.query)}:t),Ei("context"),Ei("stableKey")])((t={},e)=>{let{type:r,page:n,perPage:i,key:s=pe}=e;return r!=="RECEIVE_ITEMS"?t:{itemIds:mm(t?.itemIds||[],e.items.map(o=>o?.[s]).filter(Boolean),n,i),meta:e.meta}}),bm=(t={},e)=>{switch(e.type){case"RECEIVE_ITEMS":return _m(t,e);case"REMOVE_ITEMS":let r=e.itemIds.reduce((n,i)=>(n[i]=!0,n),{});return Object.fromEntries(Object.entries(t).map(([n,i])=>[n,Object.fromEntries(Object.entries(i).map(([s,o])=>[s,{...o,itemIds:o.itemIds.filter(c=>!r[c])}]))]));default:return t}},Rs=(0,Sd.combineReducers)({items:ym,itemIsComplete:wm,queries:bm});function Em(t={byId:{},queries:{}},e){switch(e.type){case"RECEIVE_USER_QUERY":return{byId:{...t.byId,...e.users.reduce((r,n)=>({...r,[n.id]:n}),{})},queries:{...t.queries,[e.queryID]:e.users.map(r=>r.id)}}}return t}function vm(t={},e){switch(e.type){case"RECEIVE_CURRENT_USER":return e.currentUser}return t}function Sm(t=void 0,e){switch(e.type){case"RECEIVE_CURRENT_THEME":return e.currentTheme.stylesheet}return t}function Rm(t=void 0,e){switch(e.type){case"RECEIVE_CURRENT_GLOBAL_STYLES_ID":return e.id}return t}function Cm(t={},e){switch(e.type){case"RECEIVE_THEME_GLOBAL_STYLES":return{...t,[e.stylesheet]:e.globalStyles}}return t}function Tm(t={},e){switch(e.type){case"RECEIVE_THEME_GLOBAL_STYLE_VARIATIONS":return{...t,[e.stylesheet]:e.variations}}return t}var xm=t=>(e,r)=>{if(r.type==="UNDO"||r.type==="REDO"){let{record:n}=r,i=e;return n.forEach(({id:{kind:s,name:o,recordId:c},changes:f})=>{i=t(i,{type:"EDIT_ENTITY_RECORD",kind:s,name:o,recordId:c,edits:Object.entries(f).reduce((u,[d,h])=>(u[d]=r.type==="UNDO"?h.from:h.to,u),{})})}),i}return t(e,r)};function Am(t){return(0,xd.compose)([xm,wn(e=>e.name&&e.kind&&e.name===t.name&&e.kind===t.kind),_n(e=>({key:t.key||pe,...e}))])((0,li.combineReducers)({queriedData:Rs,edits:(e={},r)=>{switch(r.type){case"RECEIVE_ITEMS":if((r?.query?.context??"default")!=="default")return e;let i={...e};for(let o of r.items){let c=o?.[r.key],f=i[c];if(!f)continue;let u=Object.keys(f).reduce((d,h)=>(!(0,ca.default)(f[h],o[h]?.raw??o[h])&&(!r.persistedEdits||!(0,ca.default)(f[h],r.persistedEdits[h]))&&(d[h]=f[h]),d),{});Object.keys(u).length?i[c]=u:delete i[c]}return i;case"EDIT_ENTITY_RECORD":let s={...e[r.recordId],...r.edits};return Object.keys(s).forEach(o=>{s[o]===void 0&&delete s[o]}),{...e,[r.recordId]:s}}return e},saving:(e={},r)=>{switch(r.type){case"SAVE_ENTITY_RECORD_START":case"SAVE_ENTITY_RECORD_FINISH":return{...e,[r.recordId]:{pending:r.type==="SAVE_ENTITY_RECORD_START",error:r.error,isAutosave:r.isAutosave}}}return e},deleting:(e={},r)=>{switch(r.type){case"DELETE_ENTITY_RECORD_START":case"DELETE_ENTITY_RECORD_FINISH":return{...e,[r.recordId]:{pending:r.type==="DELETE_ENTITY_RECORD_START",error:r.error}}}return e},revisions:(e={},r)=>{if(r.type==="RECEIVE_ITEM_REVISIONS"){let n=r.recordKey;delete r.recordKey;let i=Rs(e[n],{...r,type:"RECEIVE_ITEMS"});return{...e,[n]:i}}return r.type==="REMOVE_ITEMS"?Object.fromEntries(Object.entries(e).filter(([n])=>!r.itemIds.some(i=>Number.isInteger(i)?i===+n:i===n))):e}}))}function Im(t=vs,e){switch(e.type){case"ADD_ENTITIES":return[...t,...e.entities]}return t}var km=(t={},e)=>{let r=Im(t.config,e),n=t.reducer;if(!n||r!==t.config){let s=r.reduce((o,c)=>{let{kind:f}=c;return o[f]||(o[f]=[]),o[f].push(c),o},{});n=(0,li.combineReducers)(Object.fromEntries(Object.entries(s).map(([o,c])=>{let f=(0,li.combineReducers)(Object.fromEntries(c.map(u=>[u.name,Am(u)])));return[o,f]})))}let i=n(t.records,e);return i===t.records&&r===t.config&&n===t.reducer?t:{reducer:n,records:i,config:r}};function Um(t=(0,Ad.createUndoManager)()){return t}function Om(t={},e){switch(e.type){case"EDIT_ENTITY_RECORD":case"UNDO":case"REDO":return{}}return t}function Dm(t={},e){switch(e.type){case"RECEIVE_EMBED_PREVIEW":let{url:r,preview:n}=e;return{...t,[r]:n}}return t}function Lm(t={},e){switch(e.type){case"RECEIVE_USER_PERMISSION":return{...t,[e.key]:e.isAllowed};case"RECEIVE_USER_PERMISSIONS":return{...t,...e.permissions}}return t}function Nm(t={},e){switch(e.type){case"RECEIVE_AUTOSAVES":let{postId:r,autosaves:n}=e;return{...t,[r]:n}}return t}function Mm(t=[],e){switch(e.type){case"RECEIVE_BLOCK_PATTERNS":return e.patterns}return t}function Pm(t=[],e){switch(e.type){case"RECEIVE_BLOCK_PATTERN_CATEGORIES":return e.categories}return t}function Bm(t=[],e){switch(e.type){case"RECEIVE_USER_PATTERN_CATEGORIES":return e.patternCategories}return t}function Vm(t=null,e){switch(e.type){case"RECEIVE_NAVIGATION_FALLBACK_ID":return e.fallbackId}return t}function jm(t={},e){switch(e.type){case"RECEIVE_THEME_GLOBAL_STYLE_REVISIONS":return{...t,[e.currentId]:e.revisions}}return t}function Fm(t={},e){switch(e.type){case"RECEIVE_DEFAULT_TEMPLATE":return{...t,[JSON.stringify(e.query)]:e.templateId}}return t}function Gm(t={},e){switch(e.type){case"RECEIVE_REGISTERED_POST_META":return{...t,[e.postType]:e.registeredPostMeta}}return t}function Ym(t=null,e){switch(e.type){case"RECEIVE_EDITOR_SETTINGS":return e.settings}return t}function Km(t=null,e){switch(e.type){case"RECEIVE_EDITOR_ASSETS":return e.assets}return t}var Id=(0,li.combineReducers)({users:Em,currentTheme:Sm,currentGlobalStylesId:Rm,currentUser:vm,themeGlobalStyleVariations:Tm,themeBaseGlobalStyles:Cm,themeGlobalStyleRevisions:jm,entities:km,editsReference:Om,undoManager:Um,embedPreviews:Dm,userPermissions:Lm,autosaves:Nm,blockPatterns:Mm,blockPatternCategories:Pm,userPatternCategories:Bm,navigationFallbackId:Vm,defaultTemplates:Fm,registeredPostMeta:Gm,editorSettings:Ym,editorAssets:Km});var ga={};zt(ga,{__experimentalGetCurrentGlobalStylesId:()=>Kd,__experimentalGetCurrentThemeBaseGlobalStyles:()=>Iy,__experimentalGetCurrentThemeGlobalStylesVariations:()=>ky,__experimentalGetDirtyEntityRecords:()=>dy,__experimentalGetEntitiesBeingSaved:()=>fy,__experimentalGetEntityRecordNoResolver:()=>ay,canUser:()=>qd,canUserEditEntityRecord:()=>Ry,getAuthors:()=>ry,getAutosave:()=>Ty,getAutosaves:()=>Cy,getBlockPatternCategories:()=>Oy,getBlockPatterns:()=>Uy,getCurrentTheme:()=>xs,getCurrentThemeGlobalStylesRevisions:()=>Ly,getCurrentUser:()=>ny,getDefaultTemplateId:()=>da,getEditedEntityRecord:()=>ha,getEmbedPreview:()=>vy,getEntitiesByKind:()=>iy,getEntitiesConfig:()=>jd,getEntity:()=>sy,getEntityConfig:()=>ln,getEntityRecord:()=>tt,getEntityRecordEdits:()=>fa,getEntityRecordNonTransientEdits:()=>Gd,getEntityRecords:()=>Ts,getEntityRecordsTotalItems:()=>ly,getEntityRecordsTotalPages:()=>uy,getLastEntityDeleteError:()=>my,getLastEntitySaveError:()=>gy,getRawEntityRecord:()=>Fd,getRedoEdit:()=>wy,getReferenceByDistinctEdits:()=>Ay,getRevision:()=>My,getRevisions:()=>Ny,getThemeSupports:()=>Ey,getUndoEdit:()=>yy,getUserPatternCategories:()=>Dy,getUserQueryResults:()=>Vd,hasEditsForEntityRecord:()=>Yd,hasEntityRecord:()=>oy,hasEntityRecords:()=>cy,hasFetchedAutosaves:()=>xy,hasRedo:()=>by,hasUndo:()=>_y,isAutosavingEntityRecord:()=>hy,isDeletingEntityRecord:()=>py,isPreviewEmbedFallback:()=>Sy,isRequestingEmbedPreview:()=>ty,isSavingEntityRecord:()=>pa});var Ge=V(Ye()),Bd=V(gt()),qt=V(vr());var $="core";var ua={};zt(ua,{getBlockPatternsForPostType:()=>Hm,getEditorAssets:()=>Zm,getEditorSettings:()=>Xm,getEntityRecordPermissions:()=>Wm,getEntityRecordsPermissions:()=>Md,getHomePage:()=>zm,getNavigationFallbackId:()=>qm,getPostsPageId:()=>Jm,getRegisteredPostMeta:()=>$m,getTemplateId:()=>Qm,getUndoManager:()=>Cs});var ut=V(Ye());var Dd=V(Od()),{lock:Ld,unlock:lt}=(0,Dd.__dangerousOptInToUnstableAPIsOnlyForCoreModules)("I acknowledge private features are not for use in themes or plugins and doing so will break in the next version of WordPress.","@wordpress/core-data");var Nd=V(vr());var la=!1;function z(t,e,r,{alternativeFunctionName:n,isShorthandSelector:i=!1}={}){let s=vd[t]?.[e];if(s){if(!la){let{alternative:o}=s,c=i?`'${r}'`:`The '${t}', '${e}' entity (used via '${r}')`,f=`the '${o.kind}', '${o.name}' entity`;n&&(f+=` via the '${n}' function`),(0,Nd.default)(c,{...s,alternative:f})}la=!0,setTimeout(()=>{la=!1},0)}}function Cs(t){return window.__experimentalEnableSync?Kt()?.undoManager??t.undoManager:t.undoManager}function qm(t){return t.navigationFallbackId}var Hm=(0,ut.createRegistrySelector)(t=>(0,ut.createSelector)((e,r)=>t($).getBlockPatterns().filter(({postTypes:n})=>!n||Array.isArray(n)&&n.includes(r)),()=>[t($).getBlockPatterns()])),Md=(0,ut.createRegistrySelector)(t=>(0,ut.createSelector)((e,r,n,i)=>(Array.isArray(i)?i:[i]).map(o=>({delete:t($).canUser("delete",{kind:r,name:n,id:o}),update:t($).canUser("update",{kind:r,name:n,id:o})})),e=>[e.userPermissions]));function Wm(t,e,r,n){return z(e,r,"getEntityRecordPermissions"),Md(t,e,r,n)[0]}function $m(t,e){return t.registeredPostMeta?.[e]??{}}function Pd(t){return!t||!["number","string"].includes(typeof t)||Number(t)===0?null:t.toString()}var zm=(0,ut.createRegistrySelector)(t=>(0,ut.createSelector)(()=>{let e=t($).getEntityRecord("root","__unstableBase");if(!e)return null;let r=e?.show_on_front==="page"?Pd(e.page_on_front):null;if(r)return{postType:"page",postId:r};let n=t($).getDefaultTemplateId({slug:"front-page"});return n?{postType:"wp_template",postId:n}:null},e=>[tt(e,"root","site"),tt(e,"root","__unstableBase"),da(e,{slug:"front-page"})])),Jm=(0,ut.createRegistrySelector)(t=>()=>{let e=t($).getEntityRecord("root","__unstableBase");return e?.show_on_front==="page"?Pd(e.page_for_posts):null}),Qm=(0,ut.createRegistrySelector)(t=>(e,r,n)=>{let i=lt(t($)).getHomePage();if(!i)return;if(r==="page"&&r===i?.postType&&n.toString()===i?.postId){let u=t($).getEntityRecords("postType","wp_template",{per_page:-1});if(!u)return;let d=u.find(({slug:h})=>h==="front-page")?.id;if(d)return d}let s=t($).getEditedEntityRecord("postType",r,n);if(!s)return;let o=lt(t($)).getPostsPageId();if(r==="page"&&o===n.toString())return t($).getDefaultTemplateId({slug:"home"});let c=s.template;if(c){let u=t($).getEntityRecords("postType","wp_template",{per_page:-1})?.find(({slug:d})=>d===c);if(u)return u.id}let f;return s.slug?f=r==="page"?`${r}-${s.slug}`:`single-${r}-${s.slug}`:f=r==="page"?"page":`single-${r}`,t($).getDefaultTemplateId({slug:f})});function Xm(t){return t.editorSettings}function Zm(t){return t.editorAssets}var ey={},ty=(0,Ge.createRegistrySelector)(t=>(e,r)=>t($).isResolving("getEmbedPreview",[r]));function ry(t,e){(0,qt.default)("select( 'core' ).getAuthors()",{since:"5.9",alternative:"select( 'core' ).getUsers({ who: 'authors' })"});let r=(0,Bd.addQueryArgs)("/wp/v2/users/?who=authors&per_page=100",e);return Vd(t,r)}function ny(t){return t.currentUser}var Vd=(0,Ge.createSelector)((t,e)=>(t.users.queries[e]??[]).map(n=>t.users.byId[n]),(t,e)=>[t.users.queries[e],t.users.byId]);function iy(t,e){return(0,qt.default)("wp.data.select( 'core' ).getEntitiesByKind()",{since:"6.0",alternative:"wp.data.select( 'core' ).getEntitiesConfig()"}),jd(t,e)}var jd=(0,Ge.createSelector)((t,e)=>t.entities.config.filter(r=>r.kind===e),(t,e)=>t.entities.config);function sy(t,e,r){return(0,qt.default)("wp.data.select( 'core' ).getEntity()",{since:"6.0",alternative:"wp.data.select( 'core' ).getEntityConfig()"}),ln(t,e,r)}function ln(t,e,r){return z(e,r,"getEntityConfig"),t.entities.config?.find(n=>n.kind===e&&n.name===r)}var tt=(0,Ge.createSelector)(((t,e,r,n,i)=>{z(e,r,"getEntityRecord");let s=t.entities.records?.[e]?.[r]?.queriedData;if(!s)return;let o=i?.context??"default";if(!i||!i._fields)return s.itemIsComplete[o]?.[n]?s.items[o][n]:void 0;let c=s.items[o]?.[n];if(!c)return c;let f={},u=Oe(i._fields)??[];for(let d=0;d<u.length;d++){let h=u[d].split("."),p=c;h.forEach(m=>{p=p?.[m]}),kt(f,h,p)}return f}),(t,e,r,n,i)=>{let s=i?.context??"default",o=t.entities.records?.[e]?.[r]?.queriedData;return[o?.items[s]?.[n],o?.itemIsComplete[s]?.[n]]});tt.__unstableNormalizeArgs=t=>{let e=[...t],r=e?.[2];return e[2]=bn(r)?Number(r):r,e};function oy(t,e,r,n,i){let s=t.entities.records?.[e]?.[r]?.queriedData;if(!s)return!1;let o=i?.context??"default";if(!i||!i._fields)return!!s.itemIsComplete[o]?.[n];let c=s.items[o]?.[n];if(!c)return!1;let f=Oe(i._fields)??[];for(let u=0;u<f.length;u++){let d=f[u].split("."),h=c;for(let p=0;p<d.length;p++){let m=d[p];if(!h||!Object.hasOwn(h,m))return!1;h=h[m]}}return!0}function ay(t,e,r,n){return tt(t,e,r,n)}var Fd=(0,Ge.createSelector)((t,e,r,n)=>{z(e,r,"getRawEntityRecord");let i=tt(t,e,r,n);return i&&Object.keys(i).reduce((s,o)=>(js(ln(t,e,r),o)?s[o]=i[o]?.raw!==void 0?i[o]?.raw:i[o]:s[o]=i[o],s),{})},(t,e,r,n,i)=>{let s=i?.context??"default";return[t.entities.config,t.entities.records?.[e]?.[r]?.queriedData?.items[s]?.[n],t.entities.records?.[e]?.[r]?.queriedData?.itemIsComplete[s]?.[n]]});function cy(t,e,r,n){return z(e,r,"hasEntityRecords"),Array.isArray(Ts(t,e,r,n))}var Ts=((t,e,r,n)=>{z(e,r,"getEntityRecords");let i=t.entities.records?.[e]?.[r]?.queriedData;return i?Ys(i,n):null}),ly=(t,e,r,n)=>{z(e,r,"getEntityRecordsTotalItems");let i=t.entities.records?.[e]?.[r]?.queriedData;return i?Ks(i,n):null},uy=(t,e,r,n)=>{z(e,r,"getEntityRecordsTotalPages");let i=t.entities.records?.[e]?.[r]?.queriedData;if(!i)return null;if(n?.per_page===-1)return 1;let s=Ks(i,n);return s&&(n?.per_page?Math.ceil(s/n.per_page):nc(i,n))},dy=(0,Ge.createSelector)(t=>{let{entities:{records:e}}=t,r=[];return Object.keys(e).forEach(n=>{Object.keys(e[n]).forEach(i=>{let s=Object.keys(e[n][i].edits).filter(o=>tt(t,n,i,o)&&Yd(t,n,i,o));if(s.length){let o=ln(t,n,i);s.forEach(c=>{let f=ha(t,n,i,c);r.push({key:f?f[o.key||pe]:void 0,title:o?.getTitle?.(f)||"",name:i,kind:n})})}})}),r},t=>[t.entities.records]),fy=(0,Ge.createSelector)(t=>{let{entities:{records:e}}=t,r=[];return Object.keys(e).forEach(n=>{Object.keys(e[n]).forEach(i=>{let s=Object.keys(e[n][i].saving).filter(o=>pa(t,n,i,o));if(s.length){let o=ln(t,n,i);s.forEach(c=>{let f=ha(t,n,i,c);r.push({key:f?f[o.key||pe]:void 0,title:o?.getTitle?.(f)||"",name:i,kind:n})})}})}),r},t=>[t.entities.records]);function fa(t,e,r,n){return z(e,r,"getEntityRecordEdits"),t.entities.records?.[e]?.[r]?.edits?.[n]}var Gd=(0,Ge.createSelector)((t,e,r,n)=>{z(e,r,"getEntityRecordNonTransientEdits");let{transientEdits:i}=ln(t,e,r)||{},s=fa(t,e,r,n)||{};return i?Object.keys(s).reduce((o,c)=>(i[c]||(o[c]=s[c]),o),{}):s},(t,e,r,n)=>[t.entities.config,t.entities.records?.[e]?.[r]?.edits?.[n]]);function Yd(t,e,r,n){return z(e,r,"hasEditsForEntityRecord"),pa(t,e,r,n)||Object.keys(Gd(t,e,r,n)).length>0}var ha=(0,Ge.createSelector)((t,e,r,n)=>{z(e,r,"getEditedEntityRecord");let i=Fd(t,e,r,n),s=fa(t,e,r,n);return!i&&!s?!1:{...i,...s}},(t,e,r,n,i)=>{let s=i?.context??"default";return[t.entities.config,t.entities.records?.[e]?.[r]?.queriedData.items[s]?.[n],t.entities.records?.[e]?.[r]?.queriedData.itemIsComplete[s]?.[n],t.entities.records?.[e]?.[r]?.edits?.[n]]});function hy(t,e,r,n){z(e,r,"isAutosavingEntityRecord");let{pending:i,isAutosave:s}=t.entities.records?.[e]?.[r]?.saving?.[n]??{};return!!(i&&s)}function pa(t,e,r,n){return z(e,r,"isSavingEntityRecord"),t.entities.records?.[e]?.[r]?.saving?.[n]?.pending??!1}function py(t,e,r,n){return z(e,r,"isDeletingEntityRecord"),t.entities.records?.[e]?.[r]?.deleting?.[n]?.pending??!1}function gy(t,e,r,n){return z(e,r,"getLastEntitySaveError"),t.entities.records?.[e]?.[r]?.saving?.[n]?.error}function my(t,e,r,n){return z(e,r,"getLastEntityDeleteError"),t.entities.records?.[e]?.[r]?.deleting?.[n]?.error}function yy(t){(0,qt.default)("select( 'core' ).getUndoEdit()",{since:"6.3"})}function wy(t){(0,qt.default)("select( 'core' ).getRedoEdit()",{since:"6.3"})}function _y(t){return Cs(t).hasUndo()}function by(t){return Cs(t).hasRedo()}function xs(t){return t.currentTheme?tt(t,"root","theme",t.currentTheme):null}function Kd(t){return t.currentGlobalStylesId}function Ey(t){return xs(t)?.theme_supports??ey}function vy(t,e){return t.embedPreviews[e]}function Sy(t,e){let r=t.embedPreviews[e],n='<a href="'+e+'">'+e+"</a>";return r?r.html===n:!1}function qd(t,e,r,n){let i=typeof r=="object";if(i&&(!r.kind||!r.name))return!1;i&&z(r.kind,r.name,"canUser");let s=Xt(e,r,n);return t.userPermissions[s]}function Ry(t,e,r,n){return(0,qt.default)("wp.data.select( 'core' ).canUserEditEntityRecord()",{since:"6.7",alternative:"wp.data.select( 'core' ).canUser( 'update', { kind, name, id } )"}),qd(t,"update",{kind:e,name:r,id:n})}function Cy(t,e,r){return t.autosaves[r]}function Ty(t,e,r,n){return n===void 0?void 0:t.autosaves[r]?.find(s=>s.author===n)}var xy=(0,Ge.createRegistrySelector)(t=>(e,r,n)=>t($).hasFinishedResolution("getAutosaves",[r,n]));function Ay(t){return t.editsReference}function Iy(t){let e=xs(t);return e?t.themeBaseGlobalStyles[e.stylesheet]:null}function ky(t){let e=xs(t);return e?t.themeGlobalStyleVariations[e.stylesheet]:null}function Uy(t){return t.blockPatterns}function Oy(t){return t.blockPatternCategories}function Dy(t){return t.userPatternCategories}function Ly(t){(0,qt.default)("select( 'core' ).getCurrentThemeGlobalStylesRevisions()",{since:"6.5.0",alternative:"select( 'core' ).getRevisions( 'root', 'globalStyles', ${ recordKey } )"});let e=Kd(t);return e?t.themeGlobalStyleRevisions[e]:null}function da(t,e){return t.defaultTemplates[JSON.stringify(e)]}var Ny=(t,e,r,n,i)=>{z(e,r,"getRevisions");let s=t.entities.records?.[e]?.[r]?.revisions?.[n];return s?Ys(s,i):null},My=(0,Ge.createSelector)((t,e,r,n,i,s)=>{z(e,r,"getRevision");let o=t.entities.records?.[e]?.[r]?.revisions?.[n];if(!o)return;let c=s?.context??"default";if(!s||!s._fields)return o.itemIsComplete[c]?.[i]?o.items[c][i]:void 0;let f=o.items[c]?.[i];if(!f)return f;let u={},d=Oe(s._fields)??[];for(let h=0;h<d.length;h++){let p=d[h].split("."),m=f;p.forEach(w=>{m=m?.[w]}),kt(u,p,m)}return u},(t,e,r,n,i,s)=>{let o=s?.context??"default",c=t.entities.records?.[e]?.[r]?.revisions?.[n];return[c?.items?.[o]?.[i],c?.itemIsComplete?.[o]?.[i]]});var va={};zt(va,{__experimentalBatch:()=>ew,__experimentalReceiveCurrentGlobalStylesId:()=>Ky,__experimentalReceiveThemeBaseGlobalStyles:()=>qy,__experimentalReceiveThemeGlobalStyleVariations:()=>Hy,__experimentalSaveSpecifiedEntityEdits:()=>rw,__unstableCreateUndoLevel:()=>Zy,addEntities:()=>Fy,deleteEntityRecord:()=>ba,editEntityRecord:()=>Jy,receiveAutosaves:()=>sw,receiveCurrentTheme:()=>Yy,receiveCurrentUser:()=>jy,receiveDefaultTemplateId:()=>aw,receiveEmbedPreview:()=>zy,receiveEntityRecords:()=>Gy,receiveNavigationFallbackId:()=>ow,receiveRevisions:()=>cw,receiveThemeGlobalStyleRevisions:()=>$y,receiveThemeSupports:()=>Wy,receiveUploadPermissions:()=>nw,receiveUserPermission:()=>zd,receiveUserPermissions:()=>iw,receiveUserQuery:()=>Vy,redo:()=>Xy,saveEditedEntityRecord:()=>tw,saveEntityRecord:()=>Ea,undo:()=>Qy});var Wd=V(xr());var _a=V(mt()),$d=V(gt()),As=V(vr());var ya=V(mt()),ma=null;function Py(t,e){let r=[...t],n=[];for(;r.length;)n.push(r.splice(0,e));return n}async function Hd(t){ma===null&&(ma=(await(0,ya.default)({path:"/batch/v1",method:"OPTIONS"})).endpoints[0].args.requests.maxItems);let e=[];for(let r of Py(t,ma)){let n=await(0,ya.default)({path:"/batch/v1",method:"POST",data:{validation:"require-all-validate",requests:r.map(s=>({path:s.path,body:s.data,method:s.method,headers:s.headers}))}}),i;n.failed?i=n.responses.map(s=>({error:s?.body})):i=n.responses.map(s=>{let o={};return s.status>=200&&s.status<300?o.output=s.body:o.error=s.body,o}),e.push(...i)}return e}function wa(t=Hd){let e=0,r=[],n=new By;return{add(i){let s=++e;n.add(s);let o=c=>new Promise((f,u)=>{r.push({input:c,resolve:f,reject:u}),n.delete(s)});return typeof i=="function"?Promise.resolve(i(o)).finally(()=>{n.delete(s)}):o(i)},async run(){n.size&&await new Promise(o=>{let c=n.subscribe(()=>{n.size||(c(),o(void 0))})});let i;try{if(i=await t(r.map(({input:o})=>o)),i.length!==r.length)throw new Error("run: Array returned by processor must be same size as input array.")}catch(o){for(let{reject:c}of r)c(o);throw o}let s=!0;return i.forEach((o,c)=>{let f=r[c];o?.error?(f?.reject(o.error),s=!1):f?.resolve(o?.output??o)}),r=[],s}}}var By=class{constructor(...t){this.set=new Set(...t),this.subscribers=new Set}get size(){return this.set.size}add(t){return this.set.add(t),this.subscribers.forEach(e=>e()),this}delete(t){let e=this.set.delete(t);return this.subscribers.forEach(r=>r()),e}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}};function Vy(t,e){return{type:"RECEIVE_USER_QUERY",users:Array.isArray(e)?e:[e],queryID:t}}function jy(t){return{type:"RECEIVE_CURRENT_USER",currentUser:t}}function Fy(t){return{type:"ADD_ENTITIES",entities:t}}function Gy(t,e,r,n=void 0,i=!1,s=void 0,o=void 0){t==="postType"&&(r=(Array.isArray(r)?r:[r]).map(f=>f.status==="auto-draft"?{...f,title:""}:f));let c;return n?c=Wa(r,n,s,o):c=Gs(r,s,o),{...c,kind:t,name:e,invalidateCache:i}}function Yy(t){return{type:"RECEIVE_CURRENT_THEME",currentTheme:t}}function Ky(t){return{type:"RECEIVE_CURRENT_GLOBAL_STYLES_ID",id:t}}function qy(t,e){return{type:"RECEIVE_THEME_GLOBAL_STYLES",stylesheet:t,globalStyles:e}}function Hy(t,e){return{type:"RECEIVE_THEME_GLOBAL_STYLE_VARIATIONS",stylesheet:t,variations:e}}function Wy(){return(0,As.default)("wp.data.dispatch( 'core' ).receiveThemeSupports",{since:"5.9"}),{type:"DO_NOTHING"}}function $y(t,e){return(0,As.default)("wp.data.dispatch( 'core' ).receiveThemeGlobalStyleRevisions()",{since:"6.5.0",alternative:"wp.data.dispatch( 'core' ).receiveRevisions"}),{type:"RECEIVE_THEME_GLOBAL_STYLE_REVISIONS",currentId:t,revisions:e}}function zy(t,e){return{type:"RECEIVE_EMBED_PREVIEW",url:t,preview:e}}var ba=(t,e,r,n,{__unstableFetch:i=_a.default,throwOnError:s=!1}={})=>async({dispatch:o,resolveSelect:c})=>{z(t,e,"deleteEntityRecord");let u=(await c.getEntitiesConfig(t)).find(m=>m.kind===t&&m.name===e),d,h=!1;if(!u)return;let p=await o.__unstableAcquireStoreLock($,["entities","records",t,e,r],{exclusive:!0});try{o({type:"DELETE_ENTITY_RECORD_START",kind:t,name:e,recordId:r});let m=!1,{baseURL:w}=u;t==="postType"&&e==="wp_template"&&(r&&typeof r=="string"&&!/^\d+$/.test(r)||!window?.__experimentalTemplateActivate)&&(w=w.slice(0,w.lastIndexOf("/"))+"/templates");try{let b=`${w}/${r}`;n&&(b=(0,$d.addQueryArgs)(b,n)),h=await i({path:b,method:"DELETE"}),await o(Ha(t,e,r,!0))}catch(b){m=!0,d=b}if(o({type:"DELETE_ENTITY_RECORD_FINISH",kind:t,name:e,recordId:r,error:d}),m&&s)throw d;return h}finally{o.__unstableReleaseStoreLock(p)}},Jy=(t,e,r,n,i={})=>({select:s,dispatch:o})=>{z(t,e,"editEntityRecord");let c=s.getEntityConfig(t,e);if(!c)throw new Error(`The entity being edited (${t}, ${e}) does not have a loaded config.`);let{mergedEdits:f={}}=c,u=s.getRawEntityRecord(t,e,r),d=s.getEditedEntityRecord(t,e,r),h={kind:t,name:e,recordId:r,edits:Object.keys(n).reduce((p,m)=>{let w=u[m],b=d[m],R=f[m]?{...b,...n[m]}:n[m];return p[m]=(0,Wd.default)(w,R)?void 0:R,p},{})};if(window.__experimentalEnableSync&&c.syncConfig){let p=`${t}/${e}`,m=r;Kt()?.update(p,m,h.edits,tn)}i.undoIgnore||s.getUndoManager().addRecord([{id:{kind:t,name:e,recordId:r},changes:Object.keys(n).reduce((p,m)=>(p[m]={from:d[m],to:n[m]},p),{})}],i.isCached),o({type:"EDIT_ENTITY_RECORD",...h})},Qy=()=>({select:t,dispatch:e})=>{let r=t.getUndoManager().undo();r&&e({type:"UNDO",record:r})},Xy=()=>({select:t,dispatch:e})=>{let r=t.getUndoManager().redo();r&&e({type:"REDO",record:r})},Zy=()=>({select:t})=>{t.getUndoManager().addRecord()},Ea=(t,e,r,{isAutosave:n=!1,__unstableFetch:i=_a.default,throwOnError:s=!1}={})=>async({select:o,resolveSelect:c,dispatch:f})=>{z(t,e,"saveEntityRecord");let d=(await c.getEntitiesConfig(t)).find(b=>b.kind===t&&b.name===e);if(!d)return;let h=d.key??pe,p=r[h],m=!!h&&!p,w=await f.__unstableAcquireStoreLock($,["entities","records",t,e,p||ci()],{exclusive:!0});try{for(let[E,C]of Object.entries(r))if(typeof C=="function"){let S=C(o.getEditedEntityRecord(t,e,p));f.editEntityRecord(t,e,p,{[E]:S},{undoIgnore:!0}),r[E]=S}f({type:"SAVE_ENTITY_RECORD_START",kind:t,name:e,recordId:p,isAutosave:n});let b,R,y=!1,{baseURL:_}=d;t==="postType"&&e==="wp_template"&&(p&&typeof p=="string"&&!/^\d+$/.test(p)||!window?.__experimentalTemplateActivate)&&(_=_.slice(0,_.lastIndexOf("/"))+"/templates");try{let E=`${_}${p?"/"+p:""}`,C=m?{}:o.getRawEntityRecord(t,e,p);if(n){let S=o.getCurrentUser(),A=S?S.id:void 0,D=await c.getAutosave(C.type,C.id,A),T={...C,...D,...r};if(T=Object.keys(T).reduce((x,L)=>(["title","excerpt","content","meta"].includes(L)&&(x[L]=T[L]),x),{status:T.status==="auto-draft"?"draft":void 0}),b=await i({path:`${E}/autosaves`,method:"POST",data:T}),C.id===b.id){let x={...C,...T,...b};x=Object.keys(x).reduce((L,M)=>(["title","excerpt","content"].includes(M)?L[M]=x[M]:M==="status"?L[M]=C.status==="auto-draft"&&x.status==="draft"?x.status:C.status:L[M]=C[M],L),{}),f.receiveEntityRecords(t,e,x,void 0,!0)}else f.receiveAutosaves(C.id,b)}else{let S=r;d.__unstablePrePersist&&(S={...S,...d.__unstablePrePersist(C,S)}),b=await i({path:E,method:p?"PUT":"POST",data:S}),f.receiveEntityRecords(t,e,b,void 0,!0,S)}}catch(E){y=!0,R=E}if(f({type:"SAVE_ENTITY_RECORD_FINISH",kind:t,name:e,recordId:p,error:R,isAutosave:n}),y&&s)throw R;return b}finally{f.__unstableReleaseStoreLock(w)}},ew=t=>async({dispatch:e})=>{let r=wa(),n={saveEntityRecord(o,c,f,u){return r.add(d=>e.saveEntityRecord(o,c,f,{...u,__unstableFetch:d}))},saveEditedEntityRecord(o,c,f,u){return r.add(d=>e.saveEditedEntityRecord(o,c,f,{...u,__unstableFetch:d}))},deleteEntityRecord(o,c,f,u,d){return r.add(h=>e.deleteEntityRecord(o,c,f,u,{...d,__unstableFetch:h}))}},i=t.map(o=>o(n)),[,...s]=await Promise.all([r.run(),...i]);return s},tw=(t,e,r,n)=>async({select:i,dispatch:s,resolveSelect:o})=>{if(z(t,e,"saveEditedEntityRecord"),!i.hasEditsForEntityRecord(t,e,r))return;let f=(await o.getEntitiesConfig(t)).find(p=>p.kind===t&&p.name===e);if(!f)return;let u=f.key||pe,d=i.getEntityRecordNonTransientEdits(t,e,r),h={[u]:r,...d};return await s.saveEntityRecord(t,e,h,n)},rw=(t,e,r,n,i)=>async({select:s,dispatch:o,resolveSelect:c})=>{if(z(t,e,"__experimentalSaveSpecifiedEntityEdits"),!s.hasEditsForEntityRecord(t,e,r))return;let f=s.getEntityRecordNonTransientEdits(t,e,r),u={};for(let m of n)kt(u,m,Fs(f,m));let p=(await c.getEntitiesConfig(t)).find(m=>m.kind===t&&m.name===e)?.key||pe;return r&&(u[p]=r),await o.saveEntityRecord(t,e,u,i)};function nw(t){return(0,As.default)("wp.data.dispatch( 'core' ).receiveUploadPermissions",{since:"5.9",alternative:"receiveUserPermission"}),zd("create/media",t)}function zd(t,e){return{type:"RECEIVE_USER_PERMISSION",key:t,isAllowed:e}}function iw(t){return{type:"RECEIVE_USER_PERMISSIONS",permissions:t}}function sw(t,e){return{type:"RECEIVE_AUTOSAVES",postId:t,autosaves:Array.isArray(e)?e:[e]}}function ow(t){return{type:"RECEIVE_NAVIGATION_FALLBACK_ID",fallbackId:t}}function aw(t,e){return{type:"RECEIVE_DEFAULT_TEMPLATE",query:t,templateId:e}}var cw=(t,e,r,n,i,s=!1,o)=>async({dispatch:c,resolveSelect:f})=>{z(t,e,"receiveRevisions");let d=(await f.getEntitiesConfig(t)).find(p=>p.kind===t&&p.name===e),h=d&&d?.revisionKey?d.revisionKey:pe;c({type:"RECEIVE_ITEM_REVISIONS",key:h,items:Array.isArray(n)?n:[n],recordKey:r,meta:o,query:i,kind:t,name:e,invalidateCache:s})};var Sa={};zt(Sa,{editMediaEntity:()=>uw,receiveEditorAssets:()=>fw,receiveEditorSettings:()=>dw,receiveRegisteredPostMeta:()=>lw});var Jd=V(mt());function lw(t,e){return{type:"RECEIVE_REGISTERED_POST_META",postType:t,registeredPostMeta:e}}var uw=(t,e={},{__unstableFetch:r=Jd.default,throwOnError:n=!1}={})=>async({dispatch:i,resolveSelect:s})=>{if(!t)return;let o="postType",c="attachment",u=(await s.getEntitiesConfig(o)).find(w=>w.kind===o&&w.name===c);if(!u)return;let d=await i.__unstableAcquireStoreLock($,["entities","records",o,c,t],{exclusive:!0}),h,p,m=!1;try{i({type:"SAVE_ENTITY_RECORD_START",kind:o,name:c,recordId:t});try{let w=`${u.baseURL}/${t}/edit`,b=await r({path:w,method:"POST",data:{...e}});b&&(i.receiveEntityRecords(o,c,[b],void 0,!0,void 0,void 0),h=b)}catch(w){p=w,m=!0}if(i({type:"SAVE_ENTITY_RECORD_FINISH",kind:o,name:c,recordId:t,error:p}),m&&n)throw p;return h}finally{i.__unstableReleaseStoreLock(d)}};function dw(t){return{type:"RECEIVE_EDITOR_SETTINGS",settings:t}}function fw(t){return{type:"RECEIVE_EDITOR_ASSETS",assets:t}}var xa={};zt(xa,{__experimentalGetCurrentGlobalStylesId:()=>xw,__experimentalGetCurrentThemeBaseGlobalStyles:()=>Aw,__experimentalGetCurrentThemeGlobalStylesVariations:()=>Iw,canUser:()=>sf,canUserEditEntityRecord:()=>Rw,getAuthors:()=>gw,getAutosave:()=>Tw,getAutosaves:()=>Cw,getBlockPatternCategories:()=>Uw,getBlockPatterns:()=>kw,getCurrentTheme:()=>Ew,getCurrentThemeGlobalStylesRevisions:()=>of,getCurrentUser:()=>mw,getDefaultTemplateId:()=>af,getEditedEntityRecord:()=>ww,getEditorAssets:()=>Bw,getEditorSettings:()=>Pw,getEmbedPreview:()=>Sw,getEntitiesConfig:()=>Mw,getEntityRecord:()=>Is,getEntityRecords:()=>pi,getEntityRecordsTotalItems:()=>_w,getEntityRecordsTotalPages:()=>bw,getNavigationFallbackId:()=>Dw,getRawEntityRecord:()=>yw,getRegisteredPostMeta:()=>Nw,getRevision:()=>Lw,getRevisions:()=>cf,getThemeSupports:()=>vw,getUserPatternCategories:()=>Ow});var ft=V(gt()),nf=V(Ra()),ge=V(mt());var rf=V(mt());var ui=V(mt()),di=V(gt()),fi=V(Ra()),hi=V(Hs());async function Zd(t,e={},r={}){let n=e.isInitialSuggestions&&e.initialSuggestionsSearchOptions?{...e,...e.initialSuggestionsSearchOptions}:e,{type:i,subtype:s,page:o,perPage:c=e.isInitialSuggestions?3:20}=n,{disablePostFormats:f=!1}=r,u=[];(!i||i==="post")&&u.push((0,ui.default)({path:(0,di.addQueryArgs)("/wp/v2/search",{search:t,page:o,per_page:c,type:"post",subtype:s})}).then(p=>p.map(m=>({id:m.id,url:m.url,title:(0,fi.decodeEntities)(m.title||"")||(0,hi.__)("(no title)"),type:m.subtype||m.type,kind:"post-type"}))).catch(()=>[])),(!i||i==="term")&&u.push((0,ui.default)({path:(0,di.addQueryArgs)("/wp/v2/search",{search:t,page:o,per_page:c,type:"term",subtype:s})}).then(p=>p.map(m=>({id:m.id,url:m.url,title:(0,fi.decodeEntities)(m.title||"")||(0,hi.__)("(no title)"),type:m.subtype||m.type,kind:"taxonomy"}))).catch(()=>[])),!f&&(!i||i==="post-format")&&u.push((0,ui.default)({path:(0,di.addQueryArgs)("/wp/v2/search",{search:t,page:o,per_page:c,type:"post-format",subtype:s})}).then(p=>p.map(m=>({id:m.id,url:m.url,title:(0,fi.decodeEntities)(m.title||"")||(0,hi.__)("(no title)"),type:m.subtype||m.type,kind:"taxonomy"}))).catch(()=>[])),(!i||i==="attachment")&&u.push((0,ui.default)({path:(0,di.addQueryArgs)("/wp/v2/media",{search:t,page:o,per_page:c})}).then(p=>p.map(m=>({id:m.id,url:m.source_url,title:(0,fi.decodeEntities)(m.title.rendered||"")||(0,hi.__)("(no title)"),type:m.type,kind:"media"}))).catch(()=>[]));let h=(await Promise.all(u)).flat();return h=h.filter(p=>!!p.id),h=hw(h,t),h=h.slice(0,c),h}function hw(t,e){let r=Xd(e),n={};for(let i of t)if(i.title){let s=Xd(i.title),o=s.filter(d=>r.some(h=>d===h)),c=s.filter(d=>r.some(h=>d!==h&&d.includes(h))),f=o.length/s.length*10,u=c.length/s.length;n[i.id]=f+u}else n[i.id]=0;return t.sort((i,s)=>n[s.id]-n[i.id])}function Xd(t){return t.toLowerCase().match(/[\p{L}\p{N}]+/gu)||[]}var ef=V(mt()),dt=V(gt()),Ca=new Map,pw=async(t,e={})=>{let r="/wp-block-editor/v1/url-details",n={url:(0,dt.prependHTTP)(t)};if(!(0,dt.isURL)(t))return Promise.reject(`${t} is not a valid URL.`);let i=(0,dt.getProtocol)(t);return!i||!(0,dt.isValidProtocol)(i)||!i.startsWith("http")||!/^https?:\/\/[^\/\s]/i.test(t)?Promise.reject(`${t} does not have a valid protocol. URLs must be "http" based`):Ca.has(t)?Ca.get(t):(0,ef.default)({path:(0,dt.addQueryArgs)(r,n),...e}).then(s=>(Ca.set(t,s),s))},tf=pw;async function Ta(){let t=await(0,rf.default)({path:"/wp/v2/block-patterns/patterns"});return t?t.map(e=>Object.fromEntries(Object.entries(e).map(([r,n])=>[Si(r),n]))):[]}var gw=t=>async({dispatch:e})=>{let r=(0,ft.addQueryArgs)("/wp/v2/users/?who=authors&per_page=100",t),n=await(0,ge.default)({path:r});e.receiveUserQuery(r,n)},mw=()=>async({dispatch:t})=>{let e=await(0,ge.default)({path:"/wp/v2/users/me"});t.receiveCurrentUser(e)},Is=(t,e,r="",n)=>async({select:i,dispatch:s,registry:o,resolveSelect:c})=>{let u=(await c.getEntitiesConfig(t)).find(h=>h.name===e&&h.kind===t);if(!u)return;let d=await s.__unstableAcquireStoreLock($,["entities","records",t,e,r],{exclusive:!1});try{if(n!==void 0&&n._fields&&(n={...n,_fields:[...new Set([...Oe(n._fields)||[],u.key||pe])].join()}),n!==void 0&&n._fields&&i.hasEntityRecord(t,e,r,n))return;let{baseURL:h}=u;t==="postType"&&e==="wp_template"&&(r&&typeof r=="string"&&!/^\d+$/.test(r)||!window?.__experimentalTemplateActivate)&&(h=h.slice(0,h.lastIndexOf("/"))+"/templates");let p=(0,ft.addQueryArgs)(h+(r?"/"+r:""),{...u.baseURLParams,...n}),m=await(0,ge.default)({path:p,parse:!1}),w=await m.json(),b=En(m.headers?.get("allow")),R=[],y={};for(let _ of Qt)y[Xt(_,{kind:t,name:e,id:r})]=b[_],R.push([_,{kind:t,name:e,id:r}]);if(window.__experimentalEnableSync&&u.syncConfig&&bn(r)&&!n){let _=`${t}/${e}`,E=r,C={...w};Object.entries(u.transientEdits??{}).filter(([S,A])=>C[S]===void 0&&A&&typeof A=="object"&&"read"in A&&typeof A.read=="function").forEach(([S,A])=>{C[S]=A.read(C)}),await Kt()?.load(u.syncConfig,_,E,C,{editRecord:S=>{Object.keys(S).length&&s({type:"EDIT_ENTITY_RECORD",kind:t,name:e,recordId:r,edits:S,meta:{undo:void 0}})},getEditedRecord:async()=>await c.getEditedEntityRecord(t,e,r),saveRecord:()=>{s.saveEditedEntityRecord(t,e,r)}})}o.batch(()=>{s.receiveEntityRecords(t,e,w,n),s.receiveUserPermissions(y),s.finishResolutions("canUser",R)})}finally{s.__unstableReleaseStoreLock(d)}};Is.shouldInvalidate=(t,e,r)=>e==="root"&&r==="site"&&(t.type==="RECEIVE_ITEMS"&&t.persistedEdits&&t.persistedEdits.status!=="auto-draft"||t.type==="REMOVE_ITEMS")&&t.kind==="postType"&&t.name==="wp_template";var yw=Jt("getEntityRecord"),ww=Jt("getEntityRecord"),pi=(t,e,r={})=>async({dispatch:n,registry:i,resolveSelect:s})=>{let c=(await s.getEntitiesConfig(t)).find(p=>p.name===e&&p.kind===t);if(!c)return;let f=await n.__unstableAcquireStoreLock($,["entities","records",t,e],{exclusive:!1}),u={...r},d=c.key||pe;function h(p,m){let w=Object.fromEntries(Object.entries(m).filter(([b,R])=>["context","_fields"].includes(b)&&!!R));return p.filter(b=>b?.[d]).map(b=>[t,e,b[d],Object.keys(w).length>0?w:void 0])}try{r._fields&&(r={...r,_fields:[...new Set([...Oe(r._fields)||[],d])].join()});let{baseURL:p}=c,{combinedTemplates:m=!0}=r;t==="postType"&&e==="wp_template"&&m&&(p=p.slice(0,p.lastIndexOf("/"))+"/templates");let w=(0,ft.addQueryArgs)(p,{...c.baseURLParams,...r}),b=[],R;if(c.supportsPagination&&r.per_page!==-1){let y=await(0,ge.default)({path:w,parse:!1});b=Object.values(await y.json()),R={totalItems:parseInt(y.headers.get("X-WP-Total")),totalPages:parseInt(y.headers.get("X-WP-TotalPages"))}}else if(r.per_page===-1&&r[vn]===!0){let y=1,_;do{let E=await(0,ge.default)({path:(0,ft.addQueryArgs)(w,{page:y,per_page:100}),parse:!1}),C=Object.values(await E.json());_=parseInt(E.headers.get("X-WP-TotalPages")),R||(R={totalItems:parseInt(E.headers.get("X-WP-Total")),totalPages:1}),b.push(...C),i.batch(()=>{n.receiveEntityRecords(t,e,b,r,!1,void 0,R),n.finishResolutions("getEntityRecord",h(C,u))}),y++}while(y<=_)}else b=Object.values(await(0,ge.default)({path:w})),R={totalItems:b.length,totalPages:1};r._fields&&(b=b.map(y=>(r._fields.split(",").forEach(_=>{y.hasOwnProperty(_)||(y[_]=void 0)}),y))),i.batch(()=>{n.receiveEntityRecords(t,e,b,r,!1,void 0,R);let y=b.filter(C=>!!C?.[d]&&!!C?._links?.self?.[0]?.targetHints?.allow).map(C=>({id:C[d],permissions:En(C._links.self[0].targetHints.allow)})),_=[],E={};for(let C of y)for(let S of Qt)_.push([S,{kind:t,name:e,id:C.id}]),E[Xt(S,{kind:t,name:e,id:C.id})]=C.permissions[S];y.length>0&&(n.receiveUserPermissions(E),n.finishResolutions("canUser",_)),n.finishResolutions("getEntityRecord",h(b,u)),n.__unstableReleaseStoreLock(f)})}catch{n.__unstableReleaseStoreLock(f)}};pi.shouldInvalidate=(t,e,r)=>(t.type==="RECEIVE_ITEMS"||t.type==="REMOVE_ITEMS")&&t.invalidateCache&&e===t.kind&&r===t.name;var _w=Jt("getEntityRecords"),bw=Jt("getEntityRecords"),Ew=()=>async({dispatch:t,resolveSelect:e})=>{let r=await e.getEntityRecords("root","theme",{status:"active"});t.receiveCurrentTheme(r[0])},vw=Jt("getCurrentTheme"),Sw=t=>async({dispatch:e})=>{try{let r=await(0,ge.default)({path:(0,ft.addQueryArgs)("/oembed/1.0/proxy",{url:t})});e.receiveEmbedPreview(t,r)}catch{e.receiveEmbedPreview(t,!1)}},sf=(t,e,r)=>async({dispatch:n,registry:i,resolveSelect:s})=>{if(!Qt.includes(t))throw new Error(`'${t}' is not a valid action.`);let{hasStartedResolution:o}=i.select($);for(let d of Qt){if(d===t)continue;if(o("canUser",[d,e,r]))return}let c=null;if(typeof e=="object"){if(!e.kind||!e.name)throw new Error("The entity resource object is not valid.");let h=(await s.getEntitiesConfig(e.kind)).find(p=>p.name===e.name&&p.kind===e.kind);if(!h)return;c=h.baseURL+(e.id?"/"+e.id:"")}else c=`/wp/v2/${e}`+(r?"/"+r:"");let f;try{f=await(0,ge.default)({path:c,method:"OPTIONS",parse:!1})}catch{return}let u=En(f.headers?.get("allow"));i.batch(()=>{for(let d of Qt){let h=Xt(d,e,r);n.receiveUserPermission(h,u[d]),d!==t&&n.finishResolution("canUser",[d,e,r])}})},Rw=(t,e,r)=>async({dispatch:n})=>{await n(sf("update",{kind:t,name:e,id:r}))},Cw=(t,e)=>async({dispatch:r,resolveSelect:n})=>{let{rest_base:i,rest_namespace:s="wp/v2",supports:o}=await n.getPostType(t);if(!o?.autosave)return;let c=await(0,ge.default)({path:`/${s}/${i}/${e}/autosaves?context=edit`});c&&c.length&&r.receiveAutosaves(e,c)},Tw=(t,e)=>async({resolveSelect:r})=>{await r.getAutosaves(t,e)},xw=()=>async({dispatch:t,resolveSelect:e})=>{let n=(await e.getEntityRecords("root","theme",{status:"active"}))?.[0]?._links?.["wp:user-global-styles"]?.[0]?.href;if(!n)return;let i=n.match(/\/(\d+)(?:\?|$)/),s=i?Number(i[1]):null;s&&t.__experimentalReceiveCurrentGlobalStylesId(s)},Aw=()=>async({resolveSelect:t,dispatch:e})=>{let r=await t.getCurrentTheme(),n=await(0,ge.default)({path:`/wp/v2/global-styles/themes/${r.stylesheet}?context=view`});e.__experimentalReceiveThemeBaseGlobalStyles(r.stylesheet,n)},Iw=()=>async({resolveSelect:t,dispatch:e})=>{let r=await t.getCurrentTheme(),n=await(0,ge.default)({path:`/wp/v2/global-styles/themes/${r.stylesheet}/variations?context=view`});e.__experimentalReceiveThemeGlobalStyleVariations(r.stylesheet,n)},of=()=>async({resolveSelect:t,dispatch:e})=>{let r=await t.__experimentalGetCurrentGlobalStylesId(),i=(r?await t.getEntityRecord("root","globalStyles",r):void 0)?._links?.["version-history"]?.[0]?.href;if(i){let o=(await(0,ge.default)({url:i}))?.map(c=>Object.fromEntries(Object.entries(c).map(([f,u])=>[Si(f),u])));e.receiveThemeGlobalStyleRevisions(r,o)}};of.shouldInvalidate=t=>t.type==="SAVE_ENTITY_RECORD_FINISH"&&t.kind==="root"&&!t.error&&t.name==="globalStyles";var kw=()=>async({dispatch:t})=>{let e=await Ta();t({type:"RECEIVE_BLOCK_PATTERNS",patterns:e})},Uw=()=>async({dispatch:t})=>{let e=await(0,ge.default)({path:"/wp/v2/block-patterns/categories"});t({type:"RECEIVE_BLOCK_PATTERN_CATEGORIES",categories:e})},Ow=()=>async({dispatch:t,resolveSelect:e})=>{let n=(await e.getEntityRecords("taxonomy","wp_pattern_category",{per_page:-1,_fields:"id,name,description,slug",context:"view"}))?.map(i=>({...i,label:(0,nf.decodeEntities)(i.name),name:i.slug}))||[];t({type:"RECEIVE_USER_PATTERN_CATEGORIES",patternCategories:n})},Dw=()=>async({dispatch:t,select:e,registry:r})=>{let n=await(0,ge.default)({path:(0,ft.addQueryArgs)("/wp-block-editor/v1/navigation-fallback",{_embed:!0})}),i=n?._embedded?.self;r.batch(()=>{if(t.receiveNavigationFallbackId(n?.id),!i)return;let o=!e.getEntityRecord("postType","wp_navigation",n.id);t.receiveEntityRecords("postType","wp_navigation",i,void 0,o),t.finishResolution("getEntityRecord",["postType","wp_navigation",n.id])})},af=t=>async({dispatch:e,registry:r,resolveSelect:n})=>{let i=await(0,ge.default)({path:(0,ft.addQueryArgs)("/wp/v2/templates/lookup",t)});await n.getEntitiesConfig("postType");let s=window?.__experimentalTemplateActivate&&i?.wp_id||i?.id;s&&(i.id=s,r.batch(()=>{e.receiveDefaultTemplateId(t,s),e.receiveEntityRecords("postType",i.type,[i]),e.finishResolution("getEntityRecord",["postType",i.type,s])}))};af.shouldInvalidate=t=>t.type==="RECEIVE_ITEMS"&&t.kind==="root"&&t.name==="site";var cf=(t,e,r,n={})=>async({dispatch:i,registry:s,resolveSelect:o})=>{let f=(await o.getEntitiesConfig(t)).find(w=>w.name===e&&w.kind===t);if(!f)return;n._fields&&(n={...n,_fields:[...new Set([...Oe(n._fields)||[],f.revisionKey||pe])].join()});let u=(0,ft.addQueryArgs)(f.getRevisionsUrl(r),n),d,h,p={},m=f.supportsPagination&&n.per_page!==-1;try{h=await(0,ge.default)({path:u,parse:!m})}catch{return}h&&(m?(d=Object.values(await h.json()),p.totalItems=parseInt(h.headers.get("X-WP-Total"))):d=Object.values(h),n._fields&&(d=d.map(w=>(n._fields.split(",").forEach(b=>{w.hasOwnProperty(b)||(w[b]=void 0)}),w))),s.batch(()=>{if(i.receiveRevisions(t,e,r,d,n,!1,p),!n?._fields&&!n.context){let w=f.key||pe,b=d.filter(R=>R[w]).map(R=>[t,e,r,R[w]]);i.finishResolutions("getRevision",b)}}))};cf.shouldInvalidate=(t,e,r,n)=>t.type==="SAVE_ENTITY_RECORD_FINISH"&&r===t.name&&e===t.kind&&!t.error&&n===t.recordId;var Lw=(t,e,r,n,i)=>async({dispatch:s,resolveSelect:o})=>{let f=(await o.getEntitiesConfig(t)).find(h=>h.name===e&&h.kind===t);if(!f)return;i!==void 0&&i._fields&&(i={...i,_fields:[...new Set([...Oe(i._fields)||[],f.revisionKey||pe])].join()});let u=(0,ft.addQueryArgs)(f.getRevisionsUrl(r,n),i),d;try{d=await(0,ge.default)({path:u})}catch{return}d&&s.receiveRevisions(t,e,r,d,i)},Nw=t=>async({dispatch:e,resolveSelect:r})=>{let n;try{let{rest_namespace:i="wp/v2",rest_base:s}=await r.getPostType(t)||{};n=await(0,ge.default)({path:`${i}/${s}/?context=edit`,method:"OPTIONS"})}catch{return}n&&e.receiveRegisteredPostMeta(t,n?.schema?.properties?.meta?.properties)},Mw=t=>async({dispatch:e})=>{let r=Ss.find(n=>n.kind===t);if(r)try{let n=await r.loadEntities();if(!n.length)return;e.addEntities(n)}catch{}},Pw=()=>async({dispatch:t})=>{let e=await(0,ge.default)({path:"/wp-block-editor/v1/settings"});t.receiveEditorSettings(e)},Bw=()=>async({dispatch:t})=>{let e=await(0,ge.default)({path:"/wp-block-editor/v1/assets"});t.receiveEditorAssets(e)};function Aa(t,e){let r={...t},n=r;for(let i of e)n.children={...n.children,[i]:{locks:[],children:{},...n.children[i]}},n=n.children[i];return r}function gi(t,e){let r=t;for(let n of e){let i=r.children[n];if(!i)return null;r=i}return r}function*lf(t,e){let r=t;yield r;for(let n of e){let i=r.children[n];if(!i)break;yield i,r=i}}function*uf(t){let e=Object.values(t.children);for(;e.length;){let r=e.pop();yield r,e.push(...Object.values(r.children))}}function Ia({exclusive:t},e){return!!(t&&e.length||!t&&e.filter(r=>r.exclusive).length)}var Vw={requests:[],tree:{locks:[],children:{}}};function mi(t=Vw,e){switch(e.type){case"ENQUEUE_LOCK_REQUEST":{let{request:r}=e;return{...t,requests:[r,...t.requests]}}case"GRANT_LOCK_REQUEST":{let{lock:r,request:n}=e,{store:i,path:s}=n,o=[i,...s],c=Aa(t.tree,o),f=gi(c,o);return f.locks=[...f.locks,r],{...t,requests:t.requests.filter(u=>u!==n),tree:c}}case"RELEASE_LOCK":{let{lock:r}=e,n=[r.store,...r.path],i=Aa(t.tree,n),s=gi(i,n);return s.locks=s.locks.filter(o=>o!==r),{...t,tree:i}}}return t}function df(t){return t.requests}function ff(t,e,r,{exclusive:n}){let i=[e,...r],s=t.tree;for(let c of lf(s,i))if(Ia({exclusive:n},c.locks))return!1;let o=gi(s,i);if(!o)return!0;for(let c of uf(o))if(Ia({exclusive:n},c.locks))return!1;return!0}function hf(){let t=mi(void 0,{type:"@@INIT"});function e(){for(let i of df(t)){let{store:s,path:o,exclusive:c,notifyAcquired:f}=i;if(ff(t,s,o,{exclusive:c})){let u={store:s,path:o,exclusive:c};t=mi(t,{type:"GRANT_LOCK_REQUEST",lock:u,request:i}),f(u)}}}function r(i,s,o){return new Promise(c=>{t=mi(t,{type:"ENQUEUE_LOCK_REQUEST",request:{store:i,path:s,exclusive:o,notifyAcquired:c}}),e()})}function n(i){t=mi(t,{type:"RELEASE_LOCK",lock:i}),e()}return{acquire:r,release:n}}function pf(){let t=hf();function e(n,i,{exclusive:s}){return()=>t.acquire(n,i,s)}function r(n){return()=>t.release(n)}return{__unstableAcquireStoreLock:e,__unstableReleaseStoreLock:r}}var gf,mf;var ks=V(Ht());var wf=V(Ht()),un=(0,wf.createContext)({});un.displayName="EntityContext";var Ef=V(bf());function vf({kind:t,type:e,id:r,children:n}){let i=(0,ks.useContext)(un),s=(0,ks.useMemo)(()=>({...i,[t]:{...i?.[t],[e]:r}}),[i,t,e,r]);return(0,Ef.jsx)(un.Provider,{value:s,children:n})}var Us=V(Ye()),xf=V(vr()),Af=V(Ht());var Cf=V(Ye());function Sf(t,e){var r=0,n,i;e=e||{};function s(){var o=n,c=arguments.length,f,u;e:for(;o;){if(o.args.length!==arguments.length){o=o.next;continue}for(u=0;u<c;u++)if(o.args[u]!==arguments[u]){o=o.next;continue e}return o!==n&&(o===i&&(i=o.prev),o.prev.next=o.next,o.next&&(o.next.prev=o.prev),o.next=n,o.prev=null,n.prev=o,n=o),o.val}for(f=new Array(c),u=0;u<c;u++)f[u]=arguments[u];return o={args:f,val:t.apply(null,f)},n?(n.prev=o,o.next=n):i=o,r===e.maxSize?(i=i.prev,i.next=null):r++,n=o,o.val}return s.clear=function(){n=null,i=null,r=0},s}var Rf=Sf;var Te=(t=>(t.Idle="IDLE",t.Resolving="RESOLVING",t.Error="ERROR",t.Success="SUCCESS",t))(Te||{});var jw=["getIsResolving","hasStartedResolution","hasFinishedResolution","isResolving","getCachedResolvers"];function dn(t,e){return(0,Cf.useSelect)((r,n)=>t(s=>Fw(r(s)),n),e)}var Fw=Rf((t=>{let e={};for(let r in t)jw.includes(r)||Object.defineProperty(e,r,{get:()=>(...n)=>{let i=t[r](...n),s=t.getResolutionState(r,n)?.status,o;switch(s){case"resolving":o=Te.Resolving;break;case"finished":o=Te.Success;break;case"error":o=Te.Error;break;case void 0:o=Te.Idle;break}return{data:i,status:o,isResolving:o===Te.Resolving,hasStarted:o!==Te.Idle,hasResolved:o===Te.Success||o===Te.Error}}});return e}));var Tf={};function ka(t,e,r,n={enabled:!0}){let{editEntityRecord:i,saveEditedEntityRecord:s}=(0,Us.useDispatch)(Re),o=(0,Af.useMemo)(()=>({edit:(p,m={})=>i(t,e,r,p,m),save:(p={})=>s(t,e,r,{throwOnError:!0,...p})}),[i,t,e,r,s]),{editedRecord:c,hasEdits:f,edits:u}=(0,Us.useSelect)(p=>n.enabled?{editedRecord:p(Re).getEditedEntityRecord(t,e,r),hasEdits:p(Re).hasEditsForEntityRecord(t,e,r),edits:p(Re).getEntityRecordNonTransientEdits(t,e,r)}:{editedRecord:Tf,hasEdits:!1,edits:Tf},[t,e,r,n.enabled]),{data:d,...h}=dn(p=>n.enabled?p(Re).getEntityRecord(t,e,r):{data:null},[t,e,r,n.enabled]);return{record:d,editedRecord:c,hasEdits:f,edits:u,...h,...o}}function If(t,e,r,n){return(0,xf.default)("wp.data.__experimentalUseEntityRecord",{alternative:"wp.data.useEntityRecord",since:"6.1"}),ka(t,e,r,n)}var kf=V(gt()),Uf=V(vr()),Os=V(Ye()),Ua=V(Ht());var Gw=[];function Ds(t,e,r={},n={enabled:!0}){let i=(0,kf.addQueryArgs)("",r),{data:s,...o}=dn(u=>n.enabled?u(Re).getEntityRecords(t,e,r):{data:Gw},[t,e,i,n.enabled]),{totalItems:c,totalPages:f}=(0,Os.useSelect)(u=>n.enabled?{totalItems:u(Re).getEntityRecordsTotalItems(t,e,r),totalPages:u(Re).getEntityRecordsTotalPages(t,e,r)}:{totalItems:null,totalPages:null},[t,e,i,n.enabled]);return{records:s,totalItems:c,totalPages:f,...o}}function Of(t,e,r,n){return(0,Uf.default)("wp.data.__experimentalUseEntityRecords",{alternative:"wp.data.useEntityRecords",since:"6.1"}),Ds(t,e,r,n)}function Df(t,e,r={},n={enabled:!0}){let i=(0,Os.useSelect)(d=>d(Re).getEntityConfig(t,e),[t,e]),{records:s,...o}=Ds(t,e,{...r,...r._fields?{_fields:[...new Set([...Oe(r._fields)||[],"_links"])].join()}:{}},n),c=(0,Ua.useMemo)(()=>s?.map(d=>d[i?.key??"id"])??[],[s,i?.key]),f=(0,Os.useSelect)(d=>{let{getEntityRecordsPermissions:h}=lt(d(Re));return h(t,e,c)},[c,t,e]);return{records:(0,Ua.useMemo)(()=>s?.map((d,h)=>({...d,permissions:f[h]}))??[],[s,f]),...o}}var Mf=V(vr()),Pf=V(Nf());function Bf(t,e){let r=typeof t=="object",n=r?JSON.stringify(t):t;return r&&typeof e<"u"&&(0,Pf.default)("When 'resource' is an entity object, passing 'id' as a separate argument isn't supported."),dn(i=>{let s=r?!!t.id:!!e,{canUser:o}=i(Re),c=o("create",r?{kind:t.kind,name:t.name}:t);if(!s){let w=o("read",t),b=c.isResolving||w.isResolving,R=c.hasResolved&&w.hasResolved,y=Te.Idle;return b?y=Te.Resolving:R&&(y=Te.Success),{status:y,isResolving:b,hasResolved:R,canCreate:c.hasResolved&&c.data,canRead:w.hasResolved&&w.data}}let f=o("read",t,e),u=o("update",t,e),d=o("delete",t,e),h=f.isResolving||c.isResolving||u.isResolving||d.isResolving,p=f.hasResolved&&c.hasResolved&&u.hasResolved&&d.hasResolved,m=Te.Idle;return h?m=Te.Resolving:p&&(m=Te.Success),{status:m,isResolving:h,hasResolved:p,canRead:p&&f.data,canCreate:p&&c.data,canUpdate:p&&u.data,canDelete:p&&d.data}},[n,e])}var Vf=Bf;function jf(t,e){return(0,Mf.default)("wp.data.__experimentalUseResourcePermissions",{alternative:"wp.data.useResourcePermissions",since:"6.1"}),Bf(t,e)}var yi=V(Ht()),wi=V(Ye()),Ls=V(Rn());var Ff=V(Ht());function fn(t,e){return(0,Ff.useContext)(un)?.[t]?.[e]}var Wt=V(na());var Kf=V(Yf());var Oa,Da=new WeakMap;function qf(t){if(Oa||(Oa=lt(Kf.privateApis)),!Da.has(t)){let e=Oa.getRichTextValues([t]);Da.set(t,e)}return Da.get(t)}var La=new WeakMap;function Yw(t){if(!La.has(t)){let e=[];for(let r of qf(t))r&&r.replacements.forEach(({type:n,attributes:i})=>{n==="core/footnote"&&e.push(i["data-fn"])});La.set(t,e)}return La.get(t)}function Hf(t){return t.flatMap(Yw)}var Na={};function Ma(t,e){let r={blocks:t};if(!e||e.footnotes===void 0)return r;let n=Hf(t),i=e.footnotes?JSON.parse(e.footnotes):[];if(i.map(d=>d.id).join("")===n.join(""))return r;let o=n.map(d=>i.find(h=>h.id===d)||Na[d]||{id:d,content:""});function c(d){if(!d||Array.isArray(d)||typeof d!="object")return d;d={...d};for(let h in d){let p=d[h];if(Array.isArray(p)){d[h]=p.map(c);continue}if(typeof p!="string"&&!(p instanceof Wt.RichTextData))continue;let m=typeof p=="string"?Wt.RichTextData.fromHTMLString(p):new Wt.RichTextData(p),w=!1;m.replacements.forEach(b=>{if(b.type==="core/footnote"){let R=b.attributes["data-fn"],y=n.indexOf(R),_=(0,Wt.create)({html:b.innerHTML});_.text=String(y+1),_.formats=Array.from({length:_.text.length},()=>_.formats[0]),_.replacements=Array.from({length:_.text.length},()=>_.replacements[0]),b.innerHTML=(0,Wt.toHTMLString)({value:_}),w=!0}}),w&&(d[h]=typeof p=="string"?m.toHTMLString():m)}return d}function f(d){return d.map(h=>({...h,attributes:c(h.attributes),innerBlocks:f(h.innerBlocks)}))}let u=f(t);return Na={...Na,...i.reduce((d,h)=>(n.includes(h.id)||(d[h.id]=h),d),{})},{meta:{...e,footnotes:JSON.stringify(o)},blocks:u}}var Kw=[],Wf=new WeakMap;function $f(t,e,{id:r}={}){let n=fn(t,e),i=r??n,{getEntityRecord:s,getEntityRecordEdits:o}=(0,wi.useSelect)($),{content:c,editedBlocks:f,meta:u}=(0,wi.useSelect)(b=>{if(!i)return{};let{getEditedEntityRecord:R}=b($),y=R(t,e,i);return{editedBlocks:y.blocks,content:y.content,meta:y.meta}},[t,e,i]),{__unstableCreateUndoLevel:d,editEntityRecord:h}=(0,wi.useDispatch)($),p=(0,yi.useMemo)(()=>{if(!i)return;if(f)return f;if(!c||typeof c!="string")return Kw;let b=o(t,e,i),y=!b||!Object.keys(b).length?s(t,e,i):b,_=Wf.get(y);return _||(_=(0,Ls.parse)(c),Wf.set(y,_)),_},[t,e,i,f,c,s,o]),m=(0,yi.useCallback)((b,R)=>{if(p===b)return d(t,e,i);let{selection:_,...E}=R,C={selection:_,content:({blocks:S=[]})=>(0,Ls.__unstableSerializeAndClean)(S),...Ma(b,u)};h(t,e,i,C,{isCached:!1,...E})},[t,e,i,p,u,d,h]),w=(0,yi.useCallback)((b,R)=>{let{selection:y,..._}=R,E=Ma(b,u),C={selection:y,...E};h(t,e,i,C,{isCached:!0,..._})},[t,e,i,u,h]);return[p,w,m]}var zf=V(Ht()),Ns=V(Ye());function Jf(t,e,r,n){let i=fn(t,e),s=n??i,{value:o,fullValue:c}=(0,Ns.useSelect)(d=>{let{getEntityRecord:h,getEditedEntityRecord:p}=d($),m=h(t,e,s),w=p(t,e,s);return m&&w?{value:w[r],fullValue:m[r]}:{}},[t,e,s,r]),{editEntityRecord:f}=(0,Ns.useDispatch)($),u=(0,zf.useCallback)(d=>{f(t,e,s,{[r]:d})},[f,t,e,s,r]);return[o,u,c]}var Qf={};Ld(Qf,{useEntityRecordsWithPermissions:Df,RECEIVE_INTERMEDIATE_RESULTS:vn});var Pa=[...vs,...Ss.filter(t=>!!t.name)],qw=Pa.reduce((t,e)=>{let{kind:r,name:n,plural:i}=e,s=Er(r,n);if(t[s]=(o,c,f)=>(z(r,n,s,{isShorthandSelector:!0,alternativeFunctionName:"getEntityRecord"}),tt(o,r,n,c,f)),i){let o=Er(r,i,"get");t[o]=(c,f)=>(z(r,n,o,{isShorthandSelector:!0,alternativeFunctionName:"getEntityRecords"}),Ts(c,r,n,f))}return t},{}),Hw=Pa.reduce((t,e)=>{let{kind:r,name:n,plural:i}=e,s=Er(r,n);if(t[s]=(o,c)=>(z(r,n,s,{isShorthandSelector:!0,alternativeFunctionName:"getEntityRecord"}),Is(r,n,o,c)),i){let o=Er(r,i,"get");t[o]=(...c)=>(z(r,i,o,{isShorthandSelector:!0,alternativeFunctionName:"getEntityRecords"}),pi(r,n,...c)),t[o].shouldInvalidate=c=>pi.shouldInvalidate(c,r,n)}return t},{}),Ww=Pa.reduce((t,e)=>{let{kind:r,name:n}=e,i=Er(r,n,"save");t[i]=(o,c)=>(z(r,n,i,{isShorthandSelector:!0,alternativeFunctionName:"saveEntityRecord"}),Ea(r,n,o,c));let s=Er(r,n,"delete");return t[s]=(o,c,f)=>(z(r,n,s,{isShorthandSelector:!0,alternativeFunctionName:"deleteEntityRecord"}),ba(r,n,o,c,f)),t},{}),$w=()=>({reducer:Id,actions:{...gf,...va,...Ww,...pf()},selectors:{...mf,...ga,...qw},resolvers:{...xa,...Hw}}),Re=(0,Ms.createReduxStore)($,$w());lt(Re).registerPrivateSelectors(ua);lt(Re).registerPrivateActions(Sa);(0,Ms.register)(Re);return nh(zw);})();
/*! Bundled license information:

simple-peer/simplepeer.min.js:
  (*!
  * The buffer module from node.js, for the browser.
  *
  * @author   Feross Aboukhadijeh <https://feross.org>
  * @license  MIT
  *)
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
//# sourceMappingURL=index.min.js.map
