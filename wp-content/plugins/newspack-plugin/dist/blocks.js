(()=>{var e,t={3018:(e,t,s)=>{"use strict";var n={};s.r(n),s.d(n,{icon:()=>m,metadata:()=>w,name:()=>k,settings:()=>b});const a=window.wp.blocks,i=window.wp.blockEditor;var r=s(6427),l=s(5287),c=s.n(l),o=s(1455),p=s.n(o),d=s(7723),u=s(6087),h=s(790);const g=e=>"newspack-reader-registration-list-checkbox-"+e,_=[{label:(0,d.__)("Initial","newspack-plugin"),value:"initial"},{label:(0,d.__)("Registration Success","newspack-plugin"),value:"registration"},{label:(0,d.__)("Login Success","newspack-plugin"),value:"login"}],w=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"newspack/reader-registration","title":"Reader Registration","category":"newspack","description":"Register a reader with their email.","textdomain":"newspack-plugin","attributes":{"title":{"type":"string"},"description":{"type":"string"},"placeholder":{"type":"string","default":"Email Address"},"label":{"type":"string","default":"Sign up","required":true},"privacyLabel":{"type":"string","default":""},"newsletterSubscription":{"type":"boolean","default":true},"displayListDescription":{"type":"boolean","default":true},"hideSubscriptionInput":{"type":"boolean","default":false},"newsletterTitle":{"type":"string","default":"Newsletters"},"newsletterLabel":{"type":"string","default":"Subscribe to our newsletter"},"lists":{"type":"array","default":[],"items":{"type":"string"}},"listsCheckboxes":{"type":"object","default":{}},"haveAccountLabel":{"type":"string","default":"Already have an account?"},"signInLabel":{"type":"string","default":"Sign in"},"signedInLabel":{"type":"string","default":"An account was already registered with this email. Please check your inbox for an authentication link."}},"supports":{"html":false,"align":true,"multiple":false}}'),m=(0,h.jsxs)(r.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,h.jsx)(r.Path,{d:"M18.5 8V5.5H16V4h2.5V1.5H20V4h2.5v1.5H20V8h-1.5ZM16.75 17v-2A2.75 2.75 0 0 0 14 12.25h-4A2.75 2.75 0 0 0 7.25 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5Z"}),(0,h.jsx)(r.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Zm-1.5 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"})]}),{name:k}=w,b={icon:{src:m,foreground:"#36f"},edit:function({setAttributes:e,attributes:{title:t,description:s,placeholder:n,label:a,privacyLabel:l,newsletterSubscription:o,displayListDescription:w,hideSubscriptionInput:m,newsletterTitle:k,newsletterLabel:b,haveAccountLabel:x,signInLabel:v,signedInLabel:j,lists:f,listsCheckboxes:y,className:C}}){const N=(0,i.useBlockProps)(),[S,T]=(0,u.useState)(_[0].value);let{reader_activation_terms:L,reader_activation_url:O}=window.newspack_blocks;O&&(L=`<a href="${O}">`+L+"</a>");const A=(0,i.useInnerBlocksProps)({},{renderAppender:i.InnerBlocks.ButtonBlockAppender,template:[["core/paragraph",{align:"center",content:(0,d.__)("Thank you for registering!","newspack-plugin")}]]}),[R,P]=(0,u.useState)(!1),[B,I]=(0,u.useState)({}),F=()=>{newspack_blocks.has_newsletters&&o&&(P(!0),p()({path:"/newspack-newsletters/v1/lists_config"}).then(I).finally((()=>P(!1))))};(0,u.useEffect)(F,[]),(0,u.useEffect)(F,[o]),(0,u.useEffect)((()=>{const t=Object.keys(B);!t.length||f.length&&c()(f,t).length||e({lists:[Object.keys(B)[0]]})}),[B]);const E=e=>y.hasOwnProperty(e)&&y[e],M=t=>()=>{const s={...y};s[t]=!E(t),e({listsCheckboxes:s})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(i.InspectorControls,{children:[(0,h.jsx)(r.PanelBody,{title:(0,d.__)("Form settings","newspack-plugin"),children:(0,h.jsx)(r.TextControl,{label:(0,d.__)("Input placeholder","newspack-plugin"),value:n,disabled:R,onChange:t=>e({placeholder:t})})}),newspack_blocks.has_newsletters&&(0,h.jsxs)(r.PanelBody,{title:(0,d.__)("Newsletter Subscription","newspack-plugin"),children:[(0,h.jsx)(r.ToggleControl,{label:(0,d.__)("Enable newsletter subscription","newspack-plugin"),checked:!!o,disabled:R,onChange:()=>e({newsletterSubscription:!o})}),o&&(0,h.jsxs)(h.Fragment,{children:[R&&(0,h.jsx)(r.Spinner,{}),!R&&!Object.keys(B).length&&(0,h.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,d.__)("To enable newsletter subscription, you must configure subscription lists on Newspack Newsletters.","newspack-plugin")}),Object.keys(B).length>0&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.ToggleControl,{label:(0,d.__)("Display list description","newspack-plugin"),checked:w,disabled:R,onChange:()=>e({displayListDescription:!w})}),(0,h.jsx)(r.ToggleControl,{label:(0,d.__)("Hide newsletter selection and always subscribe","newspack-plugin"),checked:m,disabled:R||1!==f.length,onChange:()=>e({hideSubscriptionInput:!m})}),f.length<1&&(0,h.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,h.jsx)(r.Notice,{isDismissible:!1,status:"error",children:(0,d.__)("You must select at least one list.","newspack-plugin")})}),Object.keys(B).length>0&&(0,h.jsxs)("p",{children:[(0,d.__)("Lists","newspack-plugin"),":"]}),Object.keys(B).map((t=>(0,h.jsx)(r.ToggleControl,{label:B[t].title,checked:f.includes(t),disabled:R,onChange:()=>{f.includes(t)?e({lists:f.filter((e=>e!==t))}):e({lists:f.concat(t)})}},t)))]}),(0,h.jsxs)("p",{children:[(0,h.jsx)("a",{href:newspack_blocks.newsletters_url,children:(0,d.__)("Configure your subscription lists","newspack-plugin")}),"."]})]})]}),(0,h.jsxs)(r.PanelBody,{title:(0,d.__)("Spam protection","newspack-plugin"),children:[(0,h.jsx)("p",{children:(0,d.sprintf)(
// translators: %s is either 'enabled' or 'disabled'.
// translators: %s is either 'enabled' or 'disabled'.
(0,d.__)("reCAPTCHA is currently %s.","newspack-plugin"),newspack_blocks.has_recaptcha?(0,d.__)("enabled","newspack-plugin"):(0,d.__)("disabled","newspack-plugin"))}),!newspack_blocks.has_recaptcha&&(0,h.jsx)("p",{children:(0,d.__)("It's highly recommended that you enable reCAPTCHA protection to prevent spambots from using this form!","newspack-plugin")}),(0,h.jsx)("p",{children:(0,h.jsx)("a",{href:newspack_blocks.recaptcha_url,children:(0,d.__)("Configure your reCAPTCHA settings.","newspack-plugin")})})]})]}),(0,h.jsxs)("div",{...N,children:[(0,h.jsxs)("div",{className:"newspack-registration__state-bar",children:[(0,h.jsx)("span",{children:(0,d.__)("Edited State","newspack-plugin")}),(0,h.jsx)("div",{children:_.map((e=>(0,h.jsx)(r.Button,{"data-is-active":S===e.value,onClick:()=>T(e.value),children:e.label},e.value)))})]}),"initial"===S&&(0,h.jsx)("div",{className:`newspack-registration ${C}`,children:(0,h.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,h.jsxs)("div",{className:"newspack-registration__have-account",children:[(0,h.jsx)(i.RichText,{onChange:t=>e({haveAccountLabel:t}),placeholder:(0,d.__)("Already have an account?","newspack-plugin"),value:x,tagName:"span"})," ",(0,h.jsx)("a",{href:"/my-account",onClick:e=>e.preventDefault(),children:(0,h.jsx)(i.RichText,{onChange:t=>e({signInLabel:t}),placeholder:(0,d.__)("Sign In","newspack-plugin"),value:v,tagName:"span"})})]}),(0,h.jsx)("div",{className:"newspack-registration__header",children:(0,h.jsx)(i.RichText,{onChange:t=>e({title:t}),placeholder:(0,d.__)("Add title","newspack-plugin"),value:t,tagName:"h2"})}),(0,h.jsx)(i.RichText,{onChange:t=>e({description:t}),placeholder:(0,d.__)("Add description","newspack-plugin"),value:s,tagName:"p"}),(0,h.jsxs)("div",{className:"newspack-registration__form-content",children:[1===f.length&&m||!o||!f.length?null:(0,h.jsxs)("div",{className:"newspack-reader__lists",children:[f?.length>1&&(0,h.jsx)(i.RichText,{onChange:t=>e({newsletterTitle:t}),placeholder:(0,d.__)("Newsletters title…","newspack-plugin"),value:k,tagName:"h3"}),(0,h.jsx)("ul",{children:f.map((t=>(0,h.jsxs)("li",{children:[(0,h.jsx)("span",{className:"newspack-reader__lists__checkbox",children:(0,h.jsx)("input",{id:g(t),type:"checkbox",checked:E(t),onChange:M(t)})}),(0,h.jsx)("span",{className:"newspack-reader__lists__details",children:(0,h.jsxs)("label",{htmlFor:g(t),className:"newspack-reader__lists__label",children:[(0,h.jsx)("span",{className:"newspack-reader__lists__title",children:1===f.length?(0,h.jsx)(i.RichText,{onChange:t=>e({newsletterLabel:t}),placeholder:(0,d.__)("Subscribe to our newsletter","newspack-plugin"),value:b,tagName:"span"}):B[t]?.title}),w&&(0,h.jsx)("span",{className:"newspack-reader__lists__description",children:B[t]?.description})]})})]},t)))})]}),(0,h.jsxs)("div",{className:"newspack-registration__main",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"newspack-registration__inputs",children:[(0,h.jsx)("input",{type:"email",placeholder:n}),(0,h.jsx)("button",{type:"submit",children:(0,h.jsx)(i.RichText,{onChange:t=>e({label:t}),placeholder:(0,d.__)("Sign up","newspack-plugin"),value:a,tagName:"span"})})]}),newspack_blocks.has_google_oauth&&(0,h.jsxs)("div",{className:"newspack-reader__logins",children:[(0,h.jsxs)("div",{className:"newspack-reader__logins__separator",children:[(0,h.jsx)("div",{}),(0,h.jsx)("div",{children:(0,d.__)("OR","newspack-plugin")}),(0,h.jsx)("div",{})]}),(0,h.jsxs)("button",{className:"newspack-reader__logins__google",children:[(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:newspack_blocks.google_logo_svg}}),(0,h.jsx)("span",{children:(0,d.__)("Sign in with Google","newspack-plugin")})]})]}),(0,h.jsx)("div",{className:"newspack-registration__response"})]}),(0,h.jsx)("div",{className:"newspack-registration__help-text",children:(0,h.jsx)(i.RichText,{onChange:t=>e({privacyLabel:t}),placeholder:(0,d.__)("Terms & Conditions statement…","newspack-plugin"),value:l||L,tagName:"p"})})]})]})]})}),"registration"===S&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"newspack-registration__icon"}),(0,h.jsx)("div",{...A})]}),"login"===S&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"newspack-registration__icon"}),(0,h.jsx)(i.RichText,{align:"center",onChange:t=>e({signedInLabel:t}),placeholder:(0,d.__)("Logged in message…","newspack-plugin"),value:j,tagName:"p"})]})]})]})},save:()=>(0,h.jsx)("div",{...i.useInnerBlocksProps.save(i.useBlockProps.save())})};var x=s(2619),v=s(7143);const j=window.wp.compose,f=window.location.href;(0,x.addFilter)("blocks.registerBlockType","newspack-plugin/register-hook/core-image",((e,t)=>"core/image"!==t?e:{...e,attributes:{...e.attributes,meta:{type:"object",default:{}}}}));const y=({setAttributes:e,attributes:t})=>{var s;const n=t.id,{meta:a}=null!==(s=(0,v.useSelect)((e=>e("core").getMedia(n)),[n]))&&void 0!==s?s:{meta:{}};return(0,u.useEffect)((()=>{if(Object.keys(a).length){const{_media_credit:s,_media_credit_url:n,_navis_media_credit_org:i}=a;s===t?.meta?._media_credit&&n===t?.meta?._media_credit_url&&i===t?.meta?._navis_media_credit_org||e({meta:{_media_credit:s,_media_credit_url:n,_navis_media_credit_org:i}})}}),[a,t?.meta?._media_credit,t?.meta?._media_credit_url,t?.meta?._navis_media_credit_org]),(0,h.jsx)(h.Fragment,{})},C=(e,t=f)=>new URL(e).hostname===new URL(t).hostname;(0,x.addFilter)("editor.BlockEdit","newspack-plugin/block-edit-hook/core-image",(0,j.createHigherOrderComponent)((e=>t=>"core/image"===t.name?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(e,{...t}),t.attributes.url&&C(t.attributes.url)&&(0,h.jsx)(y,{...t})]}):(0,h.jsx)(e,{...t})),"withCustomMetaData"));const N=[n],S=["newspack/reader-registration"],T=e=>{if(!e)return;const{metadata:t,settings:s,name:n}=e;S.includes(n)&&!newspack_blocks.has_reader_activation||(0,a.registerBlockType)({name:n,...t},s)};for(const e of N)T(e)},5325:(e,t,s)=>{var n=s(6131);e.exports=function(e,t){return!(null==e||!e.length)&&n(e,t,0)>-1}},9905:e=>{e.exports=function(e,t,s){for(var n=-1,a=null==e?0:e.length;++n<a;)if(s(t,e[n]))return!0;return!1}},6131:(e,t,s)=>{var n=s(2523),a=s(5463),i=s(6959);e.exports=function(e,t,s){return t==t?i(e,t,s):n(e,a,s)}},7185:(e,t,s)=>{var n=s(8859),a=s(5325),i=s(9905),r=s(4932),l=s(7301),c=s(9219),o=Math.min;e.exports=function(e,t,s){for(var p=s?i:a,d=e[0].length,u=e.length,h=u,g=Array(u),_=1/0,w=[];h--;){var m=e[h];h&&t&&(m=r(m,l(t))),_=o(m.length,_),g[h]=!s&&(t||d>=120&&m.length>=120)?new n(h&&m):void 0}m=e[0];var k=-1,b=g[0];e:for(;++k<d&&w.length<_;){var x=m[k],v=t?t(x):x;if(x=s||0!==x?x:0,!(b?c(b,v):p(w,v,s))){for(h=u;--h;){var j=g[h];if(!(j?c(j,v):p(e[h],v,s)))continue e}b&&b.push(v),w.push(x)}}return w}},5463:e=>{e.exports=function(e){return e!=e}},741:(e,t,s)=>{var n=s(3693);e.exports=function(e){return n(e)?e:[]}},6959:e=>{e.exports=function(e,t,s){for(var n=s-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}},5287:(e,t,s)=>{var n=s(4932),a=s(7185),i=s(9302),r=s(741),l=i((function(e){var t=n(e,r);return t.length&&t[0]===e[0]?a(t):[]}));e.exports=l},790:e=>{"use strict";e.exports=window.ReactJSXRuntime},1455:e=>{"use strict";e.exports=window.wp.apiFetch},6427:e=>{"use strict";e.exports=window.wp.components},7143:e=>{"use strict";e.exports=window.wp.data},6087:e=>{"use strict";e.exports=window.wp.element},2619:e=>{"use strict";e.exports=window.wp.hooks},7723:e=>{"use strict";e.exports=window.wp.i18n}},s={};function n(e){var a=s[e];if(void 0!==a)return a.exports;var i=s[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,e=[],n.O=(t,s,a,i)=>{if(!s){var r=1/0;for(p=0;p<e.length;p++){for(var[s,a,i]=e[p],l=!0,c=0;c<s.length;c++)(!1&i||r>=i)&&Object.keys(n.O).every((e=>n.O[e](s[c])))?s.splice(c--,1):(l=!1,i<r&&(r=i));if(l){e.splice(p--,1);var o=a();void 0!==o&&(t=o)}}return t}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[s,a,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.j=617,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var a=s.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=s[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={617:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var a,i,[r,l,c]=s,o=0;if(r.some((t=>0!==e[t]))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(c)var p=c(n)}for(t&&t(s);o<r.length;o++)i=r[o],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(p)},s=globalThis.webpackChunknewspack=globalThis.webpackChunknewspack||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var a=n.O(void 0,[223],(()=>n(3018)));a=n.O(a)})();