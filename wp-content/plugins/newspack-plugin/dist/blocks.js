!function(){var e,t={7443:function(e,t,n){var a=n(2118);e.exports=function(e,t){return!(null==e||!e.length)&&a(e,t,0)>-1}},1196:function(e){e.exports=function(e,t,n){for(var a=-1,r=null==e?0:e.length;++a<r;)if(n(t,e[a]))return!0;return!1}},2118:function(e,t,n){var a=n(1848),r=n(2722),l=n(2351);e.exports=function(e,t,n){return t==t?l(e,t,n):a(e,r,n)}},7556:function(e,t,n){var a=n(8668),r=n(7443),l=n(1196),s=n(9932),c=n(1717),i=n(4757),o=Math.min;e.exports=function(e,t,n){for(var p=n?l:r,u=e[0].length,d=e.length,m=d,g=Array(d),h=1/0,w=[];m--;){var f=e[m];m&&t&&(f=s(f,c(t))),h=o(f.length,h),g[m]=!n&&(t||u>=120&&f.length>=120)?new a(m&&f):void 0}f=e[0];var k=-1,b=g[0];e:for(;++k<u&&w.length<h;){var v=f[k],_=t?t(v):v;if(v=n||0!==v?v:0,!(b?i(b,_):p(w,_,n))){for(m=d;--m;){var E=g[m];if(!(E?i(E,_):p(e[m],_,n)))continue e}b&&b.push(_),w.push(v)}}return w}},2722:function(e){e.exports=function(e){return e!=e}},4387:function(e,t,n){var a=n(9246);e.exports=function(e){return a(e)?e:[]}},2351:function(e){e.exports=function(e,t,n){for(var a=n-1,r=e.length;++a<r;)if(e[a]===t)return a;return-1}},5325:function(e,t,n){var a=n(9932),r=n(7556),l=n(5976),s=n(4387),c=l((function(e){var t=a(e,s);return t.length&&t[0]===e[0]?r(t):[]}));e.exports=c},930:function(e,t,n){"use strict";n.r(t),n.d(t,{blocks:function(){return v}});var a={};n.r(a),n.d(a,{icon:function(){return f},metadata:function(){return w},name:function(){return k},settings:function(){return b}});var r=window.wp.blocks,l=n(9307),s=window.wp.blockEditor,c=n(5609),i=n(5325),o=n.n(i),p=n(6989),u=n.n(p),d=n(5736);const m=d.__,g=e=>"newspack-reader-registration-list-checkbox-"+e,h=[{label:m("Initial","newspack"),value:"initial"},{label:m("Registration Success","newspack"),value:"registration"},{label:m("Login Success","newspack"),value:"login"}];var w=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"newspack/reader-registration","title":"Reader Registration","category":"newspack","description":"Register a reader with their email.","textdomain":"newspack","attributes":{"title":{"type":"string"},"description":{"type":"string"},"placeholder":{"type":"string","default":"Email Address"},"label":{"type":"string","default":"Sign up","required":true},"privacyLabel":{"type":"string","default":""},"newsletterSubscription":{"type":"boolean","default":true},"displayListDescription":{"type":"boolean","default":true},"hideSubscriptionInput":{"type":"boolean","default":false},"newsletterTitle":{"type":"string","default":"Newsletters"},"newsletterLabel":{"type":"string","default":"Subscribe to our newsletter"},"lists":{"type":"array","default":[],"items":{"type":"string"}},"listsCheckboxes":{"type":"object","default":{}},"haveAccountLabel":{"type":"string","default":"Already have an account?"},"signInLabel":{"type":"string","default":"Sign in"},"signedInLabel":{"type":"string","default":"An account was already registered with this email. Please check your inbox for an authentication link."}},"supports":{"html":false,"align":true,"multiple":false}}');const f=(0,l.createElement)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(c.Path,{d:"M18.5 8V5.5H16V4h2.5V1.5H20V4h2.5v1.5H20V8h-1.5ZM16.75 17v-2A2.75 2.75 0 0 0 14 12.25h-4A2.75 2.75 0 0 0 7.25 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5Z"}),(0,l.createElement)(c.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Zm-1.5 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"})),{name:k}=w,b={icon:{src:f,foreground:"#36f"},edit:function(e){let{setAttributes:t,attributes:{title:n,description:a,placeholder:r,label:i,privacyLabel:p,newsletterSubscription:w,displayListDescription:f,hideSubscriptionInput:k,newsletterTitle:b,newsletterLabel:v,haveAccountLabel:_,signInLabel:E,signedInLabel:y,lists:x,listsCheckboxes:N,className:C}}=e;const S=(0,s.useBlockProps)(),[T,O]=(0,l.useState)(h[0].value);let{reader_activation_terms:A,reader_activation_url:L}=window.newspack_blocks;L&&(A=`<a href="${L}">`+A+"</a>");const P=(0,s.useInnerBlocksProps)({},{renderAppender:s.InnerBlocks.ButtonBlockAppender,template:[["core/paragraph",{align:"center",content:m("Thank you for registering!","newspack")}]]}),[j,I]=(0,l.useState)(!1),[B,R]=(0,l.useState)({}),M=()=>{newspack_blocks.has_newsletters&&w&&(I(!0),u()({path:"/newspack-newsletters/v1/lists_config"}).then(R).finally((()=>I(!1))))};(0,l.useEffect)(M,[]),(0,l.useEffect)(M,[w]),(0,l.useEffect)((()=>{const e=Object.keys(B);!e.length||x.length&&o()(x,e).length||t({lists:[Object.keys(B)[0]]})}),[B]);const F=e=>!N.hasOwnProperty(e)||N[e],H=e=>()=>{const n={...N};n[e]=!F(e),t({listsCheckboxes:n})};return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.InspectorControls,null,(0,l.createElement)(c.PanelBody,{title:m("Form settings","newspack")},(0,l.createElement)(c.TextControl,{label:m("Input placeholder","newspack"),value:r,disabled:j,onChange:e=>t({placeholder:e})})),newspack_blocks.has_newsletters&&(0,l.createElement)(c.PanelBody,{title:m("Newsletter Subscription","newspack")},(0,l.createElement)(c.ToggleControl,{label:m("Enable newsletter subscription","newspack"),checked:!!w,disabled:j,onChange:()=>t({newsletterSubscription:!w})}),w&&(0,l.createElement)(l.Fragment,null,j&&(0,l.createElement)(c.Spinner,null),!j&&!Object.keys(B).length&&(0,l.createElement)("div",{style:{marginBottom:"1.5rem"}},m("To enable newsletter subscription, you must configure subscription lists on Newspack Newsletters.","newspack-newsletters")),Object.keys(B).length>0&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)(c.ToggleControl,{label:m("Display list description","newspack-newsletters"),checked:f,disabled:j,onChange:()=>t({displayListDescription:!f})}),(0,l.createElement)(c.ToggleControl,{label:m("Hide newsletter selection and always subscribe","newspack"),checked:k,disabled:j||1!==x.length,onChange:()=>t({hideSubscriptionInput:!k})}),x.length<1&&(0,l.createElement)("div",{style:{marginBottom:"1.5rem"}},(0,l.createElement)(c.Notice,{isDismissible:!1,status:"error"},m("You must select at least one list.","newspack-newsletters"))),Object.keys(B).length>0&&(0,l.createElement)("p",null,m("Lists","newspack"),":"),Object.keys(B).map((e=>(0,l.createElement)(c.ToggleControl,{key:e,label:B[e].title,checked:x.includes(e),disabled:j,onChange:()=>{x.includes(e)?t({lists:x.filter((t=>t!==e))}):t({lists:x.concat(e)})}})))),(0,l.createElement)("p",null,(0,l.createElement)("a",{href:newspack_blocks.newsletters_url},m("Configure your subscription lists","newspack-newsletters")),"."))),(0,l.createElement)(c.PanelBody,{title:m("Spam protection","newspack")},(0,l.createElement)("p",null,(0,d.sprintf)(m("reCAPTCHA v3 is currently %s.","newspack"),newspack_blocks.has_recaptcha?m("enabled","newspack"):m("disabled","newspack"))),!newspack_blocks.has_recaptcha&&(0,l.createElement)("p",null,m("It's highly recommended that you enable reCAPTCHA v3 protection to prevent spambots from using this form!","newspack")),(0,l.createElement)("p",null,(0,l.createElement)("a",{href:newspack_blocks.recaptcha_url},m("Configure your reCAPTCHA settings.","newspack"))))),(0,l.createElement)("div",S,(0,l.createElement)("div",{className:"newspack-registration__state-bar"},(0,l.createElement)("span",null,m("Edited State","newspack")),(0,l.createElement)("div",null,h.map((e=>(0,l.createElement)(c.Button,{key:e.value,"data-is-active":T===e.value,onClick:()=>O(e.value)},e.label))))),"initial"===T&&(0,l.createElement)("div",{className:`newspack-registration ${C}`},(0,l.createElement)("form",{onSubmit:e=>e.preventDefault()},(0,l.createElement)("div",{className:"newspack-registration__have-account"},(0,l.createElement)(s.RichText,{onChange:e=>t({haveAccountLabel:e}),placeholder:m("Already have an account?","newspack"),value:_,tagName:"span"})," ",(0,l.createElement)("a",{href:"/my-account",onClick:e=>e.preventDefault()},(0,l.createElement)(s.RichText,{onChange:e=>t({signInLabel:e}),placeholder:m("Sign In","newspack"),value:E,tagName:"span"}))),(0,l.createElement)("div",{className:"newspack-registration__header"},(0,l.createElement)(s.RichText,{onChange:e=>t({title:e}),placeholder:m("Add title","newspack"),value:n,tagName:"h2"})),(0,l.createElement)(s.RichText,{onChange:e=>t({description:e}),placeholder:m("Add description","newspack"),value:a,tagName:"p"}),(0,l.createElement)("div",{className:"newspack-registration__form-content"},1===x.length&&k||!w||!x.length?null:(0,l.createElement)("div",{className:"newspack-reader__lists"},x?.length>1&&(0,l.createElement)(s.RichText,{onChange:e=>t({newsletterTitle:e}),placeholder:m("Newsletters title…","newspack"),value:b,tagName:"h3"}),(0,l.createElement)("ul",null,x.map((e=>(0,l.createElement)("li",{key:e},(0,l.createElement)("span",{className:"newspack-reader__lists__checkbox"},(0,l.createElement)("input",{id:g(e),type:"checkbox",checked:F(e),onChange:H(e)})),(0,l.createElement)("span",{className:"newspack-reader__lists__details"},(0,l.createElement)("label",{htmlFor:g(e),className:"newspack-reader__lists__label"},(0,l.createElement)("span",{className:"newspack-reader__lists__title"},1===x.length?(0,l.createElement)(s.RichText,{onChange:e=>t({newsletterLabel:e}),placeholder:m("Subscribe to our newsletter","newspack"),value:v,tagName:"span"}):B[e]?.title),f&&(0,l.createElement)("span",{className:"newspack-reader__lists__description"},B[e]?.description)))))))),(0,l.createElement)("div",{className:"newspack-registration__main"},(0,l.createElement)("div",null,(0,l.createElement)("div",{className:"newspack-registration__inputs"},(0,l.createElement)("input",{type:"email",placeholder:r}),(0,l.createElement)("button",{type:"submit"},(0,l.createElement)(s.RichText,{onChange:e=>t({label:e}),placeholder:m("Sign up","newspack"),value:i,tagName:"span"}))),newspack_blocks.has_google_oauth&&(0,l.createElement)("div",{className:"newspack-reader__logins"},(0,l.createElement)("div",{className:"newspack-reader__logins__separator"},(0,l.createElement)("div",null),(0,l.createElement)("div",null,m("OR","newspack")),(0,l.createElement)("div",null)),(0,l.createElement)("button",{className:"newspack-reader__logins__google"},(0,l.createElement)("span",{dangerouslySetInnerHTML:{__html:newspack_blocks.google_logo_svg}}),(0,l.createElement)("span",null,m("Sign in with Google","newspack")))),(0,l.createElement)("div",{className:"newspack-registration__response"})),(0,l.createElement)("div",{className:"newspack-registration__help-text"},(0,l.createElement)(s.RichText,{onChange:e=>t({privacyLabel:e}),placeholder:m("Terms & Conditions statement…","newspack"),value:p||A,tagName:"p"})))))),"registration"===T&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"newspack-registration__icon"}),(0,l.createElement)("div",P)),"login"===T&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"newspack-registration__icon"}),(0,l.createElement)(s.RichText,{align:"center",onChange:e=>t({signedInLabel:e}),placeholder:m("Logged in message…","newspack"),value:y,tagName:"p"}))))},save:()=>(0,l.createElement)("div",s.useInnerBlocksProps.save(s.useBlockProps.save()))},v=[a],_=["newspack/reader-registration"],E=e=>{if(!e)return;const{metadata:t,settings:n,name:a}=e;_.includes(a)&&!newspack_blocks.has_reader_activation||(0,r.registerBlockType)({name:a,...t},n)};for(const e of v)E(e)},6989:function(e){"use strict";e.exports=window.wp.apiFetch},5609:function(e){"use strict";e.exports=window.wp.components},9307:function(e){"use strict";e.exports=window.wp.element},5736:function(e){"use strict";e.exports=window.wp.i18n}},n={};function a(e){var r=n[e];if(void 0!==r)return r.exports;var l=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=t,e=[],a.O=function(t,n,r,l){if(!n){var s=1/0;for(p=0;p<e.length;p++){n=e[p][0],r=e[p][1],l=e[p][2];for(var c=!0,i=0;i<n.length;i++)(!1&l||s>=l)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(c=!1,l<s&&(s=l));if(c){e.splice(p--,1);var o=r();void 0!==o&&(t=o)}}return t}l=l||0;for(var p=e.length;p>0&&e[p-1][2]>l;p--)e[p]=e[p-1];e[p]=[n,r,l]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},a.j=346,function(){var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e}(),function(){var e={346:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,l,s=n[0],c=n[1],i=n[2],o=0;if(s.some((function(t){return 0!==e[t]}))){for(r in c)a.o(c,r)&&(a.m[r]=c[r]);if(i)var p=i(a)}for(t&&t(n);o<s.length;o++)l=s[o],a.o(e,l)&&e[l]&&e[l][0](),e[s[o]]=0;return a.O(p)},n=self.webpackChunkwebpack=self.webpackChunkwebpack||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=a.O(void 0,[351],(function(){return a(930)}));r=a.O(r);var l=window;for(var s in r)l[s]=r[s];r.__esModule&&Object.defineProperty(l,"__esModule",{value:!0})}();