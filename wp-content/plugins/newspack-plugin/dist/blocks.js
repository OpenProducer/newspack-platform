(()=>{var e,t={7556:(e,t,a)=>{var n=a(8668),l=a(7443),r=a(1196),s=a(9932),c=a(1717),i=a(4757),o=Math.min;e.exports=function(e,t,a){for(var p=a?r:l,u=e[0].length,d=e.length,m=d,g=Array(d),h=1/0,w=[];m--;){var k=e[m];m&&t&&(k=s(k,c(t))),h=o(k.length,h),g[m]=!a&&(t||u>=120&&k.length>=120)?new n(m&&k):void 0}k=e[0];var b=-1,v=g[0];e:for(;++b<u&&w.length<h;){var _=k[b],E=t?t(_):_;if(_=a||0!==_?_:0,!(v?i(v,E):p(w,E,a))){for(m=d;--m;){var f=g[m];if(!(f?i(f,E):p(e[m],E,a)))continue e}v&&v.push(E),w.push(_)}}return w}},4387:(e,t,a)=>{var n=a(9246);e.exports=function(e){return n(e)?e:[]}},5325:(e,t,a)=>{var n=a(9932),l=a(7556),r=a(5976),s=a(4387),c=r((function(e){var t=n(e,s);return t.length&&t[0]===e[0]?l(t):[]}));e.exports=c},930:(e,t,a)=>{"use strict";a.r(t),a.d(t,{blocks:()=>v});var n={};a.r(n),a.d(n,{icon:()=>w,metadata:()=>h,name:()=>k,settings:()=>b});const l=window.wp.blocks;var r=a(9307);const s=window.wp.blockEditor;var c=a(5609),i=a(5325),o=a.n(i),p=a(6989),u=a.n(p),d=a(5736);const m=d.__,g=[{label:m("Initial","newspack"),value:"initial"},{label:m("Registration Success","newspack"),value:"registration"},{label:m("Login Success","newspack"),value:"login"}],h=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"newspack/reader-registration","title":"Reader Registration","category":"newspack","description":"Register a reader with their email.","textdomain":"newspack","attributes":{"title":{"type":"string"},"description":{"type":"string"},"placeholder":{"type":"string","default":"Email Address"},"label":{"type":"string","default":"Sign up","required":true},"privacyLabel":{"type":"string","default":""},"newsletterSubscription":{"type":"boolean","default":true},"displayListDescription":{"type":"boolean","default":true},"hideSubscriptionInput":{"type":"boolean","default":false},"newsletterTitle":{"type":"string","default":"Newsletters"},"newsletterLabel":{"type":"string","default":"Subscribe to our newsletter"},"lists":{"type":"array","default":[],"items":{"type":"string"}},"haveAccountLabel":{"type":"string","default":"Already have an account?"},"signInLabel":{"type":"string","default":"Sign in"},"signedInLabel":{"type":"string","default":"An account was already registered with this email. Please check your inbox for an authentication link."}},"supports":{"html":false,"align":true,"multiple":false}}'),w=(0,r.createElement)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(c.Path,{d:"M18.5 8V5.5H16V4h2.5V1.5H20V4h2.5v1.5H20V8h-1.5ZM16.75 17v-2A2.75 2.75 0 0 0 14 12.25h-4A2.75 2.75 0 0 0 7.25 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5Z"}),(0,r.createElement)(c.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Zm-1.5 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"})),{name:k}=h,b={icon:{src:w,foreground:"#36f"},edit:function(e){let{setAttributes:t,attributes:{title:a,description:n,placeholder:l,label:i,privacyLabel:p,newsletterSubscription:h,displayListDescription:w,hideSubscriptionInput:k,newsletterTitle:b,newsletterLabel:v,haveAccountLabel:_,signInLabel:E,signedInLabel:f,lists:y,className:N}}=e;const S=(0,s.useBlockProps)(),[C,T]=(0,r.useState)(g[0].value);let{reader_activation_terms:x,reader_activation_url:O}=window.newspack_blocks;O&&(x=`<a href="${O}">`+x+"</a>");const A=(0,s.useInnerBlocksProps)({},{renderAppender:s.InnerBlocks.ButtonBlockAppender,template:[["core/paragraph",{align:"center",content:m("Thank you for registering!","newspack")}]]}),[L,P]=(0,r.useState)(!1),[I,j]=(0,r.useState)({}),B=()=>{newspack_blocks.has_newsletters&&h&&(P(!0),u()({path:"/newspack-newsletters/v1/lists_config"}).then(j).finally((()=>P(!1))))};return(0,r.useEffect)(B,[]),(0,r.useEffect)(B,[h]),(0,r.useEffect)((()=>{const e=Object.keys(I);!e.length||y.length&&o()(y,e).length||t({lists:[Object.keys(I)[0]]})}),[I]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(s.InspectorControls,null,(0,r.createElement)(c.PanelBody,{title:m("Form settings","newspack")},(0,r.createElement)(c.TextControl,{label:m("Input placeholder","newspack"),value:l,disabled:L,onChange:e=>t({placeholder:e})})),newspack_blocks.has_newsletters&&(0,r.createElement)(c.PanelBody,{title:m("Newsletter Subscription","newspack")},(0,r.createElement)(c.ToggleControl,{label:m("Enable newsletter subscription","newspack"),checked:!!h,disabled:L,onChange:()=>t({newsletterSubscription:!h})}),h&&(0,r.createElement)(r.Fragment,null,L&&(0,r.createElement)(c.Spinner,null),!L&&!Object.keys(I).length&&(0,r.createElement)("div",{style:{marginBottom:"1.5rem"}},m("To enable newsletter subscription, you must configure subscription lists on Newspack Newsletters.","newspack-newsletters")),Object.keys(I).length>0&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.ToggleControl,{label:m("Display list description","newspack-newsletters"),checked:w,disabled:L,onChange:()=>t({displayListDescription:!w})}),(0,r.createElement)(c.ToggleControl,{label:m("Hide newsletter selection and always subscribe","newspack"),checked:k,disabled:L||1!==y.length,onChange:()=>t({hideSubscriptionInput:!k})}),y.length<1&&(0,r.createElement)("div",{style:{marginBottom:"1.5rem"}},(0,r.createElement)(c.Notice,{isDismissible:!1,status:"error"},m("You must select at least one list.","newspack-newsletters"))),Object.keys(I).length>0&&(0,r.createElement)("p",null,m("Lists","newspack"),":"),Object.keys(I).map((e=>(0,r.createElement)(c.ToggleControl,{key:e,label:I[e].title,checked:y.includes(e),disabled:L,onChange:()=>{y.includes(e)?t({lists:y.filter((t=>t!==e))}):t({lists:y.concat(e)})}})))),(0,r.createElement)("p",null,(0,r.createElement)("a",{href:newspack_blocks.newsletters_url},m("Configure your subscription lists","newspack-newsletters")),"."))),(0,r.createElement)(c.PanelBody,{title:m("Spam protection","newspack")},(0,r.createElement)("p",null,(0,d.sprintf)(m("reCAPTCHA v3 is currently %s.","newspack"),newspack_blocks.has_recaptcha?m("enabled","newspack"):m("disabled","newspack"))),!newspack_blocks.has_recaptcha&&(0,r.createElement)("p",null,m("It's highly recommended that you enable reCAPTCHA v3 protection to prevent spambots from using this form!","newspack")),(0,r.createElement)("p",null,(0,r.createElement)("a",{href:newspack_blocks.recaptcha_url},m("Configure your reCAPTCHA settings.","newspack"))))),(0,r.createElement)("div",S,(0,r.createElement)("div",{className:"newspack-registration__state-bar"},(0,r.createElement)("span",null,m("Edited State","newspack")),(0,r.createElement)("div",null,g.map((e=>(0,r.createElement)(c.Button,{key:e.value,"data-is-active":C===e.value,onClick:()=>T(e.value)},e.label))))),"initial"===C&&(0,r.createElement)("div",{className:`newspack-registration ${N}`},(0,r.createElement)("form",{onSubmit:e=>e.preventDefault()},(0,r.createElement)("div",{className:"newspack-registration__have-account"},(0,r.createElement)(s.RichText,{onChange:e=>t({haveAccountLabel:e}),placeholder:m("Already have an account?","newspack"),value:_,tagName:"span"})," ",(0,r.createElement)("a",{href:"/my-account",onClick:e=>e.preventDefault()},(0,r.createElement)(s.RichText,{onChange:e=>t({signInLabel:e}),placeholder:m("Sign In","newspack"),value:E,tagName:"span"}))),(0,r.createElement)("div",{className:"newspack-registration__header"},(0,r.createElement)(s.RichText,{onChange:e=>t({title:e}),placeholder:m("Add title","newspack"),value:a,tagName:"h2"})),(0,r.createElement)(s.RichText,{onChange:e=>t({description:e}),placeholder:m("Add description","newspack"),value:n,tagName:"p"}),(0,r.createElement)("div",{className:"newspack-registration__form-content"},1===y.length&&k||!h||!y.length?null:(0,r.createElement)("div",{className:"newspack-reader__lists"},y?.length>1&&(0,r.createElement)(s.RichText,{onChange:e=>t({newsletterTitle:e}),placeholder:m("Newsletters title…","newspack"),value:b,tagName:"h3"}),(0,r.createElement)("ul",null,y.map((e=>(0,r.createElement)("li",{key:e},(0,r.createElement)("span",{className:"newspack-reader__lists__checkbox"},(0,r.createElement)("input",{type:"checkbox",checked:!0,readOnly:!0})),(0,r.createElement)("span",{className:"newspack-reader__lists__details"},(0,r.createElement)("span",{className:"newspack-reader__lists__label"},(0,r.createElement)("span",{className:"newspack-reader__lists__title"},1===y.length?(0,r.createElement)(s.RichText,{onChange:e=>t({newsletterLabel:e}),placeholder:m("Subscribe to our newsletter","newspack"),value:v,tagName:"span"}):I[e]?.title),w&&(0,r.createElement)("span",{className:"newspack-reader__lists__description"},I[e]?.description)))))))),(0,r.createElement)("div",{className:"newspack-registration__main"},(0,r.createElement)("div",null,(0,r.createElement)("div",{className:"newspack-registration__inputs"},(0,r.createElement)("input",{type:"email",placeholder:l}),(0,r.createElement)("button",{type:"submit"},(0,r.createElement)(s.RichText,{onChange:e=>t({label:e}),placeholder:m("Sign up","newspack"),value:i,tagName:"span"}))),newspack_blocks.has_google_oauth&&(0,r.createElement)("div",{className:"newspack-reader__logins"},(0,r.createElement)("div",{className:"newspack-reader__logins__separator"},(0,r.createElement)("div",null),(0,r.createElement)("div",null,m("OR","newspack")),(0,r.createElement)("div",null)),(0,r.createElement)("button",{className:"newspack-reader__logins__google"},(0,r.createElement)("span",{dangerouslySetInnerHTML:{__html:newspack_blocks.google_logo_svg}}),(0,r.createElement)("span",null,m("Sign in with Google","newspack")))),(0,r.createElement)("div",{className:"newspack-registration__response"})),(0,r.createElement)("div",{className:"newspack-registration__help-text"},(0,r.createElement)(s.RichText,{onChange:e=>t({privacyLabel:e}),placeholder:m("Terms & Conditions statement…","newspack"),value:p||x,tagName:"p"})))))),"registration"===C&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"newspack-registration__icon"}),(0,r.createElement)("div",A)),"login"===C&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"newspack-registration__icon"}),(0,r.createElement)(s.RichText,{align:"center",onChange:e=>t({signedInLabel:e}),placeholder:m("Logged in message…","newspack"),value:f,tagName:"p"}))))},save:()=>(0,r.createElement)("div",s.useInnerBlocksProps.save(s.useBlockProps.save()))},v=[n],_=["newspack/reader-registration"],E=e=>{if(!e)return;const{metadata:t,settings:a,name:n}=e;_.includes(n)&&!newspack_blocks.has_reader_activation||(0,l.registerBlockType)({name:n,...t},a)};for(const e of v)E(e)},6989:e=>{"use strict";e.exports=window.wp.apiFetch},5609:e=>{"use strict";e.exports=window.wp.components},9307:e=>{"use strict";e.exports=window.wp.element},5736:e=>{"use strict";e.exports=window.wp.i18n}},a={};function n(e){var l=a[e];if(void 0!==l)return l.exports;var r=a[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=t,e=[],n.O=(t,a,l,r)=>{if(!a){var s=1/0;for(p=0;p<e.length;p++){a=e[p][0],l=e[p][1],r=e[p][2];for(var c=!0,i=0;i<a.length;i++)(!1&r||s>=r)&&Object.keys(n.O).every((e=>n.O[e](a[i])))?a.splice(i--,1):(c=!1,r<s&&(s=r));if(c){e.splice(p--,1);var o=l();void 0!==o&&(t=o)}}return t}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[a,l,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.j=346,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");a.length&&(e=a[a.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={346:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var l,r,s=a[0],c=a[1],i=a[2],o=0;if(s.some((t=>0!==e[t]))){for(l in c)n.o(c,l)&&(n.m[l]=c[l]);if(i)var p=i(n)}for(t&&t(a);o<s.length;o++)r=s[o],n.o(e,r)&&e[r]&&e[r][0](),e[s[o]]=0;return n.O(p)},a=self.webpackChunkwebpack=self.webpackChunkwebpack||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var l=n.O(void 0,[351],(()=>n(930)));l=n.O(l);var r=window;for(var s in l)r[s]=l[s];l.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();