(()=>{var e,t={7443:(e,t,n)=>{var a=n(2118);e.exports=function(e,t){return!(null==e||!e.length)&&a(e,t,0)>-1}},1196:e=>{e.exports=function(e,t,n){for(var a=-1,l=null==e?0:e.length;++a<l;)if(n(t,e[a]))return!0;return!1}},2118:(e,t,n)=>{var a=n(1848),l=n(2722),r=n(2351);e.exports=function(e,t,n){return t==t?r(e,t,n):a(e,l,n)}},7556:(e,t,n)=>{var a=n(8668),l=n(7443),r=n(1196),s=n(9932),i=n(1717),c=n(4757),o=Math.min;e.exports=function(e,t,n){for(var p=n?r:l,u=e[0].length,d=e.length,g=d,m=Array(d),h=1/0,w=[];g--;){var k=e[g];g&&t&&(k=s(k,i(t))),h=o(k.length,h),m[g]=!n&&(t||u>=120&&k.length>=120)?new a(g&&k):void 0}k=e[0];var b=-1,v=m[0];e:for(;++b<u&&w.length<h;){var _=k[b],f=t?t(_):_;if(_=n||0!==_?_:0,!(v?c(v,f):p(w,f,n))){for(g=d;--g;){var E=m[g];if(!(E?c(E,f):p(e[g],f,n)))continue e}v&&v.push(f),w.push(_)}}return w}},2722:e=>{e.exports=function(e){return e!=e}},4387:(e,t,n)=>{var a=n(9246);e.exports=function(e){return a(e)?e:[]}},2351:e=>{e.exports=function(e,t,n){for(var a=n-1,l=e.length;++a<l;)if(e[a]===t)return a;return-1}},5325:(e,t,n)=>{var a=n(9932),l=n(7556),r=n(5976),s=n(4387),i=r((function(e){var t=a(e,s);return t.length&&t[0]===e[0]?l(t):[]}));e.exports=i},2927:(e,t,n)=>{"use strict";n.r(t),n.d(t,{blocks:()=>C});var a={};n.r(a),n.d(a,{icon:()=>k,metadata:()=>w,name:()=>b,settings:()=>v});const l=window.wp.blocks;var r=n(9307);const s=window.wp.blockEditor;var i=n(5609),c=n(5325),o=n.n(c),p=n(6989),u=n.n(p),d=n(5736);const g=d.__,m=e=>"newspack-reader-registration-list-checkbox-"+e,h=[{label:g("Initial","newspack-plugin"),value:"initial"},{label:g("Registration Success","newspack-plugin"),value:"registration"},{label:g("Login Success","newspack-plugin"),value:"login"}],w=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"newspack/reader-registration","title":"Reader Registration","category":"newspack","description":"Register a reader with their email.","textdomain":"newspack-plugin","attributes":{"title":{"type":"string"},"description":{"type":"string"},"placeholder":{"type":"string","default":"Email Address"},"label":{"type":"string","default":"Sign up","required":true},"privacyLabel":{"type":"string","default":""},"newsletterSubscription":{"type":"boolean","default":true},"displayListDescription":{"type":"boolean","default":true},"hideSubscriptionInput":{"type":"boolean","default":false},"newsletterTitle":{"type":"string","default":"Newsletters"},"newsletterLabel":{"type":"string","default":"Subscribe to our newsletter"},"lists":{"type":"array","default":[],"items":{"type":"string"}},"listsCheckboxes":{"type":"object","default":{}},"haveAccountLabel":{"type":"string","default":"Already have an account?"},"signInLabel":{"type":"string","default":"Sign in"},"signedInLabel":{"type":"string","default":"An account was already registered with this email. Please check your inbox for an authentication link."}},"supports":{"html":false,"align":true,"multiple":false}}'),k=(0,r.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(i.Path,{d:"M18.5 8V5.5H16V4h2.5V1.5H20V4h2.5v1.5H20V8h-1.5ZM16.75 17v-2A2.75 2.75 0 0 0 14 12.25h-4A2.75 2.75 0 0 0 7.25 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5Z"}),(0,r.createElement)(i.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Zm-1.5 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"})),{name:b}=w,v={icon:{src:k,foreground:"#36f"},edit:function({setAttributes:e,attributes:{title:t,description:n,placeholder:a,label:l,privacyLabel:c,newsletterSubscription:p,displayListDescription:w,hideSubscriptionInput:k,newsletterTitle:b,newsletterLabel:v,haveAccountLabel:_,signInLabel:f,signedInLabel:E,lists:y,listsCheckboxes:x,className:C}}){const N=(0,s.useBlockProps)(),[S,T]=(0,r.useState)(h[0].value);let{reader_activation_terms:O,reader_activation_url:L}=window.newspack_blocks;L&&(O=`<a href="${L}">`+O+"</a>");const A=(0,s.useInnerBlocksProps)({},{renderAppender:s.InnerBlocks.ButtonBlockAppender,template:[["core/paragraph",{align:"center",content:g("Thank you for registering!","newspack-plugin")}]]}),[j,P]=(0,r.useState)(!1),[B,I]=(0,r.useState)({}),R=()=>{newspack_blocks.has_newsletters&&p&&(P(!0),u()({path:"/newspack-newsletters/v1/lists_config"}).then(I).finally((()=>P(!1))))};(0,r.useEffect)(R,[]),(0,r.useEffect)(R,[p]),(0,r.useEffect)((()=>{const t=Object.keys(B);!t.length||y.length&&o()(y,t).length||e({lists:[Object.keys(B)[0]]})}),[B]);const F=e=>x.hasOwnProperty(e)&&x[e],M=t=>()=>{const n={...x};n[t]=!F(t),e({listsCheckboxes:n})};return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(s.InspectorControls,null,(0,r.createElement)(i.PanelBody,{title:g("Form settings","newspack-plugin")},(0,r.createElement)(i.TextControl,{label:g("Input placeholder","newspack-plugin"),value:a,disabled:j,onChange:t=>e({placeholder:t})})),newspack_blocks.has_newsletters&&(0,r.createElement)(i.PanelBody,{title:g("Newsletter Subscription","newspack-plugin")},(0,r.createElement)(i.ToggleControl,{label:g("Enable newsletter subscription","newspack-plugin"),checked:!!p,disabled:j,onChange:()=>e({newsletterSubscription:!p})}),p&&(0,r.createElement)(r.Fragment,null,j&&(0,r.createElement)(i.Spinner,null),!j&&!Object.keys(B).length&&(0,r.createElement)("div",{style:{marginBottom:"1.5rem"}},g("To enable newsletter subscription, you must configure subscription lists on Newspack Newsletters.","newspack-plugin")),Object.keys(B).length>0&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(i.ToggleControl,{label:g("Display list description","newspack-plugin"),checked:w,disabled:j,onChange:()=>e({displayListDescription:!w})}),(0,r.createElement)(i.ToggleControl,{label:g("Hide newsletter selection and always subscribe","newspack-plugin"),checked:k,disabled:j||1!==y.length,onChange:()=>e({hideSubscriptionInput:!k})}),y.length<1&&(0,r.createElement)("div",{style:{marginBottom:"1.5rem"}},(0,r.createElement)(i.Notice,{isDismissible:!1,status:"error"},g("You must select at least one list.","newspack-plugin"))),Object.keys(B).length>0&&(0,r.createElement)("p",null,g("Lists","newspack-plugin"),":"),Object.keys(B).map((t=>(0,r.createElement)(i.ToggleControl,{key:t,label:B[t].title,checked:y.includes(t),disabled:j,onChange:()=>{y.includes(t)?e({lists:y.filter((e=>e!==t))}):e({lists:y.concat(t)})}})))),(0,r.createElement)("p",null,(0,r.createElement)("a",{href:newspack_blocks.newsletters_url},g("Configure your subscription lists","newspack-plugin")),"."))),(0,r.createElement)(i.PanelBody,{title:g("Spam protection","newspack-plugin")},(0,r.createElement)("p",null,(0,d.sprintf)(g("reCAPTCHA v3 is currently %s.","newspack-plugin"),newspack_blocks.has_recaptcha?g("enabled","newspack-plugin"):g("disabled","newspack-plugin"))),!newspack_blocks.has_recaptcha&&(0,r.createElement)("p",null,g("It's highly recommended that you enable reCAPTCHA v3 protection to prevent spambots from using this form!","newspack-plugin")),(0,r.createElement)("p",null,(0,r.createElement)("a",{href:newspack_blocks.recaptcha_url},g("Configure your reCAPTCHA settings.","newspack-plugin"))))),(0,r.createElement)("div",N,(0,r.createElement)("div",{className:"newspack-registration__state-bar"},(0,r.createElement)("span",null,g("Edited State","newspack-plugin")),(0,r.createElement)("div",null,h.map((e=>(0,r.createElement)(i.Button,{key:e.value,"data-is-active":S===e.value,onClick:()=>T(e.value)},e.label))))),"initial"===S&&(0,r.createElement)("div",{className:`newspack-registration ${C}`},(0,r.createElement)("form",{onSubmit:e=>e.preventDefault()},(0,r.createElement)("div",{className:"newspack-registration__have-account"},(0,r.createElement)(s.RichText,{onChange:t=>e({haveAccountLabel:t}),placeholder:g("Already have an account?","newspack-plugin"),value:_,tagName:"span"})," ",(0,r.createElement)("a",{href:"/my-account",onClick:e=>e.preventDefault()},(0,r.createElement)(s.RichText,{onChange:t=>e({signInLabel:t}),placeholder:g("Sign In","newspack-plugin"),value:f,tagName:"span"}))),(0,r.createElement)("div",{className:"newspack-registration__header"},(0,r.createElement)(s.RichText,{onChange:t=>e({title:t}),placeholder:g("Add title","newspack-plugin"),value:t,tagName:"h2"})),(0,r.createElement)(s.RichText,{onChange:t=>e({description:t}),placeholder:g("Add description","newspack-plugin"),value:n,tagName:"p"}),(0,r.createElement)("div",{className:"newspack-registration__form-content"},1===y.length&&k||!p||!y.length?null:(0,r.createElement)("div",{className:"newspack-reader__lists"},y?.length>1&&(0,r.createElement)(s.RichText,{onChange:t=>e({newsletterTitle:t}),placeholder:g("Newsletters title…","newspack-plugin"),value:b,tagName:"h3"}),(0,r.createElement)("ul",null,y.map((t=>(0,r.createElement)("li",{key:t},(0,r.createElement)("span",{className:"newspack-reader__lists__checkbox"},(0,r.createElement)("input",{id:m(t),type:"checkbox",checked:F(t),onChange:M(t)})),(0,r.createElement)("span",{className:"newspack-reader__lists__details"},(0,r.createElement)("label",{htmlFor:m(t),className:"newspack-reader__lists__label"},(0,r.createElement)("span",{className:"newspack-reader__lists__title"},1===y.length?(0,r.createElement)(s.RichText,{onChange:t=>e({newsletterLabel:t}),placeholder:g("Subscribe to our newsletter","newspack-plugin"),value:v,tagName:"span"}):B[t]?.title),w&&(0,r.createElement)("span",{className:"newspack-reader__lists__description"},B[t]?.description)))))))),(0,r.createElement)("div",{className:"newspack-registration__main"},(0,r.createElement)("div",null,(0,r.createElement)("div",{className:"newspack-registration__inputs"},(0,r.createElement)("input",{type:"email",placeholder:a}),(0,r.createElement)("button",{type:"submit"},(0,r.createElement)(s.RichText,{onChange:t=>e({label:t}),placeholder:g("Sign up","newspack-plugin"),value:l,tagName:"span"}))),newspack_blocks.has_google_oauth&&(0,r.createElement)("div",{className:"newspack-reader__logins"},(0,r.createElement)("div",{className:"newspack-reader__logins__separator"},(0,r.createElement)("div",null),(0,r.createElement)("div",null,g("OR","newspack-plugin")),(0,r.createElement)("div",null)),(0,r.createElement)("button",{className:"newspack-reader__logins__google"},(0,r.createElement)("span",{dangerouslySetInnerHTML:{__html:newspack_blocks.google_logo_svg}}),(0,r.createElement)("span",null,g("Sign in with Google","newspack-plugin")))),(0,r.createElement)("div",{className:"newspack-registration__response"})),(0,r.createElement)("div",{className:"newspack-registration__help-text"},(0,r.createElement)(s.RichText,{onChange:t=>e({privacyLabel:t}),placeholder:g("Terms & Conditions statement…","newspack-plugin"),value:c||O,tagName:"p"})))))),"registration"===S&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"newspack-registration__icon"}),(0,r.createElement)("div",A)),"login"===S&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"newspack-registration__icon"}),(0,r.createElement)(s.RichText,{align:"center",onChange:t=>e({signedInLabel:t}),placeholder:g("Logged in message…","newspack-plugin"),value:E,tagName:"p"}))))},save:()=>(0,r.createElement)("div",s.useInnerBlocksProps.save(s.useBlockProps.save()))};var _=n(2694),f=n(9818);const E=window.wp.compose,y=window.location.href;(0,_.addFilter)("blocks.registerBlockType","newspack-plugin/register-hook/core-image",((e,t)=>"core/image"!==t?e:{...e,attributes:{...e.attributes,meta:{type:"object",default:{}}}}));const x=({setAttributes:e,attributes:t})=>{const n=t.id,{meta:a}=(0,f.useSelect)((e=>e("core").getMedia(n)),[n])??{meta:{}};return(0,r.useEffect)((()=>{if(Object.keys(a).length){const{_media_credit:t,_media_credit_url:n,_navis_media_credit_org:l}=a;e({meta:{_media_credit:t,_media_credit_url:n,_navis_media_credit_org:l}})}}),[Object.keys(a).length]),(0,r.createElement)(r.Fragment,null)};(0,_.addFilter)("editor.BlockEdit","newspack-plugin/block-edit-hook/core-image",(0,E.createHigherOrderComponent)((e=>t=>"core/image"===t.name?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(e,t),t.attributes.url&&((e,t=y)=>new URL(e).hostname===new URL(t).hostname)(t.attributes.url)&&(0,r.createElement)(x,t)):(0,r.createElement)(e,t)),"withCustomMetaData"));const C=[a],N=["newspack/reader-registration"],S=e=>{if(!e)return;const{metadata:t,settings:n,name:a}=e;N.includes(a)&&!newspack_blocks.has_reader_activation||(0,l.registerBlockType)({name:a,...t},n)};for(const e of C)S(e)},6989:e=>{"use strict";e.exports=window.wp.apiFetch},5609:e=>{"use strict";e.exports=window.wp.components},9818:e=>{"use strict";e.exports=window.wp.data},9307:e=>{"use strict";e.exports=window.wp.element},2694:e=>{"use strict";e.exports=window.wp.hooks},5736:e=>{"use strict";e.exports=window.wp.i18n}},n={};function a(e){var l=n[e];if(void 0!==l)return l.exports;var r=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=t,e=[],a.O=(t,n,l,r)=>{if(!n){var s=1/0;for(p=0;p<e.length;p++){for(var[n,l,r]=e[p],i=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(i=!1,r<s&&(s=r));if(i){e.splice(p--,1);var o=l();void 0!==o&&(t=o)}}return t}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[n,l,r]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.j=346,(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={346:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var l,r,[s,i,c]=n,o=0;if(s.some((t=>0!==e[t]))){for(l in i)a.o(i,l)&&(a.m[l]=i[l]);if(c)var p=c(a)}for(t&&t(n);o<s.length;o++)r=s[o],a.o(e,r)&&e[r]&&e[r][0](),e[s[o]]=0;return a.O(p)},n=globalThis.webpackChunkwebpack=globalThis.webpackChunkwebpack||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var l=a.O(void 0,[351],(()=>a(2927)));l=a.O(l);var r=window;for(var s in l)r[s]=l[s];l.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();