(()=>{"use strict";var e,t={930:(e,t,a)=>{a.r(t),a.d(t,{blocks:()=>b});var n={};a.r(n),a.d(n,{icon:()=>g,metadata:()=>m,name:()=>w,settings:()=>h});const l=window.wp.blocks;var s=a(9307);const r=window.wp.blockEditor;var i=a(5609),c=a(2819),o=a(6989),p=a.n(o);const u=a(5736).__,d=[{label:u("Initial","newspack"),value:"initial"},{label:u("Registration Success","newspack"),value:"registration"},{label:u("Login Success","newspack"),value:"login"}],m=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"newspack/reader-registration","title":"Reader Registration","category":"newspack","description":"Register a reader with their email.","textdomain":"newspack","attributes":{"placeholder":{"type":"string","default":"Email Address"},"label":{"type":"string","default":"Sign up","required":true},"privacyLabel":{"type":"string","default":"By signing up, you agree to our Terms and Conditions."},"newsletterSubscription":{"type":"boolean","default":false},"displayListDescription":{"type":"boolean","default":true},"newsletterTitle":{"type":"string","default":"Newsletters"},"newsletterLabel":{"type":"string","default":"Subscribe to our newsletter"},"lists":{"type":"array","default":[],"items":{"type":"string"}},"haveAccountLabel":{"type":"string","default":"Already have an account?"},"signInLabel":{"type":"string","default":"Sign in"},"signedInLabel":{"type":"string","default":"An account was already registered with this email. Please check your inbox for an authentication link."}},"supports":{"html":false,"align":true,"multiple":false}}'),g=(0,s.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(i.Path,{d:"M18.5 8V5.5H16V4h2.5V1.5H20V4h2.5v1.5H20V8h-1.5ZM16.75 17v-2A2.75 2.75 0 0 0 14 12.25h-4A2.75 2.75 0 0 0 7.25 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5Z"}),(0,s.createElement)(i.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Zm-1.5 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"})),{name:w}=m,h={icon:{src:g,foreground:"#36f"},edit:function(e){let{setAttributes:t,attributes:{placeholder:a,label:n,privacyLabel:l,newsletterSubscription:o,displayListDescription:m,newsletterTitle:g,newsletterLabel:w,haveAccountLabel:h,signInLabel:b,signedInLabel:k,lists:v,className:E}}=e;const _=(0,r.useBlockProps)(),[f,y]=(0,s.useState)(d[0].value),N=(0,r.useInnerBlocksProps)({},{renderAppender:r.InnerBlocks.ButtonBlockAppender,template:[["core/paragraph",{align:"center",content:u("Thank you for registering!<br />Check your email for a confirmation link.","newspack")}]]}),[S,T]=(0,s.useState)(!1),[x,C]=(0,s.useState)({}),L=()=>{newspack_blocks.has_newsletters&&o&&(T(!0),p()({path:"/newspack-newsletters/v1/lists_config"}).then(C).finally((()=>T(!1))))};return(0,s.useEffect)(L,[]),(0,s.useEffect)(L,[o]),(0,s.useEffect)((()=>{const e=Object.keys(x);!e.length||v.length&&(0,c.intersection)(v,e).length||t({lists:[Object.keys(x)[0]]})}),[x]),(0,s.createElement)(s.Fragment,null,(0,s.createElement)(r.InspectorControls,null,(0,s.createElement)(i.PanelBody,{title:u("Form settings","newspack")},(0,s.createElement)(i.TextControl,{label:u("Input placeholder","newspack"),value:a,disabled:S,onChange:e=>t({placeholder:e})})),newspack_blocks.has_newsletters&&(0,s.createElement)(i.PanelBody,{title:u("Newsletter Subscription","newspack")},(0,s.createElement)(i.ToggleControl,{label:u("Enable newsletter subscription","newspack"),checked:!!o,disabled:S,onChange:()=>t({newsletterSubscription:!o})}),o&&(0,s.createElement)(s.Fragment,null,S&&(0,s.createElement)(i.Spinner,null),!S&&!Object.keys(x).length&&(0,s.createElement)("div",{style:{marginBottom:"1.5rem"}},(0,s.createElement)(i.Notice,{isDismissible:!1,status:"error"},u("You must enable lists for subscription.","newspack-newsletters"))),(0,s.createElement)(i.ToggleControl,{label:u("Display list description","newspack-newsletters"),checked:m,disabled:S,onChange:()=>t({displayListDescription:!m})}),v.length<1&&(0,s.createElement)("div",{style:{marginBottom:"1.5rem"}},(0,s.createElement)(i.Notice,{isDismissible:!1,status:"error"},u("You must select at least one list.","newspack-newsletters"))),Object.keys(x).length>0&&(0,s.createElement)("p",null,u("Lists","newspack"),":"),Object.keys(x).map((e=>(0,s.createElement)(i.ToggleControl,{key:e,label:x[e].title,checked:v.includes(e),disabled:S,onChange:()=>{v.includes(e)?t({lists:v.filter((t=>t!==e))}):t({lists:v.concat(e)})}}))),(0,s.createElement)("p",null,(0,s.createElement)("a",{href:newspack_blocks.newsletters_url},u("Manage your subscription lists","newspack-newsletters")))))),(0,s.createElement)("div",_,(0,s.createElement)("div",{className:"newspack-registration__state-bar"},(0,s.createElement)("span",null,u("Edited State","newspack")),(0,s.createElement)("div",null,d.map((e=>(0,s.createElement)(i.Button,{key:e.value,"data-is-active":f===e.value,onClick:()=>y(e.value)},e.label))))),"initial"===f&&(0,s.createElement)("div",{className:`newspack-registration ${E}`},(0,s.createElement)("form",{onSubmit:e=>e.preventDefault()},(0,s.createElement)("div",{className:"newspack-registration__form-content"},o&&v.length?(0,s.createElement)("div",{className:"newspack-reader__lists"},(null==v?void 0:v.length)>1&&(0,s.createElement)(r.RichText,{onChange:e=>t({newsletterTitle:e}),placeholder:u("Newsletters title…","newspack"),value:g,tagName:"h3"}),(0,s.createElement)("ul",null,v.map((e=>{var a,n;return(0,s.createElement)("li",{key:e},(0,s.createElement)("span",{className:"newspack-reader__lists__checkbox"},(0,s.createElement)("input",{type:"checkbox",checked:!0,readOnly:!0})),(0,s.createElement)("span",{className:"newspack-reader__lists__details"},(0,s.createElement)("span",{className:"newspack-reader__lists__label"},(0,s.createElement)("span",{className:"newspack-reader__lists__title"},1===v.length?(0,s.createElement)(r.RichText,{onChange:e=>t({newsletterLabel:e}),placeholder:u("Subscribe to our newsletter","newspack"),value:w,tagName:"span"}):null===(a=x[e])||void 0===a?void 0:a.title),m&&(0,s.createElement)("span",{className:"newspack-reader__lists__description"},null===(n=x[e])||void 0===n?void 0:n.description))))})))):null,(0,s.createElement)("div",{className:"newspack-registration__main"},(0,s.createElement)("div",null,(0,s.createElement)("div",{className:"newspack-registration__inputs"},(0,s.createElement)("input",{type:"email",placeholder:a}),(0,s.createElement)("button",{type:"submit"},(0,s.createElement)(r.RichText,{onChange:e=>t({label:e}),placeholder:u("Sign up","newspack"),value:n,tagName:"span"}))),newspack_blocks.has_google_oauth&&(0,s.createElement)("div",{className:"newspack-reader__logins"},(0,s.createElement)("div",{className:"newspack-reader__logins__separator"},(0,s.createElement)("div",null),(0,s.createElement)("div",null,u("OR","newspack")),(0,s.createElement)("div",null)),(0,s.createElement)("button",{className:"newspack-reader__logins__google"},(0,s.createElement)("span",{dangerouslySetInnerHTML:{__html:newspack_blocks.google_logo_svg}}),(0,s.createElement)("span",null,u("Sign in with Google","newspack")))),(0,s.createElement)("div",{className:"newspack-registration__response"})),(0,s.createElement)("div",{className:"newspack-registration__help-text"},(0,s.createElement)(r.RichText,{onChange:e=>t({privacyLabel:e}),placeholder:u("Terms & Conditions statement…","newspack"),value:l,tagName:"p"}),(0,s.createElement)("p",null,(0,s.createElement)(r.RichText,{onChange:e=>t({haveAccountLabel:e}),placeholder:u("Already have an account?","newspack"),value:h,tagName:"span"})," ",(0,s.createElement)("a",{href:"/my-account",onClick:e=>e.preventDefault()},(0,s.createElement)(r.RichText,{onChange:e=>t({signInLabel:e}),placeholder:u("Sign In","newspack"),value:b,tagName:"span"})))))))),"registration"===f&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"newspack-registration__icon"}),(0,s.createElement)("div",N)),"login"===f&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"newspack-registration__icon"}),(0,s.createElement)(r.RichText,{align:"center",onChange:e=>t({signedInLabel:e}),placeholder:u("Logged in message…","newspack"),value:k,tagName:"p"}))))},save:()=>(0,s.createElement)("div",r.useInnerBlocksProps.save(r.useBlockProps.save()))},b=[n],k=["newspack/reader-registration"],v=e=>{if(!e)return;const{metadata:t,settings:a,name:n}=e;k.includes(n)&&!newspack_blocks.has_reader_activation||(0,l.registerBlockType)({name:n,...t},a)};for(const e of b)v(e)},2819:e=>{e.exports=window.lodash},6989:e=>{e.exports=window.wp.apiFetch},5609:e=>{e.exports=window.wp.components},9307:e=>{e.exports=window.wp.element},5736:e=>{e.exports=window.wp.i18n}},a={};function n(e){var l=a[e];if(void 0!==l)return l.exports;var s=a[e]={exports:{}};return t[e].call(s.exports,s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,a,l,s)=>{if(!a){var r=1/0;for(p=0;p<e.length;p++){for(var[a,l,s]=e[p],i=!0,c=0;c<a.length;c++)(!1&s||r>=s)&&Object.keys(n.O).every((e=>n.O[e](a[c])))?a.splice(c--,1):(i=!1,s<r&&(r=s));if(i){e.splice(p--,1);var o=l();void 0!==o&&(t=o)}}return t}s=s||0;for(var p=e.length;p>0&&e[p-1][2]>s;p--)e[p]=e[p-1];e[p]=[a,l,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.j=346,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");a.length&&(e=a[a.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={346:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var l,s,[r,i,c]=a,o=0;if(r.some((t=>0!==e[t]))){for(l in i)n.o(i,l)&&(n.m[l]=i[l]);if(c)var p=c(n)}for(t&&t(a);o<r.length;o++)s=r[o],n.o(e,s)&&e[s]&&e[s][0](),e[r[o]]=0;return n.O(p)},a=globalThis.webpackChunkwebpack=globalThis.webpackChunkwebpack||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var l=n.O(void 0,[351],(()=>n(930)));l=n.O(l);var s=window;for(var r in l)s[r]=l[r];l.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();