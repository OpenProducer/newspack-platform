(()=>{var e,t={3018:(e,t,s)=>{"use strict";var n={};s.r(n),s.d(n,{icon:()=>m,metadata:()=>w,name:()=>k,settings:()=>b});const i=window.wp.blocks,a=window.wp.blockEditor;var r=s(6427),l=s(5287),c=s.n(l),o=s(1455),p=s.n(o),d=s(7723),u=s(6087),h=s(790);const g=e=>"newspack-reader-registration-list-checkbox-"+e,_=[{label:(0,d.__)("Initial","newspack-plugin"),value:"initial"},{label:(0,d.__)("Registration Success","newspack-plugin"),value:"registration"},{label:(0,d.__)("Login Success","newspack-plugin"),value:"login"}],w=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"newspack/reader-registration","title":"Reader Registration","category":"newspack","description":"Register a reader with their email.","textdomain":"newspack-plugin","attributes":{"title":{"type":"string"},"description":{"type":"string"},"placeholder":{"type":"string","default":"Email Address"},"label":{"type":"string","default":"Sign up","required":true},"privacyLabel":{"type":"string","default":""},"newsletterSubscription":{"type":"boolean","default":true},"displayListDescription":{"type":"boolean","default":true},"hideSubscriptionInput":{"type":"boolean","default":false},"newsletterLabel":{"type":"string","default":"Subscribe to our newsletter"},"lists":{"type":"array","default":[],"items":{"type":"string"}},"listsCheckboxes":{"type":"object","default":{}},"signInLabel":{"type":"string","default":"Sign in to an existing account"},"signedInLabel":{"type":"string","default":"An account was already registered with this email. Please check your inbox for an authentication link."}},"supports":{"html":false,"align":true,"multiple":false}}'),m=(0,h.jsxs)(r.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,h.jsx)(r.Path,{d:"M18.5 8V5.5H16V4h2.5V1.5H20V4h2.5v1.5H20V8h-1.5ZM16.75 17v-2A2.75 2.75 0 0 0 14 12.25h-4A2.75 2.75 0 0 0 7.25 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5Z"}),(0,h.jsx)(r.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Zm-1.5 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"})]}),{name:k}=w,b={icon:{src:m,foreground:"#36f"},edit:function({setAttributes:e,attributes:{title:t,description:s,placeholder:n,label:i,privacyLabel:l,newsletterSubscription:o,displayListDescription:w,hideSubscriptionInput:m,newsletterLabel:k,signInLabel:b,signedInLabel:x,lists:v,listsCheckboxes:f}}){const j=(0,a.useBlockProps)(),[y,C]=(0,u.useState)(_[0].value);let{reader_activation_terms:S,reader_activation_url:N}=window.newspack_blocks;N&&(S=`<a href="${N}">`+S+"</a>");const L=(0,a.useInnerBlocksProps)({},{renderAppender:a.InnerBlocks.ButtonBlockAppender,template:[["core/paragraph",{align:"center",content:(0,d.__)("Success! Your account was created and you’re signed in.","newspack-plugin")}]]}),[T,O]=(0,u.useState)(!1),[P,B]=(0,u.useState)({}),R=()=>{newspack_blocks.has_newsletters&&o&&(O(!0),p()({path:"/newspack-newsletters/v1/lists_config"}).then(B).finally((()=>O(!1))))};(0,u.useEffect)(R,[]),(0,u.useEffect)(R,[o]),(0,u.useEffect)((()=>{const t=Object.keys(P);!t.length||v.length&&c()(v,t).length||e({lists:[Object.keys(P)[0]]})}),[P]);const A=e=>f.hasOwnProperty(e)&&f[e],F=t=>()=>{const s={...f};s[t]=!A(t),e({listsCheckboxes:s})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(a.InspectorControls,{children:[(0,h.jsx)(r.PanelBody,{title:(0,d.__)("Form settings","newspack-plugin"),children:(0,h.jsx)(r.TextControl,{label:(0,d.__)("Input placeholder","newspack-plugin"),value:n,disabled:T,onChange:t=>e({placeholder:t})})}),newspack_blocks.has_newsletters&&(0,h.jsxs)(r.PanelBody,{title:(0,d.__)("Newsletter Subscription","newspack-plugin"),children:[(0,h.jsx)(r.ToggleControl,{label:(0,d.__)("Enable newsletter subscription","newspack-plugin"),checked:!!o,disabled:T,onChange:()=>e({newsletterSubscription:!o})}),o&&(0,h.jsxs)(h.Fragment,{children:[T&&(0,h.jsx)(r.Spinner,{}),!T&&!Object.keys(P).length&&(0,h.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,d.__)("To enable newsletter subscription, you must configure subscription lists on Newspack Newsletters.","newspack-plugin")}),Object.keys(P).length>0&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.ToggleControl,{label:(0,d.__)("Display list description","newspack-plugin"),checked:w,disabled:T,onChange:()=>e({displayListDescription:!w})}),(0,h.jsx)(r.ToggleControl,{label:(0,d.__)("Hide newsletter selection and always subscribe","newspack-plugin"),checked:m,disabled:T||1!==v.length,onChange:()=>e({hideSubscriptionInput:!m})}),v.length<1&&(0,h.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,h.jsx)(r.Notice,{isDismissible:!1,status:"error",children:(0,d.__)("You must select at least one list.","newspack-plugin")})}),Object.keys(P).length>0&&(0,h.jsxs)("p",{children:[(0,d.__)("Lists","newspack-plugin"),":"]}),Object.keys(P).map((t=>(0,h.jsx)(r.ToggleControl,{label:P[t].title,checked:v.includes(t),disabled:T,onChange:()=>{v.includes(t)?e({lists:v.filter((e=>e!==t))}):e({lists:v.concat(t)})}},t)))]}),(0,h.jsxs)("p",{children:[(0,h.jsx)("a",{href:newspack_blocks.newsletters_url,children:(0,d.__)("Configure your subscription lists","newspack-plugin")}),"."]})]})]}),(0,h.jsxs)(r.PanelBody,{title:(0,d.__)("Spam protection","newspack-plugin"),children:[(0,h.jsx)("p",{children:(0,d.sprintf)(
// translators: %s is either 'enabled' or 'disabled'.
// translators: %s is either 'enabled' or 'disabled'.
(0,d.__)("reCAPTCHA is currently %s.","newspack-plugin"),newspack_blocks.has_recaptcha?(0,d.__)("enabled","newspack-plugin"):(0,d.__)("disabled","newspack-plugin"))}),!newspack_blocks.has_recaptcha&&(0,h.jsx)("p",{children:(0,d.__)("It's highly recommended that you enable reCAPTCHA protection to prevent spambots from using this form!","newspack-plugin")}),(0,h.jsx)("p",{children:(0,h.jsx)("a",{href:newspack_blocks.recaptcha_url,children:(0,d.__)("Configure your reCAPTCHA settings.","newspack-plugin")})})]})]}),(0,h.jsxs)("div",{...j,children:[(0,h.jsxs)("div",{className:"newspack-registration__state-bar",children:[(0,h.jsx)("span",{children:(0,d.__)("Edited State","newspack-plugin")}),(0,h.jsx)("div",{children:_.map((e=>(0,h.jsx)(r.Button,{"data-is-active":y===e.value,onClick:()=>C(e.value),children:e.label},e.value)))})]}),"initial"===y&&(0,h.jsx)("div",{className:"newspack-registration newspack-ui",children:(0,h.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,h.jsx)("div",{className:"newspack-registration__header",children:(0,h.jsx)(a.RichText,{onChange:t=>e({title:t}),placeholder:(0,d.__)("Add title","newspack-plugin"),value:t,allowedFormats:[],tagName:"h3",className:"newspack-registration__title"})}),(0,h.jsx)(a.RichText,{onChange:t=>e({description:t}),placeholder:(0,d.__)("Add description","newspack-plugin"),value:s,tagName:"p",className:"newspack-registration__description"}),(0,h.jsxs)("div",{className:"newspack-registration__form-content",children:[1===v.length&&m||!o||!v.length?null:(0,h.jsx)(h.Fragment,{children:v.map((t=>(0,h.jsxs)("label",{htmlFor:g(t),className:"newspack-ui__input-card",children:[(0,h.jsx)("input",{id:g(t),type:"checkbox",checked:A(t),onChange:F(t)}),(0,h.jsx)("strong",{children:1===v.length?(0,h.jsx)(a.RichText,{onChange:t=>e({newsletterLabel:t}),placeholder:(0,d.__)("Subscribe to our newsletter","newspack-plugin"),value:k,allowedFormats:[],tagName:"span"}):P[t]?.title}),w&&(0,h.jsx)("span",{className:"newspack-ui__helper-text",children:P[t]?.description})]},t)))}),(0,h.jsxs)("div",{className:"newspack-registration__main",children:[newspack_blocks.has_google_oauth&&(0,h.jsxs)("div",{className:"newspack-ui",children:[(0,h.jsxs)("button",{className:"newspack-ui__button newspack-ui__button--wide newspack-ui__button--secondary newspack-ui__button--google-oauth",children:[(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:newspack_blocks.google_logo_svg}}),(0,d.__)("Sign in with Google","newspack-plugin")]}),(0,h.jsx)("div",{className:"newspack-ui__word-divider",children:(0,d.__)("Or","newspack-plugin")})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"newspack-registration__inputs",children:[(0,h.jsx)("input",{type:"email",placeholder:n}),(0,h.jsx)("button",{type:"submit",className:"newspack-ui__button newspack-ui__button--primary",children:(0,h.jsx)(a.RichText,{onChange:t=>e({label:t}),placeholder:(0,d.__)("Sign up","newspack-plugin"),value:i,allowedFormats:[],tagName:"span"})})]}),(0,h.jsx)("div",{className:"newspack-registration__response"})]})]})]}),(0,h.jsx)("div",{className:"newspack-registration__have-account",children:(0,h.jsx)("a",{href:"/my-account",onClick:e=>e.preventDefault(),className:"newspack-ui__button newspack-ui__button--ghost",children:(0,h.jsx)(a.RichText,{onChange:t=>e({signInLabel:t}),placeholder:(0,d.__)("Sign in to an existing account","newspack-plugin"),value:b,allowedFormats:[],tagName:"span"})})}),(0,h.jsx)("div",{className:"newspack-registration__help-text",children:(0,h.jsx)(a.RichText,{onChange:t=>e({privacyLabel:t}),placeholder:(0,d.__)("Terms & Conditions statement…","newspack-plugin"),value:l||S,allowedFormats:["core/bold","core/italic","core/link"],tagName:"p"})})]})}),"registration"===y&&(0,h.jsx)("div",{className:"newspack-registration newspack-ui",children:(0,h.jsxs)("div",{className:"newspack-ui__box newspack-ui__box--success newspack-ui__box--text-center",children:[(0,h.jsx)("span",{className:"newspack-ui__icon newspack-ui__icon--success",children:(0,h.jsx)(r.SVG,{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)(r.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})})}),(0,h.jsx)("div",{...L})]})}),"login"===y&&(0,h.jsx)("div",{className:"newspack-registration newspack-ui",children:(0,h.jsxs)("div",{className:"newspack-ui__box newspack-ui__box--success newspack-ui__box--text-center",children:[(0,h.jsx)("span",{className:"newspack-ui__icon newspack-ui__icon--success",children:(0,h.jsx)(r.SVG,{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)(r.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M19.5854 12.6708C19.8395 12.5438 20 12.2841 20 12C20 11.7159 19.8395 11.4562 19.5854 11.3292L5.08543 4.0792C4.79841 3.93569 4.45187 3.99069 4.22339 4.21602C3.9949 4.44135 3.93509 4.78709 4.07461 5.07608L7.4172 12L4.07461 18.924C3.93509 19.213 3.9949 19.5587 4.22339 19.784C4.45187 20.0094 4.79841 20.0644 5.08543 19.9208L19.5854 12.6708ZM8.72077 11.25L6.38144 6.40425L17.573 12L6.38144 17.5958L8.72079 12.75H12V11.25H8.72077Z"})})}),(0,h.jsx)(a.RichText,{align:"center",onChange:t=>e({signedInLabel:t}),placeholder:(0,d.__)("Logged in message…","newspack-plugin"),value:x,allowedFormats:[],tagName:"p"})]})})]})]})},save:()=>(0,h.jsx)("div",{...a.useInnerBlocksProps.save(a.useBlockProps.save())})};var x=s(2619),v=s(7143);const f=window.wp.compose,j=window.location.href;(0,x.addFilter)("blocks.registerBlockType","newspack-plugin/register-hook/core-image",((e,t)=>"core/image"!==t?e:{...e,attributes:{...e.attributes,meta:{type:"object",default:{}}}}));const y=({setAttributes:e,attributes:t})=>{var s;const n=t.id,{meta:i}=null!==(s=(0,v.useSelect)((e=>e("core").getMedia(n)),[n]))&&void 0!==s?s:{meta:{}};return(0,u.useEffect)((()=>{if(Object.keys(i).length){const{_media_credit:s,_media_credit_url:n,_navis_media_credit_org:a}=i;s===t?.meta?._media_credit&&n===t?.meta?._media_credit_url&&a===t?.meta?._navis_media_credit_org||e({meta:{_media_credit:s,_media_credit_url:n,_navis_media_credit_org:a}})}}),[i,t?.meta?._media_credit,t?.meta?._media_credit_url,t?.meta?._navis_media_credit_org]),(0,h.jsx)(h.Fragment,{})},C=(e,t=j)=>new URL(e).hostname===new URL(t).hostname;(0,x.addFilter)("editor.BlockEdit","newspack-plugin/block-edit-hook/core-image",(0,f.createHigherOrderComponent)((e=>t=>"core/image"===t.name?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(e,{...t}),t.attributes.url&&C(t.attributes.url)&&(0,h.jsx)(y,{...t})]}):(0,h.jsx)(e,{...t})),"withCustomMetaData"));const S=[n],N=["newspack/reader-registration"],L=e=>{if(!e)return;const{metadata:t,settings:s,name:n}=e;N.includes(n)&&!newspack_blocks.has_reader_activation||(0,i.registerBlockType)({name:n,...t},s)};for(const e of S)L(e)},7706:(e,t,s)=>{var n=s(6131);e.exports=function(e,t){return!(null==e||!e.length)&&n(e,t,0)>-1}},9905:e=>{e.exports=function(e,t,s){for(var n=-1,i=null==e?0:e.length;++n<i;)if(s(t,e[n]))return!0;return!1}},6131:(e,t,s)=>{var n=s(2523),i=s(5463),a=s(6959);e.exports=function(e,t,s){return t==t?a(e,t,s):n(e,i,s)}},7185:(e,t,s)=>{var n=s(8859),i=s(7706),a=s(9905),r=s(4932),l=s(7301),c=s(9219),o=Math.min;e.exports=function(e,t,s){for(var p=s?a:i,d=e[0].length,u=e.length,h=u,g=Array(u),_=1/0,w=[];h--;){var m=e[h];h&&t&&(m=r(m,l(t))),_=o(m.length,_),g[h]=!s&&(t||d>=120&&m.length>=120)?new n(h&&m):void 0}m=e[0];var k=-1,b=g[0];e:for(;++k<d&&w.length<_;){var x=m[k],v=t?t(x):x;if(x=s||0!==x?x:0,!(b?c(b,v):p(w,v,s))){for(h=u;--h;){var f=g[h];if(!(f?c(f,v):p(e[h],v,s)))continue e}b&&b.push(v),w.push(x)}}return w}},5463:e=>{e.exports=function(e){return e!=e}},741:(e,t,s)=>{var n=s(3693);e.exports=function(e){return n(e)?e:[]}},6959:e=>{e.exports=function(e,t,s){for(var n=s-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}},5287:(e,t,s)=>{var n=s(4932),i=s(7185),a=s(9302),r=s(741),l=a((function(e){var t=n(e,r);return t.length&&t[0]===e[0]?i(t):[]}));e.exports=l},790:e=>{"use strict";e.exports=window.ReactJSXRuntime},1455:e=>{"use strict";e.exports=window.wp.apiFetch},6427:e=>{"use strict";e.exports=window.wp.components},7143:e=>{"use strict";e.exports=window.wp.data},6087:e=>{"use strict";e.exports=window.wp.element},2619:e=>{"use strict";e.exports=window.wp.hooks},7723:e=>{"use strict";e.exports=window.wp.i18n}},s={};function n(e){var i=s[e];if(void 0!==i)return i.exports;var a=s[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,e=[],n.O=(t,s,i,a)=>{if(!s){var r=1/0;for(p=0;p<e.length;p++){for(var[s,i,a]=e[p],l=!0,c=0;c<s.length;c++)(!1&a||r>=a)&&Object.keys(n.O).every((e=>n.O[e](s[c])))?s.splice(c--,1):(l=!1,a<r&&(r=a));if(l){e.splice(p--,1);var o=i();void 0!==o&&(t=o)}}return t}a=a||0;for(var p=e.length;p>0&&e[p-1][2]>a;p--)e[p]=e[p-1];e[p]=[s,i,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.j=617,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var i=s.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=s[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={617:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var i,a,[r,l,c]=s,o=0;if(r.some((t=>0!==e[t]))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(c)var p=c(n)}for(t&&t(s);o<r.length;o++)a=r[o],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(p)},s=globalThis.webpackChunknewspack=globalThis.webpackChunknewspack||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=n.O(void 0,[223],(()=>n(3018)));i=n.O(i)})();