!function(){"use strict";var e,t={9644:function(e,t,n){n.r(t);var r=n(7462),a=n(4942),o=(n(5674),n(9307)),s=n(5736),i=n(4009),c=n(8614),l=n(2819),u=n(6989),p=n.n(u),d=n(5609),m=n(932);const w=s.__,h=e=>{let{className:t,onUpdate:n,isOnboarding:a=!0}=e;const[s,c]=(0,o.useState)(),[u,m]=i.PT.useObjectState({}),h=e=>{m(e),n&&n((0,l.mapValues)(e.settings,(0,l.property)("value")))},g=()=>{p()({path:"/newspack/v1/wizard/newspack-engagement-wizard/newsletters"}).then(h).catch(c)};(0,o.useEffect)(g,[]);const f=e=>{var t,n,r,a,o,s;return{value:(null===(t=u.settings[e])||void 0===t?void 0:t.value)||"",checked:Boolean(null===(n=u.settings[e])||void 0===n?void 0:n.value),label:null===(r=u.settings[e])||void 0===r?void 0:r.description,placeholder:null===(a=u.settings[e])||void 0===a?void 0:a.placeholder,options:(null===(o=u.settings[e])||void 0===o||null===(s=o.options)||void 0===s?void 0:s.map((e=>({value:e.value,label:e.name}))))||null,onChange:t=>h({settings:{[e]:{value:t}}})}};return!s&&(0,l.isEmpty)(u)?(0,o.createElement)("div",{className:"flex justify-around mt4"},(0,o.createElement)(i.Pi,null)):s?(0,o.createElement)(i.qX,{noticeText:s.message||w("Something went wrong.","newspack"),isError:!0}):(0,o.createElement)("div",{className:t},!1===u.configured&&(0,o.createElement)(i.xf,{plugins:["newspack-newsletters"],withoutFooterButton:!0,onStatus:e=>{let{complete:t}=e;return t&&g()}}),!0===u.configured&&(()=>{const e=f("newspack_newsletters_service_provider");return(0,o.createElement)(i.rj,{gutter:32,columns:1},(0,l.values)(u.settings).filter((t=>!t.provider||t.provider===e.value)).map((e=>{if(a&&!e.onboarding)return null;switch(e.type){case"select":return(0,o.createElement)(i.Yw,(0,r.Z)({key:e.key},f(e.key)));case"checkbox":return(0,o.createElement)(i.Z8,(0,r.Z)({key:e.key},f(e.key)));default:return(0,o.createElement)(i.rj,{columns:1,gutter:"0",key:e.key},(0,o.createElement)(i.w4,f(e.key)),e.help&&e.helpURL&&(0,o.createElement)("p",null,(0,o.createElement)(d.ExternalLink,{href:e.helpURL},e.help)))}})))})())},g=()=>{const[{status:e,url:t,error:n,newslettersConfig:r},a]=i.PT.useObjectState({});(0,o.useEffect)((()=>{(0,m.B)().then(a)}),[]);const s="active"===e;return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(i.M$,{title:w("Signup forms","newspack"),description:()=>(0,o.createElement)(o.Fragment,null,w("Connects your site to Mailchimp and sets up a Mailchimp block you can use to get new subscribers for your newsletter","newspack"),(0,o.createElement)("br",null),w("The Mailchimp connection to your site for this feature is managed through Jetpack and WordPress.com","newspack"),(0,o.createElement)("br",null),t?(0,o.createElement)(d.ExternalLink,{href:t},w(s?"Manage your Mailchimp connection":"Set up Mailchimp")):null)}),s&&(0,o.createElement)(i.qX,{noticeText:w("You can insert newsletter sign up forms in your content using the Mailchimp block."),isSuccess:!0}),"unavailable_site_id"===(null==n?void 0:n.code)&&(0,o.createElement)(i.qX,{noticeText:w("Connect Jetpack in order to configure Mailchimp."),isWarning:!0}),(0,o.createElement)(i.M$,{title:w("Authoring","newspack")}),(0,o.createElement)(h,{isOnboarding:!1,onUpdate:e=>a({newslettersConfig:e})}),(0,o.createElement)("div",{className:"newspack-buttons-card"},(0,o.createElement)(i.zx,{isPrimary:!0,onClick:async()=>p()({path:"/newspack/v1/wizard/newspack-engagement-wizard/newsletters",method:"POST",data:r})},w("Save","newspack"))))};var f=(0,i.a4)((()=>(0,o.createElement)(o.Fragment,null,(0,o.createElement)(g,null),(0,o.createElement)(i.M$,{title:w("WooCommerce integration","newspack")})," ",(0,o.createElement)(i.xf,{plugins:["mailchimp-for-woocommerce"],withoutFooterButton:!0}))));const v=s.__;class E extends o.Component{render(){return(0,o.createElement)(i.fM,{title:v("Publicize"),badge:"Jetpack",description:v("Publicize makes it easy to share your siteâ€™s posts on several social media networks automatically when you publish a new post."),actionText:v("Configure"),handoff:"jetpack",editLink:"admin.php?page=jetpack#/sharing"})}}var b=(0,i.a4)(E);const k=s.__;class y extends o.Component{render(){const{onChange:e,relatedPostsEnabled:t,relatedPostsError:n,relatedPostsMaxAge:r}=this.props;return(0,o.createElement)(o.Fragment,null,n&&(0,o.createElement)(i.qX,{noticeText:n,isError:!0}),(0,o.createElement)(i.fM,{title:k("Related Posts","newspack"),badge:"Jetpack",description:k("Automatically add related content at the bottom of each post.","newspack"),actionText:k("Configure"),handoff:"jetpack",editLink:"admin.php?page=jetpack#/traffic"}),t&&(0,o.createElement)(i.rj,null,(0,o.createElement)(i.Zb,{noBorder:!0},(0,o.createElement)(i.w4,{help:k("If set, posts will be shown as related content only if published within the past number of months. If 0, any published post can be shown, regardless of publish date.","newspack"),label:k("Maximum age of related content, in months","newspack"),onChange:t=>e(t),placeholder:k("Maximum age of related content, in months"),type:"number",value:r||0,isWide:!0}))))}}var x=(0,i.a4)(y);const P=s.__;var S=(0,i.a4)((()=>(0,o.createElement)(o.Fragment,null,(0,o.createElement)(i.fM,{title:P("WordPress Commenting"),description:P("Native WordPress commenting system."),actionText:P("Configure"),handoff:"wordpress-settings-discussion"}))));const M=s.__,{HashRouter:T,Redirect:C,Route:_,Switch:j}=c.Z;class O extends o.Component{constructor(e){super(e),(0,a.Z)(this,"onWizardReady",(()=>{const{setError:e,wizardApiFetch:t}=this.props;return t({path:"/newspack/v1/wizard/newspack-engagement-wizard/related-content"}).then((e=>this.setState(e))).catch((t=>e(t)))})),(0,a.Z)(this,"updatedRelatedContentSettings",(async()=>{const{wizardApiFetch:e}=this.props,{relatedPostsMaxAge:t}=this.state;try{await e({path:"/newspack/v1/wizard/newspack-engagement-wizard/related-posts-max-age",method:"POST",data:{relatedPostsMaxAge:t}}),this.setState({relatedPostsError:null,relatedPostsUpdated:!1})}catch(e){this.setState({relatedPostsError:e.message||M("There was an error saving settings. Please try again.","newspack")})}})),this.state={relatedPostsEnabled:!1,relatedPostsMaxAge:0,relatedPostsUpdated:!1,relatedPostsError:null}}render(){const{pluginRequirements:e}=this.props,{relatedPostsEnabled:t,relatedPostsError:n,relatedPostsMaxAge:a,relatedPostsUpdated:s}=this.state,i=[{label:M("Newsletters","newspack"),path:"/newsletters",exact:!0},{label:M("Commenting","newspack"),path:"/commenting"},{label:M("Social","newspack"),path:"/social",exact:!0},{label:M("Recirculation","newspack"),path:"/recirculation"}],c={headerText:M("Engagement","newspack"),tabbedNavigation:i};return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(T,{hashType:"slash"},(0,o.createElement)(j,null,e,(0,o.createElement)(_,{path:"/newsletters",render:()=>(0,o.createElement)(f,(0,r.Z)({subHeaderText:M("Configure your newsletter settings","newspack")},c))}),(0,o.createElement)(_,{path:"/social",exact:!0,render:()=>(0,o.createElement)(b,(0,r.Z)({subHeaderText:M("Share your content to social media","newspack")},c))}),(0,o.createElement)(_,{path:"/commenting",exact:!0,render:()=>(0,o.createElement)(S,(0,r.Z)({subHeaderText:M("Set up the commenting system for your site","newspack")},c))}),(0,o.createElement)(_,{path:"/recirculation",exact:!0,render:()=>(0,o.createElement)(x,(0,r.Z)({},c,{subHeaderText:M("Engage visitors with related content","newspack"),relatedPostsEnabled:t,relatedPostsError:n,buttonAction:()=>this.updatedRelatedContentSettings(),buttonText:M("Save","newspack"),buttonDisabled:!t||!s,relatedPostsMaxAge:a,onChange:e=>{this.setState({relatedPostsMaxAge:e,relatedPostsUpdated:!0})}}))}),(0,o.createElement)(C,{to:"/newsletters"}))))}}(0,o.render)((0,o.createElement)((0,i.uF)(O,["jetpack"])),document.getElementById("newspack-engagement-wizard"))},9196:function(e){e.exports=window.React},2819:function(e){e.exports=window.lodash},6292:function(e){e.exports=window.moment},6989:function(e){e.exports=window.wp.apiFetch},5609:function(e){e.exports=window.wp.components},9818:function(e){e.exports=window.wp.data},9307:function(e){e.exports=window.wp.element},2694:function(e){e.exports=window.wp.hooks},2629:function(e){e.exports=window.wp.htmlEntities},5736:function(e){e.exports=window.wp.i18n},9630:function(e){e.exports=window.wp.keycodes},444:function(e){e.exports=window.wp.primitives},6483:function(e){e.exports=window.wp.url}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,e=[],r.O=function(t,n,a,o){if(!n){var s=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],o=e[u][2];for(var i=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(r.O).every((function(e){return r.O[e](n[c])}))?n.splice(c--,1):(i=!1,o<s&&(s=o));if(i){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,a,o]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=103,function(){var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),function(){var e={103:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,o,s=n[0],i=n[1],c=n[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(c)var u=c(r)}for(t&&t(n);l<s.length;l++)o=s[l],r.o(e,o)&&e[o]&&e[o][0](),e[s[l]]=0;return r.O(u)},n=self.webpackChunkwebpack=self.webpackChunkwebpack||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a=r.O(void 0,[351],(function(){return r(9644)}));a=r.O(a);var o=window;for(var s in a)o[s]=a[s];a.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})}();