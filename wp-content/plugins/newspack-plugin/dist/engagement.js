(()=>{"use strict";var e,t={2831:(e,t,a)=>{a.r(t);var n=a(7462),r=a(4942),s=(a(5674),a(9307)),l=a(5736),o=a(3520),i=a(9674),c=a(2819),p=a(6989),d=a.n(p),u=a(5609);const m=l.__,w=e=>{let{className:t,onUpdate:a,isOnboarding:r=!0}=e;const[l,i]=(0,s.useState)(),[p,w]=o.PT.useObjectState({}),h=e=>{w(e),a&&a((0,c.mapValues)(e.settings,(0,c.property)("value")))},g=()=>{d()({path:"/newspack/v1/wizard/newspack-engagement-wizard/newsletters"}).then(h).catch(i)};(0,s.useEffect)(g,[]);const v=e=>{var t,a,n,r,s,l;return{value:(null===(t=p.settings[e])||void 0===t?void 0:t.value)||"",checked:Boolean(null===(a=p.settings[e])||void 0===a?void 0:a.value),label:null===(n=p.settings[e])||void 0===n?void 0:n.description,placeholder:null===(r=p.settings[e])||void 0===r?void 0:r.placeholder,options:(null===(s=p.settings[e])||void 0===s||null===(l=s.options)||void 0===l?void 0:l.map((e=>({value:e.value,label:e.name}))))||null,onChange:t=>h({settings:{[e]:{value:t}}})}};return!l&&(0,c.isEmpty)(p)?(0,s.createElement)("div",{className:"flex justify-around mt4"},(0,s.createElement)(o.Pi,null)):l?(0,s.createElement)(o.qX,{noticeText:l.message||m("Something went wrong.","newspack"),isError:!0}):(0,s.createElement)("div",{className:t},!1===p.configured&&(0,s.createElement)(o.xf,{plugins:["newspack-newsletters"],withoutFooterButton:!0,onStatus:e=>{let{complete:t}=e;return t&&g()}}),!0===p.configured&&(()=>{const e=v("newspack_newsletters_service_provider");return(0,s.createElement)(o.rj,{gutter:16,columns:1},(0,c.values)(p.settings).filter((t=>!t.provider||t.provider===e.value)).map((e=>{if(r&&!e.onboarding)return null;switch(e.type){case"select":return(0,s.createElement)(o.Yw,(0,n.Z)({key:e.key},v(e.key)));case"checkbox":return(0,s.createElement)(u.CheckboxControl,(0,n.Z)({key:e.key},v(e.key)));default:return(0,s.createElement)(o.rj,{columns:1,gutter:8,key:e.key},(0,s.createElement)(o.w4,v(e.key)),e.help&&e.helpURL&&(0,s.createElement)("p",null,(0,s.createElement)(u.ExternalLink,{href:e.helpURL},e.help)))}})))})())},h=e=>{let{onUpdate:t}=e;const[a,n]=(0,s.useState)(!1),[r,l]=(0,s.useState)(!1),[i,c]=(0,s.useState)([]),p=e=>{c(e),"function"==typeof t&&t(e)},w=(e,t)=>a=>{const n=[...i];n[e][t]=a,p(n)};return(0,s.useEffect)((()=>{n(!1),l(!0),d()({path:"/newspack-newsletters/v1/lists"}).then(p).catch(n).finally((()=>l(!1)))}),[]),null!=i&&i.length||a?(0,s.createElement)(s.Fragment,null,(0,s.createElement)(o.M$,{title:m("Subscription Lists","newspack"),description:m("Manage the lists available for subscription.","newspack")}),a&&(0,s.createElement)(o.qX,{noticeText:(null==a?void 0:a.message)||m("Something went wrong.","newspack"),isError:!0}),i.map(((e,t)=>(0,s.createElement)(o.Zb,{key:e.id,isSmall:!0},(0,s.createElement)(u.ToggleControl,{label:e.name,checked:e.active,disabled:r,onChange:w(t,"active")}),e.active&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)(o.w4,{label:m("List title","newspack"),value:e.title,disabled:r,onChange:w(t,"title")}),(0,s.createElement)(u.TextareaControl,{label:m("List description","newspack"),value:e.description,disabled:r,onChange:w(t,"description")}))))),(0,s.createElement)("div",{className:"newspack-buttons-card"},(0,s.createElement)(o.zx,{isPrimary:!0,onClick:()=>{n(!1),l(!0),d()({path:"/newspack-newsletters/v1/lists",method:"post",data:{lists:i}}).then(p).catch(n).finally((()=>l(!1)))},disabled:r},m("Save Subscription Lists","newspack")))):null},g=()=>{const[{newslettersConfig:e},t]=o.PT.useObjectState({}),[a,n]=(0,s.useState)(""),[r,l]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{const t=null==e?void 0:e.newspack_newsletters_service_provider;l(!(!a||t===a)),!a&&t&&n(t)}),[null==e?void 0:e.newspack_newsletters_service_provider]),(0,s.createElement)(s.Fragment,null,(0,s.createElement)(o.Zb,{headerActions:!0,noBorder:!0},(0,s.createElement)("h2",null,m("Authoring","newspack")),(0,s.createElement)(o.zx,{variant:"primary",onClick:async()=>d()({path:"/newspack/v1/wizard/newspack-engagement-wizard/newsletters",method:"POST",data:e}).finally((()=>{n(null==e?void 0:e.newspack_newsletters_service_provider),l(!1)}))},m("Save Settings","newspack"))),(0,s.createElement)(w,{isOnboarding:!1,onUpdate:e=>t({newslettersConfig:e})}),r?(0,s.createElement)(o.qX,{noticeText:m("Please save your settings before changing your subscription lists.","newspack"),isWarning:!0}):(0,s.createElement)(h,null))},v=(0,o.a4)((()=>(0,s.createElement)(s.Fragment,null,(0,s.createElement)(g,null),(0,s.createElement)(o.M$,{title:m("WooCommerce integration","newspack")}),(0,s.createElement)(o.xf,{plugins:["mailchimp-for-woocommerce"],withoutFooterButton:!0})))),k=l.__;function b(e){let{value:t,onChange:a}=e;const[n,r]=(0,s.useState)(!1),[l,i]=(0,s.useState)([]),[c,p]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{p(!1),r(!0),d()({path:"/newspack-newsletters/v1/lists"}).then(i).catch(p).finally((()=>r(!1)))}),[]),(0,s.createElement)(s.Fragment,null,c&&(0,s.createElement)(o.qX,{noticeText:(null==c?void 0:c.message)||k("Something went wrong.","newspack"),isError:!0}),(0,s.createElement)(o.M$,{title:k("ActiveCampaign","newspack"),description:k("Settings for the ActiveCampaign integration.","newspack")}),(0,s.createElement)(o.Yw,{label:k("Master List","newspack"),help:k("Choose a list to which all registered readers will be added.","newspack"),disabled:n,value:t.masterList,onChange:("masterList",e=>a&&a("masterList",e)),options:[{value:"",label:k("None","newspack")},...l.map((e=>({label:e.name,value:e.id})))]}))}const E=l.__,f=(0,o.a4)((()=>{const[e,t]=(0,s.useState)(!1),[a,n]=(0,s.useState)({}),[r,l]=(0,s.useState)(!1),[i,c]=(0,s.useState)(!1),p=(e,t)=>{n({...a,[e]:t})};return(0,s.useEffect)((()=>{l(!1),t(!0),d()({path:"/newspack/v1/wizard/newspack-engagement-wizard/reader-activation"}).then(n).catch(l).finally((()=>t(!1)))}),[]),(0,s.useEffect)((()=>{d()({path:"/newspack/v1/wizard/newspack-engagement-wizard/newsletters"}).then((e=>{var t,a;c("active_campaign"===(null==e||null===(t=e.settings)||void 0===t||null===(a=t.newspack_newsletters_service_provider)||void 0===a?void 0:a.value))}))}),[]),(0,s.createElement)(s.Fragment,null,r&&(0,s.createElement)(o.qX,{noticeText:(null==r?void 0:r.message)||E("Something went wrong.","newspack"),isError:!0}),(0,s.createElement)(o.Zb,{noBorder:!0},(0,s.createElement)(o.M$,{title:E("Reader Activation","newspack"),description:E("Configure a set of features for reader activation.","newspack")}),(0,s.createElement)(u.CheckboxControl,{label:E("Enable Reader Activation","newspack"),help:E("Whether to enable reader activation features for your site.","newspack"),checked:!!a.enabled,onChange:e=>p("enabled",e)}),(0,s.createElement)("hr",null),(0,s.createElement)(u.CheckboxControl,{label:E("Enable Sign In/Account link","newspack"),help:E("Display an account link in the site header. It will allow readers to register and access their account.","newspack"),checked:!!a.enabled_account_link,onChange:e=>p("enabled_account_link",e)}),(0,s.createElement)(o.w4,{label:E("Newsletter subscription text on registration","newspack"),help:E("The text to display while subscribing to newsletters on the registration modal.","newspack"),value:a.newsletters_label,onChange:e=>p("newsletters_label",e)}),(0,s.createElement)(o.rj,{columns:2,gutter:16},(0,s.createElement)(o.w4,{label:E("Terms & Conditions Text","newspack"),help:E("Terms and conditions text to display on registration.","newspack"),value:a.terms_text,onChange:e=>p("terms_text",e)}),(0,s.createElement)(o.w4,{label:E("Terms & Conditions URL","newspack"),help:E("URL to the page containing the terms and conditions.","newspack"),value:a.terms_url,onChange:e=>p("terms_url",e)}))),i&&(0,s.createElement)(b,{value:{masterList:a.active_campaign_master_list},onChange:(e,t)=>{"masterList"===e&&p("active_campaign_master_list",t)}}),(0,s.createElement)("div",{className:"newspack-buttons-card"},(0,s.createElement)(o.zx,{isPrimary:!0,onClick:()=>{l(!1),t(!0),d()({path:"/newspack/v1/wizard/newspack-engagement-wizard/reader-activation",method:"post",data:a}).then(n).catch(l).finally((()=>t(!1)))},disabled:e},E("Save Changes","newspack"))))})),x=l.__;class y extends s.Component{render(){return(0,s.createElement)(o.fM,{title:x("Publicize"),badge:"Jetpack",description:x("Publicize makes it easy to share your siteâ€™s posts on several social media networks automatically when you publish a new post."),actionText:x("Configure"),handoff:"jetpack",editLink:"admin.php?page=jetpack#/sharing"})}}const _=(0,o.a4)(y),S=l.__;class C extends s.Component{render(){const{onChange:e,relatedPostsEnabled:t,relatedPostsError:a,relatedPostsMaxAge:n}=this.props;return(0,s.createElement)(s.Fragment,null,a&&(0,s.createElement)(o.qX,{noticeText:a,isError:!0}),(0,s.createElement)(o.fM,{title:S("Related Posts","newspack"),badge:"Jetpack",description:S("Automatically add related content at the bottom of each post.","newspack"),actionText:S("Configure"),handoff:"jetpack",editLink:"admin.php?page=jetpack#/traffic"}),t&&(0,s.createElement)(o.rj,null,(0,s.createElement)(o.Zb,{noBorder:!0},(0,s.createElement)(o.w4,{help:S("If set, posts will be shown as related content only if published within the past number of months. If 0, any published post can be shown, regardless of publish date.","newspack"),label:S("Maximum age of related content, in months","newspack"),onChange:t=>e(t),placeholder:S("Maximum age of related content, in months"),type:"number",value:n||0}))))}}const P=(0,o.a4)(C),T=l.__,z=(0,o.a4)((()=>(0,s.createElement)(s.Fragment,null,(0,s.createElement)(o.fM,{title:T("WordPress Commenting"),description:T("Native WordPress commenting system."),actionText:T("Configure"),handoff:"wordpress-settings-discussion"})))),M=l.__,{HashRouter:j,Redirect:A,Route:O,Switch:L}=i.Z;class R extends s.Component{constructor(e){super(e),(0,r.Z)(this,"onWizardReady",(()=>{const{setError:e,wizardApiFetch:t}=this.props;return t({path:"/newspack/v1/wizard/newspack-engagement-wizard/related-content"}).then((e=>this.setState(e))).catch((t=>e(t)))})),(0,r.Z)(this,"updatedRelatedContentSettings",(async()=>{const{wizardApiFetch:e}=this.props,{relatedPostsMaxAge:t}=this.state;try{await e({path:"/newspack/v1/wizard/newspack-engagement-wizard/related-posts-max-age",method:"POST",data:{relatedPostsMaxAge:t}}),this.setState({relatedPostsError:null,relatedPostsUpdated:!1})}catch(e){this.setState({relatedPostsError:e.message||M("There was an error saving settings. Please try again.","newspack")})}})),this.state={relatedPostsEnabled:!1,relatedPostsMaxAge:0,relatedPostsUpdated:!1,relatedPostsError:null}}render(){const{pluginRequirements:e}=this.props,{relatedPostsEnabled:t,relatedPostsError:a,relatedPostsMaxAge:r,relatedPostsUpdated:l}=this.state,o=newspack_engagement_wizard.has_reader_activation?"/reader-activation":"/newsletters",i=[{label:M("Newsletters","newspack"),path:"/newsletters",exact:!0},{label:M("Commenting","newspack"),path:"/commenting"},{label:M("Social","newspack"),path:"/social",exact:!0},{label:M("Recirculation","newspack"),path:"/recirculation"}];newspack_engagement_wizard.has_reader_activation&&i.unshift({label:M("Reader Activation","newspack"),path:"/reader-activation",exact:!0});const c={headerText:M("Engagement","newspack"),tabbedNavigation:i};return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(j,{hashType:"slash"},(0,s.createElement)(L,null,e,newspack_engagement_wizard.has_reader_activation&&(0,s.createElement)(O,{path:"/reader-activation",render:()=>(0,s.createElement)(f,(0,n.Z)({subHeaderText:M("Configure your reader activation settings","newspack")},c))}),(0,s.createElement)(O,{path:"/newsletters",render:()=>(0,s.createElement)(v,(0,n.Z)({subHeaderText:M("Configure your newsletter settings","newspack")},c))}),(0,s.createElement)(O,{path:"/social",exact:!0,render:()=>(0,s.createElement)(_,(0,n.Z)({subHeaderText:M("Share your content to social media","newspack")},c))}),(0,s.createElement)(O,{path:"/commenting",exact:!0,render:()=>(0,s.createElement)(z,(0,n.Z)({subHeaderText:M("Set up the commenting system for your site","newspack")},c))}),(0,s.createElement)(O,{path:"/recirculation",exact:!0,render:()=>(0,s.createElement)(P,(0,n.Z)({},c,{subHeaderText:M("Engage visitors with related content","newspack"),relatedPostsEnabled:t,relatedPostsError:a,buttonAction:()=>this.updatedRelatedContentSettings(),buttonText:M("Save Settings","newspack"),buttonDisabled:!t||!l,relatedPostsMaxAge:r,onChange:e=>{this.setState({relatedPostsMaxAge:e,relatedPostsUpdated:!0})}}))}),(0,s.createElement)(A,{to:o}))))}}(0,s.render)((0,s.createElement)((0,o.uF)(R,["jetpack"])),document.getElementById("newspack-engagement-wizard"))},9196:e=>{e.exports=window.React},2819:e=>{e.exports=window.lodash},6292:e=>{e.exports=window.moment},6989:e=>{e.exports=window.wp.apiFetch},5609:e=>{e.exports=window.wp.components},9818:e=>{e.exports=window.wp.data},9307:e=>{e.exports=window.wp.element},2694:e=>{e.exports=window.wp.hooks},2629:e=>{e.exports=window.wp.htmlEntities},5736:e=>{e.exports=window.wp.i18n},9630:e=>{e.exports=window.wp.keycodes},444:e=>{e.exports=window.wp.primitives},6483:e=>{e.exports=window.wp.url}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var s=a[e]={exports:{}};return t[e].call(s.exports,s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,a,r,s)=>{if(!a){var l=1/0;for(p=0;p<e.length;p++){for(var[a,r,s]=e[p],o=!0,i=0;i<a.length;i++)(!1&s||l>=s)&&Object.keys(n.O).every((e=>n.O[e](a[i])))?a.splice(i--,1):(o=!1,s<l&&(l=s));if(o){e.splice(p--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var p=e.length;p>0&&e[p-1][2]>s;p--)e[p]=e[p-1];e[p]=[a,r,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.j=103,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");a.length&&(e=a[a.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={103:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var r,s,[l,o,i]=a,c=0;if(l.some((t=>0!==e[t]))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(i)var p=i(n)}for(t&&t(a);c<l.length;c++)s=l[c],n.o(e,s)&&e[s]&&e[s][0](),e[l[c]]=0;return n.O(p)},a=globalThis.webpackChunkwebpack=globalThis.webpackChunkwebpack||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=n.O(void 0,[351],(()=>n(2831)));r=n.O(r);var s=window;for(var l in r)s[l]=r[l];r.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();