(()=>{"use strict";var e;e=function(){const e=document.querySelector(".subscription_details .button.cancel"),{labels:t,nonce:n,rest_url:s,should_rate_limit:c}=newspack_my_account||{};if(e){const n=e=>{confirm(t?.cancel_subscription_message||"Are you sure you want to cancel this subscription?")||e.preventDefault()};e.addEventListener("click",n)}const i=document.getElementById("add_payment_method");if(i&&Boolean(c)){const e=document.querySelector(".woocommerce-notices-wrapper"),t=i.querySelector('input[type="submit"], button[type="submit"]'),c=function(c){if(i.hasAttribute("data-check-rate-limit")){e.textContent="",t.setAttribute("disabled",""),c.preventDefault();const a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState&&a.status>=200&&a.status<300){t.removeAttribute("disabled");const n=JSON.parse(a.responseText);if(n?.success&&(i.removeAttribute("data-check-rate-limit"),i.requestSubmit(t),i.setAttribute("data-check-rate-limit","1")),n?.error){const t=document.createElement("div"),s=document.createElement("ul"),c=document.createElement("li");s.classList.add("woocommerce-error"),c.textContent=n.error,t.appendChild(s),s.appendChild(c),e.appendChild(t),e.scrollIntoView({behavior:"smooth"})}}},a.open("GET",s+"newspack/v1/check-rate"),a.setRequestHeader("X-WP-Nonce",n),a.send()}};i.setAttribute("data-check-rate-limit","1"),i.addEventListener("submit",c,!0),t.addEventListener("click",c,!0)}window.newspackRAS=window.newspackRAS||[],window.newspackRAS.push((e=>{const t=e.getReader(),n=new URLSearchParams(window.location.search),s=n.get("newspack_newsletters_subscription_subscribed");s&&t?.email&&t?.authenticated&&e.dispatchActivity("newsletter_signup",{email:t.email,lists:s.split(","),newsletters_subscription_method:"my-account"}),n.delete("newspack_newsletters_subscription_subscribed");const c=n.toString()?"?"+n.toString():"";window.history.replaceState({},"",window.location.pathname+c)}))},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",e):e())})();