(()=>{"use strict";const e="np_gate_interaction",t={...newspack_memberships_gate.metadata,referrer:window.location.pathname};function n(e){return!!e&&e.offsetWidth>0&&e.offsetHeight>0}function o(e,o){return o&&(t.gate_has_donation_block=n(o.querySelector(".wp-block-newspack-blocks-donate"))?"yes":"no",t.gate_has_registration_block=n(o.querySelector(".newspack-registration"))?"yes":"no",t.gate_has_checkout_button=n(o.querySelector(".wp-block-newspack-blocks-checkout-button"))?"yes":"no",t.gate_has_registration_link=n(o.querySelector('a[href="#register_modal"]'))?"yes":"no",t.gate_has_signin_link=n(o.querySelector('a[href="#signin_modal"]'))?"yes":"no"),{...t,...e}}function a(t){"function"==typeof window.gtag&&(!function(t){[...document.querySelectorAll(".newspack-reader-auth form"),...t.querySelectorAll(".newspack-registration form"),...t.querySelectorAll(".wp-block-newspack-blocks-checkout-button form"),...t.querySelectorAll(".wp-block-newspack-blocks-donate form")].forEach((n=>{if(!n.querySelector('input[name="memberships_content_gate"]')){const a=document.createElement("input");a.type="hidden",a.name="memberships_content_gate",a.value=newspack_memberships_gate.metadata?.gate_post_id||"1",n.appendChild(a),n.addEventListener("submit",(n=>function(t,n){if("function"!=typeof window.gtag)return;const a={action:"form_submission"},i=new FormData(t.target),c={};for(const e of i.entries())c[e[0]]=e[1];if(c["reader-activation-auth-form"]&&c.action&&(a.action_type="register"===c.action?"registration":"signin"),c.newspack_reader_registration&&(a.action_type="registration"),c.newspack_donate&&(a.action_type="donation",c.donation_currency&&(a.donation_currency=c.donation_currency),c.donation_frequency&&(a.donation_frequency=c.donation_frequency,c[`donation_value_${c.donation_frequency}`]&&(a.donation_amount=c[`donation_value_${c.donation_frequency}`],"other"===a.donation_amount&&c[`donation_value_${c.donation_frequency}_other`]&&(a.donation_amount=c[`donation_value_${c.donation_frequency}_other`])))),c.newspack_checkout){a.action_type="checkout_button";const e=t.target.getAttribute("data-product")?JSON.parse(t.target.getAttribute("data-product")):null;e&&Object.assign(a,e)}window.gtag("event",e,o(a,n))}(n,t)))}}))}(t),window.gtag("event",e,o({action:"seen"},t)))}var i;i=function(){const t=document.querySelector(".newspack-memberships__gate");if(t)if(window.newspackRAS=window.newspackRAS||[],window.newspackRAS.push((function(t){let n=!1;const a=function(a){if(a?.detail?.action&&"reader_registered"===a.detail.action&&!window?.newspackReaderActivation?.getPendingCheckout()&&(n=!0),a?.detail?.overlays&&a.detail.removed){const t=window?.newspackReaderActivation?.getActivities(),a=t?.[t.length-1]||{},i=["checkout_completed","reader_registered","reader_logged_in","newsletter_signup"];t.length&&i.includes(a.action)?n=!0:(n=!1,function(){if("function"!=typeof window.gtag)return;const t=o({action:"dismissed"});window.gtag("event",e,t)}())}setTimeout((()=>{!t.overlays.get().length&&n&&window.location.reload()}),5)};t.on("overlay",a),t.on("activity",a)})),t.classList.contains("newspack-memberships__overlay-gate"))!function(e){let t=document.querySelector(".entry-content");t||(t=document.querySelector("#content")),e.style.removeProperty("display");let n=!1;const o=()=>{let o=!1;(t?.getBoundingClientRect().top||0)-window.innerHeight/2<0&&(o=!0,n||a(e),n=!0),e.setAttribute("data-visible",o)};document.addEventListener("scroll",o),o()}(t);else{const e=()=>{(t?.getBoundingClientRect().top||0)-window.innerHeight/2<0&&"function"==typeof window.gtag&&(a(t),document.removeEventListener("scroll",e))};document.addEventListener("scroll",e),e()}},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",i):i())})();