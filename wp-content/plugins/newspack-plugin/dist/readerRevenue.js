(()=>{"use strict";var e,t={898:(e,t,a)=>{a.r(t),a(5674);var n=a(2819),r=a(9307),s=a(5736),o=a(1383),l=a(9818),i=a(5609),c=a(7405);const d="wc",p="stripe",u="other",m="newspack-reader-revenue-wizard",w=s.__,h={once:{tieredLabel:w("One-time donations"),staticLabel:w("Suggested one-time donation amount")},month:{tieredLabel:w("Monthly donations"),staticLabel:w("Suggested donation amount per month")},year:{tieredLabel:w("Annual donations"),staticLabel:w("Suggested donation amount per year")}},g=Object.keys(h),k=()=>{const e=o.en.useWizardData("reader-revenue"),{updateWizardSettings:t}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);if(!e.donation_data||"errors"in e.donation_data)return null;const{amounts:a,currencySymbol:n,tiered:s,disabledFrequencies:d,minimumDonation:p}=e.donation_data,u=e=>a=>t({slug:"newspack-reader-revenue-wizard",path:["donation_data",...e],value:a}),m=g.map((e=>({key:e,...h[e]}))),k=parseFloat(p);return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.Zb,{headerActions:!0,noBorder:!0},(0,r.createElement)(o.M$,{title:w("Suggested Donations","newspack"),description:w("Set suggested donation amounts. These will be the default settings for the Donate block.","newspack"),noMargin:!0}),(0,r.createElement)(o.Yw,{label:w("Donation Type","newspack"),onChange:()=>u(["tiered"])(!s),buttonOptions:[{value:!0,label:w("Tiered","newspack")},{value:!1,label:w("Untiered","newspack")}],buttonSmall:!0,value:s,hideLabelFromVision:!0})),s?(0,r.createElement)(o.rj,{columns:1,gutter:16},m.map((e=>{const t=d[e.key],s=Object.values(d).filter(Boolean).length===g.length-1;return(0,r.createElement)(o.Zb,{isMedium:!0,key:e.key},(0,r.createElement)(o.rj,{columns:1,gutter:16},(0,r.createElement)(i.ToggleControl,{checked:!t,onChange:()=>u(["disabledFrequencies",e.key])(!t),label:e.tieredLabel,disabled:!t&&s}),!t&&(0,r.createElement)(o.rj,{columns:3,rowGap:16},(0,r.createElement)(c.P,{currencySymbol:n,label:w("Low-tier"),error:a[e.key][0]<k?w("Warning: suggested donations should be at least the minimum donation amount.","newspack"):null,value:a[e.key][0],min:k,onChange:u(["amounts",e.key,0])}),(0,r.createElement)(c.P,{currencySymbol:n,label:w("Mid-tier"),error:a[e.key][1]<k?w("Warning: suggested donations should be at least the minimum donation amount.","newspack"):null,value:a[e.key][1],min:k,onChange:u(["amounts",e.key,1])}),(0,r.createElement)(c.P,{currencySymbol:n,label:w("High-tier"),error:a[e.key][2]<k?w("Warning: suggested donations should be at least the minimum donation amount.","newspack"):null,value:a[e.key][2],min:k,onChange:u(["amounts",e.key,2])}))))}))):(0,r.createElement)(o.Zb,{isMedium:!0},(0,r.createElement)(o.rj,{columns:3,rowGap:16},m.map((e=>(0,r.createElement)(c.P,{currencySymbol:n,label:e.staticLabel,value:a[e.key][3],min:k,error:a[e.key][3]<k?w("Warning: suggested donations should be at least the minimum donation amount.","newspack"):null,onChange:u(["amounts",e.key,3]),key:e.key}))))),(0,r.createElement)(o.Zb,{headerActions:!0,noBorder:!0},(0,r.createElement)(o.M$,{title:w("Minimum Donation","newspack"),description:w("Set minimum donation amount. Setting a reasonable minimum donation amount can help protect your site from bot attacks.","newspack"),noMargin:!0}),(0,r.createElement)(o.w4,{label:w("Minimum donation","newspack"),type:"number",min:1,value:k,onChange:e=>u(["minimumDonation"])(e)})))},E=()=>{const e=o.en.useWizardData("reader-revenue"),{updateWizardSettings:t}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);if(!e.donation_data||"errors"in e.donation_data)return null;const a=e.available_billing_fields;if(!a||!Object.keys(a).length)return null;const n=e.donation_data.billingFields.length?e.donation_data.billingFields:Object.keys(a);return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.Zb,{noBorder:!0,headerActions:!0},(0,r.createElement)(o.M$,{title:w("Billing Fields","newspack"),description:w("Configure which billing fields should be rendered on the donation form.","newspack"),noMargin:!0})),(0,r.createElement)(o.rj,{columns:3,rowGap:16},Object.keys(a).map((e=>(0,r.createElement)(i.CheckboxControl,{key:e,label:a[e].label,checked:n.includes(e),disabled:"billing_email"===e,onChange:()=>{let a=[...n];var r;a=n.includes(e)?a.filter((t=>t!==e)):[...a,e],(r=["billingFields"],e=>t({slug:"newspack-reader-revenue-wizard",path:["donation_data",...r],value:e}))(a)}})))))},b=()=>{const e=o.en.useWizardData("reader-revenue"),{saveWizardSettings:t}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);return(0,r.createElement)(r.Fragment,null,e.donation_page&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.Zb,{noBorder:!0,headerActions:!0},(0,r.createElement)("h2",null,w("Donations Landing Page","newspack")),(0,r.createElement)(o.zx,{variant:"secondary",isSmall:!0,href:e.donation_page.editUrl,onClick:void 0},w("Edit Page"))),"publish"===e.donation_page.status?(0,r.createElement)(o.qX,{isSuccess:!0,noticeText:w("Your donations landing page is set up and published.","newspack")}):(0,r.createElement)(o.qX,{isError:!0,noticeText:w("Your donations landing page has been created, but is not yet published. You can now edit it and publish when you're ready.","newspack")})),(0,r.createElement)(k,null),(0,r.createElement)(E,null),(0,r.createElement)("div",{className:"newspack-buttons-card"},(0,r.createElement)(o.zx,{variant:"primary",onClick:()=>t({slug:m,section:"donations",payloadPath:["donation_data"]}),href:void 0},w("Save Settings"))))},_=s.__,y=()=>{const e=o.en.useWizardData("reader-revenue"),{updateWizardSettings:t,saveWizardSettings:a}=(0,l.useDispatch)(o.en.STORE_NAMESPACE),n=e=>a=>t({slug:m,path:["location_data",e],value:a});return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.rj,{columns:1,gutter:16},(0,r.createElement)(o.rj,{columns:1,gutter:16},(0,r.createElement)(o.w4,{label:_("Address","newspack"),value:e.location_data?.address1||"",onChange:n("address1")}),(0,r.createElement)(o.w4,{label:_("Address line 2","newspack"),value:e.location_data?.address2||"",onChange:n("address2")})),(0,r.createElement)(o.rj,{rowGap:16},(0,r.createElement)(o.w4,{label:_("City","newspack"),value:e.location_data?.city||"",onChange:n("city")}),(0,r.createElement)(o.w4,{label:_("Postcode / Zip","newspack"),value:e.location_data?.postcode||"",onChange:n("postcode")}),(0,r.createElement)(o.Yw,{label:_("Country","newspack"),value:e.location_data?.countrystate||"",options:e.country_state_fields||[],onChange:n("countrystate")}),(0,r.createElement)(o.Yw,{label:_("Currency","newspack"),value:e.location_data?.currency||"",options:e.currency_fields||[],onChange:n("currency")}))),(0,r.createElement)("div",{className:"newspack-buttons-card"},(0,r.createElement)(o.zx,{isPrimary:!0,onClick:()=>a({slug:m,section:"location",payloadPath:["location_data"]})},_("Save Settings"))))},f=s.__,v=()=>{const[e,t]=(0,r.useState)(null),a=o.en.useWizardData("reader-revenue"),{updateWizardSettings:n,saveWizardSettings:s}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);(0,r.useEffect)((()=>{a?.platform_data?.donor_landing_page&&t(a.platform_data.donor_landing_page)}),[]);const i=(e,t)=>n({slug:m,path:["platform_data",e],value:t}),c=a?.platform_data||{};return(0,r.createElement)(o.fM,{hasGreyHeader:!0,isMedium:!0,title:f("News Revenue Hub Settings","newspack"),description:f("Configure your site’s connection to News Revenue Hub.","newspack"),actionContent:(0,r.createElement)(o.zx,{isPrimary:!0,onClick:()=>s({slug:m,payloadPath:["platform_data"]})},f("Save Settings"))},(0,r.createElement)("div",null,(0,r.createElement)(o.rj,{columns:3},(0,r.createElement)(o.w4,{label:f("Organization ID","newspack"),placeholder:"exampleid",value:c?.nrh_organization_id||"",onChange:e=>i("nrh_organization_id",e)}),(0,r.createElement)(o.w4,{label:f("Custom domain (optional)","newspack"),help:f("Enter the raw domain without protocol or slashes."),placeholder:"donate.example.com",value:c?.nrh_custom_domain||"",onChange:e=>i("nrh_custom_domain",e)}),(0,r.createElement)(o.w4,{label:f("Salesforce Campaign ID (optional)","newspack"),placeholder:"exampleid",value:c?.nrh_salesforce_campaign_id||"",onChange:e=>i("nrh_salesforce_campaign_id",e)}))),c.hasOwnProperty("donor_landing_page")&&(0,r.createElement)("div",null,(0,r.createElement)("hr",null),(0,r.createElement)("h3",null,f("Donor Landing Page","newspack")),(0,r.createElement)("p",{className:"components-base-control__help"},f("Set a page on your site as a donor landing page. Once a reader donates and lands on this page, they will be considered a donor.","newspack")),(0,r.createElement)(o.ah,{label:f("Search for a New Donor Landing Page","newspack"),help:f("Begin typing page title, click autocomplete result to select.","newspack"),onChange:e=>{if(!e||!e.length)return t(null),i("donor_landing_page",null);const a=e[0];return t(a),i("donor_landing_page",a)},postTypes:[{slug:"page",label:"Page"}],postTypeLabel:f("page","newspack"),postTypeLabelPlural:f("pages","newspack"),selectedItems:e?[e]:[]})))},S=s.__,C=()=>{const e=o.en.useWizardData("reader-revenue"),{saveWizardSettings:t,updateWizardSettings:a}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.Zb,{noBorder:!0},(0,r.createElement)(o.Yw,{label:S("Select Reader Revenue Platform","newspack"),value:e.platform_data?.platform,options:[{label:S("Other","newspack"),value:u},{label:S("Newspack","newspack"),value:d},{label:S("News Revenue Hub","newspack"),value:"nrh"},{label:S("Stripe","newspack"),value:p,disabled:!1===e.stripe_data?.can_use_stripe_platform}],onChange:e=>{t({slug:"newspack-reader-revenue-wizard",payloadPath:["platform_data"],updatePayload:{path:["platform_data","platform"],value:e}})}})),d===e.platform_data?.platform&&!e.plugin_status&&(0,r.createElement)(o.xf,{plugins:["woocommerce","woocommerce-subscriptions","woocommerce-name-your-price","woocommerce-gateway-stripe"],onStatus:e=>{let{complete:t}=e;t&&a({slug:"newspack-reader-revenue-wizard",path:["plugin_status"],value:!0})},withoutFooterButton:!0}))};var T=a(6989),P=a.n(T);const x=s.__,A=e=>{let{listId:t,onChange:a}=e;const[n,s]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{P()({path:"/newspack/v1/wizard/newspack-engagement-wizard/newsletters/lists"}).then(s).catch((e=>{s({error:e})}))}),[]),!1===n?(0,r.createElement)(o.Pi,null):n.error?(0,r.createElement)(o.qX,{isError:!0,noticeText:n.error.message}):(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.qX,{noticeText:(0,r.createElement)("span",null,x("You can configure Newsletters in the","newspack")," ",(0,r.createElement)("a",{href:"/wp-admin/admin.php?page=newspack-engagement-wizard#/newsletters"},x("Engagement Wizard","newspack")),".")}),(0,r.createElement)(i.SelectControl,{value:t,label:x("Chosen list","newspack"),options:[{value:"",label:x("-- Choose a list --","newspack")},...n.map((e=>({value:e.id,label:e.name})))],onChange:a}))},z=s.__,{SettingsCard:O}=o.Zr,N=()=>{const e=o.en.useWizardData("reader-revenue"),{testMode:t=!1,publishableKey:a="",secretKey:n="",testPublishableKey:s="",testSecretKey:c=""}=e.stripe_data||{},{updateWizardSettings:d}=(0,l.useDispatch)(o.en.STORE_NAMESPACE),p=e=>t=>d({slug:m,path:["stripe_data",e],value:t});return(0,r.createElement)(o.rj,{columns:1,gutter:16},(0,r.createElement)(o.rj,{columns:1,gutter:16},(0,r.createElement)("p",{className:"newspack-payment-setup-screen__api-keys-instruction"},z("Configure Stripe and enter your API keys","newspack")," – ",(0,r.createElement)(i.ExternalLink,{href:"https://stripe.com/docs/keys#api-keys"},z("learn how"))),(0,r.createElement)(i.CheckboxControl,{label:z("Use Stripe in test mode","newspack"),checked:t,onChange:p("testMode"),help:z("Test mode will not capture real payments. Use it for testing your purchase flow.","newspack")})),(0,r.createElement)(o.rj,{noMargin:!0,rowGap:16},t?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.w4,{type:"password",value:s,label:z("Test Publishable Key","newspack"),onChange:p("testPublishableKey")}),(0,r.createElement)(o.w4,{type:"password",value:c,label:z("Test Secret Key","newspack"),onChange:p("testSecretKey")})):(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.w4,{type:"password",value:a,label:z("Publishable Key","newspack"),onChange:p("publishableKey")}),(0,r.createElement)(o.w4,{type:"password",value:n,label:z("Secret Key","newspack"),onChange:p("secretKey")}))))},M=()=>{const{stripe_data:e={},platform_data:t,is_ssl:a,currency_fields:s=[],country_state_fields:c=[],errors:d=[]}=o.en.useWizardData("reader-revenue"),u=t?.platform===p,{updateWizardSettings:w}=(0,l.useDispatch)(o.en.STORE_NAMESPACE),h=e=>t=>w({slug:m,path:["stripe_data",e],value:t}),{saveWizardSettings:g}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);return(0,r.createElement)(r.Fragment,null,d.length>0&&d.map(((e,t)=>(0,r.createElement)(o.qX,{isError:!0,key:t,noticeText:(0,r.createElement)("span",null,e.message)}))),!1===a&&(0,r.createElement)(o.qX,{isWarning:!0,noticeText:(0,r.createElement)("a",{href:"https://stripe.com/docs/security/guide"},z("This site does not use SSL. The page hosting the Stipe integration should be secured with SSL.","newspack"))}),u?(0,r.createElement)(r.Fragment,null,!(0,n.isEmpty)(e.connection_error)&&(0,r.createElement)(o.qX,{isError:!0,noticeText:e.connection_error}),(0,r.createElement)(O,{title:z("Settings","newspack"),columns:1,gutter:16,noBorder:!0},!1===e.can_use_stripe_platform&&(0,r.createElement)(o.qX,{isError:!0,noticeText:z("The Stripe platform will not work properly on this site.","newspack")}),(0,r.createElement)(N,null),(0,r.createElement)(o.rj,{rowGap:16},(0,r.createElement)(o.Yw,{label:z("Country","newspack"),value:e.location_code,options:c,onChange:h("location_code")}),(0,r.createElement)(o.Yw,{label:z("Currency","newspack"),value:e.currency,options:s,onChange:h("currency")}))),(0,r.createElement)(O,{title:z("Newsletters","newspack"),description:z("Allow donors to sign up to your newsletter when donating.","newspack"),columns:1,gutter:16,noBorder:!0},(0,r.createElement)(A,{listId:e.newsletter_list_id,onChange:h("newsletter_list_id")})),(0,r.createElement)(O,{title:z("Fee","newspack"),description:z("If you have a non-default or negotiated fee with Stripe, update its parameters here.","newspack"),columns:1,noBorder:!0},(0,r.createElement)(o.rj,{noMargin:!0,rowGap:16},(0,r.createElement)(o.w4,{type:"number",step:"0.1",value:e.fee_multiplier,label:z("Fee multiplier","newspack"),onChange:h("fee_multiplier")}),(0,r.createElement)(o.w4,{type:"number",step:"0.1",value:e.fee_static,label:z("Fee static portion","newspack"),onChange:h("fee_static")})))):(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.rj,null,(0,r.createElement)(i.ToggleControl,{label:z("Enable Stripe","newspack"),checked:e.enabled,onChange:h("enabled")})),e.enabled?(0,r.createElement)(N,null):(0,r.createElement)(o.rj,null,(0,r.createElement)("p",{className:"newspack-payment-setup-screen__info"},z("Other gateways can be enabled and set up in the ","newspack"),(0,r.createElement)(i.ExternalLink,{href:"/wp-admin/admin.php?page=wc-settings&tab=checkout"},z("WooCommerce payment gateway settings","newspack"))))),(0,r.createElement)("div",{className:"newspack-buttons-card"},(0,r.createElement)(o.zx,{isPrimary:!0,onClick:()=>g({slug:m,section:"stripe",payloadPath:["stripe_data"]})},z("Save Settings","newspack"))),u&&(0,r.createElement)(o.fM,{title:z("Webhooks","newspack"),titleLink:"#/stripe-webhooks",href:"#/stripe-webhooks",description:z("Manage the webhooks Stripe uses to communicate with your site.","newspack"),actionText:z("Edit","newspack")}))};var D=a(4184),F=a.n(D);const W=s.__,j=e=>{let{title:t,webhooks:a,onUpdate:n,withBorder:s,className:c}=e;const{wizardApiFetch:d}=(0,l.useDispatch)(o.en.STORE_NAMESPACE),p=(0,l.useSelect)((e=>e(o.en.STORE_NAMESPACE).isQuietLoading())),u=(e,t,a)=>{const r={path:`/newspack/v1/stripe/webhook/${e.id}`,method:t,data:a,isQuietFetch:!0};a&&(r.data=a),d(r).then(n(t))};return(0,r.createElement)("div",{className:F()(c,"newspack-webhooks-list",{"newspack-webhooks-list--border":s})},"function"==typeof t&&(0,r.createElement)("div",{className:"newspack-webhooks-list__title"},t()),(0,r.createElement)("ul",null,a.map((e=>(0,r.createElement)("li",{key:e.id},(0,r.createElement)("span",null,(0,r.createElement)(i.ToggleControl,{checked:"enabled"===e.status,disabled:p,onChange:()=>u(e,"POST",{status:"enabled"===e.status?"disabled":"enabled"})}),(0,r.createElement)("code",{className:"mr3"},e.url)),(0,r.createElement)(o.zx,{isDestructive:!0,isLink:!0,disabled:p,onClick:()=>{o.P6.confirmAction(W("Are you sure you want to remove this webhook?","newspack"))&&u(e,"DELETE")}},W("Delete","newspack")))))))},L=()=>{const[e,t]=(0,r.useState)([]),{wizardApiFetch:a}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);(0,r.useEffect)((()=>{a({path:"/newspack/v1/stripe/webhooks"}).then(t)}),[]);const[n,s]=e.reduce(((e,t)=>(t.matches_url?e[0].push(t):e[1].push(t),e)),[[],[]]),c=n.filter((e=>"enabled"===e.status)),d=a=>n=>{let r=e;switch(a){case"POST":r=e.map((e=>n.id===e.id?n:e));break;case"DELETE":r=e.filter((e=>n.id!==e.id))}t(r)};return(0,r.createElement)("div",{className:"newspack-payment-setup-screen__webhooks"},c.length>1&&(0,r.createElement)(o.qX,{isError:!0,noticeText:W("There are too many webhoooks for this site. Please delete or disable the extra ones.","newspack")}),0===c.length&&(0,r.createElement)(o.qX,{isError:!0,noticeText:W("There are no active webhoooks for this site.","newspack")}),(0,r.createElement)(o.fM,{title:W("Webhooks","newspack"),className:"newspack-settings__no-border",description:W("Manage the webhooks Stripe uses to communicate with your site.","newspack")}),(0,r.createElement)(j,{withBorder:!0,className:"mb4",title:()=>(0,r.createElement)("div",{className:"flex justify-between items-center"},(0,r.createElement)("h4",{className:"b f6 ma0"},W("Webhooks connected to this site","newspack")),(0,r.createElement)(o.zx,{variant:"secondary",isSmall:!0,onClick:()=>{o.P6.confirmAction(W("Are you sure you want to reset all webhooks connected to this site?","newspack"))&&a({path:"/newspack/v1/stripe/reset-webhook",method:"DELETE",isQuietFetch:!0}).then(t)}},W("Reset","newspack"))),webhooks:n,onUpdate:d}),s.length?(0,r.createElement)(o.UQ,{title:W("Webhooks not connected to this site","newspack")},(0,r.createElement)(j,{webhooks:s,onUpdate:d})):null,(0,r.createElement)("div",{className:"newspack-buttons-card"},(0,r.createElement)(o.zx,{href:"#/stripe-setup",isPrimary:!0},W("Back to Stripe Settings","newspack")),(0,r.createElement)(i.ExternalLink,{href:"https://dashboard.stripe.com/webhooks"},W("Stripe Dashboard","newspack"))))};var R=a(7462);const q=s.__,B=(0,n.values)(newspack_reader_revenue.emails),X=newspack_reader_revenue.email_cpt,H=()=>{const[e,t]=(0,r.useState)(null),[a,n]=(0,r.useState)(!1),[s,l]=(0,r.useState)(!1),[i,c]=(0,r.useState)(B);return!1===e?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.qX,{isError:!0},q("Newspack uses Newspack Newsletters to handle editing email-type content. Please activate this plugin to proceed.","newspack")),(0,r.createElement)(o.qX,{isError:!0},q("Until this feature is configured, default receipts will be used.","newspack")),(0,r.createElement)(o.xf,{style:e?{display:"none"}:{},plugins:["newspack-newsletters"],onStatus:e=>t(e.complete),onInstalled:()=>window.location.reload(),withoutFooterButton:!0})):(0,r.createElement)(r.Fragment,null,i.map((e=>{const t="publish"===e.status;return(0,r.createElement)(o.fM,(0,R.Z)({key:e.post_id,disabled:s,title:e.label,titleLink:e.edit_link,href:e.edit_link,description:e.description,actionText:q("Edit","newspack"),toggleChecked:t,toggleOnChange:t=>{return a=e.post_id,r=t?"publish":"draft",n(!1),l(!0),void P()({path:`/wp/v2/${X}/${a}`,method:"post",data:{status:r}}).then((()=>{c(i.map((e=>e.post_id===a?{...e,status:r}:e)))})).catch(n).finally((()=>l(!1)));var a,r}},t?{}:{notification:q("This email is not active. The default receipt will be used.","newspack"),notificationLevel:"info"}),a&&(0,r.createElement)(o.qX,{noticeText:a?.message||q("Something went wrong.","newspack"),isError:!0}))})))};var U=a(129),I=a(6483);const K=s.__,Y=()=>{const{salesforce_redirect_url:e}=window?.newspack_reader_revenue||{},[t,a]=(0,r.useState)(!1),{salesforce_settings:n={}}=o.en.useWizardData("reader-revenue"),[s,c]=(0,r.useState)(n.refresh_token),[d,p]=(0,r.useState)(null),{saveWizardSettings:u,wizardApiFetch:w}=(0,l.useDispatch)(o.en.STORE_NAMESPACE);return(0,r.useEffect)((()=>{const t=(0,U.parse)(window.location.search).code;t&&(window.history.replaceState({},"",e),(async t=>{try{const a=await w({path:"/newspack/salesforce/v1/tokens",method:"POST",data:{code:t,redirect_uri:e}}),{access_token:n,client_id:r,client_secret:s,instance_url:o,refresh_token:l}=a;n&&l&&u({slug:m,section:"salesforce",payloadPath:["salesforce_settings"],updatePayload:{path:["salesforce_settings"],value:{access_token:n,client_id:r,client_secret:s,instance_url:o,refresh_token:l}}}),c(!0)}catch(e){p(K("We couldn’t establish a connection to Salesforce. Please verify your Consumer Key and Secret and try connecting again.","newspack"))}})(t))}),[]),(0,r.useEffect)((()=>{s?(async()=>{const e=await w({path:"/newspack/salesforce/v1/connection-status",method:"POST",isQuietFetch:!0});e.error&&p(e.error)})():p(null)}),[s]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.d5,{afterUpdate:t=>{let a,n;if((t?.salesforce||[]).forEach((e=>{"newspack_salesforce_client_id"===e.key?a=e.value:"newspack_salesforce_client_secret"===e.key&&(n=e.value)})),a&&n&&e){const t=(0,I.addQueryArgs)("https://login.salesforce.com/services/oauth2/authorize",{response_type:"code",client_id:encodeURIComponent(a),client_secret:encodeURIComponent(n),redirect_uri:encodeURI(e)});window.location.assign(t)}else c(!1)},pluginSlug:"newspack/salesforce",title:K("Salesforce Settings","newspack"),description:()=>(0,r.createElement)(r.Fragment,null,d&&(0,r.createElement)(o.qX,{noticeText:d,isWarning:!0}),s&&!d&&(0,r.createElement)(o.qX,{noticeText:K("Your site is connected to Salesforce.","newspack"),isSuccess:!0}),K("Establish a connection to sync WooCommerce order data to Salesforce. To connect with Salesforce, create or choose a Connected App for this site in your Salesforce dashboard. Make sure to paste the full URL for this page (","newspack"),(0,r.createElement)(i.ClipboardButton,{className:"newspack-button is-link",text:e,onCopy:()=>a(!0),onFinishCopy:()=>a(!1)},K(t?"copied to clipboard!":"copy to clipboard","newspack")),K(") into the “Callback URL” field in the Connected App’s settings. ","newspack"),(0,r.createElement)(i.ExternalLink,{href:"https://help.salesforce.com/articleView?id=connected_app_create.htm"},K("Learn how to create a Connected App","newspack")))}))},G=s.__;(0,r.render)((0,r.createElement)((()=>{const{platform_data:e,plugin_status:t,donation_data:a}=o.en.useWizardData("reader-revenue"),s=e?.platform,l={label:G("Platform","newspack"),path:"/",render:C};let i=[{label:G("Donations","newspack"),path:"/donations",render:b,isHidden:s===u},{label:G(s===d?"Stripe Gateway":"Stripe Settings","newspack"),path:"/stripe-setup",activeTabPaths:["/stripe-setup","/stripe-webhooks"],render:M,isHidden:s!==d&&s!==p},{label:G("Stripe Webhooks","newspack"),path:"/stripe-webhooks",render:L,isHidden:s!==p,isHiddenInTabbedNavigation:!0},{label:G("Emails","newspack"),path:"/emails",render:H,isHidden:s!==d&&s!==p},{label:G("Address","newspack"),path:"/location-setup",render:y,isHidden:s!==d},{label:G("Salesforce","newspack"),path:"/salesforce",render:Y,isHidden:s!==d},{label:G("News Revenue Hub Settings","newspack"),path:"/settings",render:v,isHidden:"nrh"!==s},l];return s!==d||t||(i=[l]),(0,r.createElement)(o.en,{headerText:G("Reader Revenue","newspack"),subHeaderText:G("Generate revenue from your customers","newspack"),sections:i,apiSlug:m,renderAboveSections:()=>(0,n.values)(a?.errors).map(((e,t)=>(0,r.createElement)(o.qX,{key:t,isError:!0,noticeText:e}))),requiredPlugins:["newspack-blocks"]})})),document.getElementById("newspack-reader-revenue-wizard"))},9196:e=>{e.exports=window.React},2819:e=>{e.exports=window.lodash},6292:e=>{e.exports=window.moment},6989:e=>{e.exports=window.wp.apiFetch},5609:e=>{e.exports=window.wp.components},9818:e=>{e.exports=window.wp.data},9307:e=>{e.exports=window.wp.element},2694:e=>{e.exports=window.wp.hooks},2629:e=>{e.exports=window.wp.htmlEntities},5736:e=>{e.exports=window.wp.i18n},9630:e=>{e.exports=window.wp.keycodes},444:e=>{e.exports=window.wp.primitives},6483:e=>{e.exports=window.wp.url}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var s=a[e]={exports:{}};return t[e].call(s.exports,s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,a,r,s)=>{if(!a){var o=1/0;for(d=0;d<e.length;d++){for(var[a,r,s]=e[d],l=!0,i=0;i<a.length;i++)(!1&s||o>=s)&&Object.keys(n.O).every((e=>n.O[e](a[i])))?a.splice(i--,1):(l=!1,s<o&&(o=s));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[a,r,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.j=359,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");a.length&&(e=a[a.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={359:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var r,s,[o,l,i]=a,c=0;if(o.some((t=>0!==e[t]))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(i)var d=i(n)}for(t&&t(a);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[o[c]]=0;return n.O(d)},a=globalThis.webpackChunkwebpack=globalThis.webpackChunkwebpack||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=n.O(void 0,[351],(()=>n(898)));r=n.O(r);var s=window;for(var o in r)s[o]=r[o];r.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();