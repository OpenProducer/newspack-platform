"use strict";(globalThis.webpackChunknewspack=globalThis.webpackChunknewspack||[]).push([[218],{1075:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(4058);class a extends t.A{constructor(e,n,s,t=""){super(e,s,t),this.name="WizardApiError",this.statusCode=n,Object.setPrototypeOf(this,a.prototype)}toJSON(){return{name:this.name,message:this.message,statusCode:this.statusCode,errorCode:this.errorCode,details:this.details,stackTrace:this.stack}}}const i=a},1501:(e,n,s)=>{s.r(n),s.d(n,{default:()=>L});var t=s(7723),a=s(3832),i=s(6087),l=s(8558),o=s(8169),c=s(6427),r=s(6837),p=s(3984);const d="/additional-brands";var u=s(790);const{useHistory:_}=p.Ix;function g({brand:e,deleteBrand:n}){const[s,a]=(0,i.useState)(!1),g=()=>a(!1),h=_();return(0,u.jsx)(r.A,{isSmall:!0,title:e.name,actionText:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.$n,{onClick:()=>a(!s),label:(0,t.__)("More options","newspack-plugin"),icon:o.A,className:s?"popover-active":""}),s&&(0,u.jsxs)(p.AM,{position:"bottom left",onKeyDown:e=>l.ESCAPE===e.keyCode&&g,onFocusOutside:g,children:[(0,u.jsx)(c.MenuItem,{onClick:()=>g(),className:"screen-reader-text",children:(0,t.__)("Close Popover","newspack-plugin")}),(0,u.jsx)(c.MenuItem,{onClick:()=>h.push(`${d}/${e.id}`),className:"newspack-button",children:(0,t.__)("Edit","newspack-plugin")}),(0,u.jsx)(c.MenuItem,{onClick:()=>n(e),className:"newspack-button",children:(0,t.__)("Delete","newspack-plugin")})]})]})})}const{NavLink:h}=p.Ix;function w({brands:e,isFetching:n,deleteBrand:s}){return(0,u.jsxs)(i.Fragment,{children:[(0,u.jsxs)(p.Zp,{headerActions:!0,noBorder:!0,children:[(0,u.jsx)("h2",{children:e.length||n?(0,t.__)("Site brands","newspack-plugin"):(0,t.__)("You have no saved brands.","newspack-plugin")}),(0,u.jsx)(h,{to:`${d}/new`,children:(0,u.jsx)(p.$n,{variant:"primary",disabled:n,children:(0,t.__)("Add New Brand","newspack-plugin")})})]}),e.length?e.map(e=>(0,u.jsx)(g,{brand:e,deleteBrand:s},e.id)):(0,u.jsx)(i.Fragment,{children:n?(0,u.jsx)("p",{children:(0,t.__)("Fetching brands…","newspack-plugin")}):(0,u.jsx)("p",{children:(0,t.__)("Create brands to enhance your readers experience.","newspack-plugin")})})]})}const{useParams:m}=p.Ix,{themeColors:k,menuLocations:x,menus:b}=window.newspackSettings["additional-brands"].sections.additionalBrands;function f({brands:e=[],upsertBrand:n,wizardApiFetch:s,fetchLogoAttachment:l,errorMessage:o}){const{brandId:c="0"}=m(),r=e.find(({id:e})=>e===Number(c)),[_,g]=p.JL.useObjectState({id:0,name:"",slug:"",meta:{_show_page_on_front:0,_custom_url:"yes",_logo:0,_theme_colors:[],_menus:[]},count:0,description:"",link:"",taxonomy:"",parent:0}),[h,w]=(0,i.useState)([]),[f,v]=(0,i.useState)("no");(0,i.useEffect)(()=>{r&&"number"==typeof r.meta._logo&&l(Number(c),r.meta._logo)},[r?.meta._logo]),(0,i.useEffect)(()=>{r&&(g(r),v(r.meta._show_page_on_front?"yes":"no"))},[r]),(0,i.useEffect)(()=>{s({path:(0,a.addQueryArgs)("/wp/v2/pages",{per_page:100,orderby:"title",order:"asc"})},{onSuccess:w})},[]);const j=_.meta._theme_colors,C=_.name?.length>0&&("no"===f||"yes"===f&&_.meta._show_page_on_front>0);function y(e,n){if(!e)return;const s=j.find(n=>n.name===e);let t=[...j||[]];n?s?t=t.map(s=>s.name===e?{...s,color:n}:s):t.push({name:e,color:n}):t=t.filter(n=>n.name!==e),g({meta:{..._.meta,_theme_colors:t}})}const A=`${window.newspack_urls.site}/${"no"===_.meta._custom_url?"brand/":""}`;function S(e){return _.meta._menus.find(n=>n.location===e)?.menu||0}function E(){return"number"==typeof _.meta._logo&&_.meta._logo>0}return(0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)(p.X3,{title:(0,t.__)("Brand","newspack-plugin"),description:(0,t.__)("Set your brand identity","newspack-plugin")}),(0,u.jsxs)(p.xA,{gutter:32,children:[(0,u.jsx)(p.xA,{columns:1,gutter:16,children:(0,u.jsx)(p.xt,{label:(0,t.__)("Name","newspack-plugin"),value:_.name||"",onChange:g("name"),onBlur:function(e){_.slug||g({slug:(0,a.cleanForSlug)(e.target.value)})},placeholder:(0,t.__)("Brand Name","newspack-plugin")})}),(0,u.jsx)(p.xA,{columns:1,gutter:16,children:(0,u.jsx)(p.BR,{className:"newspack-brand__header__logo",buttonLabel:E()?(0,t.__)("Fetching logo…","newspack-plugin"):void 0,label:(0,t.__)("Logo","newspack-plugin"),image:E()?void 0:_.meta._logo,onChange:e=>g({meta:{..._.meta,_logo:e}})})})]}),k&&(0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)(p.X3,{title:(0,t.__)("Colors","newspack-plugin"),description:(0,t.__)("These are the colors you can customize for this brand in the active theme","newspack-plugin")}),k.map(e=>{var n;return(0,u.jsx)(p.Zp,{noBorder:!0,children:(0,u.jsx)(p.sk,{className:"newspack-brand__theme-mod-color-picker",label:(0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)("span",{children:e.label}),j.find(n=>n.name===e.theme_mod_name)?.color&&(0,u.jsx)(p.$n,{variant:"link",onClick:()=>y(e.theme_mod_name,""),children:(0,t.__)("Reset default color","newspack-plugin")})]}),color:null!==(n=j.find(n=>n.name===e.theme_mod_name)?.color)&&void 0!==n?n:e.default,onChange:n=>y(e.theme_mod_name,n)})},e.theme_mod_name)})]}),(0,u.jsx)(p.X3,{title:(0,t.__)("Settings","newspack-plugin")}),(0,u.jsxs)(p.Zp,{noBorder:!0,children:[(0,u.jsx)(p.bh,{className:"newspack-brand__base-url-radio-control",label:(0,t.__)("URL Base","newspack-plugin"),selected:_.meta._custom_url||"yes",options:[{label:(0,t.__)("Homepage","newspack-plugin"),value:"yes"},{label:(0,t.__)("Default","newspack-plugin"),value:"no"}],onChange:e=>g({meta:{..._.meta,_custom_url:e}})}),(0,u.jsxs)("div",{className:"newspack-brand__base-url-component",children:[(0,u.jsx)("span",{children:A}),(0,u.jsx)(p.xt,{className:"newspack-brand__base-url-component__text-control",label:(0,t.__)("Slug","newspack-plugin"),hideLabelFromVision:!0,withMargin:!1,value:_.slug||"",onChange:e=>g({slug:e}),placeholder:"brand-slug"})]})]}),(0,u.jsxs)(p.Zp,{noBorder:!0,children:[(0,u.jsx)(p.bh,{className:"newspack-brand__base-url-radio-control",label:(0,t.__)("Show on Front","newspack-plugin"),selected:f,options:[{label:(0,t.__)("Latest posts","newspack-plugin"),value:"no"},{label:(0,t.__)("A page","newspack-plugin"),value:"yes"}],onChange:function(e){v(e),g({meta:{..._.meta,_show_page_on_front:"yes"===e?1:0}})}}),"yes"===f&&(0,u.jsx)(p.Yq,{label:(0,t.__)("Homepage URL","newspack-plugin"),value:_.meta._show_page_on_front||0,options:[{label:(0,t.__)("Select a Page","newspack-plugin"),value:0,disabled:!0},...h.map(e=>({label:e.title.rendered,value:Number(e.id)}))],onChange:e=>g({meta:{..._.meta,_show_page_on_front:Number(e)}}),required:!0})]}),(0,u.jsx)(p.X3,{title:(0,t.__)("Menus","newspack-plugin"),description:(0,t.__)("Customize the menus for this brand","newspack-plugin")}),x&&Object.keys(x).map(e=>(0,u.jsx)(p.Yq,{label:x[e],value:S(e),options:[{label:(0,t.__)("Same as site","newspack-plugin"),value:0},...b],onChange:n=>function(e,n){const s=_.meta._menus.map(s=>s.location===e?{...s,menu:n}:s)||[];g({meta:{..._.meta,_menus:[...s,{location:e,menu:n}]}})}(e,n)},e)),o&&(0,u.jsx)(p.$T,{isError:!0,children:o}),(0,u.jsxs)("div",{className:"newspack-buttons-card",children:[(0,u.jsx)(p.$n,{disabled:!C,variant:"primary",onClick:()=>n(Number(c),_),children:(0,t.__)("Save","newspack-plugin")}),(0,u.jsx)(p.$n,{variant:"secondary",href:`#${d}`,children:(0,t.__)("Cancel","newspack-plugin")})]})]})}var v=s(5829),j=s(8721),C=s(2005);const{Route:y,Switch:A,useHistory:S,useRouteMatch:E,useLocation:T}=p.Ix;function L(){const{wizardApiFetch:e,isFetching:n,cache:s,errorMessage:l,resetError:o}=(0,C.L)("newspack-settings/additional-brands"),c=s("/wp/v2/brand"),[r,_]=(0,i.useState)([]),g=S(),h=T(),{path:m}=E();(0,i.useEffect)(()=>{o()},[h.pathname]),(0,i.useEffect)(()=>{c.set(r)},[r]);const k={isFetching:n,headerText:(0,t.__)("Brands","newspack-plugin"),subHeaderText:(0,t.__)("Configure brands settings","newspack-plugin")},x=(n,s)=>{e({path:n?`/wp/v2/brand/${n}`:"/wp/v2/brand",method:"POST",data:{...s,meta:{...s.meta,...s.meta._logo&&{_logo:s.meta._logo instanceof Object?s.meta._logo.id:s.meta._logo}}}},{onSuccess(e){_(s=>0===n?[e,...s]:s.map(s=>n===s.id?e:s)),g.push(d)}})},b=n=>{p.Wp.confirmAction((0,t.__)("Are you sure you want to delete this brand?","newspack-plugin"))&&e({path:(0,a.addQueryArgs)(`/wp/v2/brand/${n.id}`,{force:!0}),method:"DELETE"},{onSuccess(e){e.deleted&&_(e=>e.filter(e=>n.id!==e.id))}})},L=(n,s)=>{s&&e({path:`/wp/v2/media/${s}`},{onSuccess(e){_(s=>s.findIndex(e=>n===e.id)>-1?s.map(s=>n===s.id?{...s,meta:{...s.meta,_logo:{...e,url:e.source_url}}}:s):s)}})};return(0,i.useEffect)(()=>{e({path:(0,a.addQueryArgs)("/wp/v2/brand",{per_page:100})},{onSuccess(e){_(e.map(e=>({...e,meta:{...e.meta,_theme_colors:e.meta._theme_colors?.length?e.meta._theme_colors:[],_menus:e.meta._menus?.length?e.meta._menus:[]}})))}})},[]),(0,u.jsx)(v.A,{isFetching:n,title:(0,t.__)("Additional Brands","newspack-plugin"),children:(0,u.jsx)(j.A,{children:(0,u.jsxs)(A,{children:[(0,u.jsx)(y,{exact:!0,path:m,render:()=>(0,u.jsx)(w,{...k,brands:r,deleteBrand:b})}),(0,u.jsx)(y,{path:`${m}/new`,render:()=>(0,u.jsx)(f,{...k,brands:r,upsertBrand:x,fetchLogoAttachment:L,wizardApiFetch:e})}),(0,u.jsx)(y,{path:`${m}/:brandId`,render:({match:n})=>(0,u.jsx)(f,{...k,brands:r,editBrand:Number(n.params.brandId),upsertBrand:x,fetchLogoAttachment:L,wizardApiFetch:e,errorMessage:l})})]})})})}},2005:(e,n,s)=>{s.d(n,{L:()=>u});var t=s(7143),a=s(8537),i=s(6087),l=s(3076),o=s(7153);function c(e){var n;return null!==(n=e.split("?").at(0))&&void 0!==n?n:e}let r={};const p=e=>{const n={message:"An unknown API error occurred.",statusCode:500,errorCode:"api_unknown_error",details:""};if(!e)return null;if("string"==typeof e)n.message=e;else if(e instanceof Error||"message"in e){var s,t,a;n.message=null!==(s=e.message)&&void 0!==s?s:n.message,n.statusCode=null!==(t=e.data?.status)&&void 0!==t?t:n.statusCode,n.errorCode=null!==(a=e.code)&&void 0!==a?a:n.errorCode,n.details=""}return new o.Ss(n.message,n.statusCode,n.errorCode,n.details)},d=e=>({on(n,s=null){const t=e?.[n];t&&"function"==typeof t&&t(s)}});function u(e){var n;const[s,o]=(0,i.useState)(!1),{wizardApiFetch:u,updateWizardSettings:_}=(0,t.useDispatch)(l.S),g=(0,t.useSelect)(n=>n(l.S).getWizardData(e),[e]),[h,w]=(0,i.useState)(null!==(n=g.error)&&void 0!==n?n:null),m=(0,i.useRef)([]);function k(){w(null)}return(0,i.useEffect)(()=>{_({slug:e,path:["error"],value:h})},[h,_,e]),{wizardApiFetch:(0,i.useCallback)(async(n,s)=>{const{on:t}=d(null!=s?s:{}),a=function(n){return(s,t,a=n)=>{const i=a?c(a):a;_({slug:e,path:[i,...Array.isArray(s)?s:[s]].filter(e=>"string"==typeof e),value:t})}}(n.path),{path:i,method:l="GET"}=n,h=c(null!=i?i:""),{isCached:k="GET"===l,updateCacheKey:x=null,updateCacheMethods:b=[],...f}=n,{error:v,[h]:{[l]:j=null}={}}=g;function C(e){if(k&&a(l,e),x&&x.constructor===Object){const[n,s]=Object.entries(x)[0],t=g[n][s];let i;i=t&&t.constructor===Object?{...t,...e}:e,a(Object.entries(x)[0],i,null)}for(const n of b)a(n,e);return t("onSuccess",e),e}function y(e){const n=p(e);throw w(n),t("onError",n),n}function A(){const{[h]:e,...n}=r;r=n,m.current=m.current.filter(e=>e!==h),o(m.current.length>0),t("onFinally")}return r[h]?(o(!0),r[h].then(C).catch(y).finally(A)):k&&(v||j)?(w(v),t("onSuccess",j),j):(o(!0),t("onStart"),m.current.push(h),r[h]=u({isQuietFetch:!0,isLocalError:!0,...f}).then(C).catch(y).finally(A),r[e])},[u,g,_,s,e]),isFetching:s,errorMessage:h?(0,a.decodeEntities)(h.message):null,error:h,cache:n=>({get:(e="GET")=>g[n][e],set(s,t="GET"){_({slug:e,path:[n,t],value:s})}}),setError(e){null===e?k():w(p(e))},resetError:k}}},4058:(e,n,s)=>{s.d(n,{A:()=>a});class t extends Error{constructor(e,n,s=""){super(e),this.name="WizardError",this.errorCode=n,this.details=s,Object.setPrototypeOf&&Object.setPrototypeOf(this,new.target.prototype)}toJSON(){return{name:this.name,message:this.message,errorCode:this.errorCode,details:this.details,stackTrace:this.stack}}}const a=t},5829:(e,n,s)=>{s.d(n,{A:()=>l});var t=s(7143),a=s(3076),i=s(790);const l=function({title:e,children:n,isFetching:s,description:l,...o}){const c=(0,t.useSelect)(e=>e(a.S).isLoading(),[]),r=o.className||"";return(0,i.jsxs)("div",{className:`${c||s?"is-fetching ":""}${r} newspack-wizard__sections`,children:[(0,i.jsx)("h1",{children:e}),l&&(0,i.jsx)("p",{className:"newspack-wizard__sections__description",children:l}),n]})}},6747:(e,n,s)=>{s.r(n),s.d(n,{default:()=>Tn});var t=s(7723),a=s(6087);const i=[["twitter",(0,t.__)("X (formerly Twitter) Handle","newspack-plugin"),(0,t.__)("username","newspack-plugin"),e=>0===e.length?"":e.length>15?(0,t.__)("X handle cannot exceed 15 characters!","newspack-plugin"):/^[a-zA-Z0-9_]+$/.test(e)?"":(0,t.__)("X handle may only contain letters, numbers, and underscores!","newspack-plugin")],["facebook",(0,t.__)("Facebook","newspack-plugin"),"https://facebook.com/page"],["instagram",(0,t.__)("Instagram","newspack-plugin"),"https://instagram.com/user"],["youtube",(0,t.__)("YouTube","newspack-plugin"),"https://youtube.com/c/channel"],["linkedin",(0,t.__)("LinkedIn","newspack-plugin"),"https://linkedin.com/user"],["pinterest",(0,t.__)("Pinterest","newspack-plugin"),"https://pinterest.com/user"]];var l=s(3984),o=s(790);const c=function({setData:e,data:n}){return(0,o.jsx)(l.xA,{columns:3,rowGap:16,children:i.map(([s,t,a])=>(0,o.jsx)(l.xt,{label:t,onChange:t=>e({...n,[s]:t}),value:n[s],placeholder:a},s))})};var r=s(5829),p=s(6427);const d=function({data:e,setData:n}){return(0,o.jsxs)(l.xA,{children:[(0,o.jsx)(l.xt,{label:"Google",onChange:s=>n({...e,google:s}),value:e.google,help:(0,o.jsxs)(a.Fragment,{children:[(0,t.__)("Get your verification code in","newspack")+" ",(0,o.jsx)(p.ExternalLink,{href:`https://search.google.com/search-console/ownership?resource_id=${encodeURIComponent(window.location.origin)}`,children:(0,t.__)("Google Search Console","newspack")})]})}),(0,o.jsx)(l.xt,{label:"Bing",onChange:s=>n({...e,bing:s}),value:e.bing,help:(0,o.jsxs)(a.Fragment,{children:[`${(0,t.__)("Get your verification code in","newspack")} `,(0,o.jsx)(p.ExternalLink,{href:"https://www.bing.com/toolbox/webmaster/#/Dashboard/",children:(0,t.__)("Bing Webmaster Tools","newspack")})]})})]})};var u=s(8721),_=s(6837),g=s(7153);const h={isId:(e,n=(0,t.__)("Field cannot be empty!","newspack-plugin"))=>/^[A-Za-z0-9_-]*$/.test(e)?"":n,isUrl:(e,n=(0,t.__)("Invalid URL!","newspack-plugin"))=>""===e||/^https?:\/\/[^\s]*$/.test(e)?"":n},w=function(e,n){const[s,t]=(0,a.useState)(null);return{isInputsValid(){for(const[s,a,i]of e){const e=n[s],l=("string"==typeof a?h[a]:a)(e,i?.message);if(""!==l)return t(new g.u(l,`invalid_field_${s.toString()}`)),!1}return t(null),!0},errorMessage:s instanceof g.u?s.message:""}};var m=s(2005);const k="/newspack/v1/wizard/newspack-settings/seo",x="newspack-settings",b={header_color:"custom",theme_colors:"default",primary_color_hex:"#003da5",secondary_color_hex:"#666666",font_header:"",font_body:"",accent_allcaps:!0,custom_font_import_code:void 0,custom_font_import_code_alternate:void 0,header_center_logo:!1,header_simplified:!1,header_solid_background:!1,header_color_hex:"#003da5",custom_logo:"",logo_size:0,header_text:!1,header_display_tagline:!1,footer_copyright:"",footer_color:"default",footer_color_hex:"",newspack_footer_logo:"",footer_logo_size:"medium",homepage_pattern_index:0,show_author_bio:!0,show_author_email:!1,author_bio_length:200,featured_image_default:"large",post_template_default:"default",featured_image_all_posts:"none",post_template_all_posts:"none",newspack_image_credits_placeholder_url:void 0,newspack_image_credits_class_name:"image-credit",newspack_image_credits_prefix_label:"Credit:",newspack_image_credits_placeholder:null,newspack_image_credits_auto_populate:!1,pwa_display_mode:"minimal-ui",custom_css_post_id:-1};var f=s(4058);const v=({title:e,description:n,namespace:s,path:i,defaultValue:c,fieldValidationMap:r,renderProp:p,onToggle:d=(e,n)=>({...n,active:e}),onChecked:u=e=>e.active})=>{const{wizardApiFetch:g,isFetching:h,errorMessage:w,setError:k,resetError:x}=(0,m.L)(s),[b,v]=(0,a.useState)({...c}),[j,C]=(0,a.useState)({...c}),y=function({setError:e}){return{isIntegerId(n){const s=n.trim();let a="";return""===s?a=(0,t.__)("Value cannot be empty!","newspack-plugin"):/^[0-9]+$/.test(s)?"0"===s&&(a=(0,t.__)("Value cannot be zero!","newspack-plugin")):a=(0,t.__)("Value may only contain numbers!","newspack-plugin"),a?(e(new f.A(a,"invalid_input_int_id")),!1):Number(s)>0},isId(n){let s="";return""===n.trim()?s=(0,t.__)("Value cannot be empty!","newspack-plugin"):/^[a-zA-Z0-9]+$/.test(n.trim())||(s=(0,t.__)("Value may only contain numbers and letters.","newspack-plugin")),!s||(e(new f.A(s,"invalid_input_id")),!1)}}}({setError:k});(0,a.useEffect)(()=>{g({path:i},{onSuccess:e=>{v(e),C(e)}})},[]);const A=(0,a.useCallback)((e,n=!1)=>{if(x(),!n)for(const[e,n]of r){if(n.dependsOn){const[[e,s]]=Object.entries(n.dependsOn);if(j[e]!==s)continue}if("string"==typeof n.callback){if(!y[n.callback](j[e]))return}else if("function"==typeof n.callback){const s=n.callback(j[e]);if(s)return void k(new f.A(s,`invalid_${e.toString()}`))}}g({path:i,method:"POST",data:e,updateCacheMethods:["GET"]},{onSuccess:e=>{v(e),C(e)}})},[r,y,x,j,g]);return(()=>{const s=u(j);return(0,o.jsx)(_.A,{title:e,description:h&&!s?(0,t.__)("Loading…","newspack-plugin"):n,hasGreyHeader:s,actionContent:s&&(0,o.jsx)(l.$n,{variant:"primary",disabled:h,onClick:()=>A(j),children:h?(0,t.__)("Loading…","newspack-plugin"):(0,t.__)("Save Settings","newspack-plugin")}),error:w,disabled:h,toggleOnChange:e=>{A(d(e,j),!0)},toggleChecked:s,children:s&&(0,o.jsx)(a.Fragment,{children:(0,o.jsx)(l.xA,{noMargin:!0,rowGap:16,columns:1,children:p({settingsUpdates:j,setSettingsUpdates:C,isFetching:h})})})})})()},j=()=>(0,o.jsx)(v,{title:(0,t.__)("X Pixel","newspack-plugin"),namespace:`${x}/social/pixel/x`,description:(0,t.__)("Add the X pixel (formerly known as Twitter pixel) to your site.","newspack-plugin"),path:"/newspack/v1/wizard/newspack-settings/social/x_pixel",defaultValue:{active:!1,pixel_id:""},fieldValidationMap:[["pixel_id",{callback:"isId"}]],renderProp:({settingsUpdates:e,setSettingsUpdates:n,isFetching:s})=>{var i;return(0,o.jsx)(l.xt,{value:null!==(i=e?.pixel_id)&&void 0!==i?i:"",label:(0,t.__)("Pixel ID","newspack-plugin"),onChange:s=>n({...e,pixel_id:s}),help:(0,a.createInterpolateElement)((0,t.__)("The X Pixel ID. You only need to add the number, not the full code. Example: 123456789123456789. You can get this information <linkToFb>here</linkToFb>.","newspack-plugin"),{linkToFb:(0,o.jsx)("a",{href:"https://www.facebook.com/ads/manager/pixel/facebook_pixel",target:"_blank",rel:"noopener noreferrer"})}),disabled:s,autoComplete:"one-time-code"})}}),C=()=>(0,o.jsx)(v,{title:(0,t.__)("Meta Pixel","newspack-plugin"),namespace:`${x}/social/pixels/meta`,description:(0,t.__)("Add the Meta pixel (formerly known as Facebook pixel) to your site.","newspack-plugin"),path:"/newspack/v1/wizard/newspack-settings/social/meta_pixel",defaultValue:{active:!1,pixel_id:""},fieldValidationMap:[["pixel_id",{callback:"isIntegerId"}]],renderProp:({settingsUpdates:e,setSettingsUpdates:n,isFetching:s})=>{var i;return(0,o.jsx)(l.xt,{value:null!==(i=e?.pixel_id)&&void 0!==i?i:"",label:(0,t.__)("Pixel ID","newspack-plugin"),onChange:s=>n({...e,pixel_id:s}),help:(0,a.createInterpolateElement)((0,t.__)("The Meta Pixel ID. You only need to add the number, not the full code. Example: 123456789123456789. You can get this information <linkToFb>here</linkToFb>.","newspack-plugin"),{linkToFb:(0,o.jsx)("a",{href:"https://www.facebook.com/ads/manager/pixel/facebook_pixel",target:"_blank",rel:"noopener noreferrer"})}),disabled:s,autoComplete:"one-time-code"})}});var y=s(1455),A=s.n(y);const S=function({path:e,apiNamespace:n,refreshOn:s=[],data:i,description:o}){const[c,r]=(0,a.useState)(i),[p,d]=(0,a.useState)(null),{wizardApiFetch:u,isFetching:_,errorMessage:g}=(0,m.L)(n);function h(n,i){const l="boolean"==typeof i&&i?"POST":"GET",o={path:e,method:l};n&&(o.data=n),u(o,{onSuccess:r,onFinally(){s.includes(l)&&(d((0,a.createElement)("span",{className:"gray"},(0,t.__)("Page reloading…","newspack-plugin"))),g||window.location.reload())}})}return(0,a.useEffect)(()=>{h()},[]),{actionText:_?(0,a.createElement)(l.E$):p,apiData:c,apiFetchToggle:h,description:_?(0,t.__)("Loading…","newspack-plugin"):o,errorMessage:g,isFetching:_}},E=({settings:e,status:n,error:s,updateSettings:i,startOAuthFlow:c,claimPage:r,disconnect:d,setError:u})=>{const[_,g]=(0,a.useState)(e.client_id||""),[h,w]=(0,a.useState)(e.client_secret||""),[m,k]=(0,a.useState)(""),[x,b]=(0,a.useState)("US"),[f,v]=(0,a.useState)(e.publication_url||""),[j,C]=(0,a.useState)(!1),[y,A]=(0,a.useState)(1),S=window.newspackSettings?.social?.nextdoor?.country_options||[],E=window.newspackSettings?.social?.nextdoor?.redirect_uri||"";return(0,a.useEffect)(()=>{"1"===new URLSearchParams(window.location.search).get("oauth_success")&&(A(3),u(null))},[]),(0,a.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("nextdoor_oauth_error");e&&u(decodeURIComponent(e))},[]),(0,a.useEffect)(()=>{n.is_connected?A(4):n.has_tokens?A(3):n.has_credentials?A(2):A(1)},[n]),(0,o.jsxs)(o.Fragment,{children:[s&&(0,o.jsx)(l.$T,{noticeText:s,isError:!0,onClose:()=>u(null)}),1===y&&(0,o.jsxs)(l.Zp,{children:[(0,o.jsx)("p",{children:(0,t.__)("To get started, you need to register your site with Nextdoor and obtain API credentials.","newspack-plugin")}),(0,o.jsxs)("div",{className:"nextdoor-onboarding__redirect-uri-box",children:[(0,o.jsx)("strong",{children:(0,t.__)("Redirect URI:","newspack-plugin")}),(0,o.jsx)("br",{}),(0,o.jsx)("div",{className:"nextdoor-onboarding__redirect-uri-container",children:(0,o.jsx)("code",{className:"nextdoor-onboarding__redirect-uri-code",children:E})}),(0,o.jsx)("small",{className:"nextdoor-onboarding__redirect-uri-help",children:(0,t.__)("Use this URL as the Redirect URI when signing up for Nextdoor credentials.","newspack-plugin")})]}),(0,o.jsx)("p",{children:(0,o.jsx)(p.ExternalLink,{href:"https://developer.nextdoor.com/reference/applying-for-access",children:(0,t.__)("Get your API credentials from Nextdoor Developer Portal","newspack-plugin")})}),(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.xt,{label:(0,t.__)("Client ID","newspack-plugin"),value:_,onChange:g,placeholder:(0,t.__)("Enter your Nextdoor Client ID","newspack-plugin")}),(0,o.jsx)(l.xt,{label:(0,t.__)("Client Secret","newspack-plugin"),value:h,onChange:w,type:"password",placeholder:(0,t.__)("Enter your Nextdoor Client Secret","newspack-plugin")})]}),(0,o.jsx)("div",{className:"newspack-buttons-card",children:(0,o.jsx)(l.$n,{variant:"primary",onClick:async()=>{if(_&&h)try{C(!0),u(null),await i({client_id:_,client_secret:h}),A(2)}finally{C(!1)}else u((0,t.__)("Please enter both Client ID and Client Secret.","newspack-plugin"))},disabled:!_||!h||j,isBusy:j,children:(0,t.__)("Save & Continue","newspack-plugin")})})]}),2===y&&(0,o.jsxs)(l.Zp,{children:[(0,o.jsx)("p",{children:(0,t.__)("Connect your Nextdoor account to authorize publishing articles.","newspack-plugin")}),(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.xt,{label:(0,t.__)("Email Address","newspack-plugin"),value:m,onChange:k,type:"email",placeholder:(0,t.__)("Enter your Nextdoor account email","newspack-plugin"),help:(0,t.__)("This should be the email address associated with your Nextdoor account.","newspack-plugin")}),(0,o.jsx)(l.Yq,{label:(0,t.__)("Country","newspack-plugin"),value:x,onChange:b,options:S})]}),(0,o.jsxs)("div",{className:"newspack-buttons-card",children:[(0,o.jsx)(l.$n,{variant:"primary",onClick:async()=>{if(m)try{var e;C(!0),u(null);const n=await c(m,x);window.location.href=null!==(e=n.login_url)&&void 0!==e?e:window.location.href}finally{C(!1)}else u((0,t.__)("Please enter your email address.","newspack-plugin"))},disabled:!m||j,isBusy:j,children:(0,t.__)("Connect Account","newspack-plugin")}),(0,o.jsx)(l.$n,{variant:"secondary",onClick:()=>A(1),children:(0,t.__)("Back","newspack-plugin")})]})]}),3===y&&(0,o.jsxs)(l.Zp,{children:[(0,o.jsx)("p",{children:(0,t.__)("Claim your news page on Nextdoor to start publishing articles.","newspack-plugin")}),(0,o.jsx)(l.xA,{columns:1,gutter:16,children:(0,o.jsx)(l.xt,{label:(0,t.__)("Publication URL","newspack-plugin"),value:f,onChange:v,type:"url",placeholder:(0,t.__)("https://yoursite.com","newspack-plugin"),help:(0,t.__)("The main URL of your news publication.","newspack-plugin")})}),(0,o.jsxs)("div",{className:"newspack-buttons-card",children:[(0,o.jsx)(l.$n,{variant:"primary",onClick:async()=>{if(f)try{C(!0),u(null),(await r(f)).success?window.location.reload():u((0,t.__)("Failed to claim page.","newspack-plugin"))}finally{C(!1)}else u((0,t.__)("Please enter your publication URL.","newspack-plugin"))},disabled:!f||j,isBusy:j,children:(0,t.__)("Claim Page","newspack-plugin")}),(0,o.jsx)(l.$n,{variant:"secondary",onClick:()=>A(2),children:(0,t.__)("Back","newspack-plugin")})]})]}),4===y&&n.is_connected&&(0,o.jsx)(l.Lz,{title:(0,t.__)("Nextdoor Connected Successfully!","newspack-plugin"),description:(0,t.__)("Your site is now connected to Nextdoor. You can start publishing articles to your local community.","newspack-plugin"),actionText:(0,t.__)("Configure Settings","newspack-plugin"),handoff:"settings",editLink:"#/settings",hasGreyHeader:!1}),y>1&&(0,o.jsxs)(l.Zp,{children:[(0,o.jsxs)(l.xA,{columns:2,gutter:16,children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"nextdoor-onboarding__status-label",children:(0,t.__)("API Credentials:","newspack-plugin")}),n.has_credentials?(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--success",children:(0,t.__)("Configured","newspack-plugin")}):(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--error",children:(0,t.__)("Not configured","newspack-plugin")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"nextdoor-onboarding__status-label",children:(0,t.__)("Account Connected:","newspack-plugin")}),n.has_tokens?(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--success",children:(0,t.__)("Yes","newspack-plugin")}):(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--error",children:(0,t.__)("No","newspack-plugin")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"nextdoor-onboarding__status-label",children:(0,t.__)("Page Claimed:","newspack-plugin")}),n.has_page?(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--success",children:(0,t.__)("Yes","newspack-plugin")}):(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--error",children:(0,t.__)("No","newspack-plugin")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"nextdoor-onboarding__status-label",children:(0,t.__)("Overall Status:","newspack-plugin")}),n.is_connected?(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--success",children:(0,t.__)("Connected","newspack-plugin")}):(0,o.jsx)("span",{className:"nextdoor-onboarding__status-value nextdoor-onboarding__status-value--error",children:(0,t.__)("Not connected","newspack-plugin")})]})]}),n.is_connected&&(0,o.jsx)("div",{className:"newspack-buttons-card",children:(0,o.jsx)(l.$n,{isDestructive:!0,onClick:async()=>{try{C(!0),u(null),await d(),A(1)}finally{C(!1)}},disabled:j,isBusy:j,children:(0,t.__)("Disconnect","newspack-plugin")})})]})]})},T=({settings:e,status:n,error:s,updateSettings:i,disconnect:c,setError:r})=>{const[d,u]=(0,a.useState)(e.allowed_roles||[]),[_,g]=(0,a.useState)(!1),[h,w]=(0,a.useState)(!1),m=window.newspackSettings?.social?.nextdoor?.available_roles||[];return(0,a.useEffect)(()=>{u(e.allowed_roles||[])},[e]),n.is_connected?(0,o.jsxs)(o.Fragment,{children:[s&&(0,o.jsx)(l.$T,{noticeText:s,isError:!0,onClose:()=>r(null)}),(0,o.jsxs)(l.Zp,{children:[(0,o.jsx)(p.CardHeader,{children:(0,o.jsx)(p.__experimentalHeading,{level:4,children:(0,t.__)("Connection Information","newspack-plugin")})}),(0,o.jsxs)(p.CardBody,{children:[(0,o.jsxs)(l.xA,{columns:2,gutter:16,children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("strong",{children:[(0,t.__)("Status:","newspack-plugin")," "]}),n.is_connected?(0,o.jsx)("span",{className:"nextdoor-settings__status-value--success",children:(0,t.__)("Connected","newspack-plugin")}):(0,o.jsx)("span",{className:"nextdoor-settings__status-value--error",children:(0,t.__)("Not Connected","newspack-plugin")})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("strong",{children:[(0,t.__)("Token:","newspack-plugin")," "]}),n.token_valid?(0,o.jsx)("span",{className:"nextdoor-settings__status-value--success",children:(0,t.__)("Valid","newspack-plugin")}):(0,o.jsx)("span",{className:"nextdoor-settings__status-value--error",children:(0,t.__)("Invalid or expired","newspack-plugin")})]})]}),n.is_connected&&(0,o.jsx)("div",{className:"newspack-buttons-card",children:(0,o.jsx)(l.$n,{variant:"secondary",isDestructive:!0,onClick:async()=>{await c()},children:(0,t.__)("Disconnect","newspack-plugin")})})]})]}),(0,o.jsxs)(l.Zp,{children:[(0,o.jsx)(p.CardHeader,{children:(0,o.jsx)(p.__experimentalHeading,{level:4,children:(0,t.__)("Settings","newspack-plugin")})}),(0,o.jsxs)(p.CardBody,{children:[(0,o.jsx)("p",{children:(0,t.__)("Select which user roles are allowed to publish articles to Nextdoor.","newspack-plugin")}),(0,o.jsx)(l.xA,{columns:4,gutter:16,children:m.map(({label:e,value:n})=>(0,o.jsx)(p.CheckboxControl,{label:e,checked:d.includes(n)||"administrator"===n,onChange:e=>((e,n)=>{w(!0),u(n?[...d,e]:d.filter(n=>n!==e))})(n,e),disabled:"administrator"===n,help:"administrator"===n?(0,t.__)("Administrators always have publishing permissions.","newspack-plugin"):void 0},n))}),(0,o.jsx)("div",{className:"newspack-buttons-card",children:(0,o.jsx)(l.$n,{variant:"primary",onClick:async()=>{try{g(!0),r(null),await i({allowed_roles:d}),w(!1)}finally{g(!1)}},disabled:!h||_,isBusy:_,children:(0,t.__)("Save","newspack-plugin")})})]})]})]}):(0,o.jsx)(l.Zp,{children:(0,o.jsx)(l.$T,{noticeText:(0,t.__)("Nextdoor is not connected. Please complete the setup process first.","newspack-plugin"),isError:!1})})},L=function(){const[e,n]=(0,a.useState)({client_id:"",client_secret:"",publication_url:"",allowed_roles:[]}),[s,i]=(0,a.useState)({is_connected:!1,has_credentials:!1,has_tokens:!1,has_page:!1,token_valid:!1}),[l,c]=(0,a.useState)(null),{description:r,apiData:p,isFetching:d,actionText:u,apiFetchToggle:g,errorMessage:h}=S({path:"/newspack/v1/wizard/newspack-settings/social/nextdoor",apiNamespace:"newspack-settings/social/nextdoor",data:{module_enabled_nextdoor:!1,is_connected:!1,connection_status:{is_connected:!1,has_credentials:!1,has_tokens:!1,has_page:!1,token_valid:!1},settings:{client_id:"",client_secret:"",publication_url:"",allowed_roles:[]}},description:(0,t.__)("Enable publishers to easily connect their Nextdoor account to Newspack and share posts directly to their Nextdoor community.","newspack-plugin")});(0,a.useEffect)(()=>{p.connection_status&&(i(p.connection_status),n({...e,allowed_roles:p.settings.allowed_roles}))},[p]);const w=async s=>{try{c(null);const t=await A()({path:"/newspack/v1/wizard/newspack-settings/social/nextdoor",method:"POST",data:s});if(t.settings){const s={...e,...t.settings};return n(s),s}return e}catch(e){const n=e instanceof Object&&"message"in e?e.message:(0,t.__)("Failed to update settings.","newspack-plugin");throw c(n),new Error(n)}},m=async()=>{try{c(null),await A()({path:"/newspack/v1/nextdoor/disconnect",method:"DELETE"}),k(!0)}catch(e){const n=e instanceof Object&&"message"in e?e.message:(0,t.__)("Failed to disconnect.","newspack-plugin");throw c(n),new Error(n)}},k=e=>{g({...p,module_enabled_nextdoor:e},!0)};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(_.A,{title:(0,t.__)("Nextdoor Integration","newspack-plugin"),description:d?(0,t.__)("Loading…","newspack-plugin"):p.module_enabled_nextdoor?p.is_connected?(0,t.__)("Nextdoor integration is enabled and connected.","newspack-plugin"):(0,t.__)("Nextdoor integration is enabled but not connected. Complete the setup to start sharing posts.","newspack-plugin"):r,disabled:d,actionText:u,error:h,toggleChecked:p.module_enabled_nextdoor,toggleOnChange:k,children:p.module_enabled_nextdoor&&(0,o.jsx)(o.Fragment,{children:p.is_connected?(0,o.jsx)(T,{settings:e,status:s,error:l,updateSettings:w,setError:c,disconnect:m}):(0,o.jsx)(E,{settings:e,status:s,error:l,updateSettings:w,startOAuthFlow:async(e,n)=>{try{return c(null),await A()({path:"/newspack/v1/nextdoor/oauth/start",method:"POST",data:{email:e,country:n}})}catch(e){const n=e instanceof Object&&"message"in e?e.message:(0,t.__)("Failed to start OAuth flow.","newspack-plugin");throw c(n),new Error(n)}},claimPage:async(e,n=!1)=>{try{return c(null),await A()({path:"/newspack/v1/nextdoor/claim-page",method:"POST",data:{publication_url:e,test:n}})}catch(e){const n=e instanceof Object&&"message"in e?e.message:(0,t.__)("Failed to claim page.","newspack-plugin");throw c(n),new Error(n)}},disconnect:m,setError:c})})})})};function N(e,n="",s,t){return s({path:n?`/newspack/v1/plugins/${e}/${n}`:`/newspack/v1/plugins/${e}`,method:n?"POST":"GET"},t)}function P({isLoading:e,isSetup:n,isActive:s,isInstalled:a,isConfigurable:i,onActivate:c,onInstall:r,onConfigure:p,actionText:d={},...u}){if("page-reload"===u.status)return(0,o.jsx)("span",{className:"gray",children:(0,t.__)("Page reloading…","newspack-plugin")});if("page-redirect"===u.status)return(0,o.jsx)("span",{className:"gray",children:(0,t.__)("Page redirecting…","newspack-plugin")});if(e)return(0,o.jsx)(l.E$,{});var _,g,h;if(!a)return(0,o.jsx)(l.$n,{isLink:!0,onClick:r,children:null!==(_=d.install)&&void 0!==_?_:(0,t.sprintf)(/* translators: %s: Plugin name */ /* translators: %s: Plugin name */
(0,t.__)("Install %s","newspack-plugin"),u.title)});if(!s)return(0,o.jsx)(l.$n,{isLink:!0,onClick:c,children:null!==(g=d.activate)&&void 0!==g?g:(0,t.sprintf)(/* translators: %s: Plugin name */ /* translators: %s: Plugin name */
(0,t.__)("Activate %s","newspack-plugin"),u.title)});if(!n){var w,m;if(i)return(0,o.jsx)(l.$n,{isLink:!0,onClick:p,children:null!==(w=d.configure)&&void 0!==w?w:(0,t.sprintf)(/* translators: %s: Plugin name */ /* translators: %s: Plugin name */
(0,t.__)("Configure %s","newspack-plugin"),u.title)});if(u.editLink)return(0,o.jsx)("a",{href:u.editLink,children:null!==(m=d.complete)&&void 0!==m?m:(0,t.__)("Complete Setup","newspack-plugin")})}return u.editLink?(0,o.jsx)("a",{href:u.editLink,children:null!==(h=d.configure)&&void 0!==h?h:(0,t.__)("Configure","newspack-plugin")}):null}const M=function({slug:e,title:n,subTitle:s,editLink:i,description:c,statusDescription:r,onStatusChange:p=()=>{},reloadOnActivation:d=!0,isStatusPrepended:u=!0,isConfigurable:g,isTogglable:h,actionText:w={},...k}){var x;const{wizardApiFetch:b,errorMessage:f,isFetching:v}=(0,m.L)(`/newspack/wizards/plugins/${e}`),[j,C]=l.JL.useObjectState({slug:e,status:"",statusDescription:r,configured:!1}),y={isSetup:"active"===j.status&&j.configured,isActive:"active"===j.status,isLoading:!j.status,isInstalled:"uninstalled"!==j.status,isConfigured:j.configured,isError:Boolean(f)},A={init:e=>N(j.slug,void 0,b,e),activate:e=>N(j.slug,"activate",b,e),deactivate:e=>N(j.slug,"deactivate",b,e),install:e=>N(j.slug,"install",b,e),configure:e=>N(j.slug,"configure",b,e)};function S(e){const n=(d?["activate","deactivate"]:["deactivate"]).includes(e);C({status:""}),A[e]({onSuccess(e){let s=e.Status;n&&(s="page-reload"),C({status:s,configured:e.Configured})},onFinally(){n&&!f&&window.location.reload(),i&&"configure"===e&&(window.location.href=i,C({status:"page-redirect"}))}})}function E(){S("activate")}(0,a.useEffect)(()=>{S("init")},[]),(0,a.useEffect)(()=>{p(y)},[y]);const T={};return h&&(T.toggleChecked=y.isActive,T.toggleOnChange=()=>y.isActive?void S("deactivate"):E(),T.disabled=v),(0,o.jsx)(_.A,{title:`${n}${s?`: ${s}`:""}`,description:function(){if(y.isError)return(0,t.__)("Status: Error!","newspack-plugin");if(y.isLoading)return(0,t.__)("Loading…","newspack-plugin");const e=null!=c?c:"";let n="";var s;if(y.isInstalled)if(y.isActive)if(y.isConfigured){var a;n=null!==(a=j.statusDescription?.connected)&&void 0!==a?a:(0,t.__)("Connected.","newspack-plugin")}else{var i;n=null!==(i=j.statusDescription?.notConfigured)&&void 0!==i?i:(0,t.__)("Not connected.","newspack-plugin")}else{var l;n=null!==(l=j.statusDescription?.inactive)&&void 0!==l?l:(0,t.__)("Inactive.","newspack-plugin")}else n=null!==(s=j.statusDescription?.uninstalled)&&void 0!==s?s:(0,t.__)("Uninstalled.","newspack-plugin");return(0,o.jsxs)(o.Fragment,{children:[u&&(0,t.sprintf)(
// Translators: %s: Plugin status
// Translators: %s: Plugin status
(0,t.__)("Status: %s","newspack-plugin"),n)," ",e]})},className:`wizards-plugin-card ${e}`,actionText:y.isError?null:(0,o.jsx)(P,{title:n,editLink:i,onActivate:E,actionText:w,isConfigurable:g,onInstall:()=>S("activate"),onConfigure:()=>S("configure"),...y,...j}),isChecked:y.isSetup,error:null!==(x=k.error)&&void 0!==x?x:f,...k,...T})},F=function(){return(0,o.jsx)(M,{title:(0,t.__)("Publicize","newspack-plugin"),badge:(0,t.__)("Jetpack","newspack-plugin"),slug:"jetpack",description:(0,t.__)("Publicize makes it easy to share your site's posts on several social media networks automatically when you publish a new post.","newspack-plugin"),actionText:{complete:(0,t.__)("Configure","newspack-plugin"),activate:(0,t.__)("Activate Jetpack","newspack-plugin")},editLink:"admin.php?page=jetpack#/sharing"})},I=()=>{const e=window.newspackSettings.emails.sections,n=e.emails.postType,[s,i]=(0,a.useState)(e.emails.dependencies.newspackNewsletters),{wizardApiFetch:c,isFetching:r,errorMessage:p,resetError:d}=(0,m.L)("newspack-settings/emails"),[u,g]=(0,a.useState)(Object.values(e.emails.all));return!1===s?(0,o.jsxs)(a.Fragment,{children:[(0,o.jsxs)(l.$T,{isError:!0,children:[(0,t.__)("Newspack uses Newspack Newsletters to handle editing email-type content. Please activate this plugin to proceed.","newspack-plugin"),(0,o.jsx)("br",{}),(0,t.__)("Until this feature is configured, default receipts will be used.","newspack-plugin")]}),(0,o.jsx)(M,{slug:"newspack-newsletters",title:(0,t.__)("Newspack Newsletters","newspack-plugin"),description:(0,t.__)("Newspack Newsletters is the plugin that powers Newspack email receipts.","newspack-plugin"),onStatusChange:e=>{e.isLoading||i(e.isSetup)}})]}):(0,o.jsx)(a.Fragment,{children:u.map(e=>{const s="publish"===e.status,a="reader-activation"===e.category;let i=(0,t.__)("This email is not active.","newspack-plugin");return"receipt"===e.type&&(i=(0,t.__)("This email is not active. The default receipt will be used.","newspack-plugin")),"welcome"===e.type&&(i=(0,t.__)("This email is not active. The receipt template will be used if active.","newspack-plugin")),(0,o.jsx)(_.A,{isSmall:!0,disabled:r,title:e.label,titleLink:e.edit_link,href:e.edit_link,description:e.description,actionText:(0,t.__)("Edit","newspack-plugin"),secondaryActionText:(0,t.__)("Reset","newspack-plugin"),onSecondaryActionClick:()=>{var n;l.Wp.confirmAction((0,t.__)("Are you sure you want to reset the contents of this email?","newspack-plugin"))&&(n=e.post_id,c({path:`/newspack/v1/wizard/newspack-audience-donations/emails/${n}`,method:"DELETE"},{onSuccess(e){window.newspackSettings.emails.sections.emails.all=e,g(Object.values(e))}}))},secondaryDestructive:!0,...a?{}:{toggleChecked:s,toggleOnChange:s=>{return t=e.post_id,void c({path:`/wp/v2/${n}/${t}`,method:"POST",data:{status:a=s?"publish":"draft"}},{onStart(){d()},onSuccess(){g(u.map(e=>e.post_id===t?{...e,status:a}:e))}});var t,a}},...s?{}:{notification:i,notificationLevel:"info"},children:p&&(0,o.jsx)(l.$T,{noticeText:p||(0,t.__)("Something went wrong.","newspack-plugin"),isError:!0})},e.post_id)})})};var O=s(7143),z=s(5186),$=s(3076);const H="newspack-settings/emails",V=()=>{const{enable_woocommerce_email_editor:e,admin_url:n}=(0,z.l)(H),{saveWizardSettings:s}=(0,O.useDispatch)($.S);if("boolean"!=typeof e||!n)return null;const i=(0,t.__)("Use WooCommerce's block email editor (alpha)","newspack-plugin"),c=(0,t.__)("Enable the block-based email editor for transacitonal emails","newspack-plugin");return(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(l.X3,{heading:3,title:(0,t.__)("Transactional emails","newspack-plugin")}),(0,o.jsx)(_.A,{isSmall:!0,href:n,title:i,titleLink:n,description:c,actionText:(0,t.__)("Edit emails","newspack-plugin"),toggleChecked:e,toggleOnChange:()=>{s({slug:H,updatePayload:{path:["enable_woocommerce_email_editor"],value:!e}})}},"enable_woocommerce_email_editor")]})},{emails:D}=window.newspackSettings,{plugins:R,analytics:B}=window.newspackSettings.connections.sections,G={jetpack:{slug:"jetpack",title:(0,t.__)("Jetpack","newspack-plugin"),editLink:"admin.php?page=jetpack#/settings"},"google-site-kit":{slug:"google-site-kit",editLink:B.editLink,title:(0,t.__)("Site Kit by Google","newspack-plugin"),statusDescription:{notConfigured:(0,t.__)("Not connected for this user","newspack-plugin")}},everlit:{slug:"everlit",editLink:"admin.php?page=everlit_settings",title:(0,t.__)("Everlit","newspack-plugin"),subTitle:(0,t.__)("AI-Generated Audio Stories","newspack-plugin"),description:(0,o.jsxs)(o.Fragment,{children:[(0,t.__)("Complete setup and licensing agreement to unlock 5 free audio stories per month.","newspack-plugin")," ",(0,o.jsx)("a",{href:"https://everlit.audio/",target:"_blank",rel:"noreferrer",children:(0,t.__)("Learn more","newspack-plugin")})]}),statusDescription:{uninstalled:(0,t.__)("Not installed.","newspack-plugin"),inactive:(0,t.__)("Inactive.","newspack-plugin"),notConfigured:(0,t.__)("Pending.","newspack-plugin")}}},U=function(){const e=Object.keys(G).reduce((e,n)=>{var s;return e[n]={...G[n],isEnabled:null===(s=R.enabled?.[n])||void 0===s||s},e},{});return(0,o.jsx)(a.Fragment,{children:Object.keys(e).map(n=>e[n].isEnabled&&(0,o.jsx)(M,{...e[n]},n))})},Z={"/newspack/v1/webhooks/endpoints":"GET"};var q=s(5573),Y=(0,o.jsx)(q.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,o.jsx)(q.Path,{d:"M7 7.2h8.2L13.5 9l1.1 1.1 3.6-3.6-3.5-4-1.1 1 1.9 2.3H7c-.9 0-1.7.3-2.3.9-1.4 1.5-1.4 4.2-1.4 5.6v.2h1.5v-.3c0-1.1 0-3.5 1-4.5.3-.3.7-.5 1.2-.5zm13.8 4V11h-1.5v.3c0 1.1 0 3.5-1 4.5-.3.3-.7.5-1.3.5H8.8l1.7-1.7-1.1-1.1L5.9 17l3.5 4 1.1-1-1.9-2.3H17c.9 0 1.7-.3 2.3-.9 1.5-1.4 1.5-4.2 1.5-5.6z"})}),W=s(8351),K=s(4707),X=s(9214);function J(e){let n=e.slice(8);return e.length>45&&(n=`${e.slice(8,38)}...${e.slice(-10)}`),n}function Q(e){const{label:n,url:s}=e;return n||J(s)}function ee(e){const{label:n,url:s}=e;return(0,o.jsxs)(a.Fragment,{children:[n&&(0,o.jsxs)("span",{className:"newspack-webhooks__endpoint__label",children:[n,": "]}),(0,o.jsx)("span",{className:"newspack-webhooks__endpoint__url",children:J(s)})]})}function ne(e){return e.requests.some(e=>e.errors.length)}function se(e){if(!e)return(0,t.__)("URL is required.","newspack-plugin");try{return"https:"!==new URL(e).protocol&&(0,t.__)("HTTPS protocol is required for the endpoint URL.","newspack-plugin")}catch(e){return(0,t.__)("Invalid URL format.","newspack-plugin")}}var te=s(8558),ae=s(8169);const ie=function({endpoint:e,disabled:n,isSystem:s,setAction:i}){const[l,c]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{c(!1)},[n]),(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(p.Button,{className:l?"popover-active":"",onClick:()=>c(!l),icon:ae.A,disabled:n,label:(0,t.__)("Endpoint Actions","newspack-plugin"),tooltipPosition:"bottom left"}),l&&(0,o.jsxs)(p.Popover,{position:"bottom left",onFocusOutside:()=>c(!1),onKeyDown:e=>te.ESCAPE===e.keyCode&&c(!1),children:[(0,o.jsx)(p.MenuItem,{onClick:()=>c(!1),className:"screen-reader-text",children:(0,t.__)("Close Endpoint Actions","newspack-plugin")}),(0,o.jsx)(p.MenuItem,{onClick:()=>i("view",e.id),className:"newspack-button",children:(0,t.__)("View Requests","newspack-plugin")}),!s&&(0,o.jsx)(p.MenuItem,{onClick:()=>i("edit",e.id),className:"newspack-button",children:(0,t.__)("Edit","newspack-plugin")}),!s&&(0,o.jsx)(p.MenuItem,{onClick:()=>i("delete",e.id),className:"newspack-button",isDestructive:!0,children:(0,t.__)("Remove","newspack-plugin")})]})]})},le=function({endpoint:e,setAction:n}){return(0,o.jsx)(_.A,{isMedium:!0,className:"newspack-webhooks__endpoint mt16",toggleChecked:!e.disabled,toggleOnChange:()=>n("toggle",e.id),title:ee(e),description:()=>e.disabled&&e.disabled_error?`${(0,t.__)("Endpoint disabled due to error","newspack-plugin")}: ${e.disabled_error}`:(0,o.jsxs)(a.Fragment,{children:[(0,t.__)("Actions:","newspack-plugin")," ",e.actions.map(e=>(0,o.jsx)("span",{className:"newspack-webhooks__endpoint-action",children:e},e))]}),actionText:(0,o.jsx)(ie,{endpoint:e,setAction:n,isSystem:e.system})},e.id)};var oe=s(6154),ce=s.n(oe);const re=({endpoint:e,setAction:n})=>(0,o.jsxs)(l.aF,{title:(0,t.__)("Latest Requests","newspack-plugin"),onRequestClose:()=>n(null,e.id),children:[(0,o.jsx)("p",{children:(0,t.sprintf)(
// translators: %s is the endpoint title (shortened URL).
// translators: %s is the endpoint title (shortened URL).
(0,t.__)("Most recent requests for %s","newspack-plugin"),Q(e))}),e.requests.length>0?(0,o.jsxs)("table",{className:"newspack-webhooks__requests "+(ne(e)?"has-error":""),children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{}),(0,o.jsx)("th",{colSpan:2,children:(0,t.__)("Action","newspack-plugin")}),ne(e)&&(0,o.jsx)("th",{colSpan:2,children:(0,t.__)("Error","newspack-plugin")})]}),e.requests.map(n=>{return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:`status status--${n.status}`,children:(0,o.jsx)(p.Icon,{icon:(s=n.status,{pending:Y,finished:W.A,killed:K.A}[s]||X.A)})}),(0,o.jsx)("td",{className:"action-name",children:n.action_name}),(0,o.jsx)("td",{className:"scheduled",children:"pending"===n.status?(0,t.sprintf)(
// translators: %s is a human-readable time difference.
// translators: %s is a human-readable time difference.
(0,t.__)("sending in %s","newspack-plugin"),ce()(1e3*parseInt(n.scheduled)).fromNow(!0)):(0,t.sprintf)(
// translators: %s is a human-readable time difference.
// translators: %s is a human-readable time difference.
(0,t.__)("processed %s","newspack-plugin"),ce()(1e3*parseInt(n.scheduled)).fromNow())}),ne(e)&&(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)("td",{className:"error",children:n.errors&&n.errors.length>0?n.errors[n.errors.length-1]:"--"}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{className:"error-count",children:(0,t.sprintf)(
// translators: %s is the number of errors.
// translators: %s is the number of errors.
(0,t.__)("Attempt #%s","newspack-plugin"),n.errors.length)})})]})]},n.id);var s})]}):(0,o.jsx)(l.$T,{noticeText:(0,t.__)("This endpoint hasn't received any requests yet.","newspack-plugin")})]}),pe=({...e})=>(0,o.jsx)(p.CheckboxControl,{...e}),de=({endpoint:e,actions:n,errorMessage:s=null,inFlight:i=!1,setError:c,setAction:r,setEndpoints:d,wizardApiFetch:u})=>{var _;const[h,w]=(0,a.useState)(e),[m,k]=(0,a.useState)({}),x=(0,a.useRef)(null);return(0,a.useEffect)(()=>{s&&x?.current?.querySelector(".components-modal__content")?.scrollTo({top:0,left:0,behavior:"smooth"})},[s]),(0,o.jsx)(a.Fragment,{children:(0,o.jsxs)(l.aF,{ref:x,title:(0,t.__)("Webhook Endpoint","newspack-plugin"),onRequestClose:()=>{r(null,e.id)},children:[s&&(0,o.jsx)(l.$T,{isError:!0,noticeText:s}),!0===h.disabled&&(0,o.jsx)(l.$T,{noticeText:(0,t.__)("This webhook endpoint is currently disabled.","newspack-plugin")}),h.disabled&&h.disabled_error&&(0,o.jsx)(l.$T,{isError:!0,noticeText:(0,t.__)("Request Error: ","newspack-plugin")+h.disabled_error}),m.success&&(0,o.jsx)(l.$T,{isSuccess:!0,noticeText:`${m.message}: ${m.code}`}),(0,o.jsxs)(l.xA,{columns:1,gutter:16,className:"mt0",children:[(0,o.jsx)(p.TextControl,{label:(0,t.__)("URL","newspack-plugin"),help:(0,t.__)("The URL to send requests to. It's required for the URL to be under a valid TLS/SSL certificate. You can use the test button below to verify the endpoint response.","newspack-plugin"),className:"code",value:h.url,onChange:e=>w({...h,url:e}),disabled:i}),(0,o.jsx)(p.TextControl,{label:(0,t.__)("Authentication token (optional)","newspack-plugin"),help:(0,t.__)("If your endpoint requires a token authentication, enter it here. It will be sent as a Bearer token in the Authorization header.","newspack-plugin"),value:null!==(_=h.bearer_token)&&void 0!==_?_:"",onChange:e=>w({...h,bearer_token:e}),disabled:i}),(0,o.jsx)(l.Zp,{buttonsCard:!0,noBorder:!0,className:"justify-end",children:(0,o.jsx)(l.$n,{variant:"secondary",disabled:i||!h.url,onClick:()=>function(e,n){const s=se(e);s?c(s):u({path:"/newspack/v1/webhooks/endpoints/test",method:"POST",data:{url:e,bearer_token:n}},{onStart(){c(null),k({})},onSuccess(e){e.success?k(e):c(new g.Ss(`${e.code?`${e.code}: `:""}${e.message}`,e.code,"endpoint_test"))}})}(h.url,h.bearer_token),children:(0,t.__)("Send a test request","newspack-plugin")})})]}),(0,o.jsx)("hr",{}),(0,o.jsx)(p.TextControl,{label:(0,t.__)("Label (optional)","newspack-plugin"),help:(0,t.__)("A label to help you identify this endpoint. It will not be sent to the endpoint.","newspack-plugin"),value:h.label,onChange:e=>w({...h,label:e}),disabled:i}),(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)("h3",{children:(0,t.__)("Actions","newspack-plugin")}),n.length>0&&(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)("p",{children:(0,t.__)("Select which actions should trigger this endpoint:","newspack-plugin")}),(0,o.jsx)(l.xA,{columns:2,gutter:16,children:n.map((e,n)=>(0,o.jsx)(pe,{disabled:i,label:e,checked:h.actions&&h.actions.includes(e)||!1,onChange:()=>{const n=h.actions||[];n.includes(e)?n.splice(n.indexOf(e),1):n.push(e),w({...h,actions:n})}},n))})]}),(0,o.jsx)(l.Zp,{buttonsCard:!0,noBorder:!0,className:"justify-end",children:(0,o.jsx)(l.$n,{isPrimary:!0,onClick:()=>{null!==h&&"url"in h&&function(e){const n=function(e){const n=[],s=se(e.url);return s&&n.push(s),e.actions&&e.actions.length||n.push((0,t.__)("At least one action is required.","newspack-plugin")),n}(e);n.length?c(n.join(" ")):(c(null),u({path:`/newspack/v1/webhooks/endpoints/${e.id||""}`,method:"POST",data:e,updateCacheKey:Z},{onSuccess:n=>{return s=e.id,d(n),void r(null,s);var s}}))}(h)},disabled:i||null===h,children:(0,t.__)("Save","newspack-plugin")})})]})]})})},ue=function({disabled:e,onConfirm:n,onClose:s,title:a,description:i}){return(0,o.jsxs)(l.aF,{title:a,onRequestClose:s,children:[(0,o.jsx)("p",{children:i}),(0,o.jsxs)(l.Zp,{buttonsCard:!0,noBorder:!0,className:"justify-end",children:[(0,o.jsx)(l.$n,{variant:"secondary",onClick:s,disabled:e,children:(0,t.__)("Cancel","newspack-plugin")}),(0,o.jsx)(l.$n,{variant:"primary",onClick:n,disabled:e,children:(0,t.__)("Confirm","newspack-plugin")})]})]})},_e=({endpoint:e,actions:n,action:s=null,errorMessage:i=null,inFlight:l=!1,setAction:c,setError:r,setEndpoints:p,wizardApiFetch:d})=>{const u=(e,n)=>{p(n),c(null,e)};return(0,o.jsxs)(a.Fragment,{children:["delete"===s&&(0,o.jsx)(ue,{title:(0,t.__)("Remove Endpoint","newspack-plugin"),description:(0,t.sprintf)(/* translators: %s: endpoint title */ /* translators: %s: endpoint title */
(0,t.__)("Are you sure you want to remove the endpoint %s?","newspack-plugin"),`"${J(e.url)}"`),onClose:()=>c(null,e.id),onConfirm:()=>{var n;d({path:`/newspack/v1/webhooks/endpoints/${(n=e).id}`,method:"DELETE",updateCacheKey:Z},{onSuccess:e=>u(n.id,e)})},disabled:l}),"toggle"===s&&(0,o.jsx)(ue,{title:e.disabled?(0,t.__)("Enable Endpoint","newspack-plugin"):(0,t.__)("Disable Endpoint","newspack-plugin"),description:e.disabled?(0,t.sprintf)(/* translators: %s: endpoint title */ /* translators: %s: endpoint title */
(0,t.__)("Are you sure you want to enable the endpoint %s?","newspack-plugin"),`"${J(e.url)}"`):(0,t.sprintf)(/* translators: %s: endpoint title */ /* translators: %s: endpoint title */
(0,t.__)("Are you sure you want to disable the endpoint %s?","newspack-plugin"),`"${J(e.url)}"`),onClose:()=>c(null,e.id),onConfirm:()=>{var n;d({path:`/newspack/v1/webhooks/endpoints/${(n=e).id}`,method:"POST",data:{disabled:!n.disabled},updateCacheKey:Z},{onSuccess:e=>u(n.id,e)})},disabled:l}),"view"===s&&(0,o.jsx)(re,{action:s,actions:n,endpoint:e,inFlight:l,setAction:c,setError:r,errorMessage:i,setEndpoints:p,wizardApiFetch:d}),["edit","new"].includes(null!=s?s:"")&&(0,o.jsx)(de,{endpoint:e,actions:n,errorMessage:i,inFlight:l,setError:r,setAction:c,setEndpoints:p,wizardApiFetch:d})]})},ge={url:"",label:"",requests:[],disabled:!1,disabled_error:!1,id:0,system:"",actions:[],bearer_token:""},he=function(){const{setError:e,resetError:n,errorMessage:s,wizardApiFetch:i,isFetching:c}=(0,m.L)("/newspack-settings/connections/webhooks"),[r,p]=(0,a.useState)(null),[d,u]=(0,a.useState)([]),[_,g]=(0,a.useState)(null),[h,w]=(0,a.useState)(null);function k(e,s){n(),p(e),null===e?w(null):"new"===e?(n(),w({...ge})):_&&["edit","delete","view","toggle"].includes(e)&&w(_.find(e=>e.id===s)||null)}return(0,a.useEffect)(()=>{i({path:"/newspack/v1/data-events/actions"},{onSuccess:e=>u(e)}),i({path:"/newspack/v1/webhooks/endpoints"},{onSuccess:e=>g(e)})},[]),(0,o.jsxs)(l.Zp,{noBorder:!0,className:"newspack-webhooks",children:[(0,o.jsxs)("div",{className:"flex justify-between items-end mb4",children:[(0,o.jsx)(l.X3,{title:(0,t.__)("Webhook Endpoints","newspack-plugin"),heading:3,description:(0,t.__)("Register webhook endpoints to integrate reader activity data to third-party services or private APIs","newspack-plugin"),noMargin:!0}),(0,o.jsx)(l.$n,{variant:"primary",onClick:()=>k("new"),disabled:c,children:c?(0,t.__)("Loading…","newspack-plugin"):(0,t.__)("Add New Endpoint","newspack-plugin")})]}),!c&&(_&&_.length>0?(0,o.jsx)(a.Fragment,{children:_.map(e=>(0,o.jsx)(le,{endpoint:e,setAction:k},e.id))}):(0,o.jsx)(l.$T,{noticeText:(0,t.__)("No endpoints found","newspack-plugin")})),h&&(0,o.jsx)(_e,{actions:d,setError:e,action:r,errorMessage:s,inFlight:c,wizardApiFetch:i,endpoint:h,setAction:k,setEndpoints:g})]})},{analytics:we}=window.newspackSettings.connections.sections,me=function(){return(0,o.jsx)(M,{editLink:we.editLink,slug:"google-site-kit",title:(0,t.__)("Google Analytics","newspack-plugin"),actionText:{complete:(0,t.__)("View","newspack-plugin")}})},ke={RECAPTCHA:{SITE_KEY_EMPTY:(0,t.__)("Site Key cannot be empty!","newspack-plugin"),SITE_SECRET_EMPTY:(0,t.__)("Site Secret cannot be empty","newspack-plugin"),THRESHOLD_INVALID_MIN:(0,t.__)("Threshold cannot be less than 0.1","newspack-plugin"),THRESHOLD_INVALID_MAX:(0,t.__)("Threshold cannot be greater than 1","newspack-plugin"),VERSION_CHANGE:(0,t.__)("Your site key and secret must match the selected reCAPTCHA version. Please enter new credentials.","newspack-plugin")},CUSTOM_EVENTS:{INVALID_MEASUREMENT_ID:(0,t.__)('You need a valid Measurement ID (e.g. "G-ABCDE12345") to activate Newspack Custom Events.',"newspack-plugin"),INVALID_MEASUREMENT_PROTOCOL_SECRET:(0,t.__)("You need a valid Measurement API Secret to activate Newspack Custom Events.","newspack-plugin")}},xe={threshold:"",use_captcha:!1,version:"v3",credentials:{v2_invisible:{site_key:"",site_secret:""},v3:{site_key:"",site_secret:""}}},be=new Map([["credentials",{dependsOn:{version:"v3"},callback:(e,n="v3")=>e[n].site_key?e[n].site_secret?"":ke.RECAPTCHA.SITE_SECRET_EMPTY:ke.RECAPTCHA.SITE_KEY_EMPTY}],["threshold",{dependsOn:{version:"v3"},callback:e=>{const n=parseFloat(e||"0");return n<.1?ke.RECAPTCHA.THRESHOLD_INVALID_MIN:n>1?ke.RECAPTCHA.THRESHOLD_INVALID_MAX:""}}]]),fe="/newspack/v1/recaptcha",ve=function(){const{wizardApiFetch:e,isFetching:n,errorMessage:s,setError:i,resetError:c}=(0,m.L)("/newspack-settings/connections/recaptcha"),[r,d]=(0,a.useState)({...xe}),[u,g]=(0,a.useState)({...xe}),h=(u.credentials||{})[u.version];function w(n,s=!1){if(c(),!s)for(const[e,n]of be){if(n.dependsOn){const[[e,s]]=Object.entries(n.dependsOn);if(u[e]!==s)continue}const s=n.callback(u[e],u.version);if(s)return void i(new f.A(s,e))}e({path:fe,method:"POST",data:n,updateCacheMethods:["GET"]},{onSuccess(e){d(e),g(e)}})}function k(e,n){g(s=>({...s,credentials:{...s.credentials,[s.version]:{...s.credentials[s.version],[e]:n}}}))}return(0,a.useEffect)(()=>{e({path:fe},{onSuccess(e){d(e),g(e)}})},[]),(0,o.jsx)(_.A,{isMedium:!0,title:(0,t.__)("Use reCAPTCHA","newspack-plugin"),description:()=>(0,o.jsx)(a.Fragment,{children:n&&!r.use_captcha?(0,t.__)("Loading…","newspack-plugin"):(0,o.jsxs)(o.Fragment,{children:[(0,t.__)("Enabling reCAPTCHA can help protect your site against bot attacks and credit card testing.","newspack-plugin")," ",(0,o.jsx)(p.ExternalLink,{href:"https://www.google.com/recaptcha/admin/create",children:(0,t.__)("Get started","newspack-plugin")})]})}),hasGreyHeader:!!r.use_captcha,toggleChecked:!!r.use_captcha,toggleOnChange:()=>w({...r,use_captcha:!r.use_captcha},!0),actionContent:r.use_captcha&&(0,o.jsx)(l.$n,{variant:"primary",disabled:n||!Object.keys(u).length,onClick:()=>w(u),children:n?(0,t.__)("Loading…","newspack-plugin"):(0,t.__)("Save Settings","newspack-plugin")}),error:r.use_captcha?s:null,disabled:n,children:r.use_captcha&&(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(l.xA,{noMargin:!0,rowGap:16,children:(0,o.jsx)(p.BaseControl,{id:"recaptcha-version",label:(0,t.__)("reCAPTCHA Version","newspack-plugin"),help:(0,o.jsx)(p.ExternalLink,{href:"https://developers.google.com/recaptcha/docs/versions",children:(0,t.__)("Learn more about reCAPTCHA versions","newspack-plugin")}),children:(0,o.jsx)(l.Yq,{label:(0,t.__)("reCAPTCHA Version","newspack-plugin"),hideLabelFromVision:!0,value:u.version||"v3",onChange:e=>g({...u,version:e}),options:[{value:"v3",label:(0,t.__)("Score based (v3)","newspack-plugin")},{value:"v2_invisible",label:(0,t.__)("Challenge (v2) - invisible reCAPTCHA badge","newspack-plugin")}]})})}),(0,o.jsxs)(l.xA,{noMargin:!0,rowGap:16,children:[(0,o.jsx)(l.xt,{value:h.site_key||"",label:(0,t.__)("Site Key","newspack-plugin"),onChange:e=>k("site_key",e),disabled:n,autoComplete:"off"}),(0,o.jsx)(l.xt,{type:"password",value:h.site_secret||"",label:(0,t.__)("Site Secret","newspack-plugin"),onChange:e=>k("site_secret",e),disabled:n,autoComplete:"one-time-code"}),"v3"===u.version&&(0,o.jsx)(l.xt,{type:"number",step:"0.05",min:"0.1",max:"1",value:parseFloat(u?.threshold||"0"),label:(0,t.__)("Threshold","newspack-plugin"),onChange:e=>g({...u,threshold:e}),disabled:n,help:(0,o.jsx)(p.ExternalLink,{href:"https://developers.google.com/recaptcha/docs/v3#interpreting_the_score",children:(0,t.__)("Learn more about the threshold value","newspack-plugin")})})]})]})})},je=e=>e instanceof Error&&"message"in e,Ce=()=>{const[e,n]=(0,a.useState)(""),[s,i]=(0,a.useState)(!1),[c,r]=(0,a.useState)({}),[d,u]=(0,a.useState)({}),_=e=>c.available_caps?c.available_caps[e]:void 0;(0,a.useEffect)(()=>{(async()=>{i(!0);try{const e=await A()({path:"/newspack-manager/v1/jetpack-sso"});r(e),u(e)}catch(e){n(je(e)?e.message:(0,t.__)("Error fetching settings.","newspack-plugin"))}finally{i(!1)}})()},[]);const g=async e=>{n(""),i(!0);try{const n=await A()({path:"/newspack-manager/v1/jetpack-sso",method:"POST",data:e});r(n),u(n)}catch(e){n(je(e)?e.message:(0,t.__)("Error updating settings.","newspack-plugin"))}finally{i(!1)}};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(l.Lz,{isMedium:!0,title:(0,t.__)("Force two-factor authentication","newspack-plugin"),description:()=>(0,o.jsx)(o.Fragment,{children:(0,t.__)("Improve security by requiring two-factor authentication via WordPress.com for users with higher capabilities.","newspack-plugin")}),hasGreyHeader:!!c.force_2fa,toggleChecked:!!c.force_2fa,toggleOnChange:()=>g({force_2fa:!c.force_2fa}),actionContent:c.force_2fa&&(0,o.jsx)(l.$n,{variant:"primary",disabled:s||!Object.keys(d).length,onClick:()=>g(d),children:(0,t.__)("Save Settings","newspack-plugin")}),disabled:s,children:c.force_2fa&&(0,o.jsxs)(o.Fragment,{children:[e&&(0,o.jsx)(l.$T,{isError:!0,noticeText:e}),c.jetpack_sso_force_2fa&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.$T,{isError:!0,noticeText:(0,t.__)("Two-factor authentication is currently enforced for all users via Jetpack configuration.","newspack-plugin")}),(0,o.jsx)("p",{children:(0,t.__)("Customize which capabilties to enforce 2FA by untoggling the “Require accounts to use WordPress.com Two-Step Authentication” option in Jetpack settings.","newspack-plugin")})]}),(0,o.jsx)(l.xA,{columns:1,children:(0,o.jsx)(p.BaseControl,{id:"force-2fa-cap",label:(0,t.__)("Select the user capability to enforce two-factor authentication","newspack-plugin"),children:(0,o.jsx)(l.Yq,{label:(0,t.__)("Capability","newspack-plugin"),hideLabelFromVision:!0,value:d?.force_2fa_cap||"",onChange:e=>u({...d,force_2fa_cap:e}),options:Object.keys(c.available_caps||{}).map(e=>({label:_(e),value:e}))})})}),(0,o.jsx)(l.xA,{columns:1,children:(0,o.jsx)(p.CheckboxControl,{checked:d?.obfuscate_account||!1,onChange:e=>u({...d,obfuscate_account:e}),label:(0,t.__)("Obfuscate restricted accounts by throwing WP’s “user not found” errors on login form attempts.","newspack-plugin")})})]})})})},ye=function(){const[e,n]=(0,a.useState)(!1),{wizardApiFetch:s,isFetching:i,errorMessage:c,setError:r,resetError:d}=(0,m.L)("/newspack-settings/connections/apis/mailchimp"),[u,h]=(0,a.useState)(),[w,k]=(0,a.useState)(),x=(0,a.useRef)(null),b=Boolean(u&&u.username);function f(){n(!1),k(void 0)}function v(){s({path:"/newspack/v1/oauth/mailchimp",method:"POST",data:{api_key:w},updateCacheMethods:["GET"]},{onSuccess(e){h(e),d()},onFinally(){f()}})}return(0,a.useEffect)(()=>{s({path:"/newspack/v1/oauth/mailchimp"},{onSuccess:e=>h(e)})},[]),(0,a.useEffect)(()=>{if(e&&x.current){const[e]=x.current.getElementsByTagName("input");e&&e.focus()}},[e]),(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(_.A,{title:"Mailchimp",description:i?(0,t.__)("Loading…","newspack-plugin"):b?(0,t.sprintf)(/* translators: %s: username */ /* translators: %s: username */
(0,t.__)("Connected as %s","newspack-plugin"),null!==(j=u?.username)&&void 0!==j?j:{}):(0,t.__)("Not connected","newspack-plugin"),isChecked:b,actionText:(0,o.jsx)(l.$n,{variant:"link",isDestructive:b,onClick:b?function(){s({path:"/newspack/v1/oauth/mailchimp",method:"DELETE",updateCacheMethods:["GET"]},{onSuccess(e){h(e),r(new g.u(g.M1.MAILCHIMP_API_KEY_INVALID,"MAILCHIMP_API_KEY_INVALID"))}})}:function(){return n(!0)},disabled:i,children:b?(0,t.__)("Disconnect","newspack-plugin"):(0,t.__)("Connect","newspack-plugin")}),error:c,isMedium:!0}),e&&(0,o.jsxs)(l.aF,{title:(0,t.__)("Add Mailchimp API Key","newspack-plugin"),onRequestClose:f,children:[(0,o.jsx)("div",{ref:x,children:(0,o.jsxs)(l.xA,{columns:1,gutter:8,children:[(0,o.jsx)(l.xt,{placeholder:"123457103961b1f4dc0b2b2fd59c137b-us1",label:(0,t.__)("Mailchimp API Key","newspack-plugin"),hideLabelFromVision:!0,value:null!=w?w:"",onChange:e=>k(e),onKeyDown:e=>{te.ENTER===e.keyCode&&""!==w&&(e.preventDefault(),v())}}),(0,o.jsx)("p",{children:(0,o.jsx)(p.ExternalLink,{href:"https://mailchimp.com/help/about-api-keys/#Find_or_generate_your_API_key",children:(0,t.__)("Find or generate your API key","newspack-plugin")})})]})}),(0,o.jsxs)(l.Zp,{buttonsCard:!0,noBorder:!0,className:"justify-end",children:[(0,o.jsx)(l.$n,{variant:"secondary",onClick:f,children:(0,t.__)("Cancel","newspack-plugin")}),(0,o.jsx)(l.$n,{variant:"primary",disabled:!w,onClick:v,children:w?i?(0,t.__)("Connecting…","newspack-plugin"):b?(0,t.__)("Connected","newspack-plugin"):(0,t.__)("Connect","newspack-plugin"):(0,t.__)("Invalid Mailchimp API Key.","newspack")})]})]})]});var j};var Ae=s(7896);let{customEvents:Se}=window.newspackSettings.connections.sections;const Ee=function(){const[e,n]=(0,a.useState)(Se),{wizardApiFetch:s,errorMessage:i,resetError:c,setError:r}=(0,m.L)("newspack-settings/connections/custom-events");function p(){return!e.measurement_id&&!e.measurement_protocol_secret}return(0,a.useEffect)(()=>{p()?c():function(e=""){return/^G-[A-Za-z0-9]{10,}$/.test(e)}(e.measurement_id)?e.measurement_protocol_secret?c():r(new g.u(ke.CUSTOM_EVENTS.INVALID_MEASUREMENT_PROTOCOL_SECRET,"ga4_invalid_measurement_protocol_secret")):r(new g.u(ke.CUSTOM_EVENTS.INVALID_MEASUREMENT_ID,"ga4_invalid_measurement_id"))},[e.measurement_id,e.measurement_protocol_secret]),(0,o.jsxs)("div",{className:"newspack__analytics-configuration",children:[(0,o.jsx)("div",{className:"newspack__analytics-configuration__header",children:(0,o.jsx)("p",{children:(0,t.__)("Newspack already sends some custom event data to your GA account, but adding the credentials below enables enhanced events that are fired from your site's backend. For example, when a donation is confirmed or when a user successfully subscribes to a newsletter.","newspack-plugin")})}),(0,o.jsxs)(l.xA,{noMargin:!0,rowGap:16,children:[(0,o.jsx)(l.xt,{value:e.measurement_id,label:(0,t.__)("Measurement ID","newspack-plugin"),help:(0,t.__)("You can find this in Site Kit Settings, or in Google Analytics > Admin > Data Streams and clicking the data stream. Example: G-ABCDE12345","newspack-plugin"),onChange:s=>n({...e,measurement_id:s}),autoComplete:"off"}),(0,o.jsx)(l.xt,{type:"password",value:e.measurement_protocol_secret,label:(0,t.__)("Measurement Protocol API Secret","newspack-plugin"),help:(0,t.__)('Generate an API secret from your GA dashboard in Admin > Data Streams and opening your data stream. Select "Measurement Protocol API secrets" under the Events section. Create a new secret.',"newspack-plugin"),onChange:s=>n({...e,measurement_protocol_secret:s}),autoComplete:"one-time-code"})]}),i&&(0,o.jsx)(l.$T,{isError:!0,noticeText:i}),(0,o.jsx)(l.$n,{className:"mr2",variant:"primary",onClick:function(){s({path:"/newspack/v2/wizard/analytics/ga4-credentials",method:"POST",data:{measurement_id:e.measurement_id,measurement_protocol_secret:e.measurement_protocol_secret}},{onSuccess(e){Se=e,n(e)}})},disabled:p()||!!i,children:(0,t.__)("Save","newspack-plugin")}),(0,o.jsx)(l.$n,{variant:"secondary",onClick:function(){l.Wp.confirmAction((0,t.__)("Are you sure you want to reset the GA4 credentials?","newspack-plugin"))&&s({path:"/newspack/v2/wizard/analytics/ga4-credentials/reset",method:"POST"},{onSuccess(e){Se={measurement_id:"",measurement_protocol_secret:""},n(e)}})},disabled:p(),children:(0,t.__)("Reset","newspack-plugin")})]})},{connections:Te}=window.newspackSettings,Le=function(){const{description:e,apiData:n,isFetching:s,actionText:a,apiFetchToggle:i,errorMessage:l}=S({path:"/newspack/v1/wizard/newspack-settings/syndication",apiNamespace:"newspack-settings/syndication/rss",refreshOn:["POST"],data:{module_enabled_rss:!1,"module_enabled_media-partners":!1},description:(0,t.__)("Create and manage customized RSS feeds for syndication partners","newspack-plugin")});return(0,o.jsx)(_.A,{title:(0,t.__)("RSS Enhancements","newspack"),description:e,disabled:s,actionText:a,error:l,toggleChecked:n.module_enabled_rss,toggleOnChange:e=>i({...n,module_enabled_rss:e},!0)})},Ne={"publish-to-apple-news":{slug:"publish-to-apple-news",title:(0,t.__)("Publish to Apple News","newspack-plugin"),editLink:"admin.php?page=apple-news-options",isConfigurable:!0,reloadOnActivation:!1,description:(0,t.__)("Export and synchronize posts to Apple format.","newspack-plugin")},distributor:{slug:"distributor",title:(0,t.__)("Distributor","newspack-plugin"),editLink:"admin.php?page=distributor",reloadOnActivation:!1,description:(0,t.__)("Distributor is a WordPress plugin that makes it easy to syndicate and reuse content across your websites — whether in a single multisite or across the web.","newspack-plugin")}},Pe=function(){return(0,o.jsx)(a.Fragment,{children:Object.keys(Ne).map(e=>(0,o.jsx)(M,{isTogglable:!0,isStatusPrepended:!1,isMedium:!1,...Ne[e]},e))})};function Me({data:e,update:n,isFetching:s}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(_.A,{title:(0,t.__)("Related Posts","newspack-plugin"),badge:"Jetpack",description:()=>(0,o.jsx)(a.Fragment,{children:s?(0,t.__)("Loading…","newspack-plugin"):(0,t.__)("Automatically add related content at the bottom of each post.","newspack-plugin")}),editLink:"admin.php?page=jetpack#/traffic",actionText:(0,o.jsx)(a.Fragment,{children:s?(0,o.jsx)(l.E$,{}):(0,o.jsx)(l.$n,{variant:"link",href:"admin.php?page=jetpack#/traffic",children:(0,t.__)("Configure","newspack-plugin")})})}),e.relatedPostsEnabled&&(0,o.jsx)(l.xA,{children:(0,o.jsx)(l.Zp,{noBorder:!0,children:(0,o.jsx)(l.xt,{help:(0,t.__)("If set, posts will be shown as related content only if published within the past number of months. If 0, any published post can be shown, regardless of publish date.","newspack-plugin"),label:(0,t.__)("Maximum age of related content, in months","newspack-plugin"),onChange:e=>n({relatedPostsMaxAge:e}),placeholder:(0,t.__)("Maximum age of related content, in months","newspack-plugin"),type:"number",value:e.relatedPostsMaxAge||0})})})]})}function Fe({data:e,isFetching:n,update:s}){return(0,o.jsxs)(l.xA,{gutter:32,children:[(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(p.ToggleControl,{label:(0,t.__)("Author Bio","newspack-plugin"),help:(0,t.__)("Display an author bio under individual posts.","newspack-plugin"),disabled:n,checked:e.show_author_bio,onChange:e=>s({show_author_bio:e})}),e.show_author_bio&&(0,o.jsx)(p.ToggleControl,{label:(0,t.__)("Author Email","newspack-plugin"),help:(0,t.__)("Display the author email with bio on individual posts.","newspack-plugin"),disabled:n,checked:e.show_author_email,onChange:e=>s({show_author_email:e})})]}),(0,o.jsx)(l.xA,{columns:1,gutter:16,children:e.show_author_bio&&(0,o.jsx)(l.xt,{label:(0,t.__)("Length","newspack-plugin"),help:(0,t.__)("Truncates the author bio on single posts to this approximate character length, but without breaking a word. The full bio appears on the author archive page.","newspack-plugin"),type:"number",value:e.author_bio_length,onChange:e=>s({author_bio_length:e})})})]})}function Ie({data:e,update:n,postCount:s}){return(0,o.jsxs)(a.Fragment,{children:[Number(s)>1e3&&(0,o.jsx)(p.Notice,{isDismissible:!1,status:"warning",className:"ma0 mb2",children:(0,t.__)("You have more than 1000 posts. Applying these settings might take a moment.","newspack-plugin")}),(0,o.jsxs)(l.xA,{gutter:32,children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(l.Yq,{label:(0,t.__)("Featured image position for all posts","newspack-plugin"),help:(0,t.__)("Set a featured image position for all posts.","newspack-plugin"),value:e.featured_image_all_posts,options:[{label:(0,t.__)("Select to change all posts","newspack-plugin"),value:"none"},{label:(0,t.__)("Large","newspack-plugin"),value:"large"},{label:(0,t.__)("Small","newspack-plugin"),value:"small"},{label:(0,t.__)("Behind article title","newspack-plugin"),value:"behind"},{label:(0,t.__)("Beside article title","newspack-plugin"),value:"beside"},{label:(0,t.__)("Hidden","newspack-plugin"),value:"hidden"}],onChange:e=>n({featured_image_all_posts:e})}),"none"!==e.featured_image_all_posts&&(0,o.jsx)(p.Notice,{isDismissible:!1,status:"warning",className:"ma0 mt2",children:(0,t.__)("After saving the settings with this option selected, all posts will be updated. This cannot be undone.","newspack-plugin")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(l.Yq,{label:(0,t.__)("Template for all posts","newspack-plugin"),help:(0,t.__)("Set a template for all posts.","newspack-plugin"),value:e.post_template_all_posts,options:[{label:(0,t.__)("Select to change all posts","newspack-plugin"),value:"none"},{label:(0,t.__)("With sidebar","newspack-plugin"),value:"default"},{label:(0,t.__)("One Column","newspack-plugin"),value:"single-feature.php"},{label:(0,t.__)("One Column Wide","newspack-plugin"),value:"single-wide.php"}],onChange:e=>n({post_template_all_posts:e})}),"none"!==e.post_template_all_posts&&(0,o.jsx)(p.Notice,{isDismissible:!1,status:"warning",className:"ma0 mt2",children:(0,t.__)("After saving the settings with this option selected, all posts will be updated. This cannot be undone.","newspack-plugin")})]})]})]})}function Oe({data:e,update:n}){return(0,o.jsxs)(l.xA,{gutter:32,children:[(0,o.jsx)(l.Yq,{label:(0,t.__)("Default featured image position for new posts","newspack-plugin"),help:(0,t.__)("Set a default featured image position for new posts.","newspack-plugin"),value:e.featured_image_default,options:[{label:(0,t.__)("Large","newspack-plugin"),value:"large"},{label:(0,t.__)("Small","newspack-plugin"),value:"small"},{label:(0,t.__)("Behind article title","newspack-plugin"),value:"behind"},{label:(0,t.__)("Beside article title","newspack-plugin"),value:"beside"},{label:(0,t.__)("Hidden","newspack-plugin"),value:"hidden"}],onChange:e=>n({featured_image_default:e})}),(0,o.jsx)(l.Yq,{label:(0,t.__)("Default template for new posts","newspack-plugin"),help:(0,t.__)("Set a default template for new posts.","newspack-plugin"),value:e.post_template_default,options:[{label:(0,t.__)("With sidebar","newspack-plugin"),value:"default"},{label:(0,t.__)("One Column","newspack-plugin"),value:"single-feature.php"},{label:(0,t.__)("One Column Wide","newspack-plugin"),value:"single-wide.php"}],onChange:e=>n({post_template_default:e})})]})}function ze({data:e,update:n}){const[s,i]=(0,a.useState)(null);return(0,a.useEffect)(()=>{e.newspack_image_credits_placeholder_url&&i(e.newspack_image_credits_placeholder_url)},[e.newspack_image_credits_placeholder_url]),(0,o.jsx)(a.Fragment,{children:(0,o.jsxs)(l.xA,{gutter:32,children:[(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.xt,{label:(0,t.__)("Credit Class Name","newspack-plugin"),help:(0,t.__)("A CSS class name to be applied to all image credit elements. Leave blank to display no class name.","newspack-plugin"),value:e.newspack_image_credits_class_name,onChange:e=>n({newspack_image_credits_class_name:e})}),(0,o.jsx)(l.xt,{label:(0,t.__)("Credit Label","newspack-plugin"),help:(0,t.__)("A label to prefix all media credits. Leave blank to display no prefix.","newspack-plugin"),value:e.newspack_image_credits_prefix_label,onChange:e=>n({newspack_image_credits_prefix_label:e})})]}),(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.BR,{image:s&&e.newspack_image_credits_placeholder?{url:s}:null,label:(0,t.__)("Placeholder Image","newspack-plugin"),buttonLabel:(0,t.__)("Select","newspack-plugin"),onChange:e=>{i(e?.url||null),n({newspack_image_credits_placeholder:e?.id||null,newspack_image_credits_placeholder_url:e?.url})},help:(0,t.__)("A placeholder image to be displayed in place of images without credits. If none is chosen, the image will be displayed normally whether or not it has a credit.","newspack-plugin")}),(0,o.jsx)(p.ToggleControl,{label:(0,t.__)("Auto-populate image credits","newspack-plugin"),help:(0,t.__)("Automatically populate image credits from EXIF or IPTC metadata when uploading new images.","newspack-plugin"),checked:e.newspack_image_credits_auto_populate,onChange:e=>n({newspack_image_credits_auto_populate:e})})]})]})})}function $e({isFetching:e}){const{wizardApiFetch:n}=(0,m.L)("newspack-settings/advanced-settings/accessibility-statement"),[s,i]=(0,a.useState)(!1),[c,r]=(0,a.useState)(null),d=()=>{i(!0),n({path:"/newspack/v1/wizard/newspack-settings/accessibility-statement",method:"GET"},{onSuccess:e=>{e&&e.editUrl&&e.status&&"trash"!==e.status?r(e):r(null),i(!1)},onError:()=>{r(null),i(!1)}})};(0,a.useEffect)(()=>{c||d()},[]);const u=()=>{if(!c)return(0,t.__)("Create Page","newspack-plugin");switch(c.status){case"publish":return(0,t.__)("Edit Page","newspack-plugin");case"draft":case"pending":return(0,t.__)("Edit and Publish Page","newspack-plugin");default:return(0,t.__)("Create Page","newspack-plugin")}},_=(()=>{if(!c)return{type:"warning",message:(0,t.__)('Your accessibility statement page has been moved to trash or deleted. Click "Create Page" to create a new one.',"newspack-plugin")};switch(c.status){case"publish":return{type:"success",message:(0,t.__)("Your accessibility statement page is published.","newspack-plugin")};case"draft":case"pending":return{type:"warning",message:(0,t.__)("Your accessibility statement page is not yet published. Please review and make edits before publishing.","newspack-plugin")};default:return{type:"warning",message:(0,t.__)('Your accessibility statement page has been moved to trash. Click "Create Page" to create a new one.',"newspack-plugin")}}})();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(l.Zp,{noBorder:!0,headerActions:!0,children:[(0,o.jsx)(l.X3,{title:(0,t.__)("Accessibility Statement Page","newspack-plugin"),noMargin:!0,description:(0,t.__)("Edit and publish an accessibility statement page. Once published, a link to this page will display in the footer of your site.","newspack-plugin")}),c&&"trash"!==c.status?(0,o.jsx)(l.$n,{variant:"secondary",isSmall:!0,href:c.editUrl,children:u()}):(0,o.jsx)(l.$n,{variant:"secondary",isSmall:!0,onClick:()=>{i(!0),n({path:"/newspack/v1/wizard/newspack-settings/accessibility-statement",method:"POST",data:{force_create:"true"}},{onSuccess:e=>{e&&e.editUrl&&e.status?r(e):r(null),d()},onError:()=>{r(null),i(!1)}})},disabled:e||s,children:u()})]}),(0,o.jsx)(l.$T,{isSuccess:"success"===_.type,isWarning:"warning"===_.type,noticeText:_.message}),(0,o.jsxs)("p",{children:[(0,t.__)("An accessibility statement helps your readers understand how your site supports accessibility standards and what to do if they encounter accessibility issues. ","newspack-plugin"),(0,o.jsxs)(p.ExternalLink,{href:"https://www.w3.org/WAI/planning/statements/",children:[(0,t.__)("What makes a good accessibility statement.","newspack-plugin")," "]})]}),(0,o.jsxs)("p",{children:[(0,t.__)("The page you create here will include a boilerplate accessibility statement. ","newspack-plugin"),(0,o.jsx)("strong",{children:(0,t.__)("Please review and make edits to ensure it meets the requirements before publishing. ","newspack-plugin")}),(0,t.__)("You can also use the W3C Accessibility Statement Generator to create a custom statement. ","newspack-plugin"),(0,o.jsxs)(p.ExternalLink,{href:"https://www.w3.org/WAI/planning/statements/generator/#create",children:[(0,t.__)("Try out the Accessibility Statement Generator.","newspack-plugin")," "]})]}),(0,o.jsx)("p",{children:(0,o.jsxs)(p.ExternalLink,{href:"https://help.newspack.com/revenue/reader-revenue/how-to-add-an-accessibility-statement/",children:[(0,t.__)("Learn more about this feature in our documentation.","newspack-plugin")," "]})})]})}const He=[{label:(0,t.__)("Fullscreen","newspack-plugin"),value:"fullscreen"},{label:(0,t.__)("Standalone","newspack-plugin"),value:"standalone"},{label:(0,t.__)("Minimal UI","newspack-plugin"),value:"minimal-ui"},{label:(0,t.__)("Browser","newspack-plugin"),value:"browser"}];function Ve({data:e,isFetching:n,update:s}){return(0,o.jsx)(l.xA,{gutter:32,children:(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(p.SelectControl,{label:(0,t.__)("Web App Display Mode","newspack-plugin"),help:(0,t.__)("Choose how your site appears when installed as a Progressive Web App. Fullscreen: Full screen without browser UI. Standalone: Looks like a standalone app. Minimal UI: Minimal browser controls. Browser: Standard browser experience.","newspack-plugin"),value:e.pwa_display_mode||"minimal-ui",options:He,onChange:e=>s({pwa_display_mode:e}),disabled:n}),(0,o.jsx)(l.$T,{noticeText:(0,t.__)("This setting controls how your site appears when users install it as a Progressive Web App on their devices.","newspack-plugin"),isInfo:!0})]})})}const De=s.p+"images/scott.334f7869.png",Re=s.p+"images/sacha.adc0ee6a.png",Be=s.p+"images/nelson.0c4682be.png",Ge=s.p+"images/joseph.b62a5e84.png",Ue=s.p+"images/newspack.51356748.png",Ze=s.p+"images/katharine.f0faa13b.png",qe=({theme:e,updateTheme:n})=>(0,o.jsxs)(l.xA,{columns:3,gutter:32,children:[(0,o.jsx)(l.mi,{cardTitle:"Newspack",image:Ue,url:"//newspack.newspackstaging.com",isActive:"newspack-theme"===e,onClick:()=>n("newspack-theme"),id:"card--newspack-theme"}),(0,o.jsx)(l.mi,{cardTitle:"Scott",image:De,url:"//scott.newspackstaging.com",isActive:"newspack-scott"===e,onClick:()=>n("newspack-scott"),id:"card--newspack-scott"}),(0,o.jsx)(l.mi,{cardTitle:"Nelson",image:Be,url:"//nelson.newspackstaging.com",isActive:"newspack-nelson"===e,onClick:()=>n("newspack-nelson"),id:"card--newspack-nelson"}),(0,o.jsx)(l.mi,{cardTitle:"Katharine",image:Ze,url:"//katharine.newspackstaging.com",isActive:"newspack-katharine"===e,onClick:()=>n("newspack-katharine"),id:"card--newspack-katharine"}),(0,o.jsx)(l.mi,{cardTitle:"Sacha",image:Re,url:"//sacha.newspackstaging.com",isActive:"newspack-sacha"===e,onClick:()=>n("newspack-sacha"),id:"card--newspack-sacha"}),(0,o.jsx)(l.mi,{cardTitle:"Joseph",image:Ge,url:"//joseph.newspackstaging.com",isActive:"newspack-joseph"===e,onClick:()=>n("newspack-joseph"),id:"card--newspack-joseph"})]}),Ye=Array.from({length:12},Object);function We({homepagePatternIndex:e,updateHomepagePattern:n,homepagePatterns:s,isFetching:a}){const i=a&&0===s.length?Ye:s;return(0,o.jsx)(l.xA,{columns:6,gutter:16,children:i.map((s,a)=>(0,o.jsx)(l.mi,{image:{__html:s.image},imageType:"html",isActive:a===e,onClick:()=>{n(a)},ariaLabel:`${(0,t.__)("Activate Layout","newspack-plugin")} ${a+1}`},a))})}var Ke=(0,o.jsx)(q.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,o.jsx)(q.Path,{d:"M13 5.5H4V4h9v1.5Zm7 7H4V11h16v1.5Zm-7 7H4V18h9v1.5Z"})}),Xe=(0,o.jsx)(q.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,o.jsx)(q.Path,{d:"M7.5 5.5h9V4h-9v1.5Zm-3.5 7h16V11H4v1.5Zm3.5 7h9V18h-9v1.5Z"})});const Je=(e,n)=>n.reduce((n,s)=>{const t=s.label.indexOf("(*)")>0,a=s.label.replace(" (*)",""),i={label:a,value:a};return t&&!e||n.push(i),n},[]),Qe=[{label:"Alegreya"},{label:"Arvo"},{label:"BioRhyme"},{label:"BioRhyme Expanded (*)"},{label:"Bodoni Moda"},{label:"Cormorant"},{label:"Crimson Text"},{label:"EB Garamond"},{label:"Eczar"},{label:"Frank Ruhl Libre"},{label:"Georgia"},{label:"IBM Plex Serif"},{label:"Josefin Slab"},{label:"Inknut Antiqua"},{label:"Libre Baskerville"},{label:"Lora"},{label:"Merriweather"},{label:"Neuton"},{label:"Newsreader"},{label:"Noto Serif"},{label:"Old Standard TT (*)"},{label:"Playfair Display"},{label:"PT Serif"},{label:"Roboto Slab"},{label:"Source Serif Pro"},{label:"Spectral"}],en=[{label:"Alegreya Sans"},{label:"Archivo"},{label:"Archivo Black (*)"},{label:"Archivo Narrow (*)"},{label:"Chivo"},{label:"DM Sans"},{label:"Fira Sans"},{label:"Fira Sans Condensed (*)"},{label:"Fira Sans Extra Condensed (*)"},{label:"IBM Plex Sans"},{label:"IBM Plex Sans Condensed (*)"},{label:"Inter"},{label:"Josefin Sans"},{label:"Jost"},{label:"Karla"},{label:"Lato"},{label:"Libre Franklin"},{label:"Montserrat"},{label:"Noto Sans"},{label:"Open Sans"},{label:"Oswald (*)"},{label:"Overpass"},{label:"Poppins"},{label:"PT Sans"},{label:"Raleway"},{label:"Roboto"},{label:"Roboto Condensed (*)"},{label:"Rubik"},{label:"Source Sans Pro"},{label:"Work Sans"}],nn=[{label:"Abril Fatface (*)"},{label:"Bangers (*)"},{label:"Bebas Neue (*)"},{label:"Concert One (*)"},{label:"Fredoka One (*)"},{label:"Unica One (*)"}],sn=[{label:"Anonymous Pro"},{label:"IBM Plex Mono"},{label:"JetBrains Mono"},{label:"Inconsolata"},{label:"Overpass Mono"},{label:"PT Mono"},{label:"Source Code Pro"},{label:"Space Mono"},{label:"Roboto Mono"}],tn=[...Qe,...en,...nn,...sn],an=[{value:"curated",label:(0,t.__)("Default","newspack-plugin")},{value:"custom",label:(0,t.__)("Custom","newspack-plugin")}],ln=(e=!1)=>[{label:(0,t.__)("Serif","newspack-plugin"),fallback:"serif",options:Qe},{label:(0,t.__)("Sans Serif","newspack-plugin"),fallback:"sans_serif",options:en},{label:(0,t.__)("Display","newspack-plugin"),fallback:"display",options:nn},{label:(0,t.__)("Monospace","newspack-plugin"),fallback:"monospace",options:sn}].map(n=>({...n,options:Je(e,n.options)})).filter(e=>e.options.length),on=e=>tn.filter(n=>!n.label.includes(e)).length>=1,cn=e=>`//fonts.googleapis.com/css2?family=${e.replace(/\s/g,"+")}:ital,wght@0,400;0,700;1,400;1,700&display=swap`,rn=[{value:0,label:(0,t.__)("XS","newspack-plugin")},{value:19,label:(0,t.__)("S","newspack-plugin")},{value:48,label:(0,t.__)("M","newspack-plugin")},{value:72,label:(0,t.__)("L","newspack-plugin")},{value:91,label:(0,t.__)("XL","newspack-plugin")}],pn=(e,n=rn)=>n.reduce((n,{value:s})=>e>=s?s:n,n[0].value);function dn({themeMods:e,updateHeader:n}){return(0,o.jsxs)(l.xA,{gutter:32,children:[(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsxs)(l.xA,{gutter:16,className:"newspack-design__header__style-size",children:[(0,o.jsx)(l.Yq,{className:"icon-only",label:(0,t.__)("Style","newspack"),value:e.header_center_logo?"center":"left",onChange:s=>n({...e,header_center_logo:"center"===s}),buttonOptions:[{value:"left",icon:Ke},{value:"center",icon:Xe}]}),(0,o.jsx)(l.Yq,{className:"icon-only",label:(0,t.__)("Size","newspack"),value:e.header_simplified?"small":"large",onChange:s=>n({...e,header_simplified:"small"===s}),buttonOptions:[{value:"small",label:"S"},{value:"large",label:"L"}]})]}),(0,o.jsx)(p.ToggleControl,{checked:Boolean(e.header_solid_background),onChange:s=>n({...e,header_solid_background:s}),label:(0,t.__)("Apply a background color to the header","newspack")}),e.header_solid_background&&(0,o.jsx)(l.sk,{label:(0,t.__)("Background color"),color:e.header_color_hex,onChange:s=>n({...e,header_color_hex:s})})]}),(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.BR,{className:"newspack-design__header__logo",style:{backgroundColor:e.header_solid_background?e.header_color_hex:"transparent"},label:(0,t.__)("Logo","newspack"),image:e.custom_logo,onChange:s=>n({...e,custom_logo:s,header_text:!s,header_display_tagline:!s})}),e.custom_logo&&(0,o.jsx)(l.Yq,{className:"icon-only",label:(0,t.__)("Logo Size","newspack"),value:pn(e.logo_size),onChange:s=>n({...e,logo_size:s}),buttonOptions:rn})]})]})}const un=window.newspackSettings,gn=un&&"additional-brands"in un;function hn({themeMods:e,onUpdate:n}){function s(s){n({...e,...s})}return(0,o.jsxs)(l.xA,{gutter:32,children:[(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.xt,{label:(0,t.__)("Copyright information","newspack"),value:e.footer_copyright||"",onChange:e=>s({footer_copyright:e})}),(0,o.jsx)(p.ToggleControl,{checked:"default"!==e.footer_color,onChange:e=>s({footer_color:e?"custom":"default"}),label:(0,t.__)("Apply a background color to the footer","newspack")}),"custom"===e.footer_color&&(0,o.jsx)(l.sk,{label:(0,t.__)("Background color"),color:e.footer_color_hex,onChange:e=>s({footer_color_hex:e})})]}),!gn&&(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.BR,{className:"newspack-design__footer__logo",label:(0,t.__)("Alternative Logo","newspack"),help:(0,t.__)("Optional alternative logo to be displayed in the footer.","newspack"),style:{backgroundColor:"custom"===e.footer_color&&e.footer_color_hex?e.footer_color_hex:"transparent"},image:e.newspack_footer_logo,onChange:e=>s({newspack_footer_logo:e})}),e.newspack_footer_logo&&(0,o.jsx)(l.Yq,{className:"icon-only",label:(0,t.__)("Alternative logo - Size","newspack"),value:e.footer_logo_size,onChange:e=>s({footer_logo_size:e}),buttonOptions:[{value:"small",label:"S"},{value:"medium",label:"M"},{value:"large",label:"L"},{value:"xlarge",label:"XL"}]})]})]})}function wn({themeMods:e,updateColors:n}){return(0,o.jsxs)(l.xA,{gutter:32,children:[(0,o.jsx)(l.sk,{label:(0,t.__)("Primary","newspack-plugin"),color:e.primary_color_hex,onChange:s=>n({...e,primary_color_hex:s,theme_colors:"custom"})}),(0,o.jsx)(l.sk,{label:(0,t.__)("Secondary","newspack-plugin"),color:e.secondary_color_hex,onChange:s=>n({...e,secondary_color_hex:s,theme_colors:"custom"})})]})}function mn({data:e,isFetching:n,update:s}){const[i,c]=(0,a.useState)(null);function r(n,t){n instanceof Object?s({...e,...n}):void 0!==t&&s({...e,[n]:t})}(0,a.useEffect)(()=>{i||e.font_body&&e.font_header&&c(function(){const{font_header:n,font_body:s}=e;return n&&!on(n)||s&&!on(s)?an[1].value:an[0].value}())},[e.font_body,e.font_body]);const d=n=>{var s;const a="headings"===n,i=a?(0,t.__)("Headings","newspack-plugin"):(0,t.__)("Body","newspack-plugin");return(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(p.TextareaControl,{label:i+" - "+(0,t.__)("Font provider import code or URL","newspack-plugin"),placeholder:"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap",value:null!==(s=a?e.custom_font_import_code:e.custom_font_import_code_alternate)&&void 0!==s?s:"",onChange:e=>{r(a?"custom_font_import_code":"custom_font_import_code_alternate",e)},rows:3}),(0,o.jsx)(l.xt,{label:i+" - "+(0,t.__)("Font name","newspack-plugin"),value:a?e.font_header:e.font_body,onChange:e=>{r(a?"font_header":"font_body",e)}}),(0,o.jsx)(l.Yq,{label:i+" - "+(0,t.__)("Font fallback stack","newspack-plugin"),options:[{value:"serif",label:(0,t.__)("Serif","newspack-plugin")},{value:"sans-serif",label:(0,t.__)("Sans Serif","newspack-plugin")},{value:"display",label:(0,t.__)("Display","newspack-plugin")},{value:"monospace",label:(0,t.__)("Monospace","newspack-plugin")}],value:a?e.font_header_stack:e.font_body_stack,onChange:e=>r(a?"font_header_stack":"font_body_stack",e)})]})};return(0,o.jsxs)(l.xA,{columns:1,gutter:16,children:[(0,o.jsx)(l.Yq,{label:(0,t.__)("Typography Options","newspack-plugin"),hideLabelFromVision:!0,disabled:!0,value:i||"curated",onChange:c,buttonOptions:n?[{label:(0,t.__)("Loading…","newspack-plugin"),value:null}]:an}),(0,o.jsx)(l.xA,{gutter:32,children:"curated"===i||null===i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Yq,{label:(0,t.__)("Headings","newspack-plugin"),optgroups:ln(!0),value:e.font_header,onChange:(e,n)=>{r({font_header:e,custom_font_import_code:cn(e),font_header_stack:n?.fallback})}}),(0,o.jsx)(l.Yq,{label:(0,t.__)("Body","newspack-plugin"),optgroups:ln(),value:e.font_body,onChange:(e,n)=>{r({font_body:e,custom_font_import_code_alternate:cn(e),font_body_stack:n?.fallback})}})]}):(0,o.jsxs)(o.Fragment,{children:[d("headings"),d("body")]})}),(0,o.jsx)(p.ToggleControl,{checked:e.accent_allcaps,onChange:e=>r("accent_allcaps",e),label:(0,t.__)("Use all-caps for accent text","newspack-plugin")})]})}const{useHistory:kn}=l.Ix,xn={etc:{post_count:"0"},theme:"newspack-theme",homepage_patterns:[],theme_mods:{...b}};var bn=s(3832);s(1609);const fn=({settings:e,isSaving:n,onChange:s})=>(0,o.jsx)(_.A,{isMedium:!0,title:(0,t.__)("Customize collections naming schema","newspack-plugin"),description:(0,t.__)("Override labels, messages and other reader-facing elements with custom naming.","newspack-plugin"),disabled:n,toggleChecked:!!e.custom_naming_enabled,toggleOnChange:e=>s("custom_naming_enabled",e),hasGreyHeader:!!e.custom_naming_enabled,children:e.custom_naming_enabled&&(0,o.jsxs)(l.xA,{columns:2,gutter:24,children:[(0,o.jsx)(l.xt,{label:(0,t.__)("Name","newspack-plugin"),help:(0,t.__)('Name to be used instead of "Collections" (e.g., "Issues", "Magazines")',"newspack-plugin"),value:e.custom_name,onChange:e=>s("custom_name",e),placeholder:"Collections"}),(0,o.jsx)(l.xt,{label:(0,t.__)("Singular name","newspack-plugin"),help:(0,t.__)('Singular name to be used instead of "Collection" (e.g., "Issue", "Magazine")',"newspack-plugin"),value:e.custom_singular_name,onChange:e=>s("custom_singular_name",e),placeholder:"Collection"}),(0,o.jsx)(l.xt,{label:(0,t.__)("Permalink base slug","newspack-plugin"),help:(0,t.__)('Base slug to be used in permalinks and the REST API (e.g., "issues", "magazine"). Default: "collections".',"newspack-plugin"),value:e.custom_slug,onChange:e=>s("custom_slug",e),placeholder:"collections"})]})}),vn=[12,18,24],jn={custom_naming_enabled:!1,custom_name:"",custom_singular_name:"",custom_slug:"",subscribe_link:"",order_link:"",posts_per_page:12,category_filter_label:"",highlight_latest:!1,articles_block_attrs:{},show_cover_story_img:!1,post_indicator_style:"default",card_message:(0,t.__)("Keep reading. There's plenty more to discover.","newspack-plugin")},Cn=window.newspackSettings,yn={connections:function(){return(0,o.jsxs)(r.A,{title:(0,t.__)("Connections","newspack-plugin"),children:[(0,o.jsx)(u.A,{title:(0,t.__)("Plugins","newspack-plugin"),children:(0,o.jsx)(U,{})}),(0,o.jsxs)(u.A,{title:(0,t.__)("APIs","newspack-plugin"),children:[Te.sections.apis.dependencies?.googleOAuth&&(0,o.jsx)(Ae.A,{}),(0,o.jsx)(ye,{})]}),Te.sections.jetpack_sso.dependencies?.jetpack_sso?(0,o.jsx)(u.A,{title:(0,t.__)("Jetpack SSO","newspack-plugin"),children:(0,o.jsx)(Ce,{})}):null,(0,o.jsx)(u.A,{scrollToAnchor:"newspack-settings-recaptcha",title:(0,t.__)("reCAPTCHA","newspack-plugin"),children:(0,o.jsx)(ve,{})}),(0,o.jsx)(u.A,{children:(0,o.jsx)(he,{})}),(0,o.jsx)(u.A,{title:(0,t.__)("Analytics","newspack-plugin"),children:(0,o.jsx)(me,{})}),(0,o.jsx)(u.A,{title:(0,t.__)("Activate Newspack Custom Events","newspack-plugin"),description:(0,t.__)("Allows Newspack to send enhanced custom event data to your Google Analytics.","newspack-plugin"),children:(0,o.jsx)(Ee,{})})]})},social:function(){return(0,o.jsxs)("div",{className:"newspack-wizard__sections",children:[(0,o.jsx)("h1",{children:(0,t.__)("Social","newspack-plugin")}),(0,o.jsxs)(u.A,{children:[(0,o.jsx)(F,{}),(0,o.jsx)(C,{}),(0,o.jsx)(j,{}),(0,o.jsx)(L,{})]})]})},emails:function(){return(0,o.jsxs)(r.A,{title:(0,t.__)("Emails","newspack-plugin"),children:[(0,o.jsx)(u.A,{children:(0,o.jsx)(I,{})}),D?.sections?.emails?.isEmailEnhancementsActive&&(0,o.jsx)(u.A,{children:(0,o.jsx)(V,{})})]})},syndication:function(){return(0,o.jsx)(r.A,{title:(0,t.__)("Syndication","newspack-plugin"),children:(0,o.jsxs)(u.A,{children:[(0,o.jsx)(Le,{}),(0,o.jsx)(Pe,{})]})})},seo:function(){const{wizardApiFetch:e,isFetching:n}=(0,m.L)("newspack-settings/seo"),[s,p]=(0,a.useState)({under_construction:!1,urls:{facebook:"",twitter:"",instagram:"",youtube:"",linkedin:"",pinterest:""},verification:{bing:"",google:""}}),g=w([["google","isId",{message:(0,t.__)("Invalid Google verification code!","newspack-plugin")}],["bing",e=>/^[A-Fa-f0-9_-]*$/.test(e)?"":(0,t.__)("Invalid Bing verification code!","newspack-plugin")]],s.verification),h=w(i.map(([e,n,s,a])=>[e,null!=a?a:"isUrl",a?{}:{message:(0,t.sprintf)(/* translators: %1$s: label, %2$s: placeholder */ /* translators: %1$s: label, %2$s: placeholder */
(0,t.__)('Invalid URL for "%1$s", correct format is "%2$s"',"newspack-plugin"),n,s)}],[]),s.urls);return(0,a.useEffect)(function(){e({path:k},{onSuccess:e=>p(e)})},[]),(0,o.jsxs)(r.A,{title:(0,t.__)("SEO","newspack-plugin"),className:n?"is-fetching":"",children:[(0,o.jsxs)(u.A,{title:(0,t.__)("Webmaster Tools","newspack-plugin"),description:(0,t.__)("Add verification meta tags to your site","newspack-plugin"),children:[g.errorMessage&&(0,o.jsx)(l.$T,{isError:!0,noticeText:g.errorMessage}),(0,o.jsx)(d,{setData:e=>p({...s,verification:e}),data:s.verification})]}),(0,o.jsxs)(u.A,{title:(0,t.__)("Social Accounts","newspack-plugin"),description:(0,t.__)("Let search engines know which social profiles are associated to your site","newspack-plugin"),children:[h.errorMessage&&(0,o.jsx)(l.$T,{isError:!0,noticeText:h.errorMessage}),(0,o.jsx)(c,{setData:e=>p({...s,urls:e}),data:s.urls})]}),(0,o.jsx)(u.A,{children:(0,o.jsx)(_.A,{isMedium:!0,disabled:n,toggleChecked:s.under_construction,title:(0,t.__)("Under construction","newspack"),toggleOnChange:e=>p({...s,under_construction:e}),description:(0,t.__)("Discourage search engines from indexing this site.","newspack")})}),(0,o.jsx)("div",{className:"newspack-buttons-card",children:(0,o.jsx)(l.$n,{isPrimary:!0,onClick:function(){const n=g.isInputsValid(),t=h.isInputsValid();n&&t&&e({path:k,method:"POST",updateCacheMethods:["GET"],data:s},{onSuccess:e=>p(e)})},disabled:n,children:n?(0,t.__)("Loading…","newspack-plugin"):(0,t.__)("Save Settings","newspack-plugin")})})]})},"theme-and-brand":({isPartOfSetup:e=!1})=>{const{wizardApiFetch:n,isFetching:s}=(0,m.L)("newspack-settings/theme-mods"),[i,c]=(0,a.useState)(xn),p=kn();function d(e){c({...i,...e})}const _=()=>{n({data:i,path:"/newspack/v1/wizard/newspack-setup-wizard/complete",method:"POST",updateCacheMethods:["GET"]},{onSuccess:e=>{d(e),p.push("/completed")}})};async function g(){return new Promise(e=>n({data:i,path:"/newspack/v1/wizard/newspack-setup-wizard/theme",method:"POST",updateCacheMethods:["GET"]},{onSuccess:n=>{d(n),e(n)}}))}return(0,a.useEffect)(()=>{n({path:"/newspack/v1/wizard/newspack-setup-wizard/theme"},{onSuccess:d})},[]),(0,o.jsxs)(r.A,{title:(0,t.__)("Theme and Brand","newspack-plugin"),isFetching:s,children:[!e&&(0,o.jsx)(a.Fragment,{children:(0,o.jsx)(u.A,{title:(0,t.__)("Theme","newspack-plugin"),description:(0,t.__)("Update your sites theme.","newspack-plugin"),children:(0,o.jsx)(qe,{theme:s?"":i.theme||"newspack-theme",updateTheme:e=>d({...i,theme:e})})})}),e&&(0,o.jsx)(u.A,{title:(0,t.__)("Homepage","newspack-plugin"),description:(0,t.__)("Select a homepage layout.","newspack-plugin"),children:(0,o.jsx)(We,{isFetching:s,homepagePatternIndex:i.theme_mods.homepage_pattern_index,homepagePatterns:i.homepage_patterns,updateHomepagePattern:e=>{d({...i,theme_mods:{...i.theme_mods,homepage_pattern_index:e}})}})}),(0,o.jsx)(u.A,{title:(0,t.__)("Colors","newspack-plugin"),description:(0,t.__)("Pick your primary and secondary colors.","newspack-plugin"),children:(0,o.jsx)(wn,{themeMods:i.theme_mods,updateColors:e=>{d({...i,theme_mods:e})}})}),(0,o.jsx)(u.A,{title:(0,t.__)("Typography","newspack-plugin"),description:(0,t.__)("Define the font pairing to use throughout your site","newspack-plugin"),children:(0,o.jsx)(mn,{data:i.theme_mods,isFetching:s,update:e=>{d({...i,theme_mods:e})}})}),(0,o.jsx)(u.A,{title:(0,t.__)("Header","newspack-plugin"),description:(0,t.__)("Update the header and add your logo.","newspack-plugin"),children:(0,o.jsx)(dn,{themeMods:i.theme_mods,updateHeader:e=>{d({...i,theme_mods:e})}})}),(0,o.jsx)(u.A,{title:(0,t.__)("Footer","newspack-plugin"),description:(0,t.__)("Personalize the footer of your site.","newspack-plugin"),children:(0,o.jsx)(hn,{themeMods:i.theme_mods,onUpdate:e=>{d({...i,theme_mods:e})}})}),(0,o.jsx)("div",{className:"newspack-buttons-card",children:e?(0,o.jsx)(l.$n,{variant:"primary",onClick:()=>g().then(_),children:(0,t.__)("Finish","newspack-plugin")}):(0,o.jsx)(l.$n,{variant:"primary",onClick:g,children:(0,t.__)("Save","newspack-plugin")})})]})},"advanced-settings":function(){const[e,n]=l.JL.useObjectState({...b}),[s,i]=l.JL.useObjectState({post_count:"0",has_pwa_plugin:!1}),[c,p]=l.JL.useObjectState({relatedPostsMaxAge:0,relatedPostsEnabled:!1,relatedPostsError:null,relatedPostsUpdated:!1}),{wizardApiFetch:d,isFetching:_,errorMessage:g}=(0,m.L)("newspack-settings/theme-mods"),{wizardApiFetch:h,isFetching:w}=(0,m.L)("newspack-settings/advanced-settings/recirculation");return(0,a.useEffect)(()=>{d({path:"/newspack/v1/wizard/newspack-setup-wizard/theme"},{onSuccess({theme_mods:e,etc:s}){n(e),i(s)}}),h({path:"/newspack/v1/wizard/newspack-settings/related-content"},{onSuccess:p})},[]),(0,o.jsxs)(r.A,{title:(0,t.__)("Advanced Settings","newspack-plugin"),isFetching:_||w,children:[(0,o.jsx)(u.A,{title:(0,t.__)("Recirculation","newspack-plugin"),children:(0,o.jsx)(Me,{isFetching:w,update:p,data:c})}),(0,o.jsx)(u.A,{title:(0,t.__)("Author Bio","newspack-plugin"),children:(0,o.jsx)(Fe,{update:n,data:e,isFetching:_})}),(0,o.jsx)(u.A,{title:(0,t.__)("Default Featured Image Position And Post Template","newspack-plugin"),description:(0,t.__)("Modify how the featured image and post template settings are applied to new posts.","newspack-plugin"),children:(0,o.jsx)(Oe,{data:e,update:n})}),(0,o.jsx)(u.A,{title:(0,t.__)("Featured Image Position And Post Template For All Posts","newspack-plugin"),description:(0,t.__)("Modify how the featured image and post template settings are applied to existing posts. Warning: saving these options will override all posts.","newspack-plugin"),children:(0,o.jsx)(Ie,{data:e,postCount:s.post_count,update:n})}),(0,o.jsx)(u.A,{title:(0,t.__)("Media Credits","newspack-plugin"),children:(0,o.jsx)(ze,{data:e,update:n})}),(0,o.jsx)(u.A,{children:(0,o.jsx)($e,{isFetching:_})}),s.has_pwa_plugin?(0,o.jsx)(u.A,{title:(0,t.__)("Progressive Web App","newspack-plugin"),children:(0,o.jsx)(Ve,{data:e,update:n,isFetching:_})}):null,g&&(0,o.jsx)(l.$T,{}),(0,o.jsxs)("div",{className:"newspack-buttons-card",children:[(0,o.jsx)(l.$n,{variant:"primary",onClick:function(){h({path:"/newspack/v1/wizard/newspack-settings/related-posts-max-age",method:"POST",updateCacheKey:{"/newspack/v1/wizard/newspack-settings/related-content":"GET"},data:c},{onSuccess:p}),("none"===e.featured_image_all_posts&&"none"===e.post_template_all_posts||l.Wp.confirmAction((0,t.__)("Saving will overwrite existing posts, this cannot be undone. Are you sure you want to proceed?","newspack-plugin")))&&d({path:"/newspack/v1/wizard/newspack-setup-wizard/theme",method:"POST",updateCacheMethods:["GET"],data:{theme_mods:e}},{onSuccess:e=>{n({...e,featured_image_all_posts:"none",post_template_all_posts:"none"})}})},children:(0,t.__)("Save","newspack-plugin")}),(0,o.jsx)(l.$n,{variant:"tertiary",href:"/wp-admin/customize.php",children:(0,t.__)("Open Customizer","newspack-plugin")})]})]})},collections:function(){const{description:e,apiData:n,isFetching:s,actionText:i,apiFetchToggle:c,errorMessage:r}=S({path:"/newspack/v1/wizard/newspack-settings/collections",apiNamespace:"newspack-settings/collections",refreshOn:["POST"],data:{...jn,module_enabled_collections:!1},description:(0,t.__)("Manage print editions and other collections of content with custom ordering and organization.","newspack-plugin")}),[d,g]=(0,a.useState)(jn);(0,a.useEffect)(()=>{g((e=>({...jn,...e}))(n))},[n]);const[h,w]=(0,a.useState)(!1);(0,a.useEffect)(()=>{s||w(!1)},[s]);const m=(e,n)=>{g(s=>({...s,[e]:n}))},k="collections",x=(0,a.useMemo)(()=>{const e=(0,bn.cleanForSlug)(d.custom_naming_enabled&&d.custom_slug?d.custom_slug:k)||k,n=new URL(window.newspack_urls?.site||window.location.origin);return n.pathname=n.pathname+(n.pathname.endsWith("/")?"":"/"),new URL(e,n).toString()},[d.custom_naming_enabled,d.custom_slug]);return(0,o.jsxs)("div",{className:"newspack-wizard__sections",children:[(0,o.jsx)("h1",{children:(0,t.__)("Collections Settings","newspack-plugin")}),(0,o.jsx)(_.A,{isMedium:!0,title:(0,t.__)("Collections Module","newspack-plugin"),description:e,disabled:s,actionText:i,error:r,toggleChecked:n.module_enabled_collections,toggleOnChange:e=>c({...n,module_enabled_collections:e},!0)}),n.module_enabled_collections&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(fn,{settings:d,isSaving:h,onChange:m}),(0,o.jsx)(u.A,{title:(0,t.__)("Global CTAs","newspack-plugin"),description:(0,t.__)("Renderd in Collections-related pages. Can be overridden on a per-category or per-collection basis.","newspack-plugin"),children:(0,o.jsxs)(l.xA,{columns:2,gutter:32,children:[(0,o.jsx)(l.xt,{label:(0,t.__)("Subscription URL","newspack-plugin"),help:(0,t.__)('URL for the "Subscribe" button that will be displayed in the Collections archive page when no subscription URL is set for the Collection or its parent category.',"newspack-plugin"),value:d.subscribe_link,onChange:e=>m("subscribe_link",e),placeholder:`e.g., https://${window.location.hostname}/subscribe`}),(0,o.jsx)(l.xt,{label:(0,t.__)("Order URL","newspack-plugin"),help:(0,t.__)('URL for the "Order" button that will be displayed in the Collections archive page when no order URL is set for the Collection or its parent category.',"newspack-plugin"),value:d.order_link,onChange:e=>m("order_link",e),placeholder:`e.g., https://${window.location.hostname}/order`})]})}),(0,o.jsx)(u.A,{title:(0,t.__)("Collections Archive","newspack-plugin"),description:(0,o.jsxs)(o.Fragment,{children:[(0,t.__)("Customize the Collections archive page.","newspack-plugin")," ",(0,o.jsx)(p.ExternalLink,{href:x,children:(0,t.__)("Open archive page","newspack-plugin")})]}),children:(0,o.jsxs)(l.xA,{columns:2,gutter:32,children:[(0,o.jsx)(l.Yq,{label:(0,t.__)("Collections per page","newspack-plugin"),help:(0,t.__)("Number of collections to display per page in the Collections archive page.","newspack-plugin"),value:d.posts_per_page,onChange:e=>m("posts_per_page",e),buttonOptions:vn.map(e=>({label:e.toString(),value:e}))}),(0,o.jsx)(l.xt,{label:(0,t.__)("Category Filter Label","newspack-plugin"),help:(0,t.__)('Custom label for the category filter dropdown (e.g., "Collection:", "Type:", "Series:"). Leave empty to use the default "Publication:".',"newspack-plugin"),value:d.category_filter_label,onChange:e=>m("category_filter_label",e),placeholder:(0,t.__)("Publication:","newspack-plugin")}),(0,o.jsx)(p.ToggleControl,{label:(0,t.__)("Highlight Most Recent Collection","newspack-plugin"),help:(0,t.__)("Feature the latest Collection prominently at the top of the archive page, showcasing its content and any associated CTAs.","newspack-plugin"),checked:d.highlight_latest,onChange:e=>m("highlight_latest",e)})]})}),(0,o.jsx)(u.A,{title:(0,t.__)("Collection Single","newspack-plugin"),description:(0,t.__)("Customize individual collection pages.","newspack-plugin"),children:(0,o.jsxs)(l.xA,{columns:2,gutter:32,children:[(0,o.jsx)(p.ToggleControl,{label:(0,t.__)("Show Category","newspack-plugin"),help:(0,t.__)("Display the category information for posts when rendering them on collection pages.","newspack-plugin"),checked:d.articles_block_attrs?.showCategory||!1,onChange:e=>((e,n,s)=>{g(t=>{const a=t[e]||{};return{...t,[e]:{...a,[n]:s}}})})("articles_block_attrs","showCategory",e)}),(0,o.jsx)(p.ToggleControl,{label:(0,t.__)("Show Cover Story Images","newspack-plugin"),help:(0,t.__)("Display featured images for cover stories on collection pages. Individual collections can override this setting.","newspack-plugin"),checked:d.show_cover_story_img,onChange:e=>m("show_cover_story_img",e)})]})}),(0,o.jsx)(u.A,{title:(0,t.__)("Collection Posts","newspack-plugin"),description:(0,t.__)("Customize post single pages when they belong to a collection.","newspack-plugin"),children:(0,o.jsxs)(l.xA,{columns:2,gutter:32,children:[(0,o.jsx)(l.Yq,{label:(0,t.__)("Collection Indicator Style","newspack-plugin"),help:(0,t.__)("How collection indicators should be displayed on posts. When choosing the default style, an indicator with a link will be displayed at the bottom of the post content.","newspack-plugin"),value:d.post_indicator_style,onChange:e=>m("post_indicator_style",e),buttonOptions:[{label:(0,t.__)("Default","newspack-plugin"),value:"default"},{label:(0,t.__)("Card","newspack-plugin"),value:"card"}]}),"card"===d.post_indicator_style&&(0,o.jsx)(l.xt,{label:(0,t.__)("Card Message","newspack-plugin"),help:(0,t.__)("Custom message displayed in the card style indicator, along with the featured image and a button to view the collection.","newspack-plugin"),value:d.card_message,onChange:e=>m("card_message",e),placeholder:jn.card_message})]})}),(0,o.jsx)("div",{className:"newspack-buttons-card",children:(0,o.jsx)(l.$n,{variant:"primary",onClick:()=>{w(!0),c({...n,...d},!0)},disabled:h,children:h?(0,t.__)("Saving…","newspack-plugin"):(0,t.__)("Save Settings","newspack-plugin")})})]})]})},print:function(){const{description:e,apiData:n,isFetching:s,actionText:a,apiFetchToggle:i,errorMessage:l}=S({path:"/newspack/v1/wizard/newspack-settings/print",apiNamespace:"newspack-settings/print",data:{module_enabled_print:!1},description:(0,t.__)("Allows editors to export article content in Adobe InDesign Tagged Text format.","newspack-plugin")});return(0,o.jsx)(r.A,{title:(0,t.__)("Adobe Indesign","newspack-plugin"),children:(0,o.jsx)(u.A,{children:(0,o.jsx)(_.A,{title:(0,t.__)("Enable InDesign Export","newspack-plugin"),description:e,disabled:s,actionText:a,error:l,toggleChecked:n.module_enabled_print,toggleOnChange:e=>i({...n,module_enabled_print:e},!0)})})})},default:()=>(0,o.jsxs)("h2",{children:["🚫 ",(0,t.__)("Not found")]})};"additional-brands"in Cn&&(yn["additional-brands"]=(0,a.lazy)(()=>s.e(218).then(s.bind(s,1501))));const An=Object.keys(Cn).reduce((e,n)=>{var s,t,a,i;return e.push({label:Cn[n].label,exact:"/"===(null!==(s=Cn[n].path)&&void 0!==s?s:""),path:null!==(t=Cn[n].path)&&void 0!==t?t:`/${n}`,activeTabPaths:null!==(a=Cn[n].activeTabPaths)&&void 0!==a?a:void 0,render:null!==(i=yn[n])&&void 0!==i?i:yn.default}),e},[]);var Sn=s(7791);const{newspack_aux_data:{is_debug_mode:En=!1}}=window,Tn=function(){return(0,o.jsxs)(a.Fragment,{children:[En&&(0,o.jsx)(l.$T,{debugMode:!0}),(0,o.jsx)(l.Du,{}),(0,o.jsx)(Sn.A,{className:"newspack-admin__tabs",headerText:(0,t.__)("Newspack / Settings","newspack"),sections:An,isInitialFetchTriggered:!1})]})}},6837:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(3984),a=s(790);const i=({description:e,error:n,isChecked:s,notificationLevel:i="error",children:l,...o})=>{let c;return void 0!==s&&(c=s?"checked":"unchecked"),(0,a.jsx)(t.Lz,{description:e,checkbox:c,notification:n,notificationLevel:i,...o,children:l})}},6951:(e,n,s)=>{s.r(n),s.d(n,{default:()=>U});var t=s(7723),a=s(6087),i=s(7677),l=s(790),o=s(5573),c=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{fillRule:"evenodd",d:"M11.25 5h1.5v15h-1.5V5zM6 10h1.5v10H6V10zm12 4h-1.5v6H18v-6z",clipRule:"evenodd"})}),r=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M10.7 9.6c.3-.2.8-.4 1.3-.4s1 .2 1.3.4c.3.2.4.5.4.6 0 .4.3.8.8.8s.8-.3.8-.8c0-.8-.5-1.4-1.1-1.9-.4-.3-.9-.5-1.4-.6v-.3c0-.4-.3-.8-.8-.8s-.8.3-.8.8v.3c-.5 0-1 .3-1.4.6-.6.4-1.1 1.1-1.1 1.9s.5 1.4 1.1 1.9c.6.4 1.4.6 2.2.6h.2c.5 0 .9.2 1.1.4.3.2.4.5.4.6s0 .4-.4.6c-.3.2-.8.4-1.3.4s-1-.2-1.3-.4c-.3-.2-.4-.5-.4-.6 0-.4-.3-.8-.8-.8s-.8.3-.8.8c0 .8.5 1.4 1.1 1.9.4.3.9.5 1.4.6v.3c0 .4.3.8.8.8s.8-.3.8-.8v-.3c.5 0 1-.3 1.4-.6.6-.4 1.1-1.1 1.1-1.9s-.5-1.4-1.1-1.9c-.5-.4-1.2-.6-1.9-.6H12c-.6 0-1-.2-1.3-.4-.3-.2-.4-.5-.4-.6s0-.4.4-.6ZM12 4c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8Zm0 14.5c-3.6 0-6.5-2.9-6.5-6.5S8.4 5.5 12 5.5s6.5 2.9 6.5 6.5-2.9 6.5-6.5 6.5Z"})}),p=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M3 7c0-1.1.9-2 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Zm2-.5h14c.3 0 .5.2.5.5v1L12 13.5 4.5 7.9V7c0-.3.2-.5.5-.5Zm-.5 3.3V17c0 .3.2.5.5.5h14c.3 0 .5-.2.5-.5V9.8L12 15.4 4.5 9.8Z"})}),d=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M11.1 15.8H20v-1.5h-8.9v1.5zm0-8.6v1.5H20V7.2h-8.9zM6 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),u=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M12 4c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8Zm6.5 8c0 .6 0 1.2-.2 1.8h-2.7c0-.6.2-1.1.2-1.8s0-1.2-.2-1.8h2.7c.2.6.2 1.1.2 1.8Zm-.9-3.2h-2.4c-.3-.9-.7-1.8-1.1-2.4-.1-.2-.2-.4-.3-.5 1.6.5 3 1.6 3.8 3ZM12.8 17c-.3.5-.6 1-.8 1.3-.2-.3-.5-.8-.8-1.3-.3-.5-.6-1.1-.8-1.7h3.3c-.2.6-.5 1.2-.8 1.7Zm-2.9-3.2c-.1-.6-.2-1.1-.2-1.8s0-1.2.2-1.8H14c.1.6.2 1.1.2 1.8s0 1.2-.2 1.8H9.9ZM11.2 7c.3-.5.6-1 .8-1.3.2.3.5.8.8 1.3.3.5.6 1.1.8 1.7h-3.3c.2-.6.5-1.2.8-1.7Zm-1-1.2c-.1.2-.2.3-.3.5-.4.7-.8 1.5-1.1 2.4H6.4c.8-1.4 2.2-2.5 3.8-3Zm-1.8 8H5.7c-.2-.6-.2-1.1-.2-1.8s0-1.2.2-1.8h2.7c0 .6-.2 1.1-.2 1.8s0 1.2.2 1.8Zm-2 1.4h2.4c.3.9.7 1.8 1.1 2.4.1.2.2.4.3.5-1.6-.5-3-1.6-3.8-3Zm7.4 3c.1-.2.2-.3.3-.5.4-.7.8-1.5 1.1-2.4h2.4c-.8 1.4-2.2 2.5-3.8 3Z"})}),_=s(8176),g=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M12 9c-.8 0-1.5.7-1.5 1.5S11.2 12 12 12s1.5-.7 1.5-1.5S12.8 9 12 9zm0-5c-3.6 0-6.5 2.8-6.5 6.2 0 .8.3 1.8.9 3.1.5 1.1 1.2 2.3 2 3.6.7 1 3 3.8 3.2 3.9l.4.5.4-.5c.2-.2 2.6-2.9 3.2-3.9.8-1.2 1.5-2.5 2-3.6.6-1.3.9-2.3.9-3.1C18.5 6.8 15.6 4 12 4zm4.3 8.7c-.5 1-1.1 2.2-1.9 3.4-.5.7-1.7 2.2-2.4 3-.7-.8-1.9-2.3-2.4-3-.8-1.2-1.4-2.3-1.9-3.3-.6-1.4-.7-2.2-.7-2.5 0-2.6 2.2-4.7 5-4.7s5 2.1 5 4.7c0 .2-.1 1-.7 2.4z"})}),h=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{fillRule:"evenodd",d:"M6.863 13.644L5 13.25h-.5a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5H5L18 6.5h2V16h-2l-3.854-.815.026.008a3.75 3.75 0 01-7.31-1.549zm1.477.313a2.251 2.251 0 004.356.921l-4.356-.921zm-2.84-3.28L18.157 8h.343v6.5h-.343L5.5 11.823v-1.146z",clipRule:"evenodd"})}),w=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{fillRule:"evenodd",d:"M5.5 9.5v-2h13v2h-13zm0 3v4h13v-4h-13zM4 7a1 1 0 011-1h14a1 1 0 011 1v10a1 1 0 01-1 1H5a1 1 0 01-1-1V7z",clipRule:"evenodd"})}),m=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"m7.3 9.7 1.4 1.4c.2-.2.3-.3.4-.5 0 0 0-.1.1-.1.3-.5.4-1.1.3-1.6L12 7 9 4 7.2 6.5c-.6-.1-1.1 0-1.6.3 0 0-.1 0-.1.1-.3.1-.4.2-.6.4l1.4 1.4L4 11v1h1l2.3-2.3zM4 20h9v-1.5H4V20zm0-5.5V16h16v-1.5H4z"})}),k=(0,l.jsxs)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,l.jsx)(o.Path,{d:"M11.696 13.972c.356-.546.599-.958.728-1.235a1.79 1.79 0 00.203-.783c0-.264-.077-.47-.23-.618-.148-.153-.354-.23-.618-.23-.295 0-.569.07-.82.212a3.413 3.413 0 00-.738.571l-.147-1.188c.289-.234.59-.41.903-.526.313-.117.66-.175 1.041-.175.375 0 .695.08.959.24.264.153.46.362.59.626.135.265.203.556.203.876 0 .362-.08.734-.24 1.115-.154.381-.427.87-.82 1.466l-.756 1.152H14v1.106h-4l1.696-2.609z"}),(0,l.jsx)(o.Path,{d:"M19.5 7h-15v12a.5.5 0 00.5.5h14a.5.5 0 00.5-.5V7zM3 7V5a2 2 0 012-2h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"})]}),x=s(8722),b=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M15.1 4.8l-3-2.5V4c-4.4 0-8 3.6-8 8 0 3.7 2.5 6.9 6 7.7.3.1.6.1 1 .2l.2-1.5c-.4 0-.7-.1-1.1-.2l-.1.2v-.2c-2.6-.8-4.5-3.3-4.5-6.2 0-3.6 2.9-6.5 6.5-6.5v1.8l3-2.5zM20 11c-.2-1.4-.7-2.7-1.6-3.8l-1.2.8c.7.9 1.1 2 1.3 3.1L20 11zm-1.5 1.8c-.1.5-.2 1.1-.4 1.6s-.5 1-.8 1.5l1.2.9c.4-.5.8-1.1 1-1.8s.5-1.3.5-2l-1.5-.2zm-5.6 5.6l.2 1.5c1.4-.2 2.7-.7 3.8-1.6l-.9-1.1c-.9.7-2 1.1-3.1 1.2z"})}),f=s(9214),v=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{fillRule:"evenodd",d:"M19.75 11H21V8.667L19.875 4H4.125L3 8.667V11h1.25v8.75h15.5V11zm-1.5 0H5.75v7.25H10V13h4v5.25h4.25V11zm-5.5-5.5h2.067l.486 3.24.028.76H12.75v-4zm-3.567 0h2.067v4H8.669l.028-.76.486-3.24zm7.615 3.1l-.464-3.1h2.36l.806 3.345V9.5h-2.668l-.034-.9zM7.666 5.5h-2.36L4.5 8.845V9.5h2.668l.034-.9.464-3.1z",clipRule:"evenodd"})}),j=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M14.103 7.128l2.26-2.26a4 4 0 00-5.207 4.804L5.828 15a2 2 0 102.828 2.828l5.329-5.328a4 4 0 004.804-5.208l-2.261 2.26-1.912-.512-.513-1.912zm-7.214 9.64a.5.5 0 11.707-.707.5.5 0 01-.707.707z"})});const C=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M19 5H5C4.46957 5 3.96086 5.21071 3.58579 5.58579C3.21071 5.96086 3 6.46957 3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19H19C19.5304 19 20.0391 18.7893 20.4142 18.4142C20.7893 18.0391 21 17.5304 21 17V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5ZM19.5 17C19.5 17.1326 19.4473 17.2598 19.3536 17.3536C19.2598 17.4473 19.1326 17.5 19 17.5H5C4.86739 17.5 4.74021 17.4473 4.64645 17.3536C4.55268 17.2598 4.5 17.1326 4.5 17V7C4.5 6.86739 4.55268 6.74021 4.64645 6.64645C4.74021 6.55268 4.86739 6.5 5 6.5H19C19.1326 6.5 19.2598 6.55268 19.3536 6.64645C19.4473 6.74021 19.5 6.86739 19.5 7V17ZM16.007 9.736C15.568 9.50644 15.0783 9.3909 14.583 9.4H12.487V15H14.583C15.116 15 15.591 14.89 16.007 14.668C16.423 14.444 16.75 14.124 16.987 13.708C17.224 13.289 17.343 12.787 17.343 12.2C17.343 11.613 17.224 11.112 16.987 10.696C16.7603 10.2877 16.4198 9.95421 16.007 9.736ZM16.039 13.208C15.916 13.491 15.734 13.708 15.491 13.86C15.248 14.012 14.946 14.088 14.583 14.088H13.511V10.312H14.583C14.946 10.312 15.248 10.388 15.491 10.54C15.734 10.692 15.916 10.91 16.039 11.192C16.162 11.475 16.223 11.811 16.223 12.2C16.223 12.589 16.162 12.925 16.039 13.208ZM8.387 9.4L6.395 15H7.387L7.854 13.672H9.889L10.355 15H11.347L9.355 9.4H8.387ZM8.168 12.776L8.871 10.776L9.574 12.776H8.168Z"})}),y=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M4.5 16.9995V9.81253L12 15.4375L19.5 9.81253V14.3295H21V6.99953C21 6.46909 20.7893 5.96039 20.4142 5.58531C20.0391 5.21024 19.5304 4.99953 19 4.99953H5C4.46957 4.99953 3.96086 5.21024 3.58579 5.58531C3.21071 5.96039 3 6.46909 3 6.99953V16.9995C3 17.53 3.21071 18.0387 3.58579 18.4137C3.96086 18.7888 4.46957 18.9995 5 18.9995H12.42V17.4995H5C4.86739 17.4995 4.74021 17.4468 4.64645 17.3531C4.55268 17.2593 4.5 17.1321 4.5 16.9995ZM4.5 6.99953C4.5 6.86692 4.55268 6.73974 4.64645 6.64597C4.74021 6.55221 4.86739 6.49953 5 6.49953H19C19.1326 6.49953 19.2598 6.55221 19.3536 6.64597C19.4473 6.73974 19.5 6.86692 19.5 6.99953V7.93753L12 13.5625L4.5 7.93553V6.99953ZM15.035 15.8295L13.375 20.4965H14.202L14.591 19.3905H16.287L16.676 20.4975H17.502L15.842 15.8295H15.035ZM14.853 18.6435L15.439 16.9765L16.024 18.6435H14.853ZM22.203 16.9095C22.014 16.5692 21.7302 16.2913 21.386 16.1095C21.0203 15.9184 20.6125 15.8221 20.2 15.8295H18.453V20.4965H20.2C20.644 20.4965 21.04 20.4045 21.386 20.2205C21.733 20.0335 22.006 19.7665 22.203 19.4205C22.401 19.0705 22.5 18.6525 22.5 18.1635C22.5 17.6735 22.401 17.2565 22.203 16.9095ZM21.413 19.0035C21.3204 19.2274 21.1608 19.4171 20.956 19.5465C20.754 19.6735 20.502 19.7365 20.2 19.7365H19.306V16.5895H20.2C20.502 16.5895 20.754 16.6535 20.956 16.7795C21.159 16.9065 21.311 17.0875 21.413 17.3235C21.5213 17.59 21.5737 17.8759 21.567 18.1635C21.5737 18.4511 21.5213 18.737 21.413 19.0035Z"})}),A=(0,l.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,l.jsx)(o.Path,{d:"M15.333 4C16.6677 4 17.75 5.0823 17.75 6.41699V6.75C17.75 7.20058 17.6394 7.62468 17.4473 8H18.5C19.2767 8 19.9154 8.59028 19.9922 9.34668L20 9.5V18.5C20 19.3284 19.3284 20 18.5 20H5.5C4.72334 20 4.08461 19.4097 4.00781 18.6533L4 18.5V9.5L4.00781 9.34668C4.07949 8.64069 4.64069 8.07949 5.34668 8.00781L5.5 8H6.55273C6.36065 7.62468 6.25 7.20058 6.25 6.75V6.41699C6.25 5.0823 7.3323 4 8.66699 4C10.0436 4.00011 11.2604 4.68183 12 5.72559C12.7396 4.68183 13.9564 4.00011 15.333 4ZM5.5 18.5H11.25V9.5H5.5V18.5ZM12.75 18.5H18.5V9.5H12.75V18.5ZM8.66699 5.5C8.16073 5.5 7.75 5.91073 7.75 6.41699V6.75C7.75 7.44036 8.30964 8 9 8H11.2461C11.2021 6.61198 10.0657 5.50017 8.66699 5.5ZM15.333 5.5C13.9343 5.50017 12.7979 6.61198 12.7539 8H15C15.6904 8 16.25 7.44036 16.25 6.75V6.41699C16.25 5.91073 15.8393 5.5 15.333 5.5Z"})}),S={chartBar:c,currencyDollar:r,envelope:p,formatListBullets:d,globe:u,help:_.A,mapMarker:g,megaphone:h,payment:w,post:m,postDate:k,postList:x.A,rotateRight:b,settings:f.A,store:v,tool:j,ad:C,emailAd:y,gift:A};var E=s(3984);const{newspackDashboard:{sections:T}}=window,L=[{label:(0,t.__)("Dashboard","newspack"),path:"/",render:()=>Object.keys(T).map(e=>(0,l.jsxs)(a.Fragment,{children:[(0,l.jsx)("hr",{}),(0,l.jsxs)("div",{className:"newspack-dashboard__section",children:[(0,l.jsx)("h3",{children:T[e].title}),(0,l.jsx)("p",{children:T[e].desc}),(0,l.jsx)(E.xA,{columns:3,gutter:24,children:T[e].cards.map((n,s)=>{return(0,l.jsx)("a",{href:n.href,children:(0,l.jsxs)(E.Zp,{className:"newspack-dashboard__card",children:[(0,l.jsx)("div",{className:"newspack-dashboard__card-icon",children:(0,l.jsx)(i.A,{size:32,icon:(t=n.icon,t in S?S[t]:S.help)})}),(0,l.jsxs)("div",{className:"newspack-dashboard__card-text",children:[(0,l.jsx)("h4",{children:n.title}),(0,l.jsx)("p",{children:n.desc})]})]})},`${e}-card-${s}`);var t})},`${e}-grid`)]})]},e))}],{settings:N}=window.newspackDashboard,P=()=>(0,l.jsx)("header",{className:"newspack-dashboard__brand-header",style:{backgroundColor:N.headerBgColor},children:(0,l.jsx)(E.Kk,{className:"brand-header__inner",hexColor:N.headerBgColor,children:(0,l.jsx)("h1",{children:N.siteName})})}),{newspackDashboard:{quickActions:M}}=window,F=()=>(0,l.jsxs)("div",{className:"newspack-dashboard__section",children:[(0,l.jsx)("h3",{children:(0,t.__)("Quick actions","newspack-plugin")}),(0,l.jsx)(E.xA,{style:{"--np-dash-card-icon-size":"40px"},columns:3,gutter:24,children:M.map((e,n)=>(0,l.jsx)("a",{href:e.href,children:(0,l.jsxs)(E.Zp,{className:"newspack-dashboard__card",children:[(0,l.jsx)("div",{className:"newspack-dashboard__card-icon",children:(0,l.jsx)(i.A,{icon:S[e.icon]})}),(0,l.jsx)("h4",{children:e.title})]})},n))})]});var I=s(1455),O=s.n(I),z=s(6427);const $=({onRequestClose:e,plugins:n,onSuccess:s})=>(0,l.jsx)(E.aF,{title:(0,t.__)("Add missing dependencies","newspack-plugin"),onRequestClose:()=>e(!1),children:(0,l.jsx)(E.I2,{plugins:n,canUninstall:!0,onStatus:({complete:n,pluginInfo:t})=>{n&&(s(t),e(!1))}})}),H={idle:void 0,success:(0,t.__)("Connected","newspack-plugin"),pending:(0,t.__)("Fetching…","newspack-plugin"),"pending-install":(0,t.__)("Installing…","newspack-plugin"),error:(0,t.__)("Disconnected","newspack-plugin"),"error-dependencies":void 0,"error-preflight":void 0,"error-request":void 0},V=({label:e="",isPreflightValid:n=!0,dependencies:s,statuses:i,endpoint:o,configLink:c,then:r})=>{const p={...H,...i},[d,u]=(0,a.useState)(200),[_,g]=(0,a.useState)("idle"),[h,w]=(0,a.useState)([]),[m,k]=(0,a.useState)(!1),x=structuredClone(s);function b(e={}){if(x&&Object.keys(e).length>0)for(const[n]of Object.entries(e))x[n].isActive=!0;return new Promise(e=>{if(x&&Object.keys(x).length>0){const n=[];for(const[e,s]of Object.entries(x))s.isActive||n.push(e);if(w(n),n.length>0)return g("error-dependencies"),void e(!1)}if(!n)return g("error-preflight"),void e(!1);g("pending"),O()({path:o,parse:!1}).then(async n=>{const s=n;u(s.status);const t=await s.json(),a=r(t);g(a?"success":"error"),e(a)}).catch(n=>{var s;const t=null!==(s=n?.status)&&void 0!==s?s:500;g(t>399?"error-request":"error"),u(t),e()})})}(0,a.useEffect)(()=>{b()},[]);const f=`newspack-site-status newspack-site-status__${_}`;return(0,l.jsxs)(l.Fragment,{children:[m&&(0,l.jsx)($,{plugins:h,onSuccess:b,onRequestClose:k}),"error"===_&&(0,l.jsx)(z.Tooltip,{text:(0,t.__)("Click to navigate to configuration","newspack-plugin"),children:(0,l.jsxs)("a",{href:c,className:f,children:[e,": ",(0,l.jsx)("span",{children:p[_]}),(0,l.jsx)("span",{className:"hidden",children:(0,t.__)("Configure?")})]})}),"error-dependencies"===_&&x&&(0,l.jsx)(z.Tooltip,{text:(0,t.sprintf)(
// translators: %s is a comma separated list of needed dependencies.
// translators: %s is a comma separated list of needed dependencies.
(0,t.__)("%s must be installed & activated!"),h.map(e=>x[e].label).join(", ")),children:(0,l.jsxs)("button",{onClick:()=>k(!0),className:f,children:[e,": ",(0,l.jsx)("span",{children:(0,t._n)("Missing dependency","Missing dependencies",h.length,"newspack-plugin")}),(0,l.jsx)("span",{className:"hidden",children:(0,t._n)("Install dependency","Install dependencies",h.length,"newspack-plugin")})]})}),["error-preflight","success","idle","pending","error-request"].includes(_)&&(0,l.jsxs)("div",{className:f,children:[e,":"," ",(0,l.jsx)("span",{children:"error-request"===_?(0,t.sprintf)(/* translators: %d is the HTTP status code */ /* translators: %d is the HTTP status code */
(0,t.__)("Request failed - %d","newspack-plugin"),d):p[_]})]})]})},{newspackDashboard:{siteStatuses:D}}=window,R={readerActivation:{...D.readerActivation,then:({config:e})=>Boolean(e?.enabled)},googleAnalytics:{...D.googleAnalytics,then:({propertyID:e=""})=>""!==e},googleAdManager:{...D.googleAdManager,then:({services:{google_ad_manager:e}})=>e.available&&"1"===e.enabled}},B=()=>(0,l.jsxs)("div",{className:"newspack-dashboard__section",children:[(0,l.jsx)("h3",{children:(0,t.__)("Site status","newspack-plugin")}),(0,l.jsx)(E.xA,{columns:3,gutter:24,children:Object.keys(R).map(e=>(0,l.jsx)(V,{...R[e]},e))})]}),{newspack_aux_data:{is_debug_mode:G=!1}}=window,U=function(){return(0,l.jsxs)(a.Fragment,{children:[(0,l.jsx)(E.Du,{}),G&&(0,l.jsx)(E.$T,{debugMode:!0}),(0,l.jsx)(E.sQ,{headerText:(0,t.__)("Newspack / Dashboard","newspack"),sections:L,renderAboveSections:()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P,{}),(0,l.jsx)(B,{}),(0,l.jsx)("hr",{}),(0,l.jsx)(F,{})]})})]})}},7153:(e,n,s)=>{s.d(n,{M1:()=>l,Ss:()=>i.A,u:()=>a.A});var t=s(7723),a=s(4058),i=s(1075);const l={MAILCHIMP_API_KEY_INVALID:(0,t.__)("Invalid Mailchimp API Key.","newspack-plugin"),GOOGLEOAUTH_REFRESH_TOKEN_EXPIRED:(0,t.__)("Missing Google refresh token. Please re-authenticate site.","newspack-plugin"),GOOGLE:{OAUTH_POPUP_BLOCKED:(0,t.__)("Popup blocked by browser. Disable any popup blocking settings and try again.","newspack-plugin"),URL_INVALID:(0,t.__)("URL is invalid. Please try again or contact support if the issue persists.","newspack-plugin")}}},7896:(e,n,s)=>{s.d(n,{A:()=>p});var t=s(7723),a=s(6087),i=s(3984),l=s(6837),o=s(2005),c=s(7153),r=s(790);const p=function({onSuccess:e,isOnboarding:n}){const[s,p]=(0,a.useState)({}),d=s?.user_basic_info,u=Boolean(d&&d.email),{setError:_,errorMessage:g,wizardApiFetch:h,isFetching:w}=(0,o.L)("/newspack-settings/connections/apis/google-oauth");function m(){(function(){const e=new URLSearchParams(window.location.search),n={};for(const[s,t]of e.entries())n[s]=t;return n})().access_token||h({path:"/newspack/v1/oauth/google",isCached:!1},{onSuccess(n){p(n),n?.user_basic_info&&("function"==typeof e&&e(n),_(null))}})}return(0,a.useEffect)(()=>{n||m()},[]),(0,a.useEffect)(()=>{u&&d&&!d.has_refresh_token&&_(new c.u(c.M1.GOOGLEOAUTH_REFRESH_TOKEN_EXPIRED,"googleoauth_refresh_token_expired"))},[u]),(0,r.jsx)(l.A,{title:(0,t.__)("Google","newspack-plugin"),description:w?(0,t.__)("Loading…","newspack-plugin"):u?(0,t.sprintf)(
// translators: %s: connected user's email address.
// translators: %s: connected user's email address.
(0,t.__)("Connected as %s","newspack-plugin"),d?.email):(0,t.__)("Not connected","newspack-plugin"),isChecked:u,actionText:(0,r.jsx)(i.$n,{variant:"link",isDestructive:u,onClick:u?function(){h({path:"/newspack/v1/oauth/google/revoke",method:"DELETE"},{onSuccess:()=>p({})})}:function(){let e=null;h({path:"/newspack/v1/oauth/google/start",isCached:!1},{onSuccess(n){if(null===n)return void _(new c.u(c.M1.GOOGLE.URL_INVALID,"googleoauth_popup_blocked"));if(e=window.open(n,"newspack_google_oauth","width=500,height=600"),null===e)return void _(new c.u(c.M1.GOOGLE.OAUTH_POPUP_BLOCKED,"googleoauth_popup_blocked"));const s=setInterval(()=>{e?.closed&&(clearInterval(s),m())},500)},onError(){e&&e.close()}})},disabled:w,children:u?(0,t.__)("Disconnect","newspack-plugin"):(0,t.__)("Connect","newspack-plugin")}),error:g,isMedium:!0})}},8169:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(790),a=s(5573),i=(0,t.jsx)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(a.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})})},8721:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(3984),a=s(790);function i({title:e,description:n,children:s=null,scrollToAnchor:i=null,className:l}){const o="newspack-wizard__section"+(l?` ${l}`:"");return(0,a.jsxs)("div",{className:o,children:[e&&(0,a.jsx)(t.X3,{id:i,heading:3,title:e,description:n}),s]})}},8722:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(790),a=s(5573),i=(0,t.jsx)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)(a.Path,{d:"M18 5.5H6a.5.5 0 0 0-.5.5v12a.5.5 0 0 0 .5.5h12a.5.5 0 0 0 .5-.5V6a.5.5 0 0 0-.5-.5ZM6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Zm1 5h1.5v1.5H7V9Zm1.5 4.5H7V15h1.5v-1.5ZM10 9h7v1.5h-7V9Zm7 4.5h-7V15h7v-1.5Z"})})},9214:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(790),a=s(5573),i=(0,t.jsxs)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,t.jsx)(a.Path,{d:"m19 7.5h-7.628c-.3089-.87389-1.1423-1.5-2.122-1.5-.97966 0-1.81309.62611-2.12197 1.5h-2.12803v1.5h2.12803c.30888.87389 1.14231 1.5 2.12197 1.5.9797 0 1.8131-.62611 2.122-1.5h7.628z"}),(0,t.jsx)(a.Path,{d:"m19 15h-2.128c-.3089-.8739-1.1423-1.5-2.122-1.5s-1.8131.6261-2.122 1.5h-7.628v1.5h7.628c.3089.8739 1.1423 1.5 2.122 1.5s1.8131-.6261 2.122-1.5h2.128z"})]})}}]);