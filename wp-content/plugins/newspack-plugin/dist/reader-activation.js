(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{on:()=>c,off:()=>l,setReaderEmail:()=>s,setAuthenticated:()=>h,refreshAuthentication:()=>f,getReader:()=>v,hasAuthLink:()=>p,setAuthStrategy:()=>_,getAuthStrategy:()=>g,default:()=>k});const n={reader:"reader"},a={};function r(e){if(!e)return"";const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?decodeURIComponent(t.pop().split(";").shift()):void 0}function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:365;const a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3),document.cookie=`${e}=${t}; expires=${a.toUTCString()}; path=/`}const o=Object.values(n);function d(e){return o.includes(e)?`newspack-reader-activation-${e}`:""}function u(e,t){if(!(e=d(e)))throw"Invalid event";window.dispatchEvent(new CustomEvent(e,{detail:t}))}function c(e,t){if(!(e=d(e)))throw"Invalid event";window.addEventListener(e,t)}function l(e,t){if(!(e=d(e)))throw"Invalid event";window.removeEventListener(e,t)}function s(e){e&&(a.reader||(a.reader={}),a.reader.email=e,u(n.reader,a.reader))}function h(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===(e=a.reader)||void 0===e||!e.email)throw"Reader email not set";a.reader.authenticated=Boolean(t),u(n.reader,a.reader)}function f(){const e=r("np_auth_reader");e?(s(e),h(!0)):s(r("np_auth_intention"))}function v(){return a.reader}function p(){const e=v(),t=r("np_auth_link");return!(null==e||!e.email||!t)}const w=["pwd","link"];function _(e){if(!w.includes(e))throw"Invalid authentication strategy";return i("np_auth_strategy",e),e}function g(){return r("np_auth_strategy")}!function(){const e=window.newspack_reader_activation_data,t=(null==e?void 0:e.authenticated_email)||r("np_auth_intention"),i=!(null==e||!e.authenticated_email);a.reader=t?{email:t,authenticated:i}:null,u(n.reader,a.reader)}();const m={on:c,off:l,setReaderEmail:s,setAuthenticated:h,refreshAuthentication:f,getReader:v,hasAuthLink:p,setAuthStrategy:_,getAuthStrategy:g};window.newspackReaderActivation=m;const y=window.newspack_reader_activation_data.cid_cookie;if(!r(y)){const e=()=>Math.floor(999999999*Math.random()).toString(36);i(y,`${e()}${e()}`)}const k=m;var A=window;for(var S in t)A[S]=t[S];t.__esModule&&Object.defineProperty(A,"__esModule",{value:!0})})();