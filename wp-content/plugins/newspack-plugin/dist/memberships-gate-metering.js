(()=>{const e=newspack_metering_settings,t="metering-"+e.gate_id||0;function n(n){const o=function(n){const o=function(){const t=new Date;switch(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),e.period){case"day":t.setDate(t.getDate()+1);break;case"week":const e=6-t.getDay();t.setDate(t.getDate()+e);break;case"month":t.setMonth(t.getMonth()+1),t.setDate(1)}return parseInt(t.getTime()/1e3,10)}(),c=n.get(t)||{content:[],expiration:o};return c.expiration=parseInt(c.expiration,10)||0,c.expiration!==o&&(c.expiration<o&&(c.content=[]),c.expiration=o),n.set(t,c),c}(n.store);let c=!1;e.count<=o.content.length&&!o.content.includes(e.post_id)?(!function(){const t=document.querySelector(".entry-content");if(!t)return;document.querySelectorAll(".newspack-popup").forEach((e=>{e.parentNode.removeChild(e)})),t.innerHTML=e.excerpt;const n=document.getElementById("comments");n&&n.remove();const o=document.querySelector(".newspack-memberships__inline-gate");o&&t.appendChild(o)}(),c=!0):document.querySelectorAll(".newspack-memberships__gate").forEach((e=>{e.parentNode.removeChild(e)})),c||(e.article_view&&n.dispatchActivity(e.article_view.action,e.article_view.data),o.content.includes(e.post_id)||(o.content.push(e.post_id),n.store.set(t,o)))}window.newspackRAS=window.newspackRAS||[],window.newspackRAS.push((e=>n(e)))})();