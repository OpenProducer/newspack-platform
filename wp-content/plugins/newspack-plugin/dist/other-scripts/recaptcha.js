(()=>{"use strict";function e(e){"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",e):e())}window.newspack_grecaptcha=window.newspack_grecaptcha||{destroy:function(e=[]){a&&(e.length?e:[...document.querySelectorAll("form[data-newspack-recaptcha]")]).forEach((e=>{!function(e){const t=e.querySelector('input[name="g-recaptcha-response"]');t&&t.parentElement.removeChild(t)}(e)}))},render:o,version:newspack_recaptcha_data.version};const t="v2"===newspack_recaptcha_data.version.substring(0,2),a="v3"===newspack_recaptcha_data.version,r=newspack_recaptcha_data.site_key,c="v2_invisible"===newspack_recaptcha_data.version;function n(e,t="submit"){if(e)return grecaptcha.execute(r,{action:t}).then((t=>{e.value=t}))}function i(e){const t=parseInt(e.getAttribute("data-recaptcha-widget-id"));isNaN(t)||grecaptcha.reset(t)}function o(u=[],s=null,p=null){if(!grecaptcha)return e((()=>grecaptcha.ready((()=>o(u,s,p)))));(u.length?u:[...document.querySelectorAll("form[data-newspack-recaptcha]")]).forEach((e=>{a&&function(e){let t=e.querySelector('input[name="g-recaptcha-response"]');if(!t){t=document.createElement("input"),t.type="hidden",t.name="g-recaptcha-response",e.appendChild(t);const r=e.getAttribute("data-newspack-recaptcha")||"submit";n(t,r),setInterval((()=>n(t,r)),3e4),(a=jQuery)&&(a(document).on("updated_checkout",(()=>n(t,r))),a(document.body).on("checkout_error",(()=>n(t,r))))}var a}(e),t&&function(e,t=null,a=null){const n=[...e.querySelectorAll('input[type="submit"], button[type="submit"]')],o={sitekey:r,size:c?"invisible":"normal",isolated:!0};n.forEach((r=>{if(r.hasAttribute("data-skip-recaptcha"))return;if(r.hasAttribute("data-recaptcha-retry-count")&&parseInt(r.getAttribute("data-recaptcha-retry-count"))>=3)return;if(r.hasAttribute("data-recaptcha-widget-id"))return void i(r);const c=()=>{t?.(),e.requestSubmit(r),i(r)},n=grecaptcha.render(r,{...o,callback:c,"error-callback":()=>{const e=parseInt(r.getAttribute("data-recaptcha-retry-count"))||0;e<3?(r.setAttribute("data-recaptcha-retry-count",e+1),i(r)):clearInterval(u);const t=e<3?wp.i18n.__("There was an error with reCAPTCHA. Please try again.","newspack-plugin"):wp.i18n.__("There was an error with reCAPTCHA. Please reload the page and try again.","newspack-plugin");a?a(t):alert(t)}});r.setAttribute("data-recaptcha-widget-id",n);const u=setInterval((()=>i(r)),12e4);r.addEventListener("click",(e=>{e.preventDefault(),r.hasAttribute("data-skip-recaptcha")?c():grecaptcha.execute(n)}))}))}(e,s,p)}))}e((function(){grecaptcha.ready(o)}))})();