(()=>{"use strict";var e,t={9722:(e,t,n)=>{var a=n(9430);const o=["signin_modal","register_modal"];function r(){return document.querySelector(".newspack-reader-auth-modal .newspack-reader-auth")}function i(e={}){const t=window.newspackReaderActivation.getReader(),n=e.trigger;if(t?.authenticated)return void(e.onSuccess&&"function"==typeof e.onSuccess&&e.onSuccess());const i=r();if(!i)return void(e.onSuccess&&"function"==typeof e.onSuccess&&e.onSuccess());const s=i.closest(".newspack-reader-auth-modal");if(!s)return void(e.onSuccess&&"function"==typeof e.onSuccess&&e.onSuccess());const c=(t=!0)=>{i.config={},s.setAttribute("data-state","closed"),document.body.classList.remove("newspack-signin"),document.body.style.overflow="auto",s.overlayId&&window.newspackReaderActivation?.overlays&&window.newspackReaderActivation.overlays.remove(s.overlayId);const a=i.querySelector(".opener-content");a&&a.remove(),n&&n.focus(),t&&e.onDismiss&&"function"==typeof e.onDismiss&&e.onDismiss()},l=s.querySelectorAll("button[data-close], .newspack-ui__modal__close");if(l?.length&&l.forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault(),c()}))})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&c()})),e.labels={...newspack_reader_activation_labels,...e?.labels},i.config=e,i.authCallback=(t,n)=>{c(!1),e.onSuccess&&"function"==typeof e.onSuccess&&e.onSuccess(t,n)},i.formActionCallback=t=>{s.querySelector("h2").textContent="register"===t?e.labels.register.title:e.labels.signin.title,s.querySelectorAll("[data-action]").forEach((e=>{"none"!==e.style.display&&(e.prevDisplay=e.style.display),e.style.display="none"})),s.querySelectorAll('[data-action~="'+t+'"]').forEach((e=>{e.style.display=e.prevDisplay})),a.o(s)},e.content){const t=document.createElement("div");t.classList.add("opener-content"),t.innerHTML=e.content;const n=i.querySelector("form");n.insertBefore(t,n.firstChild)}const d=i.querySelector('input[name="npe"]');d&&(d.value=t?.email||"");let u="signin";window.newspackReaderActivation?.hasAuthLink()&&(u="otp");const p=window.location.hash.replace("#","");o.includes(p)&&(u="register_modal"===p?"register":"signin"),e.initialState&&(u=e.initialState),i.setFormAction(u,!0),"otp"===u&&window?.newspackReaderActivation?.getOTPTimeRemaining()<=0&&i.setFormAction("signin"),document.body.classList.add("newspack-signin"),document.body.style.overflow="hidden",s.setAttribute("data-state","open"),window.newspackReaderActivation?.overlays&&(s.overlayId=window.newspackReaderActivation.overlays.add(),a.o(s)),o.includes(window.location.hash.replace("#",""))&&history.pushState("",document.title,window.location.pathname+window.location.search)}function s(e){"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",e):e())}var c=n(5325),l=n(2864);s((function(){[...document.querySelectorAll(".newspack-reader__logins")].forEach((e=>{e.classList.remove("newspack-reader__logins--disabled")})),document.querySelectorAll(".newspack-ui__button--google-oauth").forEach((e=>{const t=e.closest("form");e.addEventListener("click",(()=>{t?.startLoginFlow&&t.startLoginFlow();const e=t?function(e,t=[]){return Array.from(e.entries()).reduce(((e,[n,a])=>t.includes(n)?(n.indexOf("[]")>-1?(e[n=n.replace("[]","")]=e[n]||[],e[n].push(a)):e[n]=a,e):e),{})}(new FormData(t),["lists[]"]):{};e.current_page_url=window.location.href;const n=window.open("about:blank","newspack_google_login","width=500,height=600");let a=!1;window.addEventListener("google-oauth-success",(()=>{a=!0,(e=>{fetch(`/wp-json/newspack/v1/login/google/register?metadata=${JSON.stringify(e)}`).then((e=>{e.json().then((({message:n,data:a})=>{t?.endLoginFlow&&t.endLoginFlow(n,e.status,a)})).catch((n=>{t?.endLoginFlow&&t.endLoginFlow(n?.message,e.status)}))})).catch((e=>{t?.endLoginFlow&&t.endLoginFlow(e?.message)}))})(e)})),fetch("/wp-json/newspack/v1/login/google?r="+Math.random()).then((e=>e.json().then((t=>Promise.resolve({data:t,status:e.status}))))).then((({data:e,status:o})=>{if(200!==o)n&&n.close(),t?.endLoginFlow&&t.endLoginFlow(e.message,o);else if(n){n.location=e;const o=setInterval((()=>{!a&&n.closed&&(t?.endLoginFlow&&t.endLoginFlow(newspack_reader_activation_labels.login_canceled,401),clearInterval(o))}),500)}else t?.endLoginFlow&&t.endLoginFlow(newspack_reader_activation_labels.blocked_popup)})).catch((e=>{t?.endLoginFlow&&t.endLoginFlow(e?.message,400),n&&n.close()}))}))}))})),s((function(){document.querySelectorAll('input[name="otp_code"]').forEach((e=>{const t=parseInt(e.getAttribute("maxlength"));if(!t)return;const n=e.parentNode;n.removeChild(e);const a=[],o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name","otp_code"),n.appendChild(o);for(let e=0;e<t;e++){const r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("maxlength","1"),r.setAttribute("pattern","[0-9]"),r.setAttribute("autocomplete","off"),r.setAttribute("inputmode","numeric"),r.setAttribute("data-index",e),r.addEventListener("keydown",(t=>{const r=n.querySelector(`[data-index="${e-1}"]`),i=n.querySelector(`[data-index="${e+1}"]`);switch(t.key){case"Backspace":t.preventDefault(),t.target.value="",r&&r.focus(),a[e]="",o.value=a.join("");break;case"ArrowLeft":t.preventDefault(),r&&r.focus();break;case"ArrowRight":t.preventDefault(),i&&i.focus();break;default:t.key.match(/^[0-9]$/)&&(t.preventDefault(),t.target.value=t.key,t.target.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),i&&i.focus())}})),r.addEventListener("input",(t=>{t.target.value.match(/^[0-9]$/)?a[e]=t.target.value:t.target.value="",o.value=a.join("")})),r.addEventListener("paste",(e=>{e.preventDefault();const r=(e.clipboardData||window.clipboardData).getData("text");if(r.length===t){for(let e=0;e<t;e++)r[e].match(/^[0-9]$/)&&(n.querySelector(`[data-index="${e}"]`).value=r[e],a[e]=r[e]);o.value=a.join("")}})),n.appendChild(r)}}))}));const d=["register","signin","pwd","otp","success"];window.newspackRAS=window.newspackRAS||[],window.newspackRAS.push((function(e){s((function(){const t=[...document.querySelectorAll(".newspack-reader-auth")];t?.length&&t.forEach((t=>{const n=t.querySelector("form");if(!n)return;const a=n.querySelector('input[name="action"]'),o=n.querySelector('input[name="npe"]'),r=n.querySelector('input[name="otp_code"]'),i=n.querySelector('input[name="password"]'),s=n.querySelectorAll('[type="submit"]'),u=t.querySelectorAll("[data-back]"),p=t.querySelector("[data-send-code]"),w=t.querySelector("[data-resend-code]"),f=t.querySelector(".response"),g=e=>{e.addEventListener("click",(function(e){e.preventDefault(),t.setFormAction(e.target.getAttribute("data-set-action"),!0)}))};let h;n.setMessageContent=(e="",t=!1)=>{e?("string"==typeof e?f.innerHTML=e:f.appendChild(e),t?(f.classList.remove("newspack-ui__helper-text"),f.classList.add("newspack-ui__inline-error")):(f.classList.remove("newspack-ui__inline-error"),f.classList.add("newspack-ui__helper-text")),f.style.display="block",f.querySelectorAll('a[data-set-action="register"], a[data-set-action="signin"]').forEach((e=>{e.parentNode.setAttribute("data-action","signin"),e.addEventListener("click",(function(){f.innerHTML=""}),!1)}))):(f.style.display="none",f.innerHTML="",f.classList.remove("newspack-ui__inline-error","newspack-ui__helper-text"))},t.setFormAction=(c,l=!1)=>{d.includes(c)||(c="signin"),"signin"!==c&&"success"!==c||n.setMessageContent();const u=window.newspack_grecaptcha||{};if("v2_invisible"===u?.version&&("register"===c?(s.forEach((e=>e.removeAttribute("data-skip-recaptcha"))),u.render([n],(e=>n.setMessageContent(e,!0)))):s.forEach((e=>e.setAttribute("data-skip-recaptcha","")))),"otp"===c){if(!e.getOTPHash())return;t.querySelectorAll(".email-address").forEach((t=>{t.textContent=e.getReader()?.email||""}));const n=t.querySelector('.otp-field input[type="text"]');n&&n.focus()}h=c,a.value=c,t.removeAttribute("data-form-status"),t.querySelectorAll("[data-action]").forEach((e=>{"none"!==e.style.display&&(e.prevDisplay=e.style.display),e.style.display="none"})),t.querySelectorAll('[data-action~="'+c+'"]').forEach((e=>{e.style.display=e.prevDisplay})),l&&("pwd"===c&&o.value?i.focus():"otp"===c?r.focus():o.focus()),t.formActionCallback&&t.formActionCallback(c)},t.setFormAction("signin");const v=()=>{const t=e.getReader();o&&(o.value=t?.email||""),setTimeout((function(){t?.authenticated&&"success"!==h&&n.endLoginFlow(null,200)}),1e3)};e.on("reader",v),v(),u.forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault(),n.setMessageContent(),t.setFormAction("signin",!0)}))}));const m=()=>{if(!w)return;w.originalButtonText=w.textContent.replace(/\s\(\d{1,}:\d{2}\)/,"");const t=()=>{const t=e.getOTPTimeRemaining();t?w.textContent=`${w.originalButtonText} (${function(e){const t=e%60;return`${Math.floor(e/60)}:${t<10?"0":""}${t}`}(t)})`:(w.textContent=w.originalButtonText,clearInterval(w.otpTimerInterval)),w.disabled=!!t};e.getOTPTimeRemaining()&&(w.otpTimerInterval=setInterval(t,1e3),t())};(p||w)&&[p,w].forEach((a=>{a.addEventListener("click",(function(a){a.preventDefault(),n.setMessageContent(),n.startLoginFlow();const r=new FormData;if(r.set("reader-activation-auth-form",1),r.set("npe",o.value),r.set("action","link"),(0,c.mB)()){const e=new URL(window.location.href);e.searchParams.set("checkout",1),r.set("redirect_url",e.toString())}fetch(n.getAttribute("action")||window.location.pathname,{method:"POST",headers:{Accept:"application/json"},body:r}).then((a=>{if(200!==a.status)return a.json().then((({message:e})=>{n.endLoginFlow(e,a.status)}));n.setMessageContent("pwd"===h?newspack_reader_activation_labels.code_sent:newspack_reader_activation_labels.code_resent),t.setFormAction("otp"),e.getOTPTimeRemaining()||e.setOTPTimer()})).finally((()=>{m(),n.style.opacity=1,s.forEach((e=>{e.disabled=!1}))}))}))})),t.querySelectorAll("[data-set-action]").forEach(g),n.startLoginFlow=()=>{t.removeAttribute("data-form-status"),s.forEach((e=>{e.disabled=!0})),n.setMessageContent(),n.style.opacity=.5},n.endLoginFlow=(a=null,o=500,r=null)=>{if(t.setAttribute("data-form-status",o),n.style.opacity=1,s.forEach((e=>{e.disabled=!1})),a&&(document.createElement("p").innerHTML=a,200!==o&&(n.setMessageContent(a,!0),f.querySelectorAll("[data-set-action]").forEach(g))),200===o){let n;if(r&&(e.setReaderEmail(r.email),e.setAuthenticated(!!r.authenticated)),n=!t.config?.skipNewslettersSignup&&r?.registered&&t.authCallback?(e,n)=>(0,l.a)({onSuccess:t.authCallback(e,n),closeOnSuccess:!0}):t.authCallback,t.config?.skipSuccess)n&&n(a,r);else{let e=newspack_reader_activation_labels.signin;r?.registered&&(e=newspack_reader_activation_labels.register),t.setFormAction("success"),t.querySelector(".success-title").innerHTML=e.success_title||"",t.querySelector(".success-description").innerHTML=e.success_description||"";const o=t.querySelector(".auth-callback");o&&n&&o.addEventListener("click",(e=>{e.preventDefault(),n(a,r)}));const i=t.querySelector(".set-password");if(i){const e=i.style.display;if(r?.password_url)i.style.display=e,i.setAttribute("href",r.password_url);else{i.style.display="none",i.setAttribute("href","#");const e=t.querySelector(".auth-callback");e&&e.classList.add("newspack-ui__last-child")}}if(r?.redirect_to){const e=t.querySelector(".auth-callback");e&&e.setAttribute("href",r.redirect_to)}}}},n.addEventListener("submit",(a=>{a.preventDefault(),n.startLoginFlow();const o=n.action?.value;if(!n.npe?.value)return n.endLoginFlow(newspack_reader_activation_labels.invalid_email,400);if("pwd"===o&&!n.password?.value)return n.endLoginFlow(newspack_reader_activation_labels.invalid_password,400);const r=new FormData(a.target);if(!r.has("npe")||!r.get("npe"))return n.endLoginFlow(newspack_reader_activation_labels.invalid_email,400);if((0,c.mB)()){const e=new URL(window.location.href);e.searchParams.set("checkout",1),r.set("redirect_url",e.toString())}"otp"===o?e.authenticateOTP(r.get("otp_code")).then((e=>{n.endLoginFlow(e.message,200,e)})).catch((e=>{e.expired&&t.setFormAction("signin"),n.endLoginFlow(e.message,400)})):fetch(n.getAttribute("action")||window.location.pathname,{method:"POST",headers:{Accept:"application/json"},body:r}).then((a=>{t.setAttribute("data-form-status",a.status),a.json().then((({message:o,data:i})=>{const s=a.status;200===s&&e.setReaderEmail(r.get("npe")),i.action?(t.setFormAction(i.action,!0),"otp"===i.action&&(e.setOTPTimer(),m())):n.endLoginFlow(o,s,i)})).catch((()=>{n.endLoginFlow()})).finally((()=>{n.style.opacity=1,s.forEach((e=>{e.disabled=!1}))}))})).catch((()=>{n.endLoginFlow()}))}))}))}))})),window.newspackRAS=window.newspackRAS||[],window.newspackRAS.push((e=>{s((function(){function t(e){const t=r();if(!t)return;const n=window.location.hash.replace("#","");o.includes(n)&&(e&&e.preventDefault(),t.setFormAction("register_modal"===n?"register":"signin"),i())}function n(e){e.preventDefault();const t=e.target;let n,a;if(a=e.target.getAttribute("data-redirect")?e.target.getAttribute("data-redirect"):e.target.getAttribute("href"),!a){const t=e.target.closest("a");t&&(a=t.getAttribute("data-redirect")?t.getAttribute("data-redirect"):t.getAttribute("href"))}a&&"#"!==a&&(n=()=>{window.location.href=a}),i({onSuccess:n,onError:n,trigger:t})}function a(){document.querySelectorAll(`[data-newspack-reader-account-link],[href="${newspack_ras_config.account_url}"]`).forEach((e=>{e.addEventListener("click",n)}))}function s(){const e=window.newspackReaderActivation.getReader(),t=document.querySelectorAll(".newspack-reader__account-link");t?.length&&t.forEach((t=>{const n=JSON.parse(t.getAttribute("data-labels")),a=t.querySelector(".newspack-reader__account-link__label");a&&(a.textContent=e?.authenticated?n.signedin:n.signedout,e?.authenticated&&t.setAttribute("href",newspack_ras_config.account_url))}))}e._openAuthModal=i,window.addEventListener("hashchange",t),t(),a(),setTimeout(a,1e3),window.newspackReaderActivation.on("reader",s),s()}))}))},5920:(e,t,n)=>{n.d(t,{AU:()=>l,Ic:()=>s,on:()=>c,qY:()=>o});const a="newspack-ras",o={reader:"reader",data:"data",activity:"activity",overlay:"overlay"},r=Object.values(o);function i(e){return r.includes(e)?`${a}-${e}`:""}function s(e,t){if(!(e=i(e)))throw new Error("Invalid event");window.dispatchEvent(new CustomEvent(e,{detail:t}))}function c(e,t){if(!(e=i(e)))throw new Error("Invalid event");window.addEventListener(e,t)}function l(e,t){if(!(e=i(e)))throw new Error("Invalid event");window.removeEventListener(e,t)}}},n={};function a(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=t,e=[],a.O=(t,n,o,r)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,o,r]=e[d],s=!0,c=0;c<n.length;c++)(!1&r||i>=r)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(s=!1,r<i&&(i=r));if(s){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.j=193,(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={193:0,619:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[i,s,c]=n,l=0;if(i.some((t=>0!==e[t]))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(c)var d=c(a)}for(t&&t(n);l<i.length;l++)r=i[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=globalThis.webpackChunknewspack=globalThis.webpackChunknewspack||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=a.O(void 0,[223],(()=>a(9722)));o=a.O(o)})();