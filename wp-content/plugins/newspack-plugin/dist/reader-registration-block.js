(()=>{"use strict";var e,t,n={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(n),e=window.newspackReaderActivation,t=function(){e&&document.querySelectorAll(".newspack-registration").forEach((t=>{const n=t.querySelector("form");if(!n)return;const o=t.querySelector(".newspack-registration__response"),a=n.querySelector('input[type="submit"]');let s=t.querySelector(".newspack-registration__success");e.on("reader",(e=>{let{detail:{authenticated:t}}=e;t&&(n.style.display="none")})),n.startLoginFlow=()=>{o.innerHTML="",a.disabled=!0,t.classList.add("newspack-registration--in-progress")},n.endLoginFlow=(r,i,l)=>{let c;if(null!=l&&l.existing_user&&(s=document.querySelector(".newspack-login__success")),r){c=document.createElement("p"),c.classList.add("has-text-align-center"),c.textContent=r;const e=s.querySelector("p");e&&null!=l&&l.sso&&e.replaceWith(c)}const d=200===i;t.classList.add("newspack-registration--"+(d?"success":"error")),d?(s.classList.remove("newspack-registration--hidden"),n.remove(),null!=l&&l.email&&(e.setReaderEmail(l.email),e.setAuthenticated(null==l?void 0:l.authenticated))):c&&o.appendChild(c),a.disabled=!1,t.classList.remove("newspack-registration--in-progress")},n.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData(n);t.has("email")&&t.get("email")&&(n.startLoginFlow(),fetch(n.getAttribute("action")||window.location.pathname,{method:"POST",headers:{Accept:"application/json"},body:t}).then((e=>{e.json().then((t=>{let{message:o,data:a}=t;return n.endLoginFlow(o,e.status,a)}))})).finally(n.endLoginFlow))}))}))},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",t):t());var o=window;for(var a in n)o[a]=n[a];n.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();