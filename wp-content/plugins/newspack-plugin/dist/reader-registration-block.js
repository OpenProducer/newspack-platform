(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e),window.newspackRAS=window.newspackRAS||[],window.newspackRAS.push((function(e){var t;t=function(){document.querySelectorAll(".newspack-registration").forEach((t=>{const n=t.querySelector("form");if(!n)return;const a=t.querySelector(".newspack-registration__response"),s=n.querySelector('button[type="submit"]'),r=document.createElement("span");r.classList.add("spinner");let i=t.querySelector(".newspack-registration__registration-success");n.startLoginFlow=()=>{a.classList.add("newspack-registration--hidden"),a.innerHTML="",s.disabled=!0,s.appendChild(r),t.classList.add("newspack-registration--in-progress")},n.endLoginFlow=(o=null,d=500,c=null)=>{let l;if(c?.existing_user&&(i=t.querySelector(".newspack-registration__login-success")),o){l=document.createElement("p"),l.classList.add("has-text-align-center"),l.textContent=o;const e=i.querySelector("p");e&&c?.sso&&e.replaceWith(l)}const u=200===d;t.classList.add("newspack-registration--"+(u?"success":"error")),u?(i.classList.remove("newspack-registration--hidden"),n.remove(),c?.email&&(e.setReaderEmail(c.email),e.setAuthenticated(c?.authenticated))):l&&(a.appendChild(l),a.classList.remove("newspack-registration--hidden")),s.removeChild(r),s.disabled=!1,t.classList.remove("newspack-registration--in-progress")},n.addEventListener("submit",(t=>{if(t.preventDefault(),n.startLoginFlow(),!n.npe?.value)return n.endLoginFlow("Please enter a vaild email address.",400);e.getCaptchaV3Token().then((e=>{if(!e)return;let t=n["g-recaptcha-response"];t||(t=document.createElement("input"),t.setAttribute("type","hidden"),t.setAttribute("name","g-recaptcha-response"),t.setAttribute("autocomplete","off"),n.appendChild(t)),t.value=e})).catch((e=>{n.endLoginFlow(e,400)})).finally((()=>{const e=new FormData(n);if(!e.has("npe")||!e.get("npe"))return n.endFlow("Please enter a vaild email address.",400);fetch(n.getAttribute("action")||window.location.pathname,{method:"POST",headers:{Accept:"application/json"},body:e}).then((e=>{e.json().then((({message:t,data:a})=>n.endLoginFlow(t,e.status,a)))})).catch((e=>{n.endLoginFlow(e,400)}))}))})),e.on("reader",(({detail:{authenticated:e}})=>{e&&n.endLoginFlow(null,200)}))}))},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",t):t())}));var t=window;for(var n in e)t[n]=e[n];e.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})})();