(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}e.r(t);var r;function c(){var e=document.querySelector('iframe[name="newspack_modal_checkout"]');e&&(e.src="about:blank"),document.body.classList.remove("newspack-modal-checkout-open"),r&&r.disconnect(),Array.from(document.querySelectorAll(".newspack-blocks-modal")).forEach((function(e){var t,n;(e.style.display="none",e.overlayId&&null!==(t=window.newspackReaderActivation)&&void 0!==t&&t.overlays)&&(null===(n=window.newspackReaderActivation)||void 0===n||n.overlays.remove(e.overlayId))}))}window.newspackCloseModalCheckout=c;var a,l=".newspack-blocks-modal";a=function(){var e=document.querySelector(".newspack-blocks-checkout-modal");if(e){var t=document.querySelector("".concat(l,"__spinner")),n="newspack_modal_checkout",a=document.createElement("input");a.type="hidden",a.name="modal_checkout",a.value="1";var i=e.querySelector("".concat(l,"__content")),d=i.clientHeight+"px",u=document.createElement("iframe");u.name=n,i.appendChild(u),e.addEventListener("click",(function(t){t.target===e&&c()})),e.querySelectorAll("".concat(l,"__close")).forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),i.style.height=d,t.style.display="flex",c()}))}));var s=document.querySelectorAll(".newspack-blocks-variation-modal");s.forEach((function(e){e.addEventListener("click",(function(t){t.target===e&&c()})),e.querySelectorAll(".newspack-blocks-modal__close").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),c()}))}))})),document.querySelectorAll(".wpbnbd.wpbnbd--platform-wc,.wp-block-newspack-blocks-checkout-button,.newspack-blocks-variation-modal").forEach((function(c){c.querySelectorAll("form").forEach((function(c){c.appendChild(a.cloneNode()),c.target=n;var l=c.querySelector('input[name="after_success_url"]'),d=c.querySelector('input[name="after_success_behavior"]');d&&l&&"referrer"===d.getAttribute("value")&&l.setAttribute("value",document.referrer||window.location.href),c.addEventListener("submit",(function(n){var a,l,d=new FormData(c);if(s.forEach((function(e){return e.style.display="none"})),d.get("is_variable")&&!d.get("variation_id")){var f=o(s).find((function(e){return e.dataset.productId===d.get("product_id")}));if(f)return f.querySelectorAll('form[target="newspack_modal_checkout"]').forEach((function(e){["after_success_behavior","after_success_url","after_success_button_label"].forEach((function(t){var n=document.createElement("input");n.type="hidden",n.name=t,n.value=d.get(t),e.appendChild(n)}))})),n.preventDefault(),document.body.classList.add("newspack-modal-checkout-open"),void(f.style.display="block")}t.style.display="flex",e.style.display="block",document.body.classList.add("newspack-modal-checkout-open"),null!==(a=window.newspackReaderActivation)&&void 0!==a&&a.overlays&&(e.overlayId=null===(l=window.newspackReaderActivation)||void 0===l?void 0:l.overlays.add()),r=new ResizeObserver((function(e){if(e&&e.length){var n=e[0].contentRect;n&&(i.style.height=n.top+n.bottom+"px",t.style.display="none")}})),u.addEventListener("load",(function(){var e=u.contentWindow.location;if(window.newspackReaderActivation&&e.href.indexOf("order-received")>-1){var n=window.newspackReaderActivation,c=new Proxy(new URLSearchParams(e.search),{get:function(e,t){return e.get(t)}});c.email&&(n.setReaderEmail(c.email),n.setAuthenticated(!0))}var a=u.contentDocument.querySelector("#newspack_modal_checkout");a&&r.observe(a),o(u.contentDocument.querySelectorAll(".modal-continue, .edit-billing-link")).forEach((function(e){e.addEventListener("click",(function(){return t.style.display="flex"}))}));var l=u.contentDocument.querySelector(".checkout");l&&o(l.querySelectorAll(".woocommerce-billing-fields input")).forEach((function(e){e.addEventListener("keyup",(function(e){"Enter"===e.key&&(t.style.display="flex",l.submit())}))}))}))}))}))}))}},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",a):a());var i=window;for(var d in t)i[d]=t[d];t.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();