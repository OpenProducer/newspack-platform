(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}e.r(t);var r,c;function a(e){var t=e.querySelector("iframe");t&&(t.src="about:blank"),document.body.classList.remove("newspack-modal-checkout-open"),r&&r.disconnect(),e.style.display="none"}c=function(){var e=document.querySelector(".newspack-blocks-checkout-modal");if(e){var t=document.querySelector(".newspack-blocks-checkout-modal__spinner"),n="newspack_modal_checkout",c=document.createElement("input");c.type="hidden",c.name="modal_checkout",c.value="1";var i=e.querySelector(".newspack-blocks-checkout-modal__content"),l=document.createElement("iframe");l.name=n,i.appendChild(l),e.addEventListener("click",(function(t){t.target===e&&a(e)})),e.querySelectorAll(".newspack-blocks-checkout-modal__close").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault(),a(e)}))}));var d=document.querySelectorAll(".newspack-blocks-variation-modal");d.forEach((function(e){e.addEventListener("click",(function(t){t.target===e&&a(e)})),e.querySelectorAll(".newspack-blocks-variation-modal__close").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault(),a(e)}))}))})),document.querySelectorAll(".wpbnbd.wpbnbd--platform-wc,.wp-block-newspack-blocks-checkout-button,.newspack-blocks-variation-modal").forEach((function(a){a.querySelectorAll("form").forEach((function(a){a.appendChild(c.cloneNode()),a.target=n,a.addEventListener("submit",(function(n){var c=new FormData(a);if(d.forEach((function(e){return e.style.display="none"})),c.get("is_variable")&&!c.get("variation_id")){var u=o(d).find((function(e){return e.dataset.productId===c.get("product_id")}));if(u)return n.preventDefault(),document.body.classList.add("newspack-modal-checkout-open"),void(u.style.display="block")}t.style.display="flex",e.style.display="block",document.body.classList.add("newspack-modal-checkout-open"),r=new ResizeObserver((function(e){if(e&&e.length){var t=e[0].contentRect;t&&(i.style.height=t.top+t.bottom+"px")}})),l.addEventListener("load",(function(){var e=l.contentWindow.location;if(window.newspackReaderActivation&&e.href.indexOf("order-received")>-1){var n=window.newspackReaderActivation,o=new Proxy(new URLSearchParams(e.search),{get:function(e,t){return e.get(t)}});o.email&&(n.setReaderEmail(o.email),n.setAuthenticated(!0))}var c=l.contentWindow.document.querySelector("#newspack_modal_checkout");c&&r.observe(c),t.style.display="none"}))}))}))}))}},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",c):c());var i=window;for(var l in t)i[l]=t[l];t.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();