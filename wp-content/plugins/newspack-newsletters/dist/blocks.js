(()=>{var e={6942:(e,s)=>{var t;!function(){"use strict";var l={}.hasOwnProperty;function a(){for(var e="",s=0;s<arguments.length;s++){var t=arguments[s];t&&(e=r(e,n(t)))}return e}function n(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var s="";for(var t in e)l.call(e,t)&&e[t]&&(s=r(s,t));return s}function r(e,s){return s?e?e+" "+s:e+s:e}e.exports?(a.default=a,e.exports=a):void 0===(t=function(){return a}.apply(s,[]))||(e.exports=t)}()}},s={};function t(l){var a=s[l];if(void 0!==a)return a.exports;var n=s[l]={exports:{}};return e[l](n,n.exports,t),n.exports}t.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},t.d=(e,s)=>{for(var l in s)t.o(s,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:s[l]})},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};t.r(e),t.d(e,{metadata:()=>_,name:()=>y,settings:()=>f});const s=window.wp.blocks,l=window.wp.primitives,a=window.ReactJSXRuntime,n=(0,a.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(l.Path,{fillRule:"evenodd",d:"M6 5.5h12a.5.5 0 01.5.5v7H14a2 2 0 11-4 0H5.5V6a.5.5 0 01.5-.5zm-.5 9V18a.5.5 0 00.5.5h12a.5.5 0 00.5-.5v-3.5h-3.337a3.5 3.5 0 01-6.326 0H5.5zM4 13V6a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2v-5z",clipRule:"evenodd"})});var r=t(6942),i=t.n(r);const o=window.lodash,c=window.wp.apiFetch;var p=t.n(c);const d=window.wp.i18n,u=window.wp.element,h=window.wp.components,w=window.wp.blockEditor,m=window.wp.data,b=e=>"newspack-newsletters-list-checkbox-"+e,g=newspack_newsletters_blocks.settings_url,x=[{label:(0,d.__)("Initial","newspack-newsletters"),value:"initial"},{label:(0,d.__)("Success","newspack-newsletters"),value:"success"}];function k(e){let s="";if(e){const t=(0,m.select)("core/editor").getEditorSettings(),l=(0,w.getColorObjectByColorValue)(t.colors,e);l&&(s=l.slug)}return s}const _=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"newspack-newsletters/subscribe","title":"Newsletter Subscription Form","category":"newspack","description":"Subscribe an email to a newsletter list.","textdomain":"newspack-newsletters","attributes":{"displayInputLabels":{"type":"boolean","default":false},"placeholder":{"type":"string","default":"Email Address"},"emailLabel":{"type":"string","default":"Email Address"},"displayNameField":{"type":"boolean","default":false},"displayLastNameField":{"type":"boolean","default":false},"namePlaceholder":{"type":"string","default":"Name"},"nameLabel":{"type":"string","default":"Name"},"lastNamePlaceholder":{"type":"string","default":"Last Name"},"lastNameLabel":{"type":"string","default":"Last Name"},"label":{"type":"string","default":"Sign up"},"displayDescription":{"type":"boolean","default":true},"lists":{"type":"array","default":[],"items":{"type":"string"}},"listsCheckboxes":{"type":"object","default":{}},"mailchimpDoubleOptIn":{"type":"boolean","default":false},"successMessage":{"type":"string","default":"Thank you for signing up!"},"className":{"type":"string"},"textColor":{"type":"string","default":"#ffffff"},"textColorName":{"type":"string","default":""},"backgroundColor":{"type":"string","default":"#dd3333"},"backgroundColorName":{"type":"string","default":""}},"supports":{"html":false,"align":true},"styles":[{"name":"modern","label":"Modern"}]}'),{name:y}=_,f={icon:{src:n,foreground:"#36f"},edit:function({setAttributes:e,attributes:{displayInputLabels:s,placeholder:t,emailLabel:l,displayNameField:n,displayLastNameField:r,namePlaceholder:c,nameLabel:m,lastNamePlaceholder:_,lastNameLabel:y,label:f,successMessage:j,lists:v,listsCheckboxes:C,displayDescription:N,mailchimpDoubleOptIn:S,textColor:P,backgroundColor:L}}){const T=(0,w.useBlockProps)(),[O,B]=(0,u.useState)(x[0].value),[D,F]=(0,u.useState)(!1),[A,M]=(0,u.useState)({});(0,u.useEffect)((()=>{F(!0),p()({path:"/newspack-newsletters/v1/lists_config"}).then(M).finally((()=>F(!1)))}),[]),(0,u.useEffect)((()=>{const s=Object.keys(A);!s.length||v.length&&(0,o.intersection)(v,s).length||e({lists:[Object.keys(A)[0]]})}),[A]);const E=e=>!C.hasOwnProperty(e)||C[e],I=s=>()=>{const t={...C};t[s]=!E(s),e({listsCheckboxes:t})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(w.InspectorControls,{children:[(0,a.jsxs)(h.PanelBody,{title:(0,d.__)("Form settings","newspack-newsletters"),children:[(0,a.jsx)(h.ToggleControl,{label:(0,d.__)("Display input labels","newspack-newsletters"),checked:s,onChange:s=>e({displayInputLabels:s})}),(0,a.jsx)(h.TextControl,{label:(0,d.__)("Email placeholder","newspack-newsletters"),value:t,onChange:s=>e({placeholder:s})}),(0,a.jsx)(h.ToggleControl,{label:(0,d.__)("Display name field","newspack-newsletters"),checked:n,onChange:s=>e({displayNameField:s})}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.TextControl,{label:(0,d.__)("Name placeholder","newspack-newsletters"),value:c,onChange:s=>e({namePlaceholder:s})}),(0,a.jsx)(h.ToggleControl,{label:(0,d.__)('Display "Last Name" field',"newspack-newsletters"),checked:r,onChange:s=>e({displayLastNameField:s})}),r&&(0,a.jsx)(h.TextControl,{label:(0,d.__)('"Last Name" placeholder',"newspack-newsletters"),value:_,onChange:s=>e({lastNamePlaceholder:s})})]}),v.length>1&&(0,a.jsx)(h.ToggleControl,{label:(0,d.__)("Display list description","newspack-newsletters"),checked:N,onChange:()=>e({displayDescription:!N})})]}),(0,a.jsxs)(h.PanelBody,{title:(0,d.__)("Styles","newspack-newsletters"),className:"styles-container",children:[(0,a.jsx)("p",{children:(0,d.__)("Make sure to pick a color that will contrast against the rest of your site's color scheme, to help this block stand out!","newspack-newsletters")}),(0,a.jsx)(w.PanelColorSettings,{initialOpen:!0,colorSettings:[{value:P,onChange:s=>{e({textColorName:k(s)}),e({textColor:s})},label:(0,d.__)("Text color","newspack-newsletters")},{value:L,onChange:s=>{e({backgroundColorName:k(s)}),e({backgroundColor:s})},label:(0,d.__)("Background color","newspack-newsletters")}]})]}),(0,a.jsxs)(h.PanelBody,{title:(0,d.__)("Subscription Lists","newspack-newsletters"),children:[D&&(0,a.jsx)(h.Spinner,{}),!D&&!Object.keys(A).length&&(0,a.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,a.jsx)(h.Notice,{isDismissible:!1,status:"error",children:(0,d.__)("You must enable lists for subscription.","newspack-newsletters")})}),v.length<1&&(0,a.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,a.jsx)(h.Notice,{isDismissible:!1,status:"error",children:(0,d.__)("You must select at least one list.","newspack-newsletters")})}),Object.keys(A).map((s=>(0,a.jsx)(h.ToggleControl,{label:A[s].title,checked:v.includes(s),onChange:()=>{v.includes(s)?e({lists:v.filter((e=>e!==s))}):e({lists:v.concat(s)})}},s))),(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:g,children:(0,d.__)("Manage your subscription lists","newspack-newsletters")})})]}),"mailchimp"===newspack_newsletters_blocks.provider&&(0,a.jsx)(h.PanelBody,{title:(0,d.__)("Mailchimp Settings","newspack-newsletters"),children:(0,a.jsx)(h.CheckboxControl,{label:(0,d.__)("Enable double opt-in","newspack-newsletters"),help:(0,d.__)('Whether the new contact will have its status as "pending" until email confirmation',"newspack-newsletters"),checked:S,onChange:s=>e({mailchimpDoubleOptIn:s})})}),newspack_newsletters_blocks.supports_recaptcha&&(0,a.jsxs)(h.PanelBody,{title:(0,d.__)("Spam protection","newspack-newsletters"),children:[(0,a.jsx)("p",{children:(0,d.sprintf)(
// translators: %s is either 'enabled' or 'disabled'.
// translators: %s is either 'enabled' or 'disabled'.
(0,d.__)("reCAPTCHA is currently %s.","newspack-newsletters"),newspack_newsletters_blocks.has_recaptcha?(0,d.__)("enabled","newspack-newsletters"):(0,d.__)("disabled","newspack-newsletters"))}),!newspack_newsletters_blocks.has_recaptcha&&(0,a.jsx)("p",{children:(0,d.__)("It's highly recommended that you enable reCAPTCHA protection to prevent spambots from using this form!","newspack-newsletters")}),(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:newspack_newsletters_blocks.recaptcha_url,children:(0,d.__)("Configure your reCAPTCHA settings.","newspack-newsletters")})})]})]}),(0,a.jsxs)("div",{...T,children:[(0,a.jsxs)("div",{className:"newspack-newsletters-subscribe__state-bar",children:[(0,a.jsx)("span",{children:(0,d.__)("Edited State","newspack-newsletters")}),(0,a.jsx)("div",{children:x.map((e=>(0,a.jsx)(h.Button,{"data-is-active":O===e.value,onClick:()=>B(e.value),children:e.label},e.value)))})]}),D?(0,a.jsx)(h.Spinner,{}):(0,a.jsxs)("div",{className:i()({"newspack-newsletters-subscribe":!0,"multiple-lists":v.length>1}),"data-status":"200",children:["initial"===O&&(0,a.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[v.length>1&&(0,a.jsx)("div",{className:"newspack-newsletters-lists",children:(0,a.jsx)("ul",{children:v.map((e=>(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"list-checkbox",children:(0,a.jsx)("input",{id:b(e),type:"checkbox",checked:E(e),onChange:I(e)})}),(0,a.jsx)("span",{className:"list-details",children:(0,a.jsxs)("label",{htmlFor:b(e),children:[(0,a.jsx)("span",{className:"list-title",children:A[e]?.title}),N&&(0,a.jsx)("span",{className:"list-description",children:A[e]?.description})]})})]},e)))})}),n&&(0,a.jsxs)("div",{className:"newspack-newsletters-name-input",children:[(0,a.jsxs)("div",{className:"newspack-newsletters-name-input-item",children:[(0,a.jsx)("label",{children:s&&(0,a.jsx)(w.RichText,{onChange:s=>e({nameLabel:s}),placeholder:(0,d.__)("Name","newspack-newsletters"),value:m,tagName:"span"})}),(0,a.jsx)("input",{type:"text",placeholder:c})]}),r&&(0,a.jsxs)("div",{className:"newspack-newsletters-name-input-item",children:[(0,a.jsx)("label",{children:s&&(0,a.jsx)(w.RichText,{onChange:s=>e({lastNameLabel:s}),placeholder:(0,d.__)("Last Name","newspack-newsletters"),value:y,tagName:"span"})}),(0,a.jsx)("input",{type:"text",placeholder:_})]})]}),(0,a.jsxs)("div",{className:"newspack-newsletters-email-input",children:[(0,a.jsx)("label",{children:s&&(0,a.jsx)(w.RichText,{onChange:s=>e({emailLabel:s}),placeholder:(0,d.__)("Email Address","newspack-newsletters"),value:l,tagName:"span"})}),(0,a.jsx)("input",{type:"email",placeholder:t}),(0,a.jsx)("div",{className:"submit-button",style:{backgroundColor:L,color:P},children:(0,a.jsx)(w.RichText,{onChange:s=>e({label:s}),placeholder:(0,d.__)("Sign up","newspack-newsletters"),value:f,tagName:"span"})})]})]}),"success"===O&&(0,a.jsxs)("div",{className:"newspack-newsletters-subscribe__response",children:[(0,a.jsx)("div",{className:"newspack-newsletters-subscribe__icon"}),(0,a.jsx)("div",{className:"newspack-newsletters-subscribe__message",children:(0,a.jsx)(w.RichText,{onChange:s=>e({successMessage:s}),placeholder:(0,d.__)("Success message","newspack-newsletters"),value:j,tagName:"p",className:"message status-200",allowedFormats:["core/bold","core/italic"]})})]})]})]})]})}},j=[e],v=e=>{if(!e)return;const{metadata:t,settings:l,name:a}=e;(0,s.registerBlockType)({name:a,...t},l)};for(const e of j)v(e)})()})();