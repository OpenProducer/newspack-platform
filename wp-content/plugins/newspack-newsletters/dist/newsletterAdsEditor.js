(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t);const n=window.wp.element,r=window.wp.i18n,a=window.wp.editPost,o=window.wp.plugins;function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],_n=!0,l=!1;try{for(n=n.call(e);!(_n=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);_n=!0);}catch(s){l=!0,a=s}finally{try{_n||null==n.return||n.return()}finally{if(l)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const i=window.wp.data,c=window.wp.components,u=window.wp.apiFetch;var d=e.n(u),__=r.__,_n=r._n;function p(e){var t=e.saveOnToggle,a=void 0!==t&&t,o=(0,i.useSelect)((function(e){var t=e("core/editor"),n=t.getEditedPostAttribute,r=t.getCurrentPostId,a=t.isSavingPost,o=e("core/block-editor").getBlocks;return{disableAutoAds:n("meta").disable_auto_ads,postId:r(),isSaving:a(),postBlocks:o()}})),l=o.disableAutoAds,u=o.postId,p=o.isSaving,f=o.postBlocks,w=(0,i.useDispatch)("core/editor"),g=w.editPost,m=w.savePost,b=s((0,n.useState)({count:0,label:__("ads","newspack-newsletters")}),2),v=b[0],y=b[1],h=s((0,n.useState)(!1),2),_=h[0],S=h[1];(0,n.useEffect)((function(){var e=!1;f.forEach((function(t){"newspack-newsletters/ad"===t.name&&(e=!0)})),S(e)}),[f]);var k=s((0,n.useState)(!1),2),E=k[0],P=k[1];return(0,n.useEffect)((function(){P(!0),d()({path:"/wp/v2/".concat("newspack_nl_ads_cpt","/config/?postId=").concat(u)}).then((function(e){y(e)})).catch((function(e){console.warn(e)})).finally((function(){P(!1)}))}),[u]),(0,n.createElement)("div",null,(0,n.createElement)(c.ToggleControl,{label:__("Enable automatic insertion of ads","newspack-newsletters"),checked:!l&&!_,disabled:p||E||_,onChange:function(e){g({meta:{disable_auto_ads:!e}}),a&&m()}}),_?(0,n.createElement)("p",null,__("Automatic ads insertion is disabled because this post contain manually inserted ad blocks.","newspack-newsletters")):null,E?null:(0,n.createElement)(n.Fragment,null,(0,n.createElement)("p",null,(0,r.sprintf)(_n("There is %1$d active %2$s.","There are %1$d active %2$ss.",v.count,"newspack-newsletters"),v.count,v.label)),(0,n.createElement)(c.Button,{href:v.manageUrl,rel:v.manageUrlRel,target:v.manageUrlTarget,variant:"secondary"},(0,r.sprintf)(__("Manage %ss","newspack-newsletters"),v.label))))}var f=r.__;(0,o.registerPlugin)("newspack-newsletters-ads-settings",{render:function(){return(0,n.createElement)(a.PluginDocumentSettingPanel,{name:"newsletters-ads-settings-panel",title:f("Ads Settings","newspack-newsletters")},(0,n.createElement)(p,null))},icon:null});var w=window;for(var g in t)w[g]=t[g];t.__esModule&&Object.defineProperty(w,"__esModule",{value:!0})})();